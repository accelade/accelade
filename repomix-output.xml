This file is a merged representation of a subset of the codebase, containing files not matching ignore patterns, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching these patterns are excluded: **/*.log, tmp/, .js, .html, .blade.php, .css, public/, vendor/, node_modules, venv/, logs/, electorn-sentinerl/
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.claude/
  settings.local.json
.github/
  ISSUE_TEMPLATE/
    bug.yml
    config.yml
  workflows/
    dependabot-auto-merge.yml
    fix-php-code-styling.yml
    playwright.yml
    tests.yml
  dependabot.yml
  FUNDING.yml
  SECURITY.md
arts/
  logo.svg
config/
  accelade.php
docs/
  animations.md
  api-reference.md
  architecture.md
  bridge.md
  code-block.md
  components.md
  configuration.md
  content.md
  contributing.md
  data.md
  event-bus.md
  event.md
  exception-handling.md
  flash.md
  frameworks.md
  getting-started.md
  installation.md
  lazy-loading.md
  link.md
  modal.md
  notifications.md
  persistent-layout.md
  rehydrate.md
  scripts.md
  seo.md
  shared-data.md
  spa-navigation.md
  sponsor.md
  state.md
  teleport.md
  testing.md
  thanks.md
  toggle.md
resources/
  js/
    adapters/
      angular/
        AngularAdapter.ts
        AngularBindingAdapter.ts
        AngularStateAdapter.ts
        index.ts
      react/
        components.tsx
        hooks.ts
        index.ts
        ReactAdapter.ts
        ReactBindingAdapter.ts
        ReactStateAdapter.ts
      svelte/
        index.ts
        SvelteAdapter.ts
        SvelteBindingAdapter.ts
        SvelteStateAdapter.ts
      vanilla/
        index.ts
        VanillaAdapter.ts
        VanillaBindingAdapter.ts
        VanillaStateAdapter.ts
      vue/
        index.ts
        VueAdapter.ts
        VueBindingAdapter.ts
        VueStateAdapter.ts
      BaseAdapter.ts
      index.ts
      types.ts
    core/
      bridge/
        BridgeFactory.ts
        index.ts
      debug/
        DebugManager.ts
        index.ts
        NetworkInspector.ts
        StateHistory.ts
      echo/
        EchoFactory.ts
        EchoManager.ts
        index.ts
        types.ts
      errors/
        ErrorHandler.ts
      events/
        EventBus.ts
        index.ts
      factories/
        ActionsFactory.ts
        ConfigFactory.ts
        DeferFactory.ts
        index.ts
        ScriptExecutor.ts
        SyncFactory.ts
      flash/
        FlashFactory.ts
        FlashManager.ts
        index.ts
        types.ts
      interpolation/
        index.ts
        TextInterpolator.ts
      lazy/
        index.ts
        LazyLoader.ts
      link/
        ConfirmDialog.ts
        index.ts
        LinkManager.ts
        types.ts
      modal/
        index.ts
        ModalFactory.ts
        ModalManager.ts
        types.ts
      notification/
        index.ts
        NotificationManager.ts
        types.ts
      rehydrate/
        index.ts
        RehydrateFactory.ts
        RehydrateManager.ts
        types.ts
      shared/
        index.ts
        SharedDataManager.ts
      state/
        index.ts
        StateFactory.ts
        types.ts
      teleport/
        index.ts
        TeleportManager.ts
        types.ts
      toggle/
        index.ts
        ToggleFactory.ts
        types.ts
      transition/
        index.ts
        TransitionFactory.ts
        types.ts
      expressions.ts
      progress.ts
      router.ts
      state.ts
      types.ts
      utils.ts
    react/
      accelade.tsx
    registry/
      FrameworkRegistry.ts
      index.ts
    vanilla/
      accelade.ts
    vue/
      accelade.ts
    index.ts
  views/
    components/
      demo/
        bridge-counter.blade.php
      layouts/
        partials/
          framework-icon.blade.php
        demo-sidebar.blade.php
        demo.blade.php
        docs.blade.php
      bridge.blade.php
      code-block.blade.php
      content.blade.php
      counter.blade.php
      data.blade.php
      defer.blade.php
      errors.blade.php
      event.blade.php
      flash.blade.php
      lazy.blade.php
      link.blade.php
      modal.blade.php
      notifications.blade.php
      persistent.blade.php
      rehydrate.blade.php
      script.blade.php
      state.blade.php
      teleport.blade.php
      toggle.blade.php
      transition.blade.php
    demo/
      partials/
        _bridge.blade.php
        _content.blade.php
        _data-component.blade.php
        _defer-component.blade.php
        _errors-component.blade.php
        _event-bus.blade.php
        _event-component.blade.php
        _flash-component.blade.php
        _lazy-loading.blade.php
        _link-component.blade.php
        _modal-component.blade.php
        _persistent-layout.blade.php
        _rehydrate-component.blade.php
        _shared-data.blade.php
        _state-component.blade.php
        _teleport-component.blade.php
        _toggle-component.blade.php
        _transition-component.blade.php
      sections/
        bridge.blade.php
        content.blade.php
        counter.blade.php
        data.blade.php
        defer.blade.php
        errors.blade.php
        event-bus.blade.php
        event.blade.php
        flash.blade.php
        lazy.blade.php
        link.blade.php
        modal.blade.php
        navigation.blade.php
        notifications.blade.php
        persistent.blade.php
        progress.blade.php
        rehydrate.blade.php
        scripts.blade.php
        shared-data.blade.php
        state.blade.php
        teleport.blade.php
        toggle.blade.php
        transition.blade.php
      angular.blade.php
      react.blade.php
      svelte.blade.php
      vanilla.blade.php
      vue.blade.php
    docs/
      sections/
        api-reference.blade.php
        architecture.blade.php
        bridge.blade.php
        code-block.blade.php
        configuration.blade.php
        content.blade.php
        contributing.blade.php
        counter.blade.php
        data.blade.php
        defer.blade.php
        errors.blade.php
        event-bus.blade.php
        event.blade.php
        flash.blade.php
        frameworks.blade.php
        getting-started.blade.php
        installation.blade.php
        lazy.blade.php
        link.blade.php
        modal.blade.php
        navigation.blade.php
        notifications.blade.php
        persistent.blade.php
        progress.blade.php
        rehydrate.blade.php
        scripts.blade.php
        shared-data.blade.php
        sponsor.blade.php
        state.blade.php
        teleport.blade.php
        testing.blade.php
        thanks.blade.php
        toggle.blade.php
        transition.blade.php
routes/
  bridge.php
  docs.php
  web.php
src/
  Animation/
    AnimationManager.php
    AnimationPhase.php
    AnimationPreset.php
  Bridge/
    BridgeManager.php
    BridgeResponse.php
    WithBridge.php
  Broadcasting/
    EventResponse.php
  Compilers/
    AcceladeTagCompiler.php
  Components/
    Demo/
      BridgeCounter.php
    AcceladeComponent.php
    Bridge.php
    Counter.php
    PersistentComponent.php
  Console/
    InstallCommand.php
  Docs/
    DocSection.php
    DocSectionBuilder.php
    DocSectionConfig.php
    DocsRegistry.php
  Exceptions/
    ExceptionHandler.php
  Facades/
    Accelade.php
    Animation.php
    Bridge.php
    Docs.php
    Notify.php
    SEO.php
  Http/
    Controllers/
      AcceladeController.php
      BridgeController.php
      DocsController.php
      NotifyDemoController.php
    Middleware/
      ShareAcceladeData.php
  Notification/
    Notification.php
    NotificationManager.php
  SEO/
    SEO.php
  Support/
    HybridReactivity.php
    SharedData.php
  Accelade.php
  AcceladeServiceProvider.php
tests/
  e2e/
    accelade-demo.spec.ts
    shared-data.spec.ts
  Feature/
    AnimationFacadeTest.php
    ContentComponentTest.php
    DataComponentTest.php
    DeferComponentTest.php
    ErrorsComponentTest.php
    EventComponentTest.php
    FlashComponentTest.php
    LazyComponentTest.php
    LinkComponentTest.php
    ModalComponentTest.php
    NotifyFacadeTest.php
    RehydrateComponentTest.php
    RouteRegistrationTest.php
    SEOFacadeTest.php
    ServiceProviderTest.php
    SharedDataFeatureTest.php
    StateComponentTest.php
    TeleportComponentTest.php
    ToggleComponentTest.php
    TransitionComponentTest.php
  Unit/
    Exceptions/
      ExceptionHandlerTest.php
    AcceladeTest.php
    EventResponseTest.php
    FlashMiddlewareTest.php
    NotificationManagerTest.php
    NotificationTest.php
    SEOTest.php
    SharedDataTest.php
  Pest.php
  TestCase.php
.gitignore
CHANGELOG.md
CLAUDE.md
CODE_OF_CONDUCT.md
composer.json
CONTRIBUTING.md
LICENSE
mago.toml
package.json
phpunit.xml
playwright.config.ts
README.md
tsconfig.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".claude/settings.local.json">
{
  "permissions": {
    "allow": [
      "WebFetch(domain:splade.dev)",
      "Bash(vendor/bin/pest:*)",
      "Bash(npm run build:*)",
      "Bash(vendor/bin/pint:*)",
      "Bash(composer mago:*)",
      "Bash(npm run typecheck:*)",
      "Bash(php artisan test:*)",
      "Bash(php artisan:*)",
      "Bash(cat:*)",
      "Bash(curl:*)",
      "WebSearch",
      "WebFetch(domain:simpleicons.org)",
      "Bash(composer require:*)",
      "Bash(grep:*)",
      "Bash(xargs:*)",
      "Bash(chmod:*)",
      "Bash(composer run-script:*)"
    ]
  },
  "enabledMcpjsonServers": [
    "laravel-boost",
    "herd"
  ],
  "enableAllProjectMcpServers": true
}
</file>

<file path=".github/ISSUE_TEMPLATE/bug.yml">
name: Bug Report
description: Report a bug or unexpected behavior
title: "[Bug]: "
labels: ["bug", "triage"]
assignees: []

body:
  - type: markdown
    attributes:
      value: |
        Thanks for taking the time to report a bug! Please fill out the form below to help us understand and fix the issue.

  - type: checkboxes
    id: prerequisites
    attributes:
      label: Prerequisites
      description: Please confirm the following before submitting
      options:
        - label: I have searched for existing issues and this is not a duplicate
          required: true
        - label: I have read the [documentation](../docs/)
          required: true
        - label: I am using the latest version of Accelade
          required: true

  - type: textarea
    id: description
    attributes:
      label: Bug Description
      description: A clear and concise description of what the bug is
      placeholder: Describe the bug...
    validations:
      required: true

  - type: textarea
    id: reproduction
    attributes:
      label: Steps to Reproduce
      description: Steps to reproduce the behavior
      placeholder: |
        1. Go to '...'
        2. Click on '...'
        3. Scroll down to '...'
        4. See error
    validations:
      required: true

  - type: textarea
    id: expected
    attributes:
      label: Expected Behavior
      description: What did you expect to happen?
      placeholder: Describe what you expected...
    validations:
      required: true

  - type: textarea
    id: actual
    attributes:
      label: Actual Behavior
      description: What actually happened?
      placeholder: Describe what actually happened...
    validations:
      required: true

  - type: textarea
    id: code
    attributes:
      label: Code Sample
      description: If applicable, provide a minimal code sample that reproduces the issue
      render: php
      placeholder: |
        // Your Blade template
        @accelade(['count' => 0])
            <span a-text="count">0</span>
        @endaccelade

  - type: dropdown
    id: framework
    attributes:
      label: Frontend Framework
      description: Which framework adapter are you using?
      options:
        - Vanilla JS
        - Vue 3
        - React 18
        - Svelte 4
        - Angular 17+
        - Not applicable
    validations:
      required: true

  - type: dropdown
    id: component
    attributes:
      label: Affected Component
      description: Which part of Accelade is affected?
      multiple: true
      options:
        - Reactive Components (@accelade)
        - Notifications
        - SPA Navigation
        - Progress Bar
        - Server Sync (a-sync)
        - Blade Directives
        - JavaScript API
        - Other

  - type: input
    id: accelade-version
    attributes:
      label: Accelade Version
      description: What version of Accelade are you using?
      placeholder: "1.0.0"
    validations:
      required: true

  - type: input
    id: php-version
    attributes:
      label: PHP Version
      description: What version of PHP are you running?
      placeholder: "8.3.0"
    validations:
      required: true

  - type: input
    id: laravel-version
    attributes:
      label: Laravel Version
      description: What version of Laravel are you using?
      placeholder: "11.0.0"
    validations:
      required: true

  - type: input
    id: browser
    attributes:
      label: Browser
      description: If this is a frontend issue, what browser are you using?
      placeholder: "Chrome 120, Firefox 121, Safari 17"

  - type: textarea
    id: logs
    attributes:
      label: Error Logs
      description: Include any relevant error messages or logs
      render: shell
      placeholder: |
        Paste error logs here...

  - type: textarea
    id: screenshots
    attributes:
      label: Screenshots
      description: If applicable, add screenshots to help explain your problem
      placeholder: Drag and drop images here...

  - type: textarea
    id: additional
    attributes:
      label: Additional Context
      description: Add any other context about the problem here
      placeholder: Any additional information...

  - type: checkboxes
    id: willing
    attributes:
      label: Contribution
      description: Would you be willing to contribute a fix?
      options:
        - label: I would be willing to submit a PR to fix this issue
</file>

<file path=".github/ISSUE_TEMPLATE/config.yml">
blank_issues_enabled: false

contact_links:
  - name: Documentation
    url: https://github.com/accelade/accelade/tree/main/docs
    about: Check the documentation for answers to common questions

  - name: Discussions
    url: https://github.com/accelade/accelade/discussions
    about: Ask questions and discuss ideas with the community

  - name: Feature Request
    url: https://github.com/accelade/accelade/discussions/categories/ideas
    about: Suggest new features or improvements

  - name: Security Vulnerability
    url: https://github.com/accelade/accelade/security/advisories/new
    about: Report security vulnerabilities privately

  - name: Stack Overflow
    url: https://stackoverflow.com/questions/tagged/accelade
    about: Ask questions on Stack Overflow with the 'accelade' tag
</file>

<file path=".github/dependabot.yml">
version: 2

updates:
  # PHP dependencies (Composer)
  - package-ecosystem: "composer"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    labels:
      - "dependencies"
      - "php"
    commit-message:
      prefix: "chore(deps):"
    groups:
      laravel:
        patterns:
          - "laravel/*"
          - "illuminate/*"
      dev-dependencies:
        dependency-type: "development"
        patterns:
          - "*"

  # JavaScript dependencies (npm)
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    labels:
      - "dependencies"
      - "javascript"
    commit-message:
      prefix: "chore(deps):"
    groups:
      typescript:
        patterns:
          - "typescript"
          - "@types/*"
      vite:
        patterns:
          - "vite"
          - "@vitejs/*"
          - "vite-*"
      testing:
        patterns:
          - "@playwright/*"
          - "playwright"
      frameworks:
        patterns:
          - "vue"
          - "react"
          - "react-dom"
          - "@vue/*"
          - "@types/react*"

  # GitHub Actions
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "monthly"
    labels:
      - "dependencies"
      - "github-actions"
    commit-message:
      prefix: "chore(ci):"
</file>

<file path=".github/FUNDING.yml">
# These are supported funding model platforms
github: fadymondy
</file>

<file path=".github/SECURITY.md">
# Security Policy

## Supported Versions

We release patches for security vulnerabilities in the following versions:

| Version | Supported          |
| ------- | ------------------ |
| 1.x     | :white_check_mark: |
| < 1.0   | :x:                |

## Reporting a Vulnerability

We take security vulnerabilities seriously. If you discover a security issue, please report it responsibly.

### How to Report

**Please do NOT report security vulnerabilities through public GitHub issues.**

Instead, please report them via one of the following methods:

1. **GitHub Security Advisories** (Preferred)
   - Go to the [Security tab](../../security/advisories) of this repository
   - Click "Report a vulnerability"
   - Fill out the form with details

2. **Email**
   - Send an email to: security@example.com (replace with actual email)
   - Use the subject line: `[SECURITY] Accelade Vulnerability Report`

### What to Include

Please include the following information in your report:

- **Type of vulnerability** (e.g., XSS, SQL injection, CSRF, etc.)
- **Location** of the affected source code (file path, line numbers)
- **Steps to reproduce** the vulnerability
- **Proof of concept** or exploit code (if possible)
- **Impact** assessment of the vulnerability
- **Suggested fix** (if you have one)

### What to Expect

1. **Acknowledgment**: We will acknowledge receipt of your report within 48 hours.

2. **Investigation**: We will investigate the issue and determine its severity and impact.

3. **Updates**: We will keep you informed about our progress throughout the process.

4. **Resolution**: Once the issue is resolved, we will:
   - Release a security patch
   - Publish a security advisory
   - Credit you for the discovery (unless you prefer to remain anonymous)

### Timeline

We aim to:

- Acknowledge reports within **48 hours**
- Provide an initial assessment within **1 week**
- Release a patch within **30 days** for critical issues
- Release a patch within **90 days** for non-critical issues

### Safe Harbor

We consider security research conducted in accordance with this policy to be:

- Authorized and lawful
- Helpful to our security posture
- Exempt from legal action by us

We will not pursue legal action against researchers who:

- Act in good faith
- Avoid privacy violations and data destruction
- Do not exploit vulnerabilities beyond what's necessary for the report
- Report vulnerabilities promptly

## Security Best Practices

When using Accelade in your application:

### CSRF Protection

Accelade automatically includes CSRF tokens in all AJAX requests. Ensure your Laravel application has CSRF protection enabled:

```php
// In your layout
<meta name="csrf-token" content="{{ csrf_token() }}">
```

### XSS Prevention

- Always escape user input in Blade templates using `{{ }}` (not `{!! !!}`)
- Be cautious when using `a-html` / `v-html` directives with user content
- Sanitize HTML content before rendering

### Content Security Policy

Consider implementing a Content Security Policy header:

```php
// In a middleware
$response->headers->set('Content-Security-Policy', "default-src 'self'; script-src 'self' 'unsafe-inline'");
```

### Session Security

Accelade stores notifications in the session. Ensure your Laravel session is configured securely:

```php
// config/session.php
'secure' => env('SESSION_SECURE_COOKIE', true),
'http_only' => true,
'same_site' => 'lax',
```

### State Sync Security

When using `a-sync` for server state synchronization:

- Validate all incoming data on the server
- Use authorization checks before updating state
- Sanitize state values before storage

## Vulnerability Disclosure

After a vulnerability has been fixed, we will:

1. Release a new version with the patch
2. Publish a security advisory on GitHub
3. Update this document if needed
4. Notify users through appropriate channels

## Contact

For security-related questions that are not vulnerabilities, please open a regular GitHub issue or discussion.

Thank you for helping keep Accelade and its users safe!
</file>

<file path="arts/logo.svg">
<?xml version="1.0" encoding="UTF-8"?>
<svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 377.22 426">
  <!-- Generator: Adobe Illustrator 29.0.1, SVG Export Plug-In . SVG Version: 2.1.0 Build 192)  -->
  <defs>
    <style>
      .st0 {
        fill: #18395c;
      }

      .st1 {
        fill: #ea7023;
      }
    </style>
  </defs>
  <polygon class="st0" points="377.22 327 263.22 327 227.49 237.96 249.96 204 213.87 204 193.47 153.18 132 0 246 0 250.47 11.13 331.47 213 377.22 327"/>
  <polygon class="st1" points="245.22 0 131.22 0 45.75 213 0 327 114 327 116.61 327 92.22 426 233.22 213 159.75 213 245.22 0"/>
</svg>
</file>

<file path="docs/animations.md">
# Animations

Accelade provides a powerful animation system with built-in presets for smooth enter/leave transitions. Add animations to your toggle components with a single attribute, or use the standalone transition component for more control.

## Quick Start

The simplest way to add animations is with the `animation` attribute on the toggle component:

```blade
<x-accelade::toggle animation="fade">
    <button @click="toggle()">Toggle</button>
    <div a-show="toggled">This content fades in and out!</div>
</x-accelade::toggle>
```

That's it! All `a-show` elements inside the toggle will automatically animate.

## Built-in Presets

| Preset | Description | Best For |
|--------|-------------|----------|
| `default` | Subtle fade with scale (95% to 100%) | Dropdowns, popovers |
| `fade` | Simple opacity fade | General purpose |
| `opacity` | Same as fade (alias) | General purpose |
| `scale` | Scale from center (0% to 100%) | Modals, dialogs |
| `collapse` | Fade only, no translate | Accordions, FAQs |
| `slide-up` | Slide up from bottom | Toasts, notifications |
| `slide-down` | Slide down from top | Menus, dropdowns |
| `slide-left` | Slide in from left | Sidebars, drawers |
| `slide-right` | Slide in from right | Sidebars, drawers |

## Toggle with Animation

Add the `animation` attribute to any toggle component:

```blade
{{-- Fade animation --}}
<x-accelade::toggle animation="fade">
    <button @click="toggle()">Show/Hide</button>
    <div a-show="toggled">Animated content</div>
</x-accelade::toggle>

{{-- Scale animation for modals --}}
<x-accelade::toggle animation="scale">
    <button @click="toggle()">Open Modal</button>
    <div a-show="toggled" class="modal">
        Modal content...
    </div>
</x-accelade::toggle>

{{-- Collapse for accordions (recommended) --}}
<x-accelade::toggle animation="collapse">
    <button @click="toggle()">FAQ Question</button>
    <div a-show="toggled">
        Answer content that fades smoothly without overlap...
    </div>
</x-accelade::toggle>
```

### Accordion Example

For accordions, use the `collapse` preset to avoid content overlapping headers:

```blade
<div class="space-y-2">
    <x-accelade::toggle animation="collapse">
        <div class="border rounded-lg overflow-hidden">
            <button @click="toggle()" class="w-full p-4 text-left flex justify-between">
                <span>What is Accelade?</span>
                <svg a-class="{'rotate-180': toggled}" class="w-5 h-5 transition-transform">...</svg>
            </button>
            <div a-show="toggled" class="p-4 border-t">
                Accelade is a reactive UI library for Laravel Blade...
            </div>
        </div>
    </x-accelade::toggle>

    <x-accelade::toggle animation="collapse">
        <div class="border rounded-lg overflow-hidden">
            <button @click="toggle()" class="w-full p-4 text-left flex justify-between">
                <span>How do I install it?</span>
                <svg a-class="{'rotate-180': toggled}" class="w-5 h-5 transition-transform">...</svg>
            </button>
            <div a-show="toggled" class="p-4 border-t">
                Run: composer require accelade/accelade
            </div>
        </div>
    </x-accelade::toggle>
</div>
```

## Transition Component

For more control, use the standalone `<x-accelade::transition>` component:

```blade
<x-accelade::toggle>
    <button @click="toggle()">Toggle</button>

    <x-accelade::transition show="toggled" animation="scale">
        <div class="modal">
            This uses the transition component directly
        </div>
    </x-accelade::transition>
</x-accelade::toggle>
```

### Custom Classes

Define your own transition using individual class props:

```blade
<x-accelade::transition
    show="toggled"
    enter="transition-all duration-500 ease-out"
    enter-from="opacity-0 translate-y-8 rotate-6"
    enter-to="opacity-100 translate-y-0 rotate-0"
    leave="transition-all duration-300 ease-in"
    leave-from="opacity-100 translate-y-0 rotate-0"
    leave-to="opacity-0 translate-y-8 -rotate-6"
>
    <div>Custom animated content!</div>
</x-accelade::transition>
```

### Props

| Prop | Type | Description |
|------|------|-------------|
| `show` | string | State expression to watch (e.g., "toggled") |
| `animation` | string | Preset name (default, fade, scale, collapse, slide-*) |
| `enter` | string | Classes during enter transition |
| `enter-from` | string | Classes at start of enter |
| `enter-to` | string | Classes at end of enter |
| `leave` | string | Classes during leave transition |
| `leave-from` | string | Classes at start of leave |
| `leave-to` | string | Classes at end of leave |

## Custom Animation Presets

Register your own animation presets in a service provider:

```php
use Accelade\Facades\Animation;

class AppServiceProvider extends ServiceProvider
{
    public function boot(): void
    {
        // Register a custom "bounce" animation
        Animation::new(
            name: 'bounce',
            enter: 'transition ease-bounce duration-300',
            enterFrom: 'opacity-0 scale-50',
            enterTo: 'opacity-100 scale-100',
            leave: 'transition ease-in duration-200',
            leaveFrom: 'opacity-100 scale-100',
            leaveTo: 'opacity-0 scale-50',
        );

        // Register a custom "slide-fade" animation
        Animation::new(
            name: 'slide-fade',
            enter: 'transition-all ease-out duration-300',
            enterFrom: 'opacity-0 -translate-y-4',
            enterTo: 'opacity-100 translate-y-0',
            leave: 'transition-all ease-in duration-200',
            leaveFrom: 'opacity-100 translate-y-0',
            leaveTo: 'opacity-0 -translate-y-4',
        );
    }
}
```

Then use your custom preset:

```blade
<x-accelade::toggle animation="bounce">
    <button @click="toggle()">Bounce!</button>
    <div a-show="toggled">Bouncy content</div>
</x-accelade::toggle>
```

## Animation Facade API

```php
use Accelade\Facades\Animation;

// Register a new preset
Animation::new(
    name: 'custom',
    enter: '...',
    enterFrom: '...',
    enterTo: '...',
    leave: '...',
    leaveFrom: '...',
    leaveTo: '...',
);

// Get a preset
$preset = Animation::get('fade');

// Check if preset exists
if (Animation::has('custom')) {
    // ...
}

// Get all presets
$all = Animation::all();

// Get all as array (for JSON)
$array = Animation::toArray();
```

## Tips

### Slide Animations with Overflow

When using slide animations (`slide-up`, `slide-down`, `slide-left`, `slide-right`), wrap the content in an `overflow-hidden` container to prevent content from appearing outside boundaries:

```blade
<x-accelade::toggle animation="slide-up">
    <button @click="toggle()">Toggle</button>
    <div class="overflow-hidden">
        <div a-show="toggled">
            Content slides up without overflow
        </div>
    </div>
</x-accelade::toggle>
```

### Accordions

For accordions, always use the `collapse` preset instead of `slide-down` to avoid content overlapping with headers during the leave animation.

### Dropdowns

For dropdown menus, the `default` preset works well:

```blade
<x-accelade::toggle animation="default">
    <div class="relative">
        <button @click="toggle()">Menu</button>
        <div a-show="toggled" class="absolute top-full left-0 mt-1 bg-white shadow-lg rounded-lg">
            <a href="#">Profile</a>
            <a href="#">Settings</a>
            <a href="#">Logout</a>
        </div>
    </div>
</x-accelade::toggle>
```

### Modals

For modals, use `scale` for a nice pop effect:

```blade
<x-accelade::toggle animation="scale">
    <button @click="toggle()">Open Modal</button>

    {{-- Backdrop --}}
    <div a-show="toggled" class="fixed inset-0 bg-black/50" @click="setToggle(false)"></div>

    {{-- Modal --}}
    <div a-show="toggled" class="fixed inset-0 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 max-w-md">
            <h2>Modal Title</h2>
            <p>Modal content...</p>
            <button @click="setToggle(false)">Close</button>
        </div>
    </div>
</x-accelade::toggle>
```

## CSS Requirements

The animation utility classes are automatically included when you use `@acceladeStyles`. No additional CSS configuration is needed.

If you're using Tailwind CSS and want to customize the animations further, ensure your custom classes are included in your content configuration.
</file>

<file path="docs/architecture.md">
# Architecture

This document describes the internal architecture and design decisions of Accelade.

## Overview

Accelade follows a hybrid architecture that combines server-rendered Blade templates with client-side reactivity. The key principle is **progressive enhancement** - your application works without JavaScript, and Accelade adds reactivity on top.

```
┌─────────────────────────────────────────────────────────────────┐
│                         Laravel Backend                          │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │   Blade     │  │  Service    │  │     Notification        │  │
│  │  Compiler   │  │  Provider   │  │       Manager           │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
├─────────────────────────────────────────────────────────────────┤
│                      Accelade Core (JS)                          │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │   Router    │  │  Progress   │  │     Notification        │  │
│  │  (SPA Nav)  │  │    Bar      │  │       System            │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
├─────────────────────────────────────────────────────────────────┤
│                    Framework Adapters                            │
├──────────┬──────────┬──────────┬──────────┬────────────────────┤
│  Vanilla │   Vue    │  React   │  Svelte  │      Angular       │
└──────────┴──────────┴──────────┴──────────┴────────────────────┘
```

## Directory Structure

```
packages/accelade/
├── config/
│   └── accelade.php           # Configuration file
├── dist/                       # Compiled JavaScript bundles
├── docs/                       # Documentation
├── resources/
│   ├── js/                    # TypeScript source
│   │   ├── core/              # Core functionality
│   │   │   ├── router.ts      # SPA navigation
│   │   │   ├── progress.ts    # Progress bar
│   │   │   ├── notification/  # Notification system
│   │   │   ├── state.ts       # State management
│   │   │   ├── types.ts       # TypeScript types
│   │   │   └── utils.ts       # Utilities
│   │   ├── vanilla/           # Vanilla JS adapter
│   │   ├── vue/               # Vue adapter
│   │   └── react/             # React adapter
│   └── views/
│       ├── components/        # Blade components
│       └── demo/              # Demo views
├── routes/
│   ├── web.php                # Core routes
│   └── demo.php               # Demo routes
├── src/
│   ├── Accelade.php           # Main class
│   ├── AcceladeServiceProvider.php
│   ├── Compilers/
│   │   └── AcceladeTagCompiler.php  # Tag compiler
│   ├── Components/            # Blade components
│   ├── Console/               # Artisan commands
│   ├── Facades/               # Laravel facades
│   ├── Http/Controllers/      # HTTP controllers
│   ├── Notification/          # Notification system
│   └── Support/               # Support classes
└── tests/
    ├── Feature/               # Feature tests
    └── Unit/                  # Unit tests
```

## PHP Components

### AcceladeServiceProvider

Registers all package services:

```php
// Singletons
$this->app->singleton('accelade', fn($app) => new Accelade($app));
$this->app->singleton('accelade.notify', fn($app) => new NotificationManager());

// Blade directives
Blade::directive('acceladeScripts', ...);
Blade::directive('acceladeStyles', ...);
Blade::directive('accelade', ...);
Blade::directive('endaccelade', ...);

// Component namespace
Blade::componentNamespace('Accelade\\Components', 'accelade');
```

### Accelade Class

The main class handles:

1. **Script/Style Rendering** - Generates JavaScript config and includes
2. **Component Stack** - Manages nested `@accelade` blocks
3. **State Serialization** - Converts PHP state to JSON for client

### AcceladeTagCompiler

Pre-processes Blade templates to transform `<x-accelade:*>` tags:

```blade
{{-- Input --}}
<x-accelade:counter :initial-count="5" />

{{-- Output (after compilation) --}}
@acceladeComponent('counter', ['initial-count' => 5])
    {{-- Component content --}}
@endacceladeComponent
```

### Notification System

```
┌──────────────────┐     ┌───────────────────┐
│   Notification   │────▶│ NotificationManager│
│    (Entity)      │     │   (Collection)     │
└──────────────────┘     └─────────┬─────────┘
                                   │
                         ┌─────────▼─────────┐
                         │  Session Store    │
                         │ (Flash Messages)  │
                         └───────────────────┘
```

Notifications persist across redirects using Laravel's session flash.

## JavaScript Components

### Core Modules

| Module | Purpose |
|--------|---------|
| `router.ts` | SPA navigation, intercepts links |
| `progress.ts` | Progress bar during navigation |
| `notification/` | Toast notification rendering |
| `state.ts` | Reactive state management |
| `utils.ts` | DOM parsing, expression evaluation |

### Framework Adapters

Each adapter implements reactivity for its framework:

```typescript
// Vanilla: Proxy-based reactivity
const state = new Proxy(initialState, {
    set(target, key, value) {
        target[key] = value;
        updateDOM();
        return true;
    }
});

// Vue: reactive()
const state = reactive(initialState);
watch(state, () => updateDOM());

// React: useState hooks
const [state, setState] = useState(initialState);
```

### Build Process

```
resources/js/
├── vanilla/accelade.ts  ──┐
├── vue/accelade.ts      ──┼──▶ dist/accelade-{framework}.js
└── react/accelade.tsx   ──┘
```

Vite bundles each framework separately as IIFE modules.

## Request/Response Flow

### Initial Page Load

```
1. Browser requests page
2. Laravel renders Blade template
3. @accelade directive creates component wrapper
4. State is serialized to data-accelade-state attribute
5. @acceladeScripts injects JavaScript
6. Client-side: Accelade.init() finds components
7. Components become reactive
```

### State Sync

```
1. User changes state (e.g., clicks button)
2. State updates locally (immediate feedback)
3. Debounced: sync request sent to /accelade/update
4. Server validates and persists state
5. Response confirms or provides new state
```

### SPA Navigation

```
1. User clicks <x-accelade::link>
2. Router intercepts click event
3. Progress bar starts
4. Fetch request for new page
5. Response HTML parsed
6. DOM diffed and updated (no full reload)
7. New components initialized
8. Progress bar completes
```

## State Management

### Client-Side State

Each component has isolated state stored in a Proxy object:

```javascript
// Component state structure
{
    componentId: 'accelade-abc123',
    state: { count: 0, name: '' },
    syncedProperties: ['count'],
    actions: { /* custom functions */ }
}
```

### Server-Side State

Server state uses Laravel's Cache:

```php
// Cache key format
"accelade.state.{$componentId}"

// Data stored
['count' => 5, 'name' => 'John']
```

## Security Considerations

1. **CSRF Protection** - All sync requests include CSRF token
2. **State Validation** - Server validates incoming state changes
3. **XSS Prevention** - State values are escaped when rendered
4. **Rate Limiting** - Debounce prevents request flooding

## Performance Optimizations

1. **Debounced Sync** - Batches rapid state changes
2. **Selective DOM Updates** - Only updates changed elements
3. **Lazy Loading** - Components initialize on visibility
4. **Minimal Bundle** - Tree-shaking removes unused code

## Extending Accelade

### Custom Components

```php
// app/View/Components/CustomCounter.php
class CustomCounter extends AcceladeComponent
{
    public int $count = 0;

    public function render()
    {
        return view('components.custom-counter');
    }
}
```

### Custom Directives

```php
// In a service provider
Blade::directive('customDirective', function ($expression) {
    return "<?php /* custom logic */ ?>";
});
```

### JavaScript Extensions

```javascript
// Extend Accelade globally
window.Accelade.extend({
    customMethod() {
        // Custom functionality
    }
});
```

## Next Steps

- [API Reference](api-reference.md) - Complete API documentation
- [Testing](testing.md) - Running and writing tests
</file>

<file path="docs/bridge.md">
# Bridge Components

Bridge Components provide two-way binding between PHP Blade Components and JavaScript. Access public PHP properties as reactive `props`, call PHP methods from the frontend, and receive responses like toasts, redirects, and events.

**No trait required!** Any Blade component works with Bridge out of the box.

## Quick Start

### 1. Create a Component (Plain PHP)

```php
<?php

namespace App\View\Components;

use Accelade\Bridge\BridgeResponse;
use Illuminate\View\Component;

class Counter extends Component
{
    // No trait needed - just define public properties and methods!

    public int $count = 0;
    public int $step = 1;
    public string $name = '';

    public function __construct(int $count = 0, int $step = 1, string $name = '')
    {
        $this->count = $count;
        $this->step = $step;
        $this->name = $name;
    }

    public function increment(): BridgeResponse
    {
        $this->count += $this->step;

        return BridgeResponse::success()
            ->toastSuccess('Incremented!', "Count is now {$this->count}");
    }

    public function decrement(): BridgeResponse
    {
        $this->count -= $this->step;

        return BridgeResponse::success()
            ->toastInfo('Decremented!');
    }

    public function reset(): BridgeResponse
    {
        $this->count = 0;

        return BridgeResponse::success()
            ->toastWarning('Counter reset');
    }

    public function render()
    {
        return view('components.counter');
    }
}
```

### 2. Use the Bridge Component

```blade
@php
    $counter = new App\View\Components\Counter(count: 10, step: 5, name: 'World');
@endphp

<x-accelade::bridge :component="$counter">
    <div class="counter">
        <div class="display" a-text="props.count">{{ $counter->count }}</div>

        <input type="text" a-model="props.name" placeholder="Your name" />
        <p a-show="props.name">Hello, <span a-text="props.name"></span>!</p>

        <input type="number" a-model="props.step" min="1" />

        <button @click="decrement()">-</button>
        <button @click="increment()">+</button>
        <button @click="reset()">Reset</button>
    </div>
</x-accelade::bridge>
```

## How It Works

1. **Props Access**: Public PHP properties are serialized and accessible via `props.propertyName` in templates
2. **Method Calls**: Public PHP methods can be called from `@click` handlers using `methodName()`
3. **AJAX Communication**: Method calls are sent to the server via AJAX and return `BridgeResponse` objects
4. **State Encryption**: Component state is encrypted for security between requests

## BridgeResponse API

Methods can return a `BridgeResponse` to control what happens after the call:

### Toast Notifications

```php
public function save(): BridgeResponse
{
    // Save logic...

    return BridgeResponse::success()
        ->toastSuccess('Saved!', 'Your changes have been saved.')
        // or
        ->toastInfo('Info', 'Optional body text')
        ->toastWarning('Warning!', 'Something to watch')
        ->toastDanger('Error!', 'Something went wrong');
}
```

### Redirects

```php
public function submit(): BridgeResponse
{
    // Submit logic...

    return BridgeResponse::success()
        ->redirectTo('/dashboard');
        // or
        ->redirectToRoute('orders.show', ['order' => $order->id]);
}
```

### Page Refresh

```php
public function reload(): BridgeResponse
{
    return BridgeResponse::success()
        ->refresh();
        // or preserve scroll position
        ->refresh(preserveScroll: true);
}
```

### Emit Events

```php
public function complete(): BridgeResponse
{
    return BridgeResponse::success()
        ->emit('task-completed', ['taskId' => $this->taskId])
        ->emit('refresh-list');
}
```

Listen for these events in other components:

```blade
<x-accelade::data :default="['completed' => false]">
    <div a-show="completed">Task completed!</div>
    <accelade:script>
        $on('task-completed', (data) => {
            $set('completed', true);
            console.log('Task ID:', data.taskId);
        });
    </accelade:script>
</x-accelade::data>
```

### Static Constructors

```php
// Success response with data
BridgeResponse::success(['key' => 'value']);

// Error response
BridgeResponse::error('Something went wrong');

// Redirect response
BridgeResponse::redirect('/path');

// Data response
BridgeResponse::data(['users' => $users]);
```

## Two-Way Binding

Use `a-model` (or your framework prefix) to bind to props:

```blade
{{-- Changes sync to PHP property --}}
<input a-model="props.name" />

{{-- Works with all input types --}}
<select a-model="props.status">
    <option value="active">Active</option>
    <option value="inactive">Inactive</option>
</select>

<input type="checkbox" a-model="props.enabled" />

<textarea a-model="props.description"></textarea>
```

## Method Arguments

Pass arguments to PHP methods:

```php
// PHP
public function setStatus(string $status): BridgeResponse
{
    $this->status = $status;

    return BridgeResponse::success()
        ->toastInfo("Status set to: {$status}");
}

public function addItem(string $name, int $quantity = 1): BridgeResponse
{
    // Add item logic...

    return BridgeResponse::success();
}
```

```blade
{{-- Blade template --}}
<button @click="setStatus('active')">Set Active</button>
<button @click="setStatus('inactive')">Set Inactive</button>

<button @click="addItem('Widget', 5)">Add 5 Widgets</button>
```

## Hiding Properties

Pass hidden properties to the Bridge component:

```blade
@php
    $user = new UserProfile(name: 'John', email: 'john@example.com', secretKey: 'abc123');
@endphp

{{-- Hide sensitive properties --}}
<x-accelade::bridge :component="$user" :hidden="['secretKey', 'internalId']">
    <input a-model="props.name" />
    <input a-model="props.email" />
</x-accelade::bridge>
```

## Working with Eloquent Models

```php
class EditUser extends Component
{
    public User $user;

    public function __construct(User $user)
    {
        $this->user = $user;
    }

    public function save(): BridgeResponse
    {
        $this->user->save();

        return BridgeResponse::success()
            ->toastSuccess('User saved!');
    }
}
```

> **Security**: Always use Eloquent's `$hidden` property on your models to prevent sensitive fields from being exposed:

```php
class User extends Model
{
    protected $hidden = [
        'password',
        'remember_token',
        'two_factor_secret',
    ];
}
```

## JavaScript API

Access bridge instances from JavaScript:

```javascript
// Get a specific bridge instance
const bridge = window.Accelade.bridge.get('bridge-abc123');

// Call a method
const result = await bridge.call('increment');

// Access props
console.log(bridge.props.count);

// Get all bridge instances
const allBridges = window.Accelade.bridge.getAll();
```

## Framework Prefixes

Bridge components work with all Accelade framework prefixes:

| Framework | Prefix | Model | Text |
|-----------|--------|-------|------|
| Vanilla JS | `a-` | `a-model` | `a-text` |
| Vue | `v-` | `v-model` | `v-text` |
| React | `data-state-` | `data-state-model` | `data-state-text` |
| Svelte | `s-` | `s-model` | `s-text` |
| Angular | `ng-` | `ng-model` | `ng-text` |

```blade
{{-- Vue style --}}
<x-accelade::bridge :component="$counter">
    <div v-text="props.count"></div>
    <input v-model="props.name" />
    <button @click="increment()">+</button>
</x-accelade::bridge>

{{-- React style --}}
<x-accelade::bridge :component="$counter">
    <div data-state-text="props.count"></div>
    <input data-state-model="props.name" />
    <button @click="increment()">+</button>
</x-accelade::bridge>
```

## Renderless Components

Create components without a render method for maximum flexibility:

```php
class DataManager extends Component
{
    public array $items = [];

    public function addItem(string $name): BridgeResponse
    {
        $this->items[] = ['name' => $name, 'id' => uniqid()];

        return BridgeResponse::success();
    }

    public function removeItem(string $id): BridgeResponse
    {
        $this->items = array_filter($this->items, fn($item) => $item['id'] !== $id);

        return BridgeResponse::success();
    }

    // No render() method - use slot content
}
```

```blade
@php
    $manager = new App\View\Components\DataManager(items: $initialItems);
@endphp

<x-accelade::bridge :component="$manager">
    <input type="text" id="newItem" />
    <button @click="addItem(document.getElementById('newItem').value)">Add</button>

    <ul>
        <template a-for="item in props.items">
            <li>
                <span a-text="item.name"></span>
                <button @click="removeItem(item.id)">Remove</button>
            </li>
        </template>
    </ul>
</x-accelade::bridge>
```

## Security Considerations

1. **Public Properties**: All public properties are serialized and sent to the browser. Never expose sensitive data.
2. **Encrypted State**: Component state is encrypted using Laravel's encryption. The app key must be secure.
3. **Method Validation**: Only public methods defined in your component class can be called.
4. **CSRF Protection**: All AJAX requests include CSRF tokens automatically.
5. **Hidden Properties**: Use the `:hidden` prop to exclude sensitive properties.

## Comparison with Livewire

| Feature | Bridge Components | Livewire |
|---------|------------------|----------|
| Server Rendering | Yes (initial) | Yes (always) |
| JS Required | Yes | Optional |
| Build Step | None | None |
| Trait Required | **No** | Yes |
| Real-time Updates | Via events | Yes |
| File Uploads | Not built-in | Built-in |
| Polling | Manual | Built-in |
| Bundle Size | Included in Accelade | Separate |

Bridge Components are ideal when you want:
- Quick PHP method calls from the frontend
- Simpler state management than Livewire
- Integration with other Accelade features
- No additional dependencies
- **Works with any existing component** - no trait required!

## Next Steps

- [Data Component](data.md) - Client-side reactive data
- [Event Bus](event-bus.md) - Component communication
- [Notifications](notifications.md) - Toast notification system
</file>

<file path="docs/code-block.md">
# Code Block Component

The Code Block component provides a beautiful, feature-rich way to display code snippets in your application. It includes syntax highlighting, a macOS-style title bar, copy functionality, and the ability to export code as an image.

## Basic Usage

Use the `x-accelade::code-block` component to display code with syntax highlighting:

```blade
<x-accelade::code-block language="php">
function greet(string $name): string
{
    return "Hello, {$name}!";
}
</x-accelade::code-block>
```

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `language` | string | `'markup'` | The programming language for syntax highlighting |
| `filename` | string | `null` | Optional filename to display in the title bar |

## Supported Languages

The component uses Prism.js for syntax highlighting and supports all major languages:

- `php` - PHP code
- `blade` - Laravel Blade templates (highlighted as PHP)
- `javascript` / `js` - JavaScript
- `typescript` / `ts` - TypeScript
- `html` - HTML markup
- `css` - CSS styles
- `bash` / `shell` - Command line
- `json` - JSON data
- `sql` - SQL queries
- `yaml` - YAML configuration
- `vue` - Vue.js components
- And many more...

## With Filename

Display a custom filename in the title bar:

```blade
<x-accelade::code-block language="php" filename="app/Models/User.php">
class User extends Model
{
    protected $fillable = ['name', 'email'];
}
</x-accelade::code-block>
```

## Features

### Copy to Clipboard

Every code block includes a "Copy" button that copies the code content to the clipboard. When clicked, it shows a "Copied!" confirmation.

### Export as Image

The "Image" button allows users to download the code block as a PNG image. This is perfect for:

- Sharing code snippets on social media
- Creating documentation screenshots
- Embedding in presentations

### macOS-Style Title Bar

The component features a sleek title bar with:

- Traffic light buttons (decorative)
- Language or filename label
- Action buttons (Copy, Image)

## Styling

The code block uses a dark theme by default with:

- Slate background (`#1e293b`)
- Rounded corners
- Subtle border and shadow
- Responsive horizontal scrolling for long lines

## Examples

### PHP Example

```blade
<x-accelade::code-block language="php">
&lt;?php

namespace App\Http\Controllers;

class HomeController extends Controller
{
    public function index()
    {
        return view('home', [
            'title' => 'Welcome'
        ]);
    }
}
</x-accelade::code-block>
```

### JavaScript Example

```blade
<x-accelade::code-block language="javascript" filename="app.js">
const greeting = (name) => {
    console.log(`Hello, ${name}!`);
};

greeting('World');
</x-accelade::code-block>
```

### Blade Template Example

```blade
<x-accelade::code-block language="blade" filename="welcome.blade.php">
&lt;div class="container"&gt;
    &lt;h1&gt;{{ $title }}&lt;/h1&gt;
    @foreach($items as $item)
        &lt;p&gt;{{ $item-&gt;name }}&lt;/p&gt;
    @endforeach
&lt;/div&gt;
</x-accelade::code-block>
```

## Tips

1. **Escape HTML entities** - When displaying HTML or Blade code, use `&lt;` and `&gt;` for angle brackets
2. **Preserve whitespace** - The component preserves all whitespace and indentation
3. **Use meaningful filenames** - When using the `filename` prop, use realistic file paths for context
</file>

<file path="docs/configuration.md">
# Configuration

All Accelade configuration is done through `config/accelade.php`.

## Publish Configuration

```bash
php artisan vendor:publish --tag=accelade-config
```

## Configuration Options

### Framework

```php
'framework' => env('ACCELADE_FRAMEWORK', 'vanilla'),
```

Choose the frontend framework adapter:

| Value | Description |
|-------|-------------|
| `vanilla` | Vanilla JavaScript (default, no dependencies) |
| `vue` | Vue 3 with Composition API |
| `react` | React 18 with hooks |
| `svelte` | Svelte 4 with stores |
| `angular` | Angular 17+ with signals |

### Asset Serving Mode

```php
'asset_mode' => env('ACCELADE_ASSET_MODE', 'route'),
```

| Value | Description |
|-------|-------------|
| `route` | Serve assets via Laravel route (default) |
| `published` | Serve from `public/vendor/accelade` |

### Route Prefix

```php
'prefix' => 'accelade',
```

URL prefix for Accelade routes. Default routes:

- `GET /accelade/accelade-v2.js` - JavaScript bundle
- `POST /accelade/update` - State sync endpoint
- `POST /accelade/batch-update` - Batch state sync

### Middleware

```php
'middleware' => ['web'],
```

Middleware applied to Accelade routes.

### State TTL

```php
'state_ttl' => env('ACCELADE_STATE_TTL', 3600),
```

Time-to-live in seconds for server-synced component state. Default: 1 hour.

### Sync Debounce

```php
'sync_debounce' => env('ACCELADE_SYNC_DEBOUNCE', 300),
```

Debounce time in milliseconds for server sync requests. Prevents excessive server calls during rapid state changes.

### Progress Bar

```php
'progress' => [
    'color' => '#6366f1',           // Primary color
    'gradientColor' => '#8b5cf6',   // Gradient color 1
    'gradientColor2' => '#a855f7',  // Gradient color 2
    'height' => 3,                   // Bar height in pixels
    'showBar' => true,               // Show progress bar
    'includeSpinner' => true,        // Show spinner
    'spinnerPosition' => 'top-right', // Spinner position
    'position' => 'top',             // Bar position (top/bottom)
],
```

Available spinner positions:
- `top-left`
- `top-right`
- `bottom-left`
- `bottom-right`

### Demo Mode

```php
'demo' => [
    'enabled' => env('ACCELADE_DEMO_ENABLED', env('APP_ENV') !== 'production'),
    'prefix' => env('ACCELADE_DEMO_PREFIX', 'demo'),
    'middleware' => ['web'],
],
```

Demo routes showcase all Accelade features. Disabled in production by default.

Demo routes when enabled:
- `/demo/vanilla` - Vanilla JS demo
- `/demo/vue` - Vue demo
- `/demo/react` - React demo
- `/demo/svelte` - Svelte demo
- `/demo/angular` - Angular demo
- `/demo/notify/{type}` - Backend notification demos

### Testing

```php
'testing' => [
    'base_url' => env('ACCELADE_TEST_URL', env('APP_URL', 'http://localhost')),
],
```

Configuration for E2E tests.

## Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `ACCELADE_FRAMEWORK` | `vanilla` | Frontend framework |
| `ACCELADE_ASSET_MODE` | `route` | Asset serving mode |
| `ACCELADE_STATE_TTL` | `3600` | State cache TTL |
| `ACCELADE_SYNC_DEBOUNCE` | `300` | Sync debounce (ms) |
| `ACCELADE_DEMO_ENABLED` | auto | Enable demo routes |
| `ACCELADE_DEMO_PREFIX` | `demo` | Demo routes prefix |
| `ACCELADE_TEST_URL` | `APP_URL` | E2E test base URL |

## JavaScript Configuration

Accelade exposes configuration to JavaScript via `window.AcceladeConfig`:

```javascript
window.AcceladeConfig = {
    framework: 'vanilla',
    csrfToken: '...',
    updateUrl: '/accelade/update',
    batchUpdateUrl: '/accelade/batch-update',
    syncDebounce: 300,
    progress: { /* progress bar options */ },
    notifications: [ /* pending notifications */ ],
};
```

You can override settings before Accelade initializes:

```html
<script>
    window.AcceladeConfig = {
        ...window.AcceladeConfig,
        syncDebounce: 500,
        progress: { color: '#ff0000' }
    };
</script>
@acceladeScripts
```

## Next Steps

- [Components](components.md) - Create reactive components
- [Architecture](architecture.md) - Understanding the internals
</file>

<file path="docs/content.md">
# Content Component

The Content component renders pre-rendered HTML without any interpolation or processing. This is useful for displaying static content like Markdown that has already been converted to HTML.

## Quick Start

```blade
<x-accelade::content :html="$renderedMarkdown" />
```

## Basic Usage

Pass pre-rendered HTML content to the component:

```blade
{{-- In your controller --}}
$html = Str::markdown($post->content);
return view('post', ['html' => $html]);

{{-- In your view --}}
<x-accelade::content :html="$html" />
```

## Custom Wrapper Element

By default, the content is wrapped in a `<div>`. Use the `as` attribute to change the wrapper element:

```blade
{{-- Render as article --}}
<x-accelade::content as="article" :html="$html" />

{{-- Render as section --}}
<x-accelade::content as="section" :html="$html" />

{{-- Render as blockquote --}}
<x-accelade::content as="blockquote" :html="$quote" />
```

### Supported Wrapper Elements

| Element | Description |
|---------|-------------|
| `div` | Default wrapper (block element) |
| `span` | Inline wrapper |
| `article` | Article content |
| `section` | Document section |
| `aside` | Sidebar content |
| `main` | Main content |
| `header` | Header section |
| `footer` | Footer section |
| `nav` | Navigation section |
| `p` | Paragraph |
| `blockquote` | Block quotation |
| `pre` | Preformatted text |
| `code` | Code block |
| `figure` | Figure with caption |
| `figcaption` | Figure caption |
| `details` | Disclosure widget |
| `summary` | Summary for details |

Invalid or unsafe elements (like `script`) will fall back to `div`.

## Styling with Tailwind

The component accepts all standard HTML attributes, making it easy to style with Tailwind CSS:

```blade
{{-- Prose styling for Markdown --}}
<x-accelade::content
    as="article"
    class="prose prose-lg dark:prose-invert max-w-none"
    :html="$html"
/>

{{-- Custom styling --}}
<x-accelade::content
    class="p-6 bg-white rounded-lg shadow"
    :html="$html"
/>
```

## Use Cases

### Rendering Markdown

```php
// Controller
use Illuminate\Support\Str;

public function show(Post $post)
{
    return view('posts.show', [
        'post' => $post,
        'content' => Str::markdown($post->body),
    ]);
}
```

```blade
{{-- View --}}
<article class="post">
    <h1>{{ $post->title }}</h1>

    <x-accelade::content
        as="div"
        class="prose prose-slate"
        :html="$content"
    />
</article>
```

### Displaying Rich Text from CMS

```blade
<x-accelade::content
    as="section"
    class="cms-content"
    :html="$page->body"
/>
```

### Code Snippets with Syntax Highlighting

```php
// After processing with a syntax highlighter
$highlightedCode = highlight($code, 'php');
```

```blade
<x-accelade::content
    as="div"
    class="code-block"
    :html="$highlightedCode"
/>
```

### Email Templates Preview

```blade
<x-accelade::content
    as="div"
    class="email-preview border rounded-lg p-4"
    :html="$emailHtml"
/>
```

## Component Attributes

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `html` | string | `''` | The pre-rendered HTML content to display |
| `as` | string | `'div'` | The wrapper element tag |
| `class` | string | - | CSS classes for the wrapper |
| `id` | string | - | ID for the wrapper |
| `*` | - | - | Any other HTML attributes |

## Security Warning

Only use this component with trusted content. Since the HTML is rendered directly without sanitization, user-provided content could contain malicious scripts (XSS attacks).

**Safe:**
```blade
{{-- Content from your own database/CMS --}}
<x-accelade::content :html="$trustedContent" />

{{-- Markdown you converted yourself --}}
<x-accelade::content :html="Str::markdown($trustedMarkdown)" />
```

**Dangerous - Do NOT do this:**
```blade
{{-- Never render user input directly --}}
<x-accelade::content :html="$userProvidedHtml" />

{{-- Never render request data --}}
<x-accelade::content :html="request('content')" />
```

If you need to render user-provided content, sanitize it first using a library like [HTML Purifier](http://htmlpurifier.org/).

## Comparison with Standard Blade

The Content component is equivalent to using `{!! !!}` but with a semantic wrapper:

```blade
{{-- Standard Blade (no wrapper) --}}
{!! $html !!}

{{-- Content component (with wrapper) --}}
<x-accelade::content :html="$html" />

{{-- Equivalent to --}}
<div>{!! $html !!}</div>
```

The advantage of using the component is cleaner syntax when you need a wrapper element with attributes:

```blade
{{-- Without component --}}
<article class="prose dark:prose-invert max-w-none">
    {!! $html !!}
</article>

{{-- With component --}}
<x-accelade::content as="article" class="prose dark:prose-invert max-w-none" :html="$html" />
```

## Next Steps

- [Lazy Loading](lazy-loading.md) - Defer content rendering
- [Components](components.md) - Building reactive components
- [API Reference](api-reference.md) - Complete API documentation
</file>

<file path="docs/contributing.md">
# Contributing

Thank you for considering contributing to Accelade! We welcome contributions from everyone, whether it's fixing bugs, improving documentation, or adding new features.

---

## Getting Started

### Fork the Repository

1. Fork the [Accelade repository](https://github.com/accelade/accelade) on GitHub
2. Clone your fork locally:

```bash
git clone https://github.com/YOUR-USERNAME/accelade.git
cd accelade
```

3. Add the upstream remote:

```bash
git remote add upstream https://github.com/accelade/accelade.git
```

### Set Up Development Environment

1. Install PHP dependencies:

```bash
composer install
```

2. Install JavaScript dependencies:

```bash
npm install
```

3. Build assets for development:

```bash
npm run dev
```

4. Run tests to ensure everything is working:

```bash
composer test
```

---

## Development Workflow

### Creating a Branch

Create a feature branch for your changes:

```bash
git checkout -b feature/your-feature-name
```

Use meaningful branch names:
- `feature/add-tooltip-component` - For new features
- `fix/notification-position` - For bug fixes
- `docs/improve-modal-docs` - For documentation
- `refactor/optimize-state-sync` - For refactoring

### Making Changes

1. Write your code following our coding standards
2. Add tests for new functionality
3. Update documentation if needed
4. Run the test suite to ensure nothing is broken

### Commit Messages

Write clear, descriptive commit messages:

```bash
# Good examples
git commit -m "Add tooltip component with hover and click triggers"
git commit -m "Fix notification RTL positioning issue"
git commit -m "Update modal documentation with new examples"

# Bad examples
git commit -m "fix stuff"
git commit -m "update"
```

### Pull Requests

1. Push your branch to your fork:

```bash
git push origin feature/your-feature-name
```

2. Open a Pull Request from your fork to the main repository
3. Fill out the PR template with:
   - Description of changes
   - Related issue numbers
   - Screenshots (if applicable)
   - Testing instructions

---

## Coding Standards

### PHP

We follow [PSR-12](https://www.php-fig.org/psr/psr-12/) coding standards. Run Laravel Pint to format your code:

```bash
vendor/bin/pint
```

Key guidelines:
- Use strict types: `declare(strict_types=1);`
- Add return type declarations to all methods
- Use descriptive variable and method names
- Document public methods with PHPDoc

```php
<?php

declare(strict_types=1);

namespace Accelade\Components;

class MyComponent
{
    /**
     * Create a new component instance.
     *
     * @param  array<string, mixed>  $options
     */
    public function __construct(
        protected array $options = []
    ) {}

    /**
     * Render the component.
     */
    public function render(): string
    {
        // Implementation
    }
}
```

### JavaScript/TypeScript

- Use TypeScript for new code
- Follow ESLint configuration
- Use meaningful variable names
- Document complex functions

```typescript
/**
 * Synchronize state with the server.
 *
 * @param key - The state key to sync
 * @param value - The value to send
 * @param options - Sync options
 */
export function syncState(
    key: string,
    value: unknown,
    options: SyncOptions = {}
): Promise<void> {
    // Implementation
}
```

### Blade Templates

- Use semantic HTML
- Include dark mode support (`dark:` prefixed classes)
- Support RTL layouts with logical properties
- Test across all supported frameworks

---

## Testing

### Running Tests

```bash
# Run all tests
composer test

# Run specific test file
vendor/bin/pest tests/Feature/NotificationTest.php

# Run with coverage
composer test-coverage
```

### Writing Tests

Use Pest for PHP tests:

```php
<?php

use Accelade\Notification\Notification;

it('creates a notification with title', function () {
    $notification = Notification::make('Hello World');

    expect($notification->getTitle())->toBe('Hello World');
});

it('sets the correct status type', function () {
    $notification = Notification::make()->success();

    expect($notification->getStatus())->toBe('success');
});
```

### Testing Guidelines

- Write tests for all new functionality
- Cover edge cases and error scenarios
- Test across different framework configurations
- Use meaningful test descriptions

---

## Documentation

### Writing Documentation

- Use clear, concise language
- Include code examples
- Add live demos when possible
- Keep examples up-to-date with the codebase

### Documentation Structure

```markdown
# Component Name

Brief description of what the component does.

---

## Basic Usage

Show the simplest possible example.

## Props/Options

Document all available options.

## Advanced Usage

Show more complex scenarios.

## JavaScript API

Document any JS methods.

---

## Related

Link to related components or concepts.
```

---

## Reporting Issues

### Bug Reports

Include:
- Accelade version
- Laravel version
- PHP version
- Browser (for frontend issues)
- Steps to reproduce
- Expected vs actual behavior
- Error messages or screenshots

### Feature Requests

Describe:
- The problem you're trying to solve
- Your proposed solution
- Alternative solutions considered
- Any related components or features

---

## Code of Conduct

We are committed to providing a welcoming and inclusive environment. Please:

- Be respectful and considerate
- Use inclusive language
- Focus on constructive feedback
- Help others learn and grow
- Report unacceptable behavior

---

## Recognition

All contributors are recognized in our [Thanks](/docs/thanks) page. We appreciate every contribution, no matter how small!

---

## Questions?

If you have questions:

1. Check the [documentation](/docs/getting-started)
2. Search existing [GitHub issues](https://github.com/accelade/accelade/issues)
3. Open a new issue with your question
4. Join our community discussions

Thank you for contributing to Accelade!
</file>

<file path="docs/data.md">
# Data Component

The Data component provides a reactive data container that automatically handles state initialization, storage persistence, and global stores. It's an alternative to `@accelade` directive with additional features for data management.

## Quick Start

```blade
<x-accelade::data :default="['count' => 0]">
    <button @click="$set('count', count + 1)">
        Count: <span a-text="count">0</span>
    </button>
</x-accelade::data>
```

## Basic Usage

### With Array Data

```blade
<x-accelade::data :default="['name' => '', 'email' => '']">
    <input a-model="name" placeholder="Name">
    <input a-model="email" type="email" placeholder="Email">
    <p a-show="name">Hello, <span a-text="name"></span>!</p>
</x-accelade::data>
```

### With PHP Variables

```blade
{{-- In your controller --}}
return view('profile', [
    'user' => auth()->user()->only('name', 'email'),
]);

{{-- In your view --}}
<x-accelade::data :default="$user">
    <input a-model="name" placeholder="Name">
    <input a-model="email" type="email" placeholder="Email">
</x-accelade::data>
```

### With Eloquent Models

The component automatically converts Eloquent models to arrays:

```blade
<x-accelade::data :default="$user">
    <span a-text="name"></span>
    <span a-text="email"></span>
</x-accelade::data>
```

### With Collections

```blade
<x-accelade::data :default="collect(['count' => 0, 'items' => []])">
    {{-- Your content --}}
</x-accelade::data>
```

## Session Storage (Remember)

Use the `remember` attribute to persist state in session storage. The state will be restored when the user navigates back to the page during the same browser session:

```blade
<x-accelade::data :default="['step' => 1, 'formData' => []]" remember="wizard-form">
    <div a-show="step === 1">
        Step 1 content...
        <button @click="$set('step', 2)">Next</button>
    </div>
    <div a-show="step === 2">
        Step 2 content...
        <button @click="$set('step', 1)">Back</button>
    </div>
</x-accelade::data>
```

The state is stored with the key `accelade:wizard-form` in sessionStorage.

## Local Storage

Use the `local-storage` attribute to persist state in localStorage. The state will be restored even after the browser is closed:

```blade
<x-accelade::data
    :default="['theme' => 'light', 'fontSize' => 16]"
    local-storage="user-preferences"
>
    <select a-model="theme">
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
    <input type="range" a-model="fontSize" min="12" max="24">
</x-accelade::data>
```

The state is stored with the key `accelade:user-preferences` in localStorage.

## Global Stores

Use the `store` attribute to create shared state across multiple components:

```blade
{{-- First component - Cart icon in header --}}
<x-accelade::data :default="['items' => [], 'count' => 0]" store="cart">
    <span a-text="count">0</span> items in cart
</x-accelade::data>

{{-- Second component - Product list --}}
<x-accelade::data :default="['items' => [], 'count' => 0]" store="cart">
    <button @click="$set('count', count + 1); $set('items', [...items, 'Product'])">
        Add to Cart
    </button>
</x-accelade::data>
```

When `count` is updated in one component, all components using the same store will automatically update.

### Reserved Store Names

The following names are reserved and cannot be used as store names:
- `data`
- `form`
- `toggle`
- `state`
- `store`

## JavaScript Object Notation

You can pass JavaScript object notation directly as a string:

```blade
<x-accelade::data :default="'{ count: 0, items: [], isActive: true }'">
    {{-- Your content --}}
</x-accelade::data>
```

This is useful when you want to use JavaScript-specific syntax that isn't valid PHP.

## Accessing Stores from JavaScript

You can access global stores from JavaScript:

```javascript
// Get a specific store
const cart = window.Accelade.stores.get('cart');
console.log(cart.items);

// Check if a store exists
if (window.Accelade.stores.has('cart')) {
    // ...
}

// Get all store names
const names = window.Accelade.stores.names();

// Get all stores
const allStores = window.Accelade.stores.all();
```

## Combining Features

You can combine storage persistence with global stores:

```blade
{{-- Persist cart to localStorage AND share across components --}}
<x-accelade::data
    :default="['items' => [], 'total' => 0]"
    store="cart"
    local-storage="shopping-cart"
>
    {{-- Your content --}}
</x-accelade::data>
```

## Component Attributes

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `default` | array\|object\|string | `[]` | Initial state data |
| `remember` | string | `null` | Session storage key for persistence |
| `local-storage` | string | `null` | Local storage key for persistence |
| `store` | string | `null` | Global store name for shared state |
| `class` | string | - | CSS classes for the wrapper |
| `id` | string | - | ID for the wrapper |
| `*` | - | - | Any other HTML attributes |

## Comparison with @accelade Directive

The `<x-accelade::data>` component and `@accelade` directive are functionally similar, with the component offering additional storage features:

```blade
{{-- Using @accelade directive --}}
@accelade(['count' => 0])
    <button @click="$set('count', count + 1)">
        Count: <span a-text="count">0</span>
    </button>
@endaccelade

{{-- Using x-accelade::data component --}}
<x-accelade::data :default="['count' => 0]">
    <button @click="$set('count', count + 1)">
        Count: <span a-text="count">0</span>
    </button>
</x-accelade::data>

{{-- With storage persistence (only available with component) --}}
<x-accelade::data :default="['count' => 0]" remember="counter">
    <button @click="$set('count', count + 1)">
        Count: <span a-text="count">0</span>
    </button>
</x-accelade::data>
```

### When to Use What

| Use Case | Recommended |
|----------|-------------|
| Simple reactive state | `@accelade` |
| State persistence (session/local) | `<x-accelade::data>` |
| Global shared state | `<x-accelade::data>` with `store` |
| Dynamic PHP data | Either works |

## Examples

### Multi-Step Form with Persistence

```blade
<x-accelade::data
    :default="[
        'step' => 1,
        'name' => '',
        'email' => '',
        'phone' => '',
    ]"
    remember="contact-form"
>
    <div a-show="step === 1">
        <h2>Step 1: Basic Info</h2>
        <input a-model="name" placeholder="Name">
        <input a-model="email" type="email" placeholder="Email">
        <button @click="$set('step', 2)">Next</button>
    </div>

    <div a-show="step === 2">
        <h2>Step 2: Contact</h2>
        <input a-model="phone" placeholder="Phone">
        <button @click="$set('step', 1)">Back</button>
        <button @click="submit()">Submit</button>
    </div>
</x-accelade::data>
```

### Theme Switcher with Local Storage

```blade
<x-accelade::data
    :default="['theme' => 'light']"
    local-storage="theme-preference"
>
    <button @click="$set('theme', theme === 'light' ? 'dark' : 'light')">
        Toggle Theme (Current: <span a-text="theme">light</span>)
    </button>
</x-accelade::data>
```

### Shopping Cart with Global Store

```blade
{{-- Header cart indicator --}}
<x-accelade::data
    :default="['items' => [], 'total' => 0]"
    store="cart"
    local-storage="shopping-cart"
>
    <a href="/cart">
        Cart (<span a-text="items.length">0</span>)
        - $<span a-text="total">0.00</span>
    </a>
</x-accelade::data>

{{-- Product page --}}
<x-accelade::data
    :default="['items' => [], 'total' => 0]"
    store="cart"
>
    @foreach($products as $product)
        <div class="product">
            <h3>{{ $product->name }}</h3>
            <p>${{ $product->price }}</p>
            <button @click="$set('items', [...items, {{ json_encode($product->only('id', 'name', 'price')) }}]); $set('total', total + {{ $product->price }})">
                Add to Cart
            </button>
        </div>
    @endforeach
</x-accelade::data>
```

## Next Steps

- [Components](components.md) - Building reactive components
- [Shared Data](shared-data.md) - Share data from PHP to JavaScript
- [API Reference](api-reference.md) - Complete API documentation
</file>

<file path="docs/event-bus.md">
# Event Bus

Accelade includes a built-in event bus for decoupled communication between components. Components can emit and listen to events without needing direct references to each other.

## Quick Start

```blade
{{-- Component A: Emit an event --}}
<button @click="$emit('user-selected', { id: 123 })">
    Select User
</button>

{{-- Component B: Listen for the event --}}
<x-accelade::data :default="['userId' => null]">
    <div a-show="userId">Selected: <span a-text="userId"></span></div>
    <accelade:script>
        $on('user-selected', (data) => {
            $set('userId', data.id);
        });
    </accelade:script>
</x-accelade::data>
```

## API

### Global Methods

Access the event bus from anywhere via `window.Accelade`:

```javascript
// Emit an event with data
Accelade.emit('event-name', { foo: 'bar' });

// Listen for an event
const unsubscribe = Accelade.on('event-name', (data) => {
    console.log('Received:', data);
});

// Stop listening
unsubscribe();

// Listen once (auto-removes after first call)
Accelade.once('init-complete', () => {
    console.log('Initialization done!');
});

// Remove a specific listener
Accelade.off('event-name', callbackFunction);
```

### Component Context Methods

Inside Accelade components, use the `$` prefixed methods:

| Method | Description |
|--------|-------------|
| `$emit(event, data?)` | Emit an event with optional data |
| `$on(event, callback)` | Listen for an event, returns unsubscribe function |
| `$once(event, callback)` | Listen once, auto-removes after first call |
| `$off(event, callback)` | Remove a specific listener |

### Events Object

For advanced usage, access the full events API:

```javascript
// Full events API
Accelade.events.emit('event', data);
Accelade.events.on('event', callback);
Accelade.events.once('event', callback);
Accelade.events.off('event', callback);

// Additional methods
Accelade.events.clear('event');        // Remove all listeners for an event
Accelade.events.clear();               // Remove ALL listeners
Accelade.events.hasListeners('event'); // Check if event has listeners
Accelade.events.listenerCount('event'); // Get number of listeners
Accelade.events.eventNames();          // Get all registered event names
```

## Examples

### Form Validation Feedback

```blade
{{-- Form component --}}
<x-accelade::data :default="['email' => '']">
    <form @submit.prevent="validateAndSubmit()">
        <input type="email" a-model="email" />
        <button type="submit">Submit</button>
    </form>
    <accelade:script>
        function validateAndSubmit() {
            if (!email.includes('@')) {
                $emit('form-error', { field: 'email', message: 'Invalid email' });
                return;
            }
            $emit('form-success', { email });
        }
    </accelade:script>
</x-accelade::data>

{{-- Toast notification listener --}}
<x-accelade::data :default="['message' => '', 'type' => '']">
    <div a-show="message" a-class="{ 'bg-red-100': type === 'error', 'bg-green-100': type === 'success' }">
        <span a-text="message"></span>
    </div>
    <accelade:script>
        $on('form-error', (data) => {
            $set('message', data.message);
            $set('type', 'error');
        });

        $on('form-success', () => {
            $set('message', 'Form submitted successfully!');
            $set('type', 'success');
        });
    </accelade:script>
</x-accelade::data>
```

### Shopping Cart Updates

```blade
{{-- Product card --}}
<x-accelade::data :default="['product' => $product]">
    <div class="product-card">
        <h3 a-text="product.name"></h3>
        <button @click="$emit('add-to-cart', product)">
            Add to Cart
        </button>
    </div>
</x-accelade::data>

{{-- Cart counter in header --}}
<x-accelade::data :default="['count' => 0]">
    <span class="cart-count" a-text="count">0</span>
    <accelade:script>
        $on('add-to-cart', () => {
            $set('count', $get('count') + 1);
        });

        $on('remove-from-cart', () => {
            $set('count', Math.max(0, $get('count') - 1));
        });

        $on('clear-cart', () => {
            $set('count', 0);
        });
    </accelade:script>
</x-accelade::data>
```

### Modal Communication

```blade
{{-- Open modal button --}}
<button @click="$emit('open-modal', { type: 'confirm', title: 'Delete Item?' })">
    Delete
</button>

{{-- Modal component --}}
<x-accelade::data :default="['isOpen' => false, 'title' => '', 'type' => '']">
    <div a-show="isOpen" class="modal-overlay">
        <div class="modal">
            <h2 a-text="title"></h2>
            <button @click="$emit('modal-confirm'); $set('isOpen', false)">Confirm</button>
            <button @click="$emit('modal-cancel'); $set('isOpen', false)">Cancel</button>
        </div>
    </div>
    <accelade:script>
        $on('open-modal', (data) => {
            $set('isOpen', true);
            $set('title', data.title);
            $set('type', data.type);
        });

        $on('close-modal', () => {
            $set('isOpen', false);
        });
    </accelade:script>
</x-accelade::data>
```

### One-Time Initialization

```blade
<x-accelade::data :default="['ready' => false]">
    <div a-show="!ready">Loading...</div>
    <div a-show="ready">App is ready!</div>
    <accelade:script>
        // Only fires once
        $once('app-initialized', () => {
            $set('ready', true);
        });
    </accelade:script>
</x-accelade::data>

{{-- Somewhere else in your app --}}
<script>
    // After all components are loaded
    window.Accelade.emit('app-initialized');
</script>
```

### Cleanup on Component Destroy

```blade
<x-accelade::data :default="['messages' => []]">
    <ul>
        <template a-for="msg in messages">
            <li a-text="msg"></li>
        </template>
    </ul>
    <accelade:script>
        // Store unsubscribe function
        const unsubscribe = $on('new-message', (data) => {
            $set('messages', [...$get('messages'), data.text]);
        });

        // Clean up when component is removed
        // (This is automatically handled by Accelade's component lifecycle)
    </accelade:script>
</x-accelade::data>
```

## Using with JavaScript

```javascript
// In your app.js or any script
document.addEventListener('DOMContentLoaded', () => {
    // Subscribe to events
    window.Accelade.on('user-action', (data) => {
        analytics.track('user_action', data);
    });

    // Emit from anywhere
    document.querySelector('.special-button').addEventListener('click', () => {
        window.Accelade.emit('special-action', {
            timestamp: Date.now(),
            source: 'button'
        });
    });
});
```

## Best Practices

### 1. Use Descriptive Event Names

```javascript
// Good
$emit('user-profile-updated', { userId: 123 });
$emit('cart-item-added', { product, quantity });
$emit('checkout-completed', { orderId });

// Avoid
$emit('update');
$emit('click');
$emit('data');
```

### 2. Keep Payloads Simple

```javascript
// Good - simple, serializable data
$emit('user-selected', { id: 123, name: 'John' });

// Avoid - complex objects, functions
$emit('user-selected', userInstance); // May have methods, circular refs
```

### 3. Unsubscribe When Done

```javascript
// Store the unsubscribe function
const unsubscribe = $on('event', callback);

// Later, when no longer needed
unsubscribe();
```

### 4. Use `$once` for Initialization

```javascript
// Only need to know when app is ready once
$once('app-ready', () => {
    initializeFeature();
});
```

### 5. Namespace Events for Large Apps

```javascript
// Namespace by feature
$emit('auth:login-success', user);
$emit('auth:logout');
$emit('cart:item-added', item);
$emit('cart:cleared');
```

### 6. Use `$get()` in Callbacks

When accessing current state values inside event callbacks, always use `$get()` instead of the variable name directly. This is because callbacks execute later when the original scope is no longer available.

```javascript
// Good - use $get() to access current state
$on('increment', (data) => {
    $set('count', $get('count') + data.amount);
});

// Bad - will throw "count is not defined" error
$on('increment', (data) => {
    $set('count', count + data.amount);
});
```

## TypeScript Support

The event bus is fully typed:

```typescript
import { emit, on, once, off, EventCallback } from '@accelade/accelade';

interface UserData {
    id: number;
    name: string;
}

// Typed callback
const callback: EventCallback<UserData> = (data) => {
    console.log(data.id, data.name); // TypeScript knows the shape
};

on<UserData>('user-selected', callback);
emit<UserData>('user-selected', { id: 1, name: 'John' });
```

## Next Steps

- [Components](components.md) - Building reactive components
- [Rehydrate](rehydrate.md) - Server-triggered updates
- [Notifications](notifications.md) - Toast notification system
</file>

<file path="docs/event.md">
# Event Component (Laravel Echo)

Accelade provides real-time event handling through Laravel Echo integration. The Event component enables listening to broadcasted events and triggering client-side actions like redirects, page refreshes, and toast notifications.

## Requirements

The Event component requires Laravel Echo to be configured and available as `window.Echo`. Follow the [Laravel Broadcasting documentation](https://laravel.com/docs/broadcasting) to set up Echo with your preferred driver (Pusher, Ably, Soketi, etc.).

## Basic Usage

```blade
<x-accelade::event channel="orders" listen="OrderCreated">
    <p a-if="subscribed">Listening for new orders...</p>
    <p a-if="!subscribed">Not connected to channel.</p>
</x-accelade::event>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `channel` | string | null | The channel name to subscribe to |
| `private` | bool | false | Use a private (authenticated) channel |
| `presence` | bool | false | Use a presence channel |
| `listen` | string | '' | Comma-separated event names to listen for |
| `preserve-scroll` | bool | false | Preserve scroll position on refresh actions |

## Channel Types

### Public Channel

```blade
<x-accelade::event channel="announcements" listen="NewAnnouncement">
    <!-- Anyone can listen -->
</x-accelade::event>
```

### Private Channel

Private channels require authentication. Laravel will verify the user has permission to join.

```blade
<x-accelade::event
    channel="user.{{ auth()->id() }}"
    :private="true"
    listen="MessageReceived,NotificationReceived"
>
    <div a-show="events.length > 0">
        You have <span a-text="events.length"></span> new events
    </div>
</x-accelade::event>
```

### Presence Channel

Presence channels track who is currently subscribed.

```blade
<x-accelade::event
    channel="chat.room.1"
    :presence="true"
    listen="UserJoined,UserLeft,MessageSent"
>
    <!-- Track users in real-time -->
</x-accelade::event>
```

## Exposed State

The component exposes reactive state that you can use in your templates:

| State | Type | Description |
|-------|------|-------------|
| `subscribed` | boolean | Whether successfully subscribed to the channel |
| `events` | array | Array of received events with `name`, `data`, and `timestamp` |

```blade
<x-accelade::event channel="orders" listen="OrderCreated">
    <div a-show="subscribed" class="text-green-600">
        Connected to orders channel
    </div>

    <div a-show="!subscribed" class="text-amber-600">
        Connecting...
    </div>

    <ul>
        <template a-for="event in events">
            <li>
                <span a-text="event.name"></span> at
                <span a-text="new Date(event.timestamp).toLocaleString()"></span>
            </li>
        </template>
    </ul>
</x-accelade::event>
```

## Backend Event Actions

When broadcasting events, you can include Accelade action payloads that automatically trigger client-side behavior.

### Redirect on Event

Navigate the client to a new page when the event is received:

```php
use Accelade\Accelade;
use Illuminate\Broadcasting\PrivateChannel;
use Illuminate\Contracts\Broadcasting\ShouldBroadcast;

class OrderCreated implements ShouldBroadcast
{
    public function __construct(public Order $order) {}

    public function broadcastOn(): array
    {
        return [
            new PrivateChannel('user.' . $this->order->user_id),
        ];
    }

    public function broadcastWith(): array
    {
        return Accelade::redirectOnEvent(
            route('orders.show', $this->order)
        )->toArray();
    }
}
```

### Redirect to Named Route

```php
public function broadcastWith(): array
{
    return Accelade::redirectToRouteOnEvent(
        'orders.show',
        ['order' => $this->order->id]
    )->toArray();
}
```

### Refresh on Event

Reload the current page when the event is received:

```php
public function broadcastWith(): array
{
    return Accelade::refreshOnEvent()->toArray();
}
```

With scroll preservation (useful for dashboards):

```blade
<x-accelade::event
    channel="dashboard"
    listen="DataUpdated"
    :preserve-scroll="true"
/>
```

### Toast on Event

Show a notification when the event is received:

```php
public function broadcastWith(): array
{
    return Accelade::toastOnEvent(
        'New order received!',
        'success'
    )->toArray();
}
```

#### Toast Shortcuts

```php
// Success toast
Accelade::successOnEvent('Order completed!')

// Info toast
Accelade::infoOnEvent('New update available')

// Warning toast
Accelade::warningOnEvent('Low inventory alert')

// Danger toast
Accelade::dangerOnEvent('Payment failed')
```

#### Toast with Title

```php
Accelade::toastOnEvent('Your order has been shipped!')
    ->withTitle('Order Update')
    ->toArray();
```

### Including Custom Data

Add additional data alongside the action:

```php
public function broadcastWith(): array
{
    return Accelade::redirectOnEvent(route('orders.show', $this->order))
        ->with([
            'order_id' => $this->order->id,
            'status' => $this->order->status,
            'total' => $this->order->total,
        ])
        ->toArray();
}
```

## Custom Event Handling

For advanced use cases, listen to the `accelade:echo` custom event:

```blade
<x-accelade::event
    channel="orders"
    listen="OrderCreated"
    id="order-listener"
>
    <!-- Content -->
</x-accelade::event>

<script>
document.getElementById('order-listener').addEventListener('accelade:echo', (e) => {
    console.log('Event received:', e.detail.name, e.detail.data);

    // Custom handling
    if (e.detail.data.priority === 'high') {
        playNotificationSound();
    }
});
</script>
```

## Multiple Events

Listen to multiple events on the same channel:

```blade
<x-accelade::event
    channel="orders"
    listen="OrderCreated,OrderUpdated,OrderCancelled"
>
    <div a-for="event in events">
        <span a-show="event.name === 'OrderCreated'" class="text-green-600">
            New order created
        </span>
        <span a-show="event.name === 'OrderUpdated'" class="text-blue-600">
            Order updated
        </span>
        <span a-show="event.name === 'OrderCancelled'" class="text-red-600">
            Order cancelled
        </span>
    </div>
</x-accelade::event>
```

## Framework-Specific Attributes

The component works with all Accelade-supported frameworks:

```blade
{{-- Vanilla --}}
<x-accelade::event channel="orders" listen="OrderCreated">
    <p a-text="events.length"></p>
</x-accelade::event>

{{-- Vue --}}
<x-accelade::event channel="orders" listen="OrderCreated">
    <p v-text="events.length"></p>
</x-accelade::event>

{{-- React --}}
<x-accelade::event channel="orders" listen="OrderCreated">
    <p data-state-text="events.length"></p>
</x-accelade::event>
```

## Graceful Degradation

If Laravel Echo is not configured, the component:

- Renders without error
- Sets `subscribed` to `false`
- Logs a warning to the console
- All other Accelade features continue working

## Complete Example

### Backend Event

```php
<?php

namespace App\Events;

use App\Models\Order;
use Accelade\Accelade;
use Illuminate\Broadcasting\PrivateChannel;
use Illuminate\Contracts\Broadcasting\ShouldBroadcast;

class OrderStatusChanged implements ShouldBroadcast
{
    public function __construct(
        public Order $order,
        public string $oldStatus,
        public string $newStatus
    ) {}

    public function broadcastOn(): array
    {
        return [
            new PrivateChannel('user.' . $this->order->user_id),
        ];
    }

    public function broadcastWith(): array
    {
        // Show toast and include order data
        return Accelade::successOnEvent("Order #{$this->order->id} is now {$this->newStatus}")
            ->withTitle('Order Status Update')
            ->with([
                'order_id' => $this->order->id,
                'old_status' => $this->oldStatus,
                'new_status' => $this->newStatus,
            ])
            ->toArray();
    }
}
```

### Frontend Component

```blade
<x-accelade::event
    channel="user.{{ auth()->id() }}"
    :private="true"
    listen="OrderStatusChanged"
    class="fixed bottom-4 right-4"
>
    {{-- Status indicator --}}
    <div class="flex items-center gap-2 p-3 bg-white rounded-lg shadow">
        <span
            a-class="{ 'bg-green-500': subscribed, 'bg-amber-500': !subscribed }"
            class="w-2 h-2 rounded-full"
        ></span>
        <span a-show="subscribed" class="text-sm text-gray-600">
            Real-time updates active
        </span>
        <span a-show="!subscribed" class="text-sm text-amber-600">
            Connecting...
        </span>
    </div>
</x-accelade::event>
```

## API Reference

### EventResponse Methods

| Method | Description |
|--------|-------------|
| `EventResponse::redirect($url)` | Create redirect action |
| `EventResponse::redirectToRoute($route, $params)` | Redirect to named route |
| `EventResponse::refresh()` | Create page refresh action |
| `EventResponse::toast($message, $type)` | Create toast notification |
| `EventResponse::success($message)` | Success toast shorthand |
| `EventResponse::info($message)` | Info toast shorthand |
| `EventResponse::warning($message)` | Warning toast shorthand |
| `EventResponse::danger($message)` | Danger toast shorthand |
| `->withTitle($title)` | Add title to toast |
| `->with($data)` | Add custom data to response |
| `->toArray()` | Convert to array for broadcasting |

### Accelade Facade Methods

| Method | Description |
|--------|-------------|
| `Accelade::redirectOnEvent($url)` | Create redirect action |
| `Accelade::redirectToRouteOnEvent($route, $params)` | Redirect to named route |
| `Accelade::refreshOnEvent()` | Create page refresh action |
| `Accelade::toastOnEvent($message, $type)` | Create toast notification |
| `Accelade::successOnEvent($message)` | Success toast shorthand |
| `Accelade::infoOnEvent($message)` | Info toast shorthand |
| `Accelade::warningOnEvent($message)` | Warning toast shorthand |
| `Accelade::dangerOnEvent($message)` | Danger toast shorthand |

## Next Steps

- [Notifications](notifications.md) - Toast notification system
- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Components](components.md) - Reactive components
</file>

<file path="docs/exception-handling.md">
# Exception Handling

Accelade provides custom exception handling for AJAX requests, ensuring graceful error handling with toast notifications, redirects, and proper error responses.

## Quick Start

Register the Accelade exception handler in your `app/Exceptions/Handler.php`:

```php
<?php

namespace App\Exceptions;

use Accelade\Facades\Accelade;
use Illuminate\Foundation\Exceptions\Handler as ExceptionHandler;

class Handler extends ExceptionHandler
{
    public function register(): void
    {
        $this->renderable(Accelade::exceptionHandler($this));
    }
}
```

That's it! Accelade will now handle exceptions for all AJAX requests automatically.

## How It Works

### Server-Side

When an exception occurs during an Accelade AJAX request (Bridge calls, Defer loading, etc.), the exception handler:

1. Detects if the request is an Accelade request (XHR with Accelade routes or headers)
2. Converts the exception to a JSON response with:
   - Error message
   - Toast notification configuration
   - Optional action (redirect, refresh)
   - Debug info (in development mode)

### Client-Side

The JavaScript error handler:

1. Receives the error response
2. Shows a toast notification
3. Executes any actions (redirect, refresh)
4. Logs errors to the console (configurable)

## Custom Exception Handling

Handle specific exceptions differently by passing a closure:

```php
$this->renderable(Accelade::exceptionHandler($this, function ($e, $request) {
    // Handle CSRF token mismatch with custom redirect
    if ($e instanceof \Symfony\Component\HttpKernel\Exception\HttpException) {
        if ($e->getStatusCode() === 419) {
            return redirect()->route('login', ['reason' => 'timeout']);
        }
    }

    // Handle custom exceptions
    if ($e instanceof \App\Exceptions\PaymentException) {
        return response()->json([
            'success' => false,
            'message' => 'Payment failed',
            '_accelade' => [
                'type' => 'payment',
                'toast' => [
                    'type' => 'danger',
                    'title' => 'Payment Error',
                    'body' => $e->getMessage(),
                ],
            ],
        ], 402);
    }

    // Return null to let Accelade handle other exceptions
    return null;
}));
```

## Error Response Format

Accelade error responses follow this structure:

```json
{
    "success": false,
    "message": "Error message",
    "errors": {
        "field": ["Validation error message"]
    },
    "_accelade": {
        "type": "validation|http|exception",
        "status": 422,
        "action": "refresh|redirect",
        "url": "/redirect/url",
        "toast": {
            "type": "danger",
            "title": "Error Title",
            "body": "Error details"
        },
        "debug": {
            "exception": "RuntimeException",
            "message": "Detailed error message",
            "file": "/path/to/file.php",
            "line": 42,
            "trace": [...]
        }
    }
}
```

## HTTP Status Code Handling

Different HTTP status codes trigger different behaviors:

| Status | Behavior |
|--------|----------|
| 401 | Redirect to login page |
| 403 | Show "Access Denied" toast |
| 404 | Show "Not Found" toast |
| 419 | Refresh page (CSRF expired) |
| 422 | Show validation errors |
| 429 | Show "Too Many Requests" toast |
| 500+ | Show "Server Error" toast |

## Configuration

Configure error handling behavior in `config/accelade.php`:

```php
'errors' => [
    // In production, suppress JS errors that may cause blank pages
    'suppress_errors' => env('ACCELADE_SUPPRESS_ERRORS', env('APP_ENV') === 'production'),

    // Show toast notifications for errors
    'show_toasts' => env('ACCELADE_ERROR_TOASTS', true),

    // Log errors to browser console
    'log_errors' => env('ACCELADE_LOG_ERRORS', true),

    // Include debug information (uses APP_DEBUG)
    'debug' => env('APP_DEBUG', false),
],
```

### suppress_errors

When `true`, JavaScript errors that might cause blank pages are caught and shown as toast notifications instead. This is enabled by default in production.

### show_toasts

When `true`, error toast notifications are automatically shown for AJAX failures. Users see friendly error messages instead of silent failures.

### log_errors

When `true`, errors are logged to the browser console for debugging. Useful during development.

### debug

When `true`, detailed error information (exception class, file, line, trace) is included in the response. This uses Laravel's `APP_DEBUG` setting by default.

## JavaScript API

Access error handling from JavaScript:

```javascript
// Initialize with custom config
Accelade.errors.init({
    suppressErrors: true,
    showToasts: true,
    logErrors: true,
    debug: false,
});

// Handle a generic error
Accelade.errors.handle(error, 'Context');

// Handle an AJAX error response
Accelade.errors.handleAjax(response, statusCode);

// Access the full ErrorHandler module
const ErrorHandler = Accelade.errors.handler;
```

## Validation Errors

Validation errors are handled specially:

```php
// In your controller
public function store(Request $request)
{
    $request->validate([
        'email' => 'required|email',
        'name' => 'required|min:3',
    ]);

    // ... handle valid request
}
```

When validation fails, Accelade automatically:

1. Returns a 422 response
2. Shows a "Validation Error" toast
3. Includes the error messages in the response

You can access validation errors in JavaScript:

```javascript
const result = await bridge.call('store', formData);

if (!result.success && result.errors) {
    // result.errors contains validation error messages
    console.log(result.errors.email); // ['The email field is required.']
}
```

## Network Error Handling

Network errors (offline, timeout, etc.) are handled gracefully:

- **Offline**: Shows "No Connection" toast
- **Timeout/Abort**: Shows "Request Cancelled" toast
- **Network Error**: Shows "Network Error" toast

## Security Considerations

1. **Debug Info**: Debug information is only included when `APP_DEBUG=true`. Never enable debug mode in production.

2. **Error Messages**: In production, generic error messages are shown to users. Detailed messages are only shown in development.

3. **Stack Traces**: Stack traces are truncated to 10 frames to prevent exposing too much application structure.

## Comparison with Splade

| Feature | Accelade | Splade |
|---------|----------|--------|
| Exception Handler | `Accelade::exceptionHandler()` | `SpladeCore::exceptionHandler()` |
| Custom Handler | Closure as 2nd argument | Closure as 2nd argument |
| Error Suppression | `suppress_errors` config | `suppress_compile_errors` config |
| Toast Notifications | Built-in | Built-in |
| Debug Mode | Uses `APP_DEBUG` | Uses `APP_DEBUG` |

## Next Steps

- [Bridge Components](bridge.md) - PHP/JS two-way binding
- [Notifications](notifications.md) - Toast notification system
- [Defer Component](defer.md) - Lazy loading content
</file>

<file path="docs/flash.md">
# Flash Component (Session Flash Data)

Accelade provides seamless access to Laravel's session flash data through the Flash component. This enables displaying flash messages without full page reloads, perfect for SPA-like applications.

## Basic Usage

```blade
<x-accelade::flash>
    <div a-if="flash.has('success')" class="alert alert-success">
        <span a-text="flash.success"></span>
    </div>

    <div a-if="flash.has('error')" class="alert alert-danger">
        <span a-text="flash.error"></span>
    </div>
</x-accelade::flash>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `shared` | bool | true | Share flash data globally via `Accelade::share()` |

## The Flash Object

The component exposes a `flash` object with the following methods and properties:

### `flash.has(key)`

Check if a flash key exists and has a truthy value:

```blade
<x-accelade::flash>
    <div a-if="flash.has('message')">
        Message exists!
    </div>
</x-accelade::flash>
```

### `flash.key`

Access flash values directly by key:

```blade
<x-accelade::flash>
    <p a-text="flash.success"></p>
    <p a-text="flash.error"></p>
    <p a-text="flash.message"></p>
</x-accelade::flash>
```

### `flash.get(key, default)`

Get a flash value with an optional default:

```blade
<x-accelade::flash>
    <p a-text="flash.get('message', 'No message')"></p>
</x-accelade::flash>
```

### `flash.all()`

Get all flash data as an object:

```blade
<x-accelade::flash>
    <pre a-text="JSON.stringify(flash.all(), null, 2)"></pre>
</x-accelade::flash>
```

## Setting Flash Data

Flash data is set in your Laravel controllers using the standard session methods:

```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class OrderController extends Controller
{
    public function store(Request $request)
    {
        // Create the order...
        $order = Order::create($request->validated());

        // Flash a success message
        session()->flash('success', 'Order created successfully!');

        return redirect()->route('orders.index');
    }

    public function destroy(Order $order)
    {
        $order->delete();

        // Flash multiple messages
        session()->flash('message', 'Order has been deleted.');
        session()->flash('info', 'You can restore it within 30 days.');

        return redirect()->route('orders.index');
    }
}
```

You can also use the `with()` helper when redirecting:

```php
return redirect()->route('orders.index')
    ->with('success', 'Order created successfully!');
```

## Configuration

Configure flash data behavior in `config/accelade.php`:

```php
'flash' => [
    // Enable/disable automatic flash data sharing
    'enabled' => env('ACCELADE_FLASH_ENABLED', true),

    // Specific keys to share (null = all common keys)
    'keys' => null,
],
```

### Limiting Flash Keys

To only share specific flash keys:

```php
'flash' => [
    'enabled' => true,
    'keys' => ['success', 'error', 'warning', 'info', 'message'],
],
```

This is useful for security if you want to prevent accidentally exposing sensitive session data.

## Automatic Sharing

By default, flash data is automatically shared via the `ShareAcceladeData` middleware. This means flash data is available:

1. In the `<x-accelade::flash>` component
2. Via `Accelade::shared()->get('flash')` in views
3. In JavaScript via the shared data system

The middleware automatically collects common flash keys:
- `message`
- `success`
- `error`
- `warning`
- `info`
- `status`
- `notification`
- `alert`

## Framework-Specific Syntax

The Flash component works with all Accelade-supported frameworks:

### Vanilla (Default)

```blade
<x-accelade::flash>
    <div a-if="flash.has('success')">
        <p a-text="flash.success"></p>
    </div>
</x-accelade::flash>
```

### Vue

```blade
<x-accelade::flash>
    <div v-if="flash.has('success')">
        <p v-text="flash.success"></p>
    </div>
</x-accelade::flash>
```

### React

```blade
<x-accelade::flash>
    <div data-state-if="flash.has('success')">
        <p data-state-text="flash.success"></p>
    </div>
</x-accelade::flash>
```

## Notification-Style Flash Messages

Position flash messages as toast notifications:

```blade
<x-accelade::flash class="fixed top-4 right-4 z-50 space-y-2">
    <div
        a-show="flash.has('success')"
        class="p-4 bg-green-100 border border-green-400 rounded-lg shadow-lg"
    >
        <p a-text="flash.success" class="text-green-700"></p>
    </div>

    <div
        a-show="flash.has('error')"
        class="p-4 bg-red-100 border border-red-400 rounded-lg shadow-lg"
    >
        <p a-text="flash.error" class="text-red-700"></p>
    </div>
</x-accelade::flash>
```

## Combining with Custom Scripts

Add custom behavior like auto-dismiss:

```blade
<x-accelade::flash>
    <div a-show="flash.has('message')" class="alert">
        <span a-text="flash.message"></span>
        <button @click="dismiss()">Dismiss</button>
    </div>

    <accelade:script>
        return {
            dismiss() {
                // Custom dismiss logic
                $set('flash', {});
            }
        };
    </accelade:script>
</x-accelade::flash>
```

## SPA Navigation

Flash data works seamlessly with SPA navigation. When navigating between pages:

1. The server sets flash data
2. Accelade fetches the page via AJAX
3. Flash data is included in the response
4. The Flash component reactively updates

No page reload required.

## Disabling Shared Mode

If you don't want flash data shared globally:

```blade
<x-accelade::flash :shared="false">
    {{-- Flash data only available within this component --}}
    <p a-text="flash.message"></p>
</x-accelade::flash>
```

## Complete Example

### Controller

```php
<?php

namespace App\Http\Controllers;

class TaskController extends Controller
{
    public function store(Request $request)
    {
        $task = Task::create($request->validated());

        session()->flash('success', "Task '{$task->title}' created!");
        session()->flash('info', 'You can edit it anytime.');

        return redirect()->route('tasks.index');
    }

    public function destroy(Task $task)
    {
        $task->delete();

        session()->flash('message', 'Task deleted.');

        return redirect()->route('tasks.index');
    }
}
```

### Blade Template

```blade
<!DOCTYPE html>
<html>
<head>
    <title>Tasks</title>
    @acceladeStyles
</head>
<body>
    {{-- Flash message area --}}
    <x-accelade::flash class="mb-4">
        <div a-if="flash.has('success')"
             class="p-4 bg-green-100 text-green-700 rounded-lg">
            <strong>Success!</strong>
            <span a-text="flash.success"></span>
        </div>

        <div a-if="flash.has('info')"
             class="p-4 bg-blue-100 text-blue-700 rounded-lg mt-2">
            <span a-text="flash.info"></span>
        </div>

        <div a-if="flash.has('message')"
             class="p-4 bg-gray-100 text-gray-700 rounded-lg">
            <span a-text="flash.message"></span>
        </div>
    </x-accelade::flash>

    {{-- Page content --}}
    <div class="tasks">
        @foreach($tasks as $task)
            <div class="task">{{ $task->title }}</div>
        @endforeach
    </div>

    @acceladeScripts
</body>
</html>
```

## Next Steps

- [Notifications](notifications.md) - Toast notification system
- [Components](components.md) - Reactive components
- [SPA Navigation](spa-navigation.md) - Client-side routing
</file>

<file path="docs/lazy-loading.md">
# Lazy Loading

Accelade provides a powerful lazy loading component for deferring content rendering. Show beautiful shimmer placeholders while content loads, reducing initial page load time.

## Quick Start

```blade
{{-- Basic lazy loading with shimmer --}}
<x-accelade::lazy :shimmer="true">
    @foreach($items as $item)
        <div class="item">{{ $item->name }}</div>
    @endforeach
</x-accelade::lazy>
```

The content will display a shimmer animation while loading, then smoothly fade in.

## Shimmer Placeholder

Enable shimmer with a single attribute:

```blade
{{-- Simple shimmer with 3 lines (default) --}}
<x-accelade::lazy :shimmer="true">
    Content here
</x-accelade::lazy>

{{-- Custom number of lines --}}
<x-accelade::lazy :shimmer="true" :shimmer-lines="5">
    Content here
</x-accelade::lazy>

{{-- Custom height --}}
<x-accelade::lazy :shimmer="true" shimmer-height="200px">
    Content here
</x-accelade::lazy>

{{-- Custom width --}}
<x-accelade::lazy :shimmer="true" shimmer-width="50%">
    Content here
</x-accelade::lazy>

{{-- Rounded shimmer --}}
<x-accelade::lazy :shimmer="true" :shimmer-rounded="true">
    Content here
</x-accelade::lazy>

{{-- Circle shimmer (for avatars) --}}
<x-accelade::lazy :shimmer="true" :shimmer-circle="true">
    <img src="{{ $user->avatar }}" alt="{{ $user->name }}">
</x-accelade::lazy>
```

## Custom Placeholder

Use the `placeholder` slot for custom loading content:

```blade
<x-accelade::lazy>
    <x-slot:placeholder>
        <div class="flex items-center gap-4">
            <div class="animate-pulse bg-gray-200 rounded-full w-12 h-12"></div>
            <div class="space-y-2">
                <div class="animate-pulse bg-gray-200 h-4 w-32 rounded"></div>
                <div class="animate-pulse bg-gray-200 h-3 w-24 rounded"></div>
            </div>
        </div>
    </x-slot:placeholder>

    <div class="flex items-center gap-4">
        <img src="{{ $user->avatar }}" class="w-12 h-12 rounded-full">
        <div>
            <h3>{{ $user->name }}</h3>
            <p>{{ $user->email }}</p>
        </div>
    </div>
</x-accelade::lazy>
```

## Loading from URL

Load content from a separate endpoint:

```blade
<x-accelade::lazy url="/api/notifications" :shimmer="true">
</x-accelade::lazy>
```

With POST method and data:

```blade
<x-accelade::lazy
    url="/api/search"
    method="POST"
    :data="['query' => $searchQuery]"
    :shimmer="true"
>
</x-accelade::lazy>
```

## Delayed Loading

Add a delay before content loads:

```blade
{{-- Wait 500ms before loading --}}
<x-accelade::lazy :delay="500" :shimmer="true">
    Content loads after delay
</x-accelade::lazy>
```

## Conditional Loading

Show content based on a condition:

```blade
@accelade(['showNotifications' => false])
    <button @click="$toggle('showNotifications')">
        Toggle Notifications
    </button>

    <x-accelade::lazy show="showNotifications" :shimmer="true">
        @foreach($notifications as $notification)
            <div>{{ $notification->message }}</div>
        @endforeach
    </x-accelade::lazy>
@endaccelade
```

The content loads fresh from the server each time the condition becomes true.

## JavaScript API

Control lazy loading programmatically:

```javascript
// Get a lazy instance by ID
const lazy = Accelade.lazy.get('lazy-abc123');

// Manually load content
Accelade.lazy.load('lazy-abc123');

// Reload content
Accelade.lazy.reload('lazy-abc123');

// Hide content (show placeholder)
Accelade.lazy.hide('lazy-abc123');

// Listen for events
Accelade.lazy.on('loaded', (instance) => {
    console.log('Content loaded:', instance.id);
});

// Configure global options
Accelade.lazy.configure({
    delay: 100, // Default delay for all lazy components
});
```

## Events

| Event | Description |
|-------|-------------|
| `load` | Content is about to load |
| `loaded` | Content has finished loading |
| `error` | Loading failed |

```javascript
Accelade.lazy.on('error', (instance, error) => {
    console.error('Failed to load:', instance.id, error);
});
```

## Component Attributes

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `shimmer` | bool | `false` | Enable shimmer placeholder |
| `shimmer-lines` | int | `3` | Number of shimmer lines |
| `shimmer-height` | string | auto | Custom height (e.g., "200px") |
| `shimmer-width` | string | auto | Custom width (e.g., "50%") |
| `shimmer-rounded` | bool | `false` | Rounded corners |
| `shimmer-circle` | bool | `false` | Circle shape (for avatars) |
| `url` | string | null | URL to fetch content from |
| `method` | string | `GET` | HTTP method for URL requests |
| `data` | array | `[]` | Data to send with POST requests |
| `delay` | int | `0` | Delay in ms before loading |
| `show` | bool/string | `true` | Condition for loading |
| `name` | string | null | Optional name for the component |

## Shimmer CSS Classes

Use these classes for custom shimmer effects:

```html
<!-- Container -->
<div class="accelade-shimmer-container">
    <div class="accelade-shimmer-line"></div>
    <div class="accelade-shimmer-line"></div>
    <div class="accelade-shimmer-line accelade-shimmer-line-short"></div>
</div>

<!-- Modifiers -->
<div class="accelade-shimmer-container accelade-shimmer-rounded">...</div>
<div class="accelade-shimmer-container accelade-shimmer-circle">...</div>
<div class="accelade-shimmer-container accelade-shimmer-dark">...</div>

<!-- Presets -->
<div class="accelade-shimmer-card">...</div>
<div class="accelade-shimmer-image">...</div>
<div class="accelade-shimmer-avatar">...</div>

<!-- Inline -->
<span class="accelade-shimmer-inline" style="width: 100px;"></span>
```

## Examples

### Card Skeleton

```blade
<x-accelade::lazy :shimmer="true" shimmer-height="200px">
    <x-slot:placeholder>
        <div class="accelade-shimmer-card">
            <div class="accelade-shimmer-line" style="height: 1.5rem; width: 60%;"></div>
            <div class="accelade-shimmer-line"></div>
            <div class="accelade-shimmer-line"></div>
            <div class="accelade-shimmer-line accelade-shimmer-line-short"></div>
        </div>
    </x-slot:placeholder>

    <div class="card">
        <h2>{{ $post->title }}</h2>
        <p>{{ $post->excerpt }}</p>
    </div>
</x-accelade::lazy>
```

### User List

```blade
<x-accelade::lazy :shimmer="true" :shimmer-lines="6">
    @foreach($users as $user)
        <div class="flex items-center gap-3 py-2">
            <img src="{{ $user->avatar }}" class="w-10 h-10 rounded-full">
            <span>{{ $user->name }}</span>
        </div>
    @endforeach
</x-accelade::lazy>
```

### Image Gallery

```blade
<div class="grid grid-cols-3 gap-4">
    @foreach($images as $image)
        <x-accelade::lazy :shimmer="true" :shimmer-rounded="true" shimmer-height="150px">
            <img src="{{ $image->url }}" alt="{{ $image->alt }}" class="rounded-lg">
        </x-accelade::lazy>
    @endforeach
</div>
```

### Comment Section (Load on Demand)

```blade
@accelade(['showComments' => false])
    <button @click="$toggle('showComments')" class="btn">
        <span a-show="!showComments">Show Comments</span>
        <span a-show="showComments">Hide Comments</span>
    </button>

    <x-accelade::lazy show="showComments" url="/posts/{{ $post->id }}/comments" :shimmer="true">
    </x-accelade::lazy>
@endaccelade
```

## Best Practices

1. **Use Shimmer for Better UX** - Shimmer provides visual feedback that content is loading
2. **Keep Placeholders Similar** - Match placeholder dimensions to actual content
3. **Lazy Load Heavy Content** - Use for images, lists, and data-heavy sections
4. **Conditional Loading** - Load content only when needed (tabs, accordions)
5. **Add Delays Sparingly** - Only use delays when necessary for visual effect

## Next Steps

- [Components](components.md) - Building reactive components
- [SPA Navigation](spa-navigation.md) - Client-side routing
- [API Reference](api-reference.md) - Complete API documentation
</file>

<file path="docs/link.md">
# Link Component

The Accelade Link component provides enhanced navigation with HTTP methods, confirmation dialogs, and SPA routing. It wraps standard anchor elements to enable asynchronous page loading without full browser refreshes.

## Basic Usage

```blade
<x-accelade::link href="/dashboard">Dashboard</x-accelade::link>

<x-accelade::link href="/users">All Users</x-accelade::link>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `href` | string | - | Target URL (required) |
| `method` | string | GET | HTTP method (GET, POST, PUT, PATCH, DELETE) |
| `data` | array | null | Request payload data |
| `headers` | array | null | Custom HTTP headers |
| `spa` | bool | true | Enable SPA navigation |
| `away` | bool | false | Treat as external link (full page navigation) |
| `activeClass` | string | 'active' | CSS class added when on current URL |
| `prefetch` | bool | false | Prefetch page on hover |
| `preserveScroll` | bool | false | Keep scroll position after navigation |
| `preserveState` | bool | false | Preserve component state |
| `replace` | bool | false | Replace history instead of push |
| `confirm` | bool/string | null | Show confirmation dialog |
| `confirmText` | string | null | Custom confirmation message |
| `confirmTitle` | string | null | Confirmation dialog title |
| `confirmButton` | string | 'Confirm' | Confirm button label |
| `cancelButton` | string | 'Cancel' | Cancel button label |
| `confirmDanger` | bool | false | Render confirm button in red (danger) style |

## Confirmation Dialogs

Show a confirmation dialog before navigation:

```blade
{{-- Simple confirmation --}}
<x-accelade::link href="/action" :confirm="true">
    Do Something
</x-accelade::link>

{{-- Custom confirmation text --}}
<x-accelade::link
    href="/delete"
    confirm-text="Are you sure you want to delete this item?"
>
    Delete
</x-accelade::link>

{{-- Fully customized confirmation --}}
<x-accelade::link
    href="/account/delete"
    confirm-title="Delete Account"
    confirm-text="This will permanently delete your account and all data. This action cannot be undone."
    confirm-button="Yes, delete my account"
    cancel-button="No, keep my account"
    :confirm-danger="true"
>
    Delete Account
</x-accelade::link>
```

### Danger Confirmation

For destructive actions, use the `confirm-danger` prop to render the confirm button in red:

```blade
<x-accelade::link
    href="/api/items/123"
    method="DELETE"
    confirm-text="Delete this item?"
    confirm-button="Delete"
    :confirm-danger="true"
>
    Delete Item
</x-accelade::link>
```

## HTTP Methods

Support POST, PUT, PATCH, and DELETE methods for form-like submissions:

```blade
{{-- POST request --}}
<x-accelade::link
    href="/api/items"
    method="POST"
    :data="['name' => 'New Item', 'status' => 'active']"
>
    Create Item
</x-accelade::link>

{{-- PUT request --}}
<x-accelade::link
    href="/api/items/123"
    method="PUT"
    :data="['name' => 'Updated Item']"
>
    Update Item
</x-accelade::link>

{{-- PATCH request --}}
<x-accelade::link
    href="/api/items/123/toggle"
    method="PATCH"
>
    Toggle Status
</x-accelade::link>

{{-- DELETE request --}}
<x-accelade::link
    href="/api/items/123"
    method="DELETE"
    :confirm-danger="true"
    confirm-text="Delete this item permanently?"
>
    Delete
</x-accelade::link>
```

### Request Data

Pass data with your request:

```blade
<x-accelade::link
    href="/api/orders"
    method="POST"
    :data="[
        'product_id' => $product->id,
        'quantity' => 1,
    ]"
>
    Add to Cart
</x-accelade::link>
```

### Custom Headers

Add custom headers to requests:

```blade
<x-accelade::link
    href="/api/resource"
    method="POST"
    :headers="['X-Custom-Header' => 'value']"
>
    Submit
</x-accelade::link>
```

## External Links

Use the `away` attribute for external links:

```blade
{{-- Simple external link --}}
<x-accelade::link href="https://example.com" :away="true">
    Visit Example
</x-accelade::link>

{{-- External link with confirmation --}}
<x-accelade::link
    href="https://external-site.com"
    :away="true"
    confirm-text="You are leaving this site. Continue?"
>
    External Link
</x-accelade::link>
```

## Navigation Options

### Preserve Scroll

Keep the scroll position after navigation:

```blade
<x-accelade::link href="/page" :preserve-scroll="true">
    Update (keep scroll)
</x-accelade::link>
```

Useful when:
- Updating content in the middle of a long page
- Navigating back from a form submission
- Pagination with server-side redirects

### Preserve State

Maintain component state across navigation:

```blade
<x-accelade::link href="/next-page" :preserve-state="true">
    Next (keep state)
</x-accelade::link>
```

### Prefetch

Prefetch the page on hover for faster navigation:

```blade
<x-accelade::link href="/dashboard" :prefetch="true">
    Dashboard
</x-accelade::link>
```

### Replace History

Replace the current history entry instead of pushing a new one:

```blade
<x-accelade::link href="/redirect-target" :replace="true">
    Redirect
</x-accelade::link>
```

## Active State

Links automatically receive an `active` class when on the current URL:

```blade
{{-- Default active class --}}
<x-accelade::link href="/current" class="nav-link">
    Current Page
</x-accelade::link>

{{-- Custom active class --}}
<x-accelade::link href="/page" active-class="is-active">
    Page
</x-accelade::link>
```

Style active links with CSS:

```css
.nav-link.active {
    font-weight: bold;
    color: blue;
}
```

## Non-SPA Links

Disable SPA behavior for specific links:

```blade
<x-accelade::link href="/download" :spa="false">
    Download File
</x-accelade::link>
```

## JavaScript API

### Events

Listen to link events:

```javascript
// Before link is handled
document.addEventListener('accelade:link-before', (e) => {
    console.log('Navigating to:', e.detail.href);
    // Set e.detail.cancelled = true to prevent navigation
});

// After response received
document.addEventListener('accelade:link-response', (e) => {
    console.log('Response:', e.detail.response);
});

// On error
document.addEventListener('accelade:link-error', (e) => {
    console.error('Error:', e.detail.error);
});
```

### Programmatic Confirmation

Use the confirmation dialog programmatically:

```javascript
import { confirm, confirmDanger, showConfirmDialog } from 'accelade';

// Simple confirm
const result = await confirm('Are you sure?');
if (result) {
    // User confirmed
}

// Danger confirm
const deleted = await confirmDanger('Delete this item?', 'Delete');
if (deleted) {
    // User confirmed deletion
}

// Full options
const result = await showConfirmDialog({
    title: 'Confirm Action',
    text: 'This will modify your data.',
    confirmButton: 'Proceed',
    cancelButton: 'Cancel',
    danger: false,
});

if (result.confirmed) {
    // User confirmed
}
```

## Complete Example

### Navigation Menu

```blade
<nav class="flex gap-4">
    <x-accelade::link
        href="{{ route('dashboard') }}"
        class="px-4 py-2 rounded hover:bg-gray-100"
        active-class="bg-blue-100 text-blue-700"
    >
        Dashboard
    </x-accelade::link>

    <x-accelade::link
        href="{{ route('users.index') }}"
        class="px-4 py-2 rounded hover:bg-gray-100"
        active-class="bg-blue-100 text-blue-700"
        :prefetch="true"
    >
        Users
    </x-accelade::link>

    <x-accelade::link
        href="{{ route('settings') }}"
        class="px-4 py-2 rounded hover:bg-gray-100"
        active-class="bg-blue-100 text-blue-700"
    >
        Settings
    </x-accelade::link>
</nav>
```

### Action Buttons

```blade
<div class="flex gap-2">
    {{-- Edit action --}}
    <x-accelade::link
        href="{{ route('items.edit', $item) }}"
        class="px-3 py-1 bg-blue-500 text-white rounded"
    >
        Edit
    </x-accelade::link>

    {{-- Duplicate action --}}
    <x-accelade::link
        href="{{ route('items.duplicate', $item) }}"
        method="POST"
        class="px-3 py-1 bg-gray-500 text-white rounded"
    >
        Duplicate
    </x-accelade::link>

    {{-- Delete action --}}
    <x-accelade::link
        href="{{ route('items.destroy', $item) }}"
        method="DELETE"
        confirm-text="Delete '{{ $item->name }}'?"
        confirm-button="Delete"
        :confirm-danger="true"
        class="px-3 py-1 bg-red-500 text-white rounded"
    >
        Delete
    </x-accelade::link>
</div>
```

## Framework-Specific Attributes

The Link component automatically uses the correct attributes for each framework:

| Framework | Attribute |
|-----------|-----------|
| Vanilla | `a-link` |
| Vue | `data-accelade-link` |
| React | `data-spa-link` |
| Svelte | `data-spa-link` |
| Angular | `data-spa-link` |

## Next Steps

- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Components](components.md) - Reactive components
- [Flash Component](flash.md) - Session flash data
</file>

<file path="docs/modal.md">
# Modal Component

The Accelade Modal component provides modal dialogs, slideover panels, and bottom sheets with async content loading, customizable appearance, and pre-loaded content support.

## Basic Usage

### Pre-loaded Modal

Use a hash link to open a modal with pre-loaded content:

```blade
{{-- Link to open modal --}}
<x-accelade::link href="#my-modal">Open Modal</x-accelade::link>

{{-- Modal component (hidden until triggered) --}}
<x-accelade::modal name="my-modal">
    <h2>Modal Title</h2>
    <p>Modal content goes here...</p>
    <button data-modal-close>Close</button>
</x-accelade::modal>
```

### Async Modal (Load from URL)

Load modal content asynchronously from a URL:

```blade
<x-accelade::link href="/users/create" :modal="true">
    Create User
</x-accelade::link>
```

The content from `/users/create` will be loaded into the modal when clicked.

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `name` | string | null | Modal name for hash-based opening |
| `slideover` | bool | false | Render as slideover instead of modal |
| `bottomSheet` | bool | false | Render as bottom sheet (mobile-friendly) |
| `maxWidth` | string | 2xl / md | Max width (sm, md, lg, xl, 2xl, 3xl, 4xl, 5xl, 6xl, 7xl) |
| `position` | string | center | Vertical position (top, center, bottom) |
| `slideoverPosition` | string | right | Slideover horizontal position (left, right) |
| `closeExplicitly` | bool | false | Disable ESC key and outside click closing |
| `closeButton` | bool | true | Show the X close button |
| `opened` | bool | false | Open immediately on page load |

## Slideovers

Slideovers are side panels that slide in from the left or right:

```blade
{{-- Right slideover (default) --}}
<x-accelade::link href="#settings">Settings</x-accelade::link>

<x-accelade::modal name="settings" :slideover="true">
    <h2>Settings</h2>
    <nav>...</nav>
</x-accelade::modal>

{{-- Left slideover --}}
<x-accelade::modal name="navigation" :slideover="true" slideover-position="left">
    <nav>...</nav>
</x-accelade::modal>
```

### Async Slideover

```blade
<x-accelade::link href="/settings" :slideover="true">
    Open Settings
</x-accelade::link>
```

## Bottom Sheets

Bottom sheets are mobile-friendly panels that slide up from the bottom of the screen. They're perfect for action sheets, quick selections, and mobile navigation:

```blade
{{-- Pre-loaded bottom sheet --}}
<x-accelade::link href="#actions">Actions</x-accelade::link>

<x-accelade::modal name="actions" :bottom-sheet="true">
    <h2>Choose an Action</h2>
    <button>Edit</button>
    <button>Share</button>
    <button>Delete</button>
    <button data-modal-close>Cancel</button>
</x-accelade::modal>
```

Bottom sheets include a drag handle at the top for visual affordance.

### Async Bottom Sheet

Load bottom sheet content from a URL:

```blade
<x-accelade::link href="/share-options" :bottom-sheet="true">
    Share
</x-accelade::link>
```

### Bottom Sheet Features

- Slides up from the bottom of the screen
- Full width with rounded top corners
- Includes a drag handle indicator
- Max height of 90vh with scroll support
- Perfect for mobile-first interfaces

## Max Width Options

Control the width of modals and slideovers:

| Value | Width | Description |
|-------|-------|-------------|
| `sm` | 24rem | Small |
| `md` | 28rem | Medium (slideover default) |
| `lg` | 32rem | Large |
| `xl` | 36rem | Extra large |
| `2xl` | 42rem | 2X large (modal default) |
| `3xl` | 48rem | 3X large |
| `4xl` | 56rem | 4X large |
| `5xl` | 64rem | 5X large |
| `6xl` | 72rem | 6X large |
| `7xl` | 80rem | 7X large |

```blade
{{-- Small modal --}}
<x-accelade::modal name="confirm" max-width="sm">
    <p>Are you sure?</p>
</x-accelade::modal>

{{-- Large modal for tables/forms --}}
<x-accelade::modal name="data-table" max-width="5xl">
    <table>...</table>
</x-accelade::modal>
```

## Position Options

### Modal Positions

Position modals vertically within the viewport:

```blade
{{-- Top of screen --}}
<x-accelade::modal name="alert" position="top">
    Alert content...
</x-accelade::modal>

{{-- Center (default) --}}
<x-accelade::modal name="dialog" position="center">
    Dialog content...
</x-accelade::modal>

{{-- Bottom of screen --}}
<x-accelade::modal name="action-sheet" position="bottom">
    Action sheet...
</x-accelade::modal>
```

### Slideover Positions

```blade
{{-- Right side (default) --}}
<x-accelade::modal name="details" :slideover="true" slideover-position="right">
    Detail panel...
</x-accelade::modal>

{{-- Left side --}}
<x-accelade::modal name="menu" :slideover="true" slideover-position="left">
    Navigation menu...
</x-accelade::modal>
```

## Closing Modals

### Close Button

By default, modals have an X button in the top-right corner. Disable it with:

```blade
<x-accelade::modal name="custom" :close-button="false">
    <button data-modal-close>Custom Close Button</button>
</x-accelade::modal>
```

### Data Attribute Close

Add `data-modal-close` to any element to make it close the modal:

```blade
<x-accelade::modal name="dialog">
    <p>Modal content...</p>
    <button data-modal-close>Cancel</button>
    <button data-modal-close>Save & Close</button>
</x-accelade::modal>
```

### Close Explicitly

Prevent closing via ESC key and outside click:

```blade
<x-accelade::modal name="important" :close-explicitly="true">
    <h2>Important Notice</h2>
    <p>You must acknowledge this message.</p>
    <button data-modal-close>I Understand</button>
</x-accelade::modal>
```

## Link Component Props

Use these props on `<x-accelade::link>` to open modals:

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `modal` | bool | false | Open link in modal |
| `slideover` | bool | false | Open link in slideover |
| `bottomSheet` | bool | false | Open link in bottom sheet |
| `modalMaxWidth` | string | null | Override modal max-width |
| `modalPosition` | string | null | Override modal position |
| `slideoverPosition` | string | null | Override slideover position |

```blade
{{-- Modal link --}}
<x-accelade::link href="/form" :modal="true">
    Open Form
</x-accelade::link>

{{-- Modal link with options --}}
<x-accelade::link
    href="/details"
    :modal="true"
    modal-max-width="4xl"
    modal-position="top"
>
    View Details
</x-accelade::link>

{{-- Slideover link --}}
<x-accelade::link
    href="/settings"
    :slideover="true"
    slideover-position="left"
>
    Settings
</x-accelade::link>

{{-- Bottom sheet link --}}
<x-accelade::link href="/share" :bottom-sheet="true">
    Share Options
</x-accelade::link>
```

## JavaScript API

### Events

Listen to modal events:

```javascript
// When any modal opens
document.addEventListener('accelade:modal-open', (e) => {
    console.log('Modal opened:', e.detail.id, e.detail.name);
});

// When any modal closes
document.addEventListener('accelade:modal-close', (e) => {
    console.log('Modal closed:', e.detail.id);
});
```

### Programmatic Control

Access the modal manager:

```javascript
// Open a named modal
window.Accelade.modal.openNamed('my-modal');

// Open modal from URL
await window.Accelade.modal.openUrl('/users/create', {
    maxWidth: '4xl',
    position: 'top',
});

// Open slideover from URL
await window.Accelade.modal.openUrl('/settings', {
    type: 'slideover',
    slideoverPosition: 'left',
});

// Open bottom sheet from URL
await window.Accelade.modal.openUrl('/actions', {
    type: 'bottom-sheet',
    maxWidth: 'lg',
});

// Open with HTML content
window.Accelade.modal.open({
    content: '<h2>Hello</h2><p>World</p>',
    maxWidth: 'md',
});

// Close all modals
window.Accelade.modal.closeAll();

// Close the topmost modal
window.Accelade.modal.closeLast();

// Check if any modal is open
if (window.Accelade.modal.hasOpen()) {
    // ...
}
```

### Modal Instance

Get a reference to a modal instance:

```javascript
const modal = window.Accelade.modal.getByName('my-modal');

// Control the modal
modal.open();
modal.close();
modal.setIsOpen(true);

// Check state
console.log(modal.isOpen);
```

## Complete Examples

### Confirmation Modal

```blade
<x-accelade::link href="#confirm-delete">
    Delete Item
</x-accelade::link>

<x-accelade::modal name="confirm-delete" max-width="sm" :close-explicitly="true">
    <h3 class="text-lg font-semibold text-red-600">Delete Item?</h3>
    <p class="text-slate-600 my-4">
        This action cannot be undone. Are you sure you want to delete this item?
    </p>
    <div class="flex gap-3 justify-end">
        <button data-modal-close class="px-4 py-2 bg-slate-200 rounded">
            Cancel
        </button>
        <x-accelade::link
            href="/items/123"
            method="DELETE"
            class="px-4 py-2 bg-red-500 text-white rounded"
        >
            Delete
        </x-accelade::link>
    </div>
</x-accelade::modal>
```

### Form in Modal

```blade
<x-accelade::link href="/users/create" :modal="true" modal-max-width="lg">
    Create User
</x-accelade::link>
```

In your `/users/create` view, wrap the form with the modal component:

```blade
{{-- resources/views/users/create.blade.php --}}
<x-accelade::modal>
    <h2 class="text-xl font-semibold mb-4">Create User</h2>

    <form action="/users" method="POST">
        @csrf
        <input type="text" name="name" placeholder="Name">
        <input type="email" name="email" placeholder="Email">

        <div class="flex gap-3 justify-end mt-4">
            <button type="button" data-modal-close>Cancel</button>
            <button type="submit">Create</button>
        </div>
    </form>
</x-accelade::modal>
```

### Navigation Sidebar

```blade
<x-accelade::link href="#nav-menu">
    <svg><!-- menu icon --></svg>
</x-accelade::link>

<x-accelade::modal name="nav-menu" :slideover="true" slideover-position="left">
    <nav class="space-y-2">
        <x-accelade::link href="/dashboard" data-modal-close>
            Dashboard
        </x-accelade::link>
        <x-accelade::link href="/users" data-modal-close>
            Users
        </x-accelade::link>
        <x-accelade::link href="/settings" data-modal-close>
            Settings
        </x-accelade::link>
    </nav>
</x-accelade::modal>
```

### Auto-open Modal

Open a modal immediately when the page loads:

```blade
<x-accelade::modal name="welcome" :opened="true">
    <h2>Welcome!</h2>
    <p>Thanks for visiting our site.</p>
    <button data-modal-close>Got it</button>
</x-accelade::modal>
```

### Action Sheet (Bottom Sheet)

Create a mobile-friendly action sheet:

```blade
<x-accelade::link href="#photo-options">
    <svg><!-- camera icon --></svg>
    Add Photo
</x-accelade::link>

<x-accelade::modal name="photo-options" :bottom-sheet="true">
    <div class="space-y-2">
        <button class="w-full p-4 text-left hover:bg-slate-100 rounded">
            Take Photo
        </button>
        <button class="w-full p-4 text-left hover:bg-slate-100 rounded">
            Choose from Gallery
        </button>
        <button class="w-full p-4 text-left hover:bg-slate-100 rounded">
            Browse Files
        </button>
    </div>
    <button data-modal-close class="w-full p-4 text-center text-slate-500">
        Cancel
    </button>
</x-accelade::modal>
```

## Styling

### CSS Variables

Customize modal appearance with CSS:

```css
/* Modal overlay background */
.accelade-modal-overlay {
    background: rgba(0, 0, 0, 0.75);
}

/* Modal panel */
.accelade-modal-panel {
    border-radius: 1rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

/* Close button */
.accelade-modal-close:hover {
    background: #fee2e2;
    color: #dc2626;
}
```

### Dark Mode

```css
@media (prefers-color-scheme: dark) {
    .accelade-modal-panel {
        background: #1f2937;
        color: #f9fafb;
    }

    .accelade-modal-close {
        color: #9ca3af;
    }

    .accelade-modal-close:hover {
        background: #374151;
        color: #f9fafb;
    }
}
```

## Next Steps

- [Link Component](link.md) - Enhanced navigation
- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Components](components.md) - Reactive components
</file>

<file path="docs/notifications.md">
# Notifications

Accelade provides a Filament-inspired notification system for displaying toast messages from PHP or JavaScript.

## Setup

Add the notifications container to your layout:

```blade
<body>
    {{ $slot }}

    @acceladeScripts
    @acceladeNotifications
</body>
```

## PHP Notifications

### Using the Facade

```php
use Accelade\Facades\Notify;

// Quick notifications
Notify::success('Success!')->body('Your changes have been saved.');
Notify::info('Info')->body('Here is some information.');
Notify::warning('Warning')->body('Please review your input.');
Notify::danger('Error')->body('Something went wrong.');
```

### Using the Notification Class

```php
use Accelade\Notification\Notification;

Notification::make()
    ->title('Welcome!')
    ->body('Thanks for signing up.')
    ->success()
    ->send();
```

### In Controllers

```php
class UserController extends Controller
{
    public function store(Request $request)
    {
        // Create user...

        Notify::success('User Created')
            ->body('The user account has been created successfully.');

        return redirect()->route('users.index');
    }

    public function destroy(User $user)
    {
        $user->delete();

        Notify::danger('User Deleted')
            ->body("User {$user->name} has been removed.");

        return redirect()->route('users.index');
    }
}
```

## Notification Methods

### Basic Properties

```php
Notification::make()
    ->title('Title')           // Main title
    ->body('Body text')        // Description/body
    ->status('success')        // Status type
    ->send();
```

### Status Types

```php
->success()    // Green - positive actions
->info()       // Blue - informational
->warning()    // Yellow/Orange - warnings
->danger()     // Red - errors, destructive actions
```

### Custom Icon

```php
Notification::make()
    ->title('Custom Icon')
    ->icon('<svg>...</svg>')
    ->iconColor('#ff0000')
    ->send();
```

### Duration

```php
// Duration in milliseconds
->duration(5000)   // 5 seconds

// Duration in seconds
->seconds(10)      // 10 seconds

// Auto-dismiss helper
->autoDismiss(8)   // 8 seconds
```

### Persistent Notifications

```php
// Won't auto-dismiss, requires manual close
Notification::make()
    ->title('Important')
    ->body('This requires your attention.')
    ->persistent()
    ->send();
```

### Position

```php
->position('top-right')      // Default
->position('top-left')
->position('top-center')
->position('bottom-right')
->position('bottom-left')
->position('bottom-center')
```

### Actions

Add buttons to notifications:

```php
Notification::make()
    ->title('New Message')
    ->body('You have a new message from John.')
    ->info()
    ->actions([
        [
            'name' => 'view',
            'label' => 'View Message',
            'url' => '/messages/1',
        ],
        [
            'name' => 'dismiss',
            'label' => 'Dismiss',
            'close' => true,
        ],
    ])
    ->send();
```

Action properties:

| Property | Type | Description |
|----------|------|-------------|
| `name` | string | Action identifier |
| `label` | string | Button text |
| `url` | string | Link URL |
| `openInNewTab` | bool | Open URL in new tab |
| `close` | bool | Close notification on click |
| `dispatch` | string | Dispatch browser event |

## JavaScript Notifications

### Quick Methods

```javascript
window.Accelade.notify.success('Success!', 'Operation completed.');
window.Accelade.notify.info('Info', 'Here is some information.');
window.Accelade.notify.warning('Warning', 'Please be careful.');
window.Accelade.notify.danger('Error', 'Something went wrong.');
```

### Full Options

```javascript
window.Accelade.notify.show({
    id: 'unique-id',          // Optional, auto-generated if not provided
    title: 'Notification',
    body: 'This is the body text.',
    status: 'success',         // success, info, warning, danger
    position: 'top-right',
    duration: 5000,           // milliseconds
    persistent: false,
    actions: [
        { label: 'View', url: '/view' },
        { label: 'Close', close: true }
    ]
});
```

### Closing Notifications

```javascript
// Close by ID
window.Accelade.notify.close('notification-id');

// Close all
window.Accelade.notify.closeAll();
```

## Customizing Appearance

### CSS Variables

Override these CSS variables to customize appearance:

```css
:root {
    /* Container */
    --accelade-notif-width: 24rem;
    --accelade-notif-radius: 0.75rem;
    --accelade-notif-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
    --accelade-notif-bg: #fff;

    /* Success */
    --accelade-notif-success-icon: #10b981;
    --accelade-notif-success-bg: #ecfdf5;
    --accelade-notif-success-border: #a7f3d0;

    /* Info */
    --accelade-notif-info-icon: #3b82f6;
    --accelade-notif-info-bg: #eff6ff;
    --accelade-notif-info-border: #bfdbfe;

    /* Warning */
    --accelade-notif-warning-icon: #f59e0b;
    --accelade-notif-warning-bg: #fffbeb;
    --accelade-notif-warning-border: #fde68a;

    /* Danger */
    --accelade-notif-danger-icon: #ef4444;
    --accelade-notif-danger-bg: #fef2f2;
    --accelade-notif-danger-border: #fecaca;

    /* Animation */
    --accelade-notif-animation-duration: 0.3s;
}
```

### Dark Mode

```css
.dark {
    --accelade-notif-bg: #1f2937;
    --accelade-notif-success-bg: #064e3b;
    --accelade-notif-info-bg: #1e3a5f;
    --accelade-notif-warning-bg: #78350f;
    --accelade-notif-danger-bg: #7f1d1d;
}
```

## Manager Configuration

### Default Position

```php
use Accelade\Facades\Notify;

Notify::defaultPosition('bottom-right');

// All subsequent notifications use this position
Notify::success('Saved!');
```

### Default Duration

```php
Notify::defaultDuration(8000); // 8 seconds

Notify::info('This shows for 8 seconds');
```

## Backend Notification Demo

Visit `/demo/notify/{type}` to test backend notifications:

| URL | Description |
|-----|-------------|
| `/demo/notify/success` | Success notification |
| `/demo/notify/info` | Info notification |
| `/demo/notify/warning` | Warning notification |
| `/demo/notify/danger` | Danger notification |
| `/demo/notify/persistent` | Persistent (no auto-dismiss) |
| `/demo/notify/actions` | With action buttons |
| `/demo/notify/custom` | Custom icon |

## Complete Example

```php
// In a controller
public function processPayment(Request $request)
{
    try {
        $payment = Payment::process($request->all());

        Notification::make()
            ->title('Payment Successful')
            ->body("Transaction #{$payment->id} completed.")
            ->success()
            ->actions([
                [
                    'label' => 'View Receipt',
                    'url' => route('payments.receipt', $payment),
                ],
            ])
            ->seconds(10)
            ->send();

        return redirect()->route('dashboard');

    } catch (PaymentException $e) {
        Notification::make()
            ->title('Payment Failed')
            ->body($e->getMessage())
            ->danger()
            ->persistent()
            ->actions([
                ['label' => 'Try Again', 'url' => route('payments.create')],
                ['label' => 'Contact Support', 'url' => route('support')],
            ])
            ->send();

        return back();
    }
}
```

## Next Steps

- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Components](components.md) - Reactive components
- [API Reference](api-reference.md) - Complete API
</file>

<file path="docs/persistent-layout.md">
# Persistent Layout

Accelade's Persistent Layout feature allows certain elements to remain active and unaffected during SPA navigation. This is ideal for media players, chat widgets, and other components that should continue functioning as users navigate your application.

## Quick Start

Wrap any element you want to persist across navigation:

```blade
<x-accelade::persistent id="music-player">
    <audio src="/music.mp3" controls></audio>
</x-accelade::persistent>
```

That's it! The audio player will continue playing even when users navigate to other pages.

## How It Works

1. When SPA navigation begins, Accelade saves all elements with `data-accelade-persistent`
2. After the new page content loads, matching persistent elements are restored
3. The original DOM elements are moved (not cloned), preserving their state
4. Media playback, form inputs, and component state remain intact

## The Persistent Component

### Basic Usage

```blade
<x-accelade::persistent id="my-widget">
    <div class="fixed bottom-4 right-4">
        <!-- This content persists across navigation -->
    </div>
</x-accelade::persistent>
```

### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | string | auto-generated | Unique identifier to match elements across pages |

### Important Notes

- The `id` must be identical on both the source and destination pages
- Navigation must use SPA links (`<x-accelade::link>`) for persistence to work
- Traditional page loads will reset persistent elements

## Custom Persistent Layouts

For complex layouts where you want specific regions to persist, create a custom component extending `PersistentComponent`.

### Step 1: Create the Component

```bash
php artisan make:component VideoLayout
```

### Step 2: Extend PersistentComponent

```php
<?php

namespace App\View\Components;

use Accelade\Components\PersistentComponent;

class VideoLayout extends PersistentComponent
{
    public function render()
    {
        return view('components.video-layout');
    }
}
```

### Step 3: Create the View

```blade
{{-- resources/views/components/video-layout.blade.php --}}
<div class="min-h-screen">
    {{-- Main content area (changes with navigation) --}}
    <main data-accelade-page class="pb-24">
        {{ $slot }}
    </main>

    {{-- Persistent video player --}}
    <x-accelade::persistent id="video-player">
        <div class="fixed bottom-0 left-0 right-0 h-24 bg-black">
            <video id="main-video" controls class="h-full mx-auto">
                <source src="/video.mp4" type="video/mp4">
            </video>
        </div>
    </x-accelade::persistent>
</div>
```

### Step 4: Use the Layout

```blade
<x-video-layout>
    <h1>Page Title</h1>
    <p>Your page content here...</p>

    <x-accelade::link href="/another-page">
        Go to another page (video keeps playing!)
    </x-accelade::link>
</x-video-layout>
```

## Use Cases

### Music Player

```blade
<x-accelade::persistent id="audio-player">
    <div class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4">
        <audio id="player" src="/current-track.mp3" controls class="w-full"></audio>
        <div class="flex justify-between mt-2">
            <span id="track-title">Now Playing: Track Name</span>
            <button onclick="togglePlaylist()">Playlist</button>
        </div>
    </div>
</x-accelade::persistent>
```

### Chat Widget

```blade
<x-accelade::persistent id="chat-widget">
    <div class="fixed bottom-4 right-4 w-80">
        <div class="bg-white rounded-lg shadow-xl">
            <div class="p-4 bg-blue-600 text-white rounded-t-lg">
                Live Chat
            </div>
            <div class="h-64 overflow-y-auto p-4">
                <!-- Chat messages preserved across navigation -->
            </div>
            <div class="p-4 border-t">
                <input type="text" placeholder="Type a message..." class="w-full">
            </div>
        </div>
    </div>
</x-accelade::persistent>
```

### Video Mini-Player

```blade
<x-accelade::persistent id="mini-player">
    <div class="fixed bottom-4 right-4 w-64 shadow-xl rounded-lg overflow-hidden">
        <video id="mini-video" autoplay muted class="w-full">
            <source src="/video.mp4" type="video/mp4">
        </video>
        <div class="absolute top-2 right-2">
            <button onclick="closeMiniPlayer()" class="text-white">×</button>
        </div>
    </div>
</x-accelade::persistent>
```

### Notification Panel

```blade
<x-accelade::persistent id="notifications">
    <div class="fixed top-4 right-4 w-80">
        @foreach($notifications as $notification)
            <div class="bg-white p-4 rounded shadow mb-2">
                {{ $notification->message }}
            </div>
        @endforeach
    </div>
</x-accelade::persistent>
```

## Multiple Persistent Elements

You can have multiple persistent elements on a page:

```blade
<x-accelade::persistent id="music-player">
    <!-- Music player -->
</x-accelade::persistent>

<x-accelade::persistent id="chat-widget">
    <!-- Chat widget -->
</x-accelade::persistent>

<x-accelade::persistent id="notifications">
    <!-- Notification panel -->
</x-accelade::persistent>
```

Each element is saved and restored independently based on its `id`.

## JavaScript API

You can check if the current page has persistent elements:

```javascript
const router = window.Accelade.router.instance();

// Check if page has persistent elements
if (router.hasPersistentElements()) {
    console.log('This page has persistent elements');
}
```

## Best Practices

### 1. Use Unique IDs

Always use unique, descriptive IDs for persistent elements:

```blade
{{-- Good --}}
<x-accelade::persistent id="main-video-player">
<x-accelade::persistent id="support-chat-widget">

{{-- Avoid --}}
<x-accelade::persistent id="widget1">
<x-accelade::persistent id="player">
```

### 2. Keep Persistent Elements Simple

Persistent elements work best when they're self-contained:

```blade
{{-- Good: Self-contained component --}}
<x-accelade::persistent id="audio-player">
    <livewire:audio-player />
</x-accelade::persistent>

{{-- Avoid: Complex nested structures --}}
<x-accelade::persistent id="complex">
    <div>
        <!-- Many nested components that reference external state -->
    </div>
</x-accelade::persistent>
```

### 3. Use Fixed Positioning

Persistent elements typically use fixed positioning:

```blade
<x-accelade::persistent id="player" class="fixed bottom-0 left-0 right-0">
    <!-- Content -->
</x-accelade::persistent>
```

### 4. Handle State Carefully

If your persistent element has JavaScript state, ensure it's properly managed:

```blade
<x-accelade::persistent id="stateful-widget">
    <div x-data="{ isOpen: false }">
        <!-- Alpine.js state will be preserved -->
    </div>
</x-accelade::persistent>
```

## Limitations

1. **SPA Navigation Required**: Persistent elements only work with SPA navigation. Traditional page loads will reset them.

2. **Same ID Required**: The persistent element must have the same `id` on both the source and destination pages.

3. **No Server-Side State**: Persistent elements maintain client-side DOM state only. Server-rendered content will be from the new page.

## Comparison with Keep-Alive

| Feature | Persistent Layout | Keep-Alive Cache |
|---------|-------------------|------------------|
| Preserves | Specific elements | Entire page state |
| Navigation | Forward and back | Back/forward only |
| Use case | Media players, widgets | Form state, scroll position |
| Memory | Low (specific elements) | Higher (full pages) |

Use **Persistent Layout** for elements that should remain active during forward navigation (like media players). Use **Keep-Alive Cache** for preserving page state when users navigate back.

## Next Steps

- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Components](components.md) - Reactive components
- [Configuration](configuration.md) - All config options
</file>

<file path="docs/rehydrate.md">
# Rehydrate Component

The Accelade Rehydrate component enables selective section reloading in Blade templates without refreshing the entire page. Content can be updated via events or automatic polling.

## Basic Usage

### Event-Triggered Rehydration

Reload a section when an event is emitted:

```blade
{{-- List that updates when an item is added --}}
<x-accelade::rehydrate on="item-added">
    <ul>
        @foreach($items as $item)
            <li>{{ $item->name }}</li>
        @endforeach
    </ul>
</x-accelade::rehydrate>
```

Trigger the event from JavaScript:

```javascript
// After creating a new item
Accelade.emit('item-added');

// Or with event data
Accelade.emit('item-added', { id: 123 });
```

### Polling (Auto-Refresh)

Automatically refresh content at intervals:

```blade
{{-- Updates every 5 seconds --}}
<x-accelade::rehydrate :poll="5000">
    Current score: {{ $score }}
</x-accelade::rehydrate>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `on` | string\|array | null | Event name(s) that trigger rehydration |
| `poll` | int | null | Polling interval in milliseconds |
| `url` | string | current page | URL to fetch content from |
| `preserveScroll` | bool | true | Preserve scroll position after reload |

## Multiple Events

Listen to multiple events with a single component:

```blade
<x-accelade::rehydrate :on="['created', 'updated', 'deleted']">
    <table>
        @foreach($records as $record)
            <tr>{{ $record->name }}</tr>
        @endforeach
    </table>
</x-accelade::rehydrate>
```

## Integration with Forms

Emit events after form submission:

```blade
{{-- Form that emits event on success --}}
<form method="POST" action="/items">
    @csrf
    <input name="name" required>
    <button type="submit">Add Item</button>
</form>

{{-- List that reloads when item is added --}}
<x-accelade::rehydrate on="item-added">
    @foreach($items as $item)
        <div>{{ $item->name }}</div>
    @endforeach
</x-accelade::rehydrate>

<script>
// In your form submission handler
form.addEventListener('submit', async (e) => {
    e.preventDefault();
    await fetch('/items', { method: 'POST', body: new FormData(form) });
    Accelade.emit('item-added');
});
</script>
```

## Custom URL

Fetch content from a different URL:

```blade
<x-accelade::rehydrate on="refresh" url="/partials/stats">
    @include('partials.stats')
</x-accelade::rehydrate>
```

## JavaScript API

### Emitting Events

```javascript
// Emit an event
Accelade.emit('event-name');

// With data payload
Accelade.emit('user-updated', { userId: 123 });

// Alternative via rehydrate namespace
Accelade.rehydrate.emit('event-name');
```

### Manual Rehydration

```javascript
// Reload a specific component by ID
Accelade.rehydrate.reload('component-id');

// Reload all rehydrate components
Accelade.rehydrate.reloadAll();
```

### Getting Instances

```javascript
// Get a specific instance
const instance = Accelade.rehydrate.get('component-id');

// Get all instances
const instances = Accelade.rehydrate.getAll();

// Trigger rehydration directly
if (instance) {
    await instance.rehydrate();
}
```

### Instance Properties

```javascript
const instance = Accelade.rehydrate.get('my-component');

instance.id;           // Component ID
instance.config;       // Configuration object
instance.element;      // DOM element
instance.isLoading;    // Whether currently loading

instance.rehydrate();  // Trigger rehydration
instance.startPolling(); // Start polling (if configured)
instance.stopPolling();  // Stop polling
instance.dispose();    // Clean up
```

## Events

Listen to rehydration events:

```javascript
// When rehydration completes
document.addEventListener('accelade:rehydrate', (e) => {
    console.log('Rehydrated:', e.detail.id, e.detail.success);
});

// Custom event emission
document.addEventListener('accelade:emit', (e) => {
    console.log('Event emitted:', e.detail.event, e.detail.data);
});
```

## Best Practices

### Place Conditionals Inside

Always place conditionals inside the rehydrate component:

```blade
{{-- Good: Conditional inside --}}
<x-accelade::rehydrate on="data-loaded">
    @if($hasData)
        <div>Data here</div>
    @else
        <div>No data</div>
    @endif
</x-accelade::rehydrate>

{{-- Bad: Wrapping with conditional --}}
@if($hasData)
    <x-accelade::rehydrate on="data-loaded">
        <div>Data here</div>
    </x-accelade::rehydrate>
@endif
```

### Use Unique IDs

For multiple rehydrate components, use explicit IDs:

```blade
<x-accelade::rehydrate on="users-updated" id="users-list">
    ...
</x-accelade::rehydrate>

<x-accelade::rehydrate on="orders-updated" id="orders-list">
    ...
</x-accelade::rehydrate>
```

### Combine with Forms

Use with the `stay` behavior on forms to keep the form visible:

```blade
<x-accelade::rehydrate on="team-member-added">
    <ul>
        @foreach($team->members as $member)
            <li>{{ $member->name }}</li>
        @endforeach
    </ul>
</x-accelade::rehydrate>

{{-- Form stays visible after submission --}}
<form @submit.prevent="submitForm" @success="Accelade.emit('team-member-added')">
    <input name="name">
    <button>Add Member</button>
</form>
```

## Complete Examples

### Live Dashboard Stats

```blade
{{-- Stats that refresh every 10 seconds --}}
<x-accelade::rehydrate :poll="10000" id="dashboard-stats">
    <div class="grid grid-cols-3 gap-4">
        <div class="stat-card">
            <h3>Total Users</h3>
            <p>{{ $totalUsers }}</p>
        </div>
        <div class="stat-card">
            <h3>Active Sessions</h3>
            <p>{{ $activeSessions }}</p>
        </div>
        <div class="stat-card">
            <h3>Revenue Today</h3>
            <p>${{ $revenueToday }}</p>
        </div>
    </div>
</x-accelade::rehydrate>
```

### Notification Counter

```blade
{{-- Badge that updates when notifications arrive --}}
<x-accelade::rehydrate on="notification-received" id="notification-badge">
    @if($unreadCount > 0)
        <span class="badge">{{ $unreadCount }}</span>
    @endif
</x-accelade::rehydrate>

<script>
// When a WebSocket message arrives
Echo.channel('notifications')
    .listen('NewNotification', () => {
        Accelade.emit('notification-received');
    });
</script>
```

### Chat Messages

```blade
{{-- Messages list that polls for new messages --}}
<x-accelade::rehydrate :poll="2000" :on="['message-sent']" id="messages">
    <div class="messages">
        @foreach($messages as $message)
            <div class="message">
                <strong>{{ $message->user->name }}</strong>
                <p>{{ $message->content }}</p>
            </div>
        @endforeach
    </div>
</x-accelade::rehydrate>
```

## Styling

The component adds a loading class during rehydration:

```css
/* Style during rehydration */
.accelade-rehydrating {
    opacity: 0.5;
    pointer-events: none;
}

/* Or add a loading indicator */
.accelade-rehydrating::after {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
}
```

## Next Steps

- [Components](components.md) - Reactive components
- [Event Component](event.md) - Laravel Echo integration
- [Defer Component](defer.md) - Async data loading
- [SPA Navigation](spa-navigation.md) - Client-side routing
</file>

<file path="docs/scripts.md">
# Custom Scripts

Define custom JavaScript functions with full access to component state and actions using the `<x-accelade::script>` component.

---

## Basic Usage

The script component allows you to add custom methods to your Accelade components:

```blade
@accelade(['count' => 0, 'items' => []])
    <button @click="customIncrement()">Add 5</button>
    <button @click="addItem('New Item')">Add Item</button>

    <x-accelade::script>
        return {
            customIncrement() {
                $set('count', $get('count') + 5);
            },
            addItem(name) {
                const items = $get('items');
                items.push({ name, id: Date.now() });
                $set('items', items);
            }
        };
    </x-accelade::script>
@endaccelade
```

---

## Available Functions

Inside the script component, you have access to these built-in functions:

| Function | Description |
|----------|-------------|
| `$set(key, value)` | Set a state value |
| `$get(key)` | Get a state value |
| `$toggle(key)` | Toggle a boolean state value |
| `$reset(key?)` | Reset state to initial values (all or specific key) |
| `$navigate(url, options?)` | Navigate to a URL using SPA |
| `$watch(key, callback)` | Watch a state property for changes (Vue only) |
| `increment(key, amount?)` | Increment a numeric state value |
| `decrement(key, amount?)` | Decrement a numeric state value |
| `state` | Direct access to the reactive state object |
| `actions` | Access to built-in action methods |

---

## Framework Support

The component automatically renders the correct script attribute based on your configured framework:

| Framework | Output |
|-----------|--------|
| Vanilla JS | `<script a-script>...</script>` |
| Vue.js | `<script v-script>...</script>` |
| React | `<script state-script>...</script>` |
| Svelte | `<script state-script>...</script>` |
| Angular | `<script state-script>...</script>` |

---

## Examples

### Form Validation

Create custom validation logic for forms:

```blade
@accelade(['email' => '', 'password' => '', 'errors' => []])
    <form @submit.prevent="validate()">
        <input a-model="email" type="email" placeholder="Email">
        <p a-show="errors.email" a-text="errors.email" class="text-red-500"></p>

        <input a-model="password" type="password" placeholder="Password">
        <p a-show="errors.password" a-text="errors.password" class="text-red-500"></p>

        <button type="submit">Login</button>
    </form>

    <x-accelade::script>
        return {
            validate() {
                const errors = {};
                const email = $get('email');
                const password = $get('password');

                if (!email) {
                    errors.email = 'Email is required';
                } else if (!email.includes('@')) {
                    errors.email = 'Invalid email format';
                }

                if (!password) {
                    errors.password = 'Password is required';
                } else if (password.length < 8) {
                    errors.password = 'Password must be at least 8 characters';
                }

                $set('errors', errors);

                if (Object.keys(errors).length === 0) {
                    this.submitForm();
                }
            },
            async submitForm() {
                // Submit to server...
                $navigate('/dashboard');
            }
        };
    </x-accelade::script>
@endaccelade
```

### Async Data Loading

Load data from an API with loading and error states:

```blade
@accelade(['loading' => false, 'users' => [], 'error' => null])
    <button @click="loadUsers()" a-show="!loading">Load Users</button>
    <span a-show="loading">Loading...</span>

    <ul a-show="users.length">
        <template a-for="user in users">
            <li a-text="user.name"></li>
        </template>
    </ul>

    <p a-show="error" a-text="error" class="text-red-500"></p>

    <x-accelade::script>
        return {
            async loadUsers() {
                $set('loading', true);
                $set('error', null);

                try {
                    const response = await fetch('/api/users');
                    if (!response.ok) throw new Error('Failed to load users');

                    const data = await response.json();
                    $set('users', data);
                } catch (e) {
                    $set('error', e.message);
                } finally {
                    $set('loading', false);
                }
            }
        };
    </x-accelade::script>
@endaccelade
```

### Shopping Cart

Manage a shopping cart with add, remove, and total calculation:

```blade
@accelade(['cart' => [], 'total' => 0])
    <div class="cart">
        <template a-for="item in cart">
            <div class="cart-item">
                <span a-text="item.name"></span>
                <span a-text="'$' + item.price.toFixed(2)"></span>
                <button @click="removeItem(item.id)">Remove</button>
            </div>
        </template>

        <div class="cart-total">
            Total: <span a-text="'$' + total.toFixed(2)">$0.00</span>
        </div>
    </div>

    <x-accelade::script>
        return {
            addItem(product) {
                const cart = $get('cart');
                const existing = cart.find(i => i.id === product.id);

                if (existing) {
                    existing.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }

                $set('cart', cart);
                this.updateTotal();
            },
            removeItem(id) {
                const cart = $get('cart').filter(i => i.id !== id);
                $set('cart', cart);
                this.updateTotal();
            },
            updateTotal() {
                const cart = $get('cart');
                const total = cart.reduce((sum, item) => {
                    return sum + (item.price * item.quantity);
                }, 0);
                $set('total', total);
            }
        };
    </x-accelade::script>
@endaccelade
```

### Debounced Search

Implement debounced search with custom timing:

```blade
@accelade(['query' => '', 'results' => [], 'searching' => false])
    <input
        a-model="query"
        @input="debouncedSearch()"
        placeholder="Search..."
    >

    <div a-show="searching">Searching...</div>

    <ul a-show="results.length && !searching">
        <template a-for="result in results">
            <li a-text="result.title"></li>
        </template>
    </ul>

    <x-accelade::script>
        let searchTimeout = null;

        return {
            debouncedSearch() {
                clearTimeout(searchTimeout);

                searchTimeout = setTimeout(() => {
                    this.search();
                }, 300);
            },
            async search() {
                const query = $get('query');
                if (!query.trim()) {
                    $set('results', []);
                    return;
                }

                $set('searching', true);

                try {
                    const response = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
                    const data = await response.json();
                    $set('results', data.results);
                } finally {
                    $set('searching', false);
                }
            }
        };
    </x-accelade::script>
@endaccelade
```

---

## Best Practices

### Keep Scripts Focused

Each script should handle related functionality. For complex components, consider breaking them into smaller, focused components.

### Use Async/Await

For API calls and async operations, use async/await for cleaner code:

```blade
<x-accelade::script>
    return {
        async saveData() {
            try {
                const response = await fetch('/api/save', {
                    method: 'POST',
                    body: JSON.stringify($get('formData'))
                });
                // Handle response
            } catch (error) {
                $set('error', error.message);
            }
        }
    };
</x-accelade::script>
```

### Leverage State Functions

Use the built-in state functions instead of direct manipulation:

```blade
{{-- Good --}}
$set('count', $get('count') + 1);

{{-- Better - use increment helper --}}
increment('count');
```

---

## Related

- [State Management](state.md) — Managing component state
- [Bridge](bridge.md) — Call PHP methods from JavaScript
- [API Reference](api-reference.md) — Complete API documentation
</file>

<file path="docs/seo.md">
# SEO

Accelade provides a powerful SEO engine for managing page metadata. Set titles, descriptions, OpenGraph, Twitter Cards, and custom meta tags using a fluent PHP API or Blade directives.

## Quick Start

```blade
{{-- In your Blade template --}}
@seoTitle('My Page Title')
@seoDescription('This is my page description')
@seoKeywords('php, laravel, accelade')

{{-- In your layout's <head> section --}}
<head>
    @seo
</head>
```

## Blade Directives

### Basic Meta Tags

```blade
{{-- Set page title --}}
@seoTitle('My Page Title')

{{-- Set page description --}}
@seoDescription('A brief description of the page content')

{{-- Set keywords (comma-separated string) --}}
@seoKeywords('laravel, php, accelade')

{{-- Set canonical URL --}}
@seoCanonical('https://example.com/page')

{{-- Set robots meta --}}
@seoRobots('index, follow')

{{-- Set author --}}
@seoAuthor('John Doe')
```

### OpenGraph Tags

```blade
@seoOpenGraph([
    'type' => 'article',
    'site_name' => 'My Website',
    'title' => 'Article Title',
    'description' => 'Article description',
    'url' => 'https://example.com/article',
    'image' => 'https://example.com/image.jpg',
    'image_alt' => 'Image description',
    'locale' => 'en_US',
])
```

### Twitter Cards

```blade
@seoTwitter([
    'card' => 'summary_large_image',
    'site' => '@mysite',
    'creator' => '@johndoe',
    'title' => 'Tweet Title',
    'description' => 'Tweet description',
    'image' => 'https://example.com/twitter.jpg',
    'image_alt' => 'Image description',
])
```

### Custom Meta Tags

```blade
{{-- Add meta by name attribute --}}
@seoMeta('theme-color', '#6366f1')

{{-- Output all SEO tags --}}
@seo
```

## PHP API

Use the SEO facade for programmatic control:

```php
use Accelade\Facades\SEO;

// Basic meta
SEO::title('My Page Title')
    ->description('Page description')
    ->keywords(['php', 'laravel', 'accelade'])
    ->canonical('https://example.com/page')
    ->robots('index, follow')
    ->author('John Doe');

// OpenGraph
SEO::openGraphType('article')
    ->openGraphSiteName('My Website')
    ->openGraphTitle('OG Title')
    ->openGraphDescription('OG Description')
    ->openGraphUrl('https://example.com')
    ->openGraphImage('https://example.com/og.jpg', 'Alt text')
    ->openGraphLocale('en_US');

// Twitter Cards
SEO::twitterCard('summary_large_image')
    ->twitterSite('@mysite')
    ->twitterCreator('@johndoe')
    ->twitterTitle('Twitter Title')
    ->twitterDescription('Twitter Description')
    ->twitterImage('https://example.com/twitter.jpg', 'Alt text');

// Custom meta tags
SEO::metaByName('theme-color', '#6366f1');
SEO::metaByProperty('article:section', 'Technology');
SEO::meta(['http-equiv' => 'refresh', 'content' => '30']);

// Get values
$title = SEO::getTitle();
$description = SEO::getDescription();
$keywords = SEO::getKeywords();
$canonical = SEO::getCanonical();
$robots = SEO::getRobots();
$author = SEO::getAuthor();
$openGraph = SEO::getOpenGraph();
$twitter = SEO::getTwitter();
$meta = SEO::getMeta();

// Convert to array or HTML
$array = SEO::toArray();
$html = SEO::toHtml();
$html = SEO::render(); // Alias for toHtml()

// Reset all values
SEO::reset();
```

## Usage in Controllers

Set SEO data from your controller:

```php
use Accelade\Facades\SEO;

class PostController extends Controller
{
    public function show(Post $post)
    {
        SEO::title($post->title)
            ->description($post->excerpt)
            ->canonical(route('posts.show', $post))
            ->openGraphType('article')
            ->openGraphImage($post->featured_image);

        return view('posts.show', compact('post'));
    }
}
```

## Configuration

Configure default SEO values in `config/accelade.php`:

```php
'seo' => [
    // Default values when none are set
    'defaults' => [
        'title' => null,
        'description' => null,
        'keywords' => [],
    ],

    // Title formatting
    'title_separator' => ' | ',
    'title_prefix' => null,
    'title_suffix' => 'My Website', // Appended to all titles

    // Auto-generate canonical from current URL
    'auto_canonical_link' => true,

    // OpenGraph defaults
    'open_graph' => [
        'auto_fill' => true, // Auto-fill from main SEO values
        'defaults' => [
            'type' => 'website',
            'site_name' => null,
            'locale' => null,
        ],
    ],

    // Twitter Card defaults
    'twitter' => [
        'auto_fill' => true, // Auto-fill from main SEO values
        'defaults' => [
            'card' => 'summary_large_image',
            'site' => null,
            'creator' => null,
        ],
    ],
],
```

### Title Formatting

When `title_suffix` is set, titles are automatically formatted:

```php
// Config: 'title_suffix' => 'My Website', 'title_separator' => ' | '
SEO::title('About Us');
// Output: <title>About Us | My Website</title>
```

### Auto-Fill

When `auto_fill` is enabled for OpenGraph/Twitter:

- `og:title` and `twitter:title` inherit from main title
- `og:description` and `twitter:description` inherit from main description
- `og:url` inherits from canonical URL

## Output

Place `@seo` in your layout's `<head>` section:

```blade
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    @seo
    @acceladeStyles
    @acceladeScripts
</head>
<body>
    {{ $slot }}
</body>
</html>
```

### Generated Output Example

```html
<title>My Page Title | My Website</title>
<meta name="description" content="Page description">
<meta name="keywords" content="php, laravel, accelade">
<meta name="robots" content="index, follow">
<meta name="author" content="John Doe">
<link rel="canonical" href="https://example.com/page">
<meta property="og:type" content="article">
<meta property="og:site:name" content="My Website">
<meta property="og:title" content="My Page Title | My Website">
<meta property="og:description" content="Page description">
<meta property="og:url" content="https://example.com/page">
<meta property="og:image" content="https://example.com/og.jpg">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@mysite">
<meta name="twitter:title" content="My Page Title | My Website">
<meta name="twitter:description" content="Page description">
<meta name="twitter:image" content="https://example.com/twitter.jpg">
```

## Extending with Macros

The SEO class uses Laravel's `Macroable` trait:

```php
use Accelade\SEO\SEO;

SEO::macro('article', function (Post $post) {
    return $this
        ->title($post->title)
        ->description($post->excerpt)
        ->openGraphType('article')
        ->openGraphImage($post->featured_image)
        ->metaByProperty('article:published_time', $post->published_at->toIso8601String())
        ->metaByProperty('article:author', $post->author->name);
});

// Usage
SEO::article($post);
```

## Best Practices

1. **Set SEO in Controllers** - Keep SEO logic in controllers, not views
2. **Use Configuration** - Set site-wide defaults in config
3. **Escape Output** - All values are automatically HTML-escaped
4. **Unique Titles** - Each page should have a unique title
5. **Description Length** - Keep descriptions under 160 characters
6. **OpenGraph Images** - Use 1200x630px images for best sharing

## Next Steps

- [Configuration](configuration.md) - Full configuration reference
- [API Reference](api-reference.md) - Complete API documentation
- [SPA Navigation](spa-navigation.md) - SEO with client-side navigation
</file>

<file path="docs/shared-data.md">
# Shared Data

Share data from your Laravel backend to the JavaScript frontend, making it globally accessible across your entire application.

## Overview

Shared data allows you to pass information from PHP to JavaScript without explicitly passing props to every component. This is useful for:

- User authentication state
- Application settings
- Flash messages
- Global configuration
- Any cross-cutting data needed throughout your app

## Text Interpolation

Use `@{{ expression }}` in Blade templates to display JavaScript variables directly in your HTML. The `@` escapes Blade's own syntax, outputting `{{ expression }}` which Accelade evaluates.

```blade
@accelade(['count' => 0, 'name' => 'World'])
    <p>Hello, @{{ name }}!</p>
    <p>Count: @{{ count }}</p>

    {{-- Access shared data --}}
    <p>User: @{{ shared.user.name }}</p>
    <p>Theme: @{{ shared.settings.theme }}</p>

    <button @click="$set('count', count + 1)">Increment</button>
@endaccelade
```

### Available Context

Inside `{{ }}` expressions, you have access to:

- **Component state** - All state variables defined in `@accelade(['key' => value])`
- **`shared`** - All shared data from `Accelade::share()`
- **`$shared`** - Alias for shared data

```blade
@{{ count }}              {{-- Component state --}}
@{{ shared.user.name }}   {{-- Shared data --}}
@{{ $shared.settings }}   {{-- Shared data alias --}}
```

## Basic Usage

### Sharing Data from PHP

Use the `Accelade` facade to share data from anywhere in your application:

```php
use Accelade\Facades\Accelade;

// Share a single value
Accelade::share('appName', config('app.name'));

// Share multiple values at once
Accelade::share([
    'user' => auth()->user()?->only('id', 'name', 'email'),
    'settings' => [
        'theme' => 'dark',
        'language' => 'en',
    ],
]);

// Lazy-loaded data (closure is evaluated only when needed)
Accelade::share('stats', fn () => [
    'users' => User::count(),
    'orders' => Order::count(),
]);
```

### Accessing Data in JavaScript

Access shared data via `window.Accelade.shared`:

```javascript
// Get a value
const appName = window.Accelade.shared.get('appName');

// Get nested values with dot notation
const userName = window.Accelade.shared.get('user.name');
const theme = window.Accelade.shared.get('settings.theme');

// Get with default value
const locale = window.Accelade.shared.get('locale', 'en');

// Check if key exists
if (window.Accelade.shared.has('user')) {
    // User is authenticated
}

// Get all shared data
const allData = window.Accelade.shared.all();
```

## Sharing in Middleware

For data that should be available on every request, create a middleware:

```php
<?php

namespace App\Http\Middleware;

use Accelade\Facades\Accelade;
use Closure;
use Illuminate\Http\Request;

class ShareAcceladeData
{
    public function handle(Request $request, Closure $next)
    {
        Accelade::share([
            'auth' => [
                'user' => $request->user()?->only('id', 'name', 'email', 'avatar'),
                'guest' => !$request->user(),
            ],
            'flash' => [
                'success' => session('success'),
                'error' => session('error'),
                'warning' => session('warning'),
            ],
            'app' => [
                'name' => config('app.name'),
                'environment' => app()->environment(),
            ],
        ]);

        return $next($request);
    }
}
```

Register the middleware in `bootstrap/app.php`:

```php
->withMiddleware(function (Middleware $middleware) {
    $middleware->web(append: [
        \App\Http\Middleware\ShareAcceladeData::class,
    ]);
})
```

## Sharing in Controllers

Share data specific to certain routes:

```php
class DashboardController extends Controller
{
    public function index()
    {
        Accelade::share('dashboard', [
            'widgets' => $this->getWidgets(),
            'notifications' => auth()->user()->unreadNotifications->take(5),
        ]);

        return view('dashboard');
    }
}
```

## Sharing in Service Providers

For truly global data, share in your `AppServiceProvider`:

```php
class AppServiceProvider extends ServiceProvider
{
    public function boot(): void
    {
        Accelade::share('version', config('app.version', '1.0.0'));
        Accelade::share('features', config('features', []));
    }
}
```

## Client-Side Modifications

You can modify shared data on the client side (useful for optimistic updates):

```javascript
// Set a value
window.Accelade.shared.set('theme', 'light');

// Set a nested value
window.Accelade.shared.set('settings.sidebar', 'collapsed');

// Merge multiple values
window.Accelade.shared.merge({
    theme: 'light',
    fontSize: 'large',
});
```

> **Note:** Client-side modifications are not persisted to the server. They only affect the current page session.

## Reactive Subscriptions

Subscribe to changes in shared data:

```javascript
// Subscribe to a specific key
const unsubscribe = window.Accelade.shared.subscribe('theme', (key, newValue, oldValue) => {
    console.log(`Theme changed from ${oldValue} to ${newValue}`);
    document.body.classList.toggle('dark-mode', newValue === 'dark');
});

// Later, unsubscribe when no longer needed
unsubscribe();

// Subscribe to all changes
window.Accelade.shared.subscribeAll((key, newValue, oldValue) => {
    console.log(`Shared data changed: ${key}`);
});
```

## Using in Blade Components

Access shared data in your Blade templates via JavaScript:

```blade
@accelade(['localState' => 'value'])
    <div class="user-greeting">
        Welcome, <span id="user-name">Loading...</span>!
    </div>

    <script>
        document.getElementById('user-name').textContent =
            window.Accelade.shared.get('user.name', 'Guest');
    </script>
@endaccelade
```

## API Reference

### PHP API

#### `Accelade::share(string|array $key, mixed $value = null): self`

Share data globally. Accepts either a key-value pair or an array of key-value pairs.

```php
Accelade::share('key', 'value');
Accelade::share(['key1' => 'value1', 'key2' => 'value2']);
```

#### `Accelade::getShared(string $key, mixed $default = null): mixed`

Get a shared value by key.

```php
$value = Accelade::getShared('key', 'default');
```

#### `Accelade::allShared(): array`

Get all shared data as an array.

```php
$all = Accelade::allShared();
```

#### `Accelade::shared(): SharedData`

Get the underlying SharedData instance for advanced operations.

```php
$shared = Accelade::shared();
$shared->has('key');
$shared->forget('key');
$shared->flush();
```

### JavaScript API

#### `window.Accelade.shared.get<T>(key: string, defaultValue?: T): T`

Get a shared value. Supports dot notation for nested values.

```javascript
const name = Accelade.shared.get('user.name');
const theme = Accelade.shared.get('settings.theme', 'light');
```

#### `window.Accelade.shared.has(key: string): boolean`

Check if a shared key exists.

```javascript
if (Accelade.shared.has('user')) {
    // authenticated
}
```

#### `window.Accelade.shared.all(): object`

Get all shared data.

```javascript
const data = Accelade.shared.all();
```

#### `window.Accelade.shared.set(key: string, value: unknown): void`

Set a shared value (client-side only).

```javascript
Accelade.shared.set('theme', 'dark');
```

#### `window.Accelade.shared.merge(data: object): void`

Merge data into shared data.

```javascript
Accelade.shared.merge({ key1: 'value1', key2: 'value2' });
```

#### `window.Accelade.shared.subscribe(key, callback): () => void`

Subscribe to changes for a specific key. Returns an unsubscribe function.

```javascript
const unsubscribe = Accelade.shared.subscribe('theme', (key, newVal, oldVal) => {
    console.log(`${key}: ${oldVal} -> ${newVal}`);
});
```

#### `window.Accelade.shared.subscribeAll(callback): () => void`

Subscribe to all shared data changes.

```javascript
const unsubscribe = Accelade.shared.subscribeAll((key, newVal, oldVal) => {
    console.log(`Changed: ${key}`);
});
```

## Best Practices

1. **Keep shared data minimal** - Only share data that's truly needed globally
2. **Use lazy loading for expensive data** - Pass closures to defer computation
3. **Organize with namespaces** - Group related data under keys like `auth`, `settings`, `flash`
4. **Don't share sensitive data** - Never share passwords, tokens, or other secrets
5. **Use TypeScript declarations** - Define types for better IDE support

## Demo

Visit `/demo/shared-data` (when demo mode is enabled) to see shared data in action.

## See Also

- [Getting Started](getting-started.md)
- [Components](components.md)
- [API Reference](api-reference.md)
</file>

<file path="docs/spa-navigation.md">
# SPA Navigation

Accelade includes a built-in router for single-page application (SPA) style navigation without full page reloads.

## Overview

When you click an `<x-accelade::link>` component, Accelade:

1. Intercepts the click event
2. Shows a progress bar
3. Fetches the new page via AJAX
4. Updates the DOM without a full reload
5. Updates the browser history
6. Initializes new components

## Link Component

### Basic Usage

```blade
<x-accelade::link href="/dashboard">
    Dashboard
</x-accelade::link>
```

Renders as:

```html
<a href="/dashboard" data-accelade-link>Dashboard</a>
```

### With Attributes

```blade
<x-accelade::link
    href="/settings"
    class="nav-link active"
    id="settings-link"
>
    Settings
</x-accelade::link>
```

### Preserve Scroll Position

Maintain scroll position after navigation:

```blade
<x-accelade::link href="/products" :preserveScroll="true">
    Products
</x-accelade::link>
```

### Preserve Component State

Keep component state across navigation:

```blade
<x-accelade::link href="/page-2" :preserveState="true">
    Next Page
</x-accelade::link>
```

### External Links

Links to other domains are not intercepted:

```blade
{{-- Opens normally (not SPA) --}}
<x-accelade::link href="https://external-site.com">
    External
</x-accelade::link>
```

## Programmatic Navigation

Navigate using JavaScript:

```javascript
// Basic navigation
window.Accelade.navigate('/dashboard');

// With options
window.Accelade.navigate('/settings', {
    preserveScroll: true,
    preserveState: true
});

// Replace history (no back button)
window.Accelade.router.replace('/login');
```

## Progress Bar

The progress bar shows during navigation.

### Configuration

```php
// config/accelade.php
'progress' => [
    'delay' => 250,              // Delay before showing (ms)
    'color' => '#6366f1',        // Primary color
    'gradientColor' => '#8b5cf6', // Gradient start
    'gradientColor2' => '#a855f7', // Gradient end
    'useGradient' => true,       // Use gradient
    'height' => 3,               // Height in pixels
    'showBar' => true,           // Show the bar
    'includeSpinner' => true,    // Show spinner
    'spinnerSize' => 18,         // Spinner size (px)
    'spinnerPosition' => 'top-right',
    'position' => 'top',         // top or bottom
    'minimum' => 8,              // Starting percentage
    'easing' => 'ease-out',
    'speed' => 200,              // Animation speed (ms)
    'trickleSpeed' => 200,       // Trickle speed (ms)
    'zIndex' => 99999,
],
```

### Manual Control

```javascript
// Start progress
window.Accelade.progress.start();

// Complete progress
window.Accelade.progress.done();

// Force complete (immediate)
window.Accelade.progress.done(true);

// Set specific percentage
window.Accelade.progress.set(50);

// Increment
window.Accelade.progress.inc();
```

### Customizing via CSS

```css
/* Progress bar */
#accelade-progress-bar {
    background: linear-gradient(to right, #ff0000, #ff6600) !important;
}

/* Spinner */
#accelade-spinner {
    border-top-color: #ff0000 !important;
}
```

## Navigation Events

Listen to navigation events:

```javascript
// Before navigation starts
document.addEventListener('accelade:navigate-start', (event) => {
    console.log('Navigating to:', event.detail.url);
});

// After navigation completes
document.addEventListener('accelade:navigate-end', (event) => {
    console.log('Navigated to:', event.detail.url);
});

// Navigation error
document.addEventListener('accelade:navigate-error', (event) => {
    console.error('Navigation failed:', event.detail.error);
});
```

## Handling Non-SPA Links

### Exclude Specific Links

Add `data-no-spa` to skip SPA handling:

```html
<a href="/download" data-no-spa>Download PDF</a>
```

### Links with Target

Links with `target="_blank"` are not intercepted:

```blade
<x-accelade::link href="/document" target="_blank">
    Open in New Tab
</x-accelade::link>
```

### Form Submissions

Form submissions trigger full page loads by default:

```html
<form action="/submit" method="POST">
    {{-- Normal form submission --}}
</form>
```

For AJAX form handling, use JavaScript:

```javascript
form.addEventListener('submit', async (e) => {
    e.preventDefault();
    // Handle with fetch/axios
});
```

## History Management

### Back/Forward Navigation

Accelade handles browser back/forward buttons automatically.

### Replace vs Push

```javascript
// Push (adds to history)
window.Accelade.navigate('/new-page');

// Replace (replaces current entry)
window.Accelade.router.replace('/new-page');
```

### Current URL

```javascript
const currentUrl = window.Accelade.router.currentUrl;
```

## Prefetching

Prefetch pages on hover for faster navigation:

```blade
<x-accelade::link href="/heavy-page" prefetch>
    Heavy Page
</x-accelade::link>
```

Or manually:

```javascript
window.Accelade.router.prefetch('/heavy-page');
```

## Loading States

Show loading indicators during navigation:

```blade
@accelade(['loading' => false])
    <div a-show="loading" class="loading-overlay">
        Loading...
    </div>

    <div a-show="!loading">
        {{-- Page content --}}
    </div>

    <accelade:script>
        return {
            init() {
                document.addEventListener('accelade:navigate-start', () => {
                    $set('loading', true);
                });
                document.addEventListener('accelade:navigate-end', () => {
                    $set('loading', false);
                });
            }
        };
    </accelade:script>
@endaccelade
```

## Framework Switching

When navigating between pages with different frameworks, a full page reload occurs automatically to load the correct adapter.

```blade
{{-- On /demo/vue (Vue adapter) --}}
<x-accelade::link href="/demo/react">
    Go to React
</x-accelade::link>
{{-- Full reload happens because framework changes --}}
```

## Performance Tips

1. **Use preserveState** for wizard-like flows
2. **Prefetch common pages** on hover
3. **Keep page sizes small** for faster transitions
4. **Use skeleton loaders** for perceived performance
5. **Cache repeated requests** on the server

## Troubleshooting

### Navigation Not Working

1. Ensure `@acceladeScripts` is included
2. Check for JavaScript errors in console
3. Verify links use `<x-accelade::link>` component

### Progress Bar Not Showing

1. Check progress config: `showBar => true`
2. Verify CSS isn't hiding `#accelade-progress-bar`
3. Check `delay` setting (default 250ms)

### State Lost on Navigation

Use `preserveState`:

```blade
<x-accelade::link href="/page" :preserveState="true">
```

Or store state on server with `a-sync`.

## Next Steps

- [Components](components.md) - Reactive components
- [Notifications](notifications.md) - Toast notifications
- [Configuration](configuration.md) - All options
</file>

<file path="docs/sponsor.md">
# Sponsor Accelade

Support the continued development of Accelade by becoming a sponsor. Your sponsorship helps keep the project active, well-maintained, and free for everyone.

---

## Why Sponsor?

Accelade is free and open source, built with passion and countless hours of development. Your sponsorship directly supports:

- **Active Development** - New features, improvements, and bug fixes
- **Documentation** - Comprehensive guides, examples, and tutorials
- **Community Support** - Issue responses, discussions, and assistance
- **Infrastructure** - Server costs, CI/CD, and tooling
- **Long-term Maintenance** - Security updates and Laravel compatibility

---

## Sponsor on GitHub

The easiest way to support Accelade is through GitHub Sponsors:

### [@fadymondy](https://github.com/sponsors/fadymondy)

Fady is the creator and primary maintainer of Accelade. Sponsor his work to help ensure Accelade's continued growth and maintenance.

[![Sponsor fadymondy on GitHub](https://img.shields.io/badge/Sponsor-fadymondy-ea4aaa?style=for-the-badge&logo=github-sponsors)](https://github.com/sponsors/fadymondy)

---

## Sponsorship Tiers

### Supporter - $5/month
- Your name in our sponsors list
- Priority issue responses
- Warm fuzzy feeling of supporting open source

### Backer - $15/month
- Everything in Supporter tier
- Your name with link on Thanks page
- Early access to new features

### Bronze Sponsor - $50/month
- Everything in Backer tier
- Your logo (small) on documentation
- Shoutout on release notes

### Silver Sponsor - $100/month
- Everything in Bronze tier
- Your logo (medium) on homepage
- Priority feature requests

### Gold Sponsor - $250/month
- Everything in Silver tier
- Your logo (large) on homepage
- Direct communication channel
- Technical consultation

### Platinum Sponsor - $500/month
- Everything in Gold tier
- Your logo at top of documentation
- Featured case study
- Dedicated support hours

---

## One-Time Donations

If you prefer a one-time donation, you can:

- [Buy me a coffee](https://buymeacoffee.com/fadymondy)
- [PayPal](https://paypal.me/fadymondy)

---

## Corporate Sponsorship

For corporate sponsorships, custom packages, or enterprise support agreements, please contact us directly at:

**sponsorship@acceladephp.com**

We offer:
- Custom sponsorship packages
- Priority support agreements
- Training and consultation
- Custom feature development

---

## Current Sponsors

We're grateful to all our sponsors who help make Accelade possible.

### Platinum Sponsors
*Be the first platinum sponsor!*

### Gold Sponsors
*Become a gold sponsor and see your logo here.*

### Silver Sponsors
*Support us and join our silver sponsors.*

### Bronze Sponsors
*Your support makes a difference!*

### Backers & Supporters
*Thank you to all our individual backers!*

---

## Other Ways to Support

Not able to sponsor financially? You can still help:

- **Star the repo** - Help others discover Accelade
- **Share on social media** - Spread the word
- **Write about us** - Blog posts, tutorials, videos
- **Contribute code** - Bug fixes and features
- **Improve docs** - Help make Accelade easier to learn
- **Answer questions** - Help others in issues and discussions
- **Report bugs** - Help us improve quality

---

## Transparency

We believe in transparency. Sponsorship funds are used for:

- 70% - Development and maintenance
- 15% - Infrastructure and tooling
- 10% - Community and documentation
- 5% - Marketing and outreach

---

## Thank You

Whether you sponsor, contribute, or simply use Accelade in your projects, we're grateful for your support. Together, we're building something amazing for the Laravel community.

[![Sponsor on GitHub](https://img.shields.io/badge/Sponsor%20on-GitHub-181717?style=for-the-badge&logo=github)](https://github.com/sponsors/fadymondy)
</file>

<file path="docs/state.md">
# State Component

The Accelade State component provides unified access to validation errors, flash messages, and shared data within a reactive scope. It wraps your content and exposes helper methods for accessing these common data sources.

## Basic Usage

### Validation Errors

Display validation errors from Laravel's error bag:

```blade
<x-accelade::state>
    {{-- Show general error message if any errors exist --}}
    <div a-show="state.hasErrors" class="alert alert-danger">
        Please fix the errors below.
    </div>

    {{-- Email field with error --}}
    <div>
        <label>Email</label>
        <input type="email" name="email">
        <span a-show="hasError('email')" class="text-red-500" a-text="getError('email')"></span>
    </div>

    {{-- Password field with error --}}
    <div>
        <label>Password</label>
        <input type="password" name="password">
        <span a-show="hasError('password')" class="text-red-500" a-text="getError('password')"></span>
    </div>
</x-accelade::state>
```

### Flash Messages

Display session flash data:

```blade
<x-accelade::state>
    {{-- Success message --}}
    <div a-show="hasFlash('success')" class="alert alert-success">
        <span a-text="getFlash('success')"></span>
    </div>

    {{-- Info message --}}
    <div a-show="hasFlash('info')" class="alert alert-info">
        <span a-text="getFlash('info')"></span>
    </div>

    {{-- Warning message --}}
    <div a-show="hasFlash('warning')" class="alert alert-warning">
        <span a-text="getFlash('warning')"></span>
    </div>
</x-accelade::state>
```

### Shared Data

Access globally shared data:

```blade
<x-accelade::state>
    {{-- Display user info --}}
    <div a-show="hasShared('user')">
        Welcome, <span a-text="getShared('user.name')"></span>!
        Your role: <span a-text="getShared('user.role')"></span>
    </div>

    {{-- Access app settings --}}
    <p>Current theme: <span a-text="getShared('settings.theme')"></span></p>
</x-accelade::state>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `errors` | array | error bag | Custom validation errors (uses Laravel error bag by default) |
| `flash` | array | session flash | Custom flash data (uses session flash by default) |
| `shared` | array | Accelade shared | Custom shared data (uses Accelade shared data by default) |

## State Object

The `state` object is available within the component scope and contains:

| Property | Type | Description |
|----------|------|-------------|
| `state.errors` | object | First error message for each field |
| `state.rawErrors` | object | All error messages per field (arrays) |
| `state.hasErrors` | boolean | Whether any errors exist |
| `state.flash` | object | All flash data |
| `state.shared` | object | All shared data |

## Helper Methods

### Error Methods

| Method | Return Type | Description |
|--------|-------------|-------------|
| `hasError(key)` | boolean | Check if a field has an error |
| `getError(key)` | string\|null | Get the first error message for a field |
| `getErrors(key)` | string[] | Get all error messages for a field |

### Flash Methods

| Method | Return Type | Description |
|--------|-------------|-------------|
| `hasFlash(key)` | boolean | Check if flash data exists for key |
| `getFlash(key)` | any\|null | Get flash value |

### Shared Methods

| Method | Return Type | Description |
|--------|-------------|-------------|
| `hasShared(key)` | boolean | Check if shared data exists (supports dot notation) |
| `getShared(key)` | any\|null | Get shared value (supports dot notation) |

## Custom Data

Override the default data sources with custom arrays:

```blade
<x-accelade::state
    :errors="['email' => ['Invalid email format']]"
    :flash="['success' => 'Changes saved!']"
    :shared="['customKey' => 'customValue']"
>
    <div a-show="hasError('email')" a-text="getError('email')"></div>
    <div a-show="hasFlash('success')" a-text="getFlash('success')"></div>
    <p a-text="getShared('customKey')"></p>
</x-accelade::state>
```

## Direct State Access

You can also access the state object directly:

```blade
<x-accelade::state>
    {{-- Access errors directly --}}
    <span a-text="state.errors.email"></span>

    {{-- Access flash directly --}}
    <span a-text="state.flash.message"></span>

    {{-- Access nested shared data --}}
    <span a-text="state.shared.user?.name"></span>

    {{-- Conditional with hasErrors --}}
    <div a-show="state.hasErrors" class="error-summary">
        You have errors in your form.
    </div>
</x-accelade::state>
```

## Dot Notation for Shared Data

The `hasShared()` and `getShared()` methods support dot notation for nested data:

```php
// In your controller or service provider
Accelade::share('user', [
    'profile' => [
        'name' => 'John Doe',
        'settings' => [
            'theme' => 'dark',
            'notifications' => true
        ]
    ]
]);
```

```blade
<x-accelade::state>
    {{-- Access deeply nested values --}}
    <span a-text="getShared('user.profile.name')"></span>
    <span a-text="getShared('user.profile.settings.theme')"></span>

    {{-- Check if nested path exists --}}
    <div a-show="hasShared('user.profile.settings')">
        Settings configured!
    </div>
</x-accelade::state>
```

## Form Validation Example

A complete form with validation error display:

```blade
<x-accelade::state>
    {{-- Global error message --}}
    <div a-show="state.hasErrors" class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
        <p class="font-bold">Validation Error</p>
        <p>Please correct the errors below.</p>
    </div>

    <form method="POST" action="/register">
        @csrf

        {{-- Name field --}}
        <div class="mb-4">
            <label class="block font-medium">Name</label>
            <input type="text" name="name" class="border rounded p-2 w-full"
                :class="{ 'border-red-500': hasError('name') }">
            <p a-show="hasError('name')" class="text-red-500 text-sm mt-1" a-text="getError('name')"></p>
        </div>

        {{-- Email field --}}
        <div class="mb-4">
            <label class="block font-medium">Email</label>
            <input type="email" name="email" class="border rounded p-2 w-full"
                :class="{ 'border-red-500': hasError('email') }">
            <p a-show="hasError('email')" class="text-red-500 text-sm mt-1" a-text="getError('email')"></p>
        </div>

        {{-- Password field with multiple errors --}}
        <div class="mb-4">
            <label class="block font-medium">Password</label>
            <input type="password" name="password" class="border rounded p-2 w-full"
                :class="{ 'border-red-500': hasError('password') }">
            <p a-show="hasError('password')" class="text-red-500 text-sm mt-1" a-text="getError('password')"></p>
        </div>

        <button type="submit" class="bg-blue-500 text-white py-2 px-4 rounded">
            Register
        </button>
    </form>
</x-accelade::state>
```

## Flash Messages Example

Display various types of flash messages:

```blade
<x-accelade::state>
    {{-- Success notification --}}
    <div a-show="hasFlash('success')" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
        <span class="font-bold">Success!</span>
        <span a-text="getFlash('success')"></span>
    </div>

    {{-- Error notification --}}
    <div a-show="hasFlash('error')" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
        <span class="font-bold">Error!</span>
        <span a-text="getFlash('error')"></span>
    </div>

    {{-- Info notification --}}
    <div a-show="hasFlash('info')" class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4">
        <span class="font-bold">Info:</span>
        <span a-text="getFlash('info')"></span>
    </div>

    {{-- Warning notification --}}
    <div a-show="hasFlash('warning')" class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4">
        <span class="font-bold">Warning:</span>
        <span a-text="getFlash('warning')"></span>
    </div>
</x-accelade::state>
```

## User Profile Example

Display user information from shared data:

```blade
<x-accelade::state>
    <div a-show="hasShared('user')" class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center gap-4">
            {{-- Avatar --}}
            <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center">
                <span class="text-2xl" a-text="getShared('user.name')?.charAt(0)"></span>
            </div>

            {{-- User info --}}
            <div>
                <h2 class="text-xl font-bold" a-text="getShared('user.name')"></h2>
                <p class="text-gray-600" a-text="getShared('user.email')"></p>
                <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded"
                    a-text="getShared('user.role')"></span>
            </div>
        </div>
    </div>

    <div a-show="!hasShared('user')" class="text-gray-500">
        Please log in to view your profile.
    </div>
</x-accelade::state>
```

## Sharing Data in Laravel

Use the Accelade facade to share data globally:

```php
// In a service provider or middleware
use Accelade\Facades\Accelade;

Accelade::share('user', [
    'id' => auth()->id(),
    'name' => auth()->user()->name,
    'email' => auth()->user()->email,
    'role' => auth()->user()->role,
]);

Accelade::share('settings', [
    'theme' => 'dark',
    'language' => 'en',
]);

// Or share multiple at once
Accelade::share([
    'appName' => config('app.name'),
    'currentYear' => date('Y'),
]);
```

## Framework Attributes

The State component works with all framework attribute prefixes:

| Framework | Attribute Prefix | Example |
|-----------|-----------------|---------|
| Vanilla | `a-` | `a-show="hasError('email')"` |
| Vue | `v-` | `v-show="hasError('email')"` |
| React | `data-state-` | `data-state-show="hasError('email')"` |
| Svelte | `s-` | `s-show="hasError('email')"` |
| Angular | `ng-` | `ng-show="hasError('email')"` |

## Next Steps

- [Components](components.md) - Reactive components
- [Errors Component](errors.md) - Dedicated error display
- [Flash Component](flash.md) - Flash message helpers
- [Shared Data](shared-data.md) - Global data sharing
</file>

<file path="docs/teleport.md">
# Teleport Component

The Accelade Teleport component enables relocating template sections to different DOM nodes. Content is "teleported" to a target element specified by a CSS selector while maintaining access to parent component data and reactive properties.

## Basic Usage

Teleport content to a target element:

```blade
{{-- Define teleport source --}}
<x-accelade::teleport to="#footer">
    <p>This content appears in the footer</p>
</x-accelade::teleport>

{{-- Target element (anywhere in the document) --}}
<div id="footer"></div>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `to` | string | null | CSS selector for the target element (required) |
| `disabled` | bool | false | Keep content in original location when true |

## Reactive Data Access

Teleported content maintains access to parent component's reactive state:

```blade
<div data-accelade data-accelade-state='{"search": "", "count": 0}'>
    <input a-model="search" placeholder="Search...">
    <button @click="$set('count', count + 1)">Increment</button>

    {{-- This content teleports but stays reactive --}}
    <x-accelade::teleport to="#preview">
        <div class="preview">
            <p>Search: <span a-text="search"></span></p>
            <p>Count: <span a-text="count"></span></p>
        </div>
    </x-accelade::teleport>
</div>

<div id="preview"></div>
```

Changes to `search` and `count` will update the teleported content in real-time.

## Multiple Teleports to Same Target

Multiple teleport components can send content to the same target:

```blade
{{-- First component --}}
<x-accelade::teleport to="#notifications" id="teleport-1">
    <div class="alert alert-info">First notification</div>
</x-accelade::teleport>

{{-- Second component --}}
<x-accelade::teleport to="#notifications" id="teleport-2">
    <div class="alert alert-success">Second notification</div>
</x-accelade::teleport>

{{-- Target receives both --}}
<div id="notifications"></div>
```

## Disabled Teleport

Keep content in its original location:

```blade
{{-- Content stays in place --}}
<x-accelade::teleport to="#target" :disabled="true">
    <p>This content won't be teleported</p>
</x-accelade::teleport>

{{-- Conditionally disable --}}
<x-accelade::teleport to="#target" :disabled="$isMobile">
    <p>Teleports on desktop, stays in place on mobile</p>
</x-accelade::teleport>
```

## CSS Selector Support

The `to` prop accepts any valid CSS selector:

```blade
{{-- ID selector --}}
<x-accelade::teleport to="#footer">...</x-accelade::teleport>

{{-- Class selector --}}
<x-accelade::teleport to=".modal-body">...</x-accelade::teleport>

{{-- Attribute selector --}}
<x-accelade::teleport to="[data-notifications]">...</x-accelade::teleport>

{{-- Complex selector --}}
<x-accelade::teleport to="#app > .container .notifications">...</x-accelade::teleport>
```

## JavaScript API

### Getting Instances

```javascript
// Get a teleport instance by ID
const instance = Accelade.teleport.get('my-teleport');

// Get all teleport instances
const allInstances = Accelade.teleport.getAll();
```

### Controlling Teleport

```javascript
// Teleport content (if not already teleported)
Accelade.teleport.teleport('my-teleport');

// Return content to original position
Accelade.teleport.return('my-teleport');

// Update target and re-teleport
Accelade.teleport.updateTarget('my-teleport', '#new-target');
```

### Instance Properties

```javascript
const instance = Accelade.teleport.get('my-teleport');

instance.id;              // Teleport ID
instance.config;          // Configuration object
instance.sourceElement;   // Original container element
instance.targetElement;   // Current target element
instance.contentElement;  // The teleported content wrapper
instance.isTeleported;    // Whether content is currently teleported

// Methods
instance.teleport();      // Move content to target
instance.return();        // Return content to source
instance.updateTarget('#selector'); // Change target
instance.dispose();       // Clean up
```

## Events

Listen to teleport events:

```javascript
// Global event
document.addEventListener('accelade:teleport', (e) => {
    console.log('Teleport:', e.detail.id, e.detail.to, e.detail.success);
});

// Element-specific event
element.addEventListener('teleport', (e) => {
    if (e.detail.success) {
        console.log('Content teleported to', e.detail.to);
    } else {
        console.error('Teleport failed:', e.detail.error);
    }
});
```

## Use Cases

### Global Notifications

Teleport form feedback to a global notification area:

```blade
<form data-accelade data-accelade-state='{"message": "", "status": ""}'>
    @csrf
    <input name="email" type="email">
    <button type="submit">Subscribe</button>

    <x-accelade::teleport to="#global-notifications">
        <div a-show="status === 'success'" class="alert alert-success">
            <span a-text="message"></span>
        </div>
        <div a-show="status === 'error'" class="alert alert-danger">
            <span a-text="message"></span>
        </div>
    </x-accelade::teleport>
</form>

{{-- In your layout --}}
<div id="global-notifications" class="fixed top-4 right-4 z-50"></div>
```

### Modal Content

Teleport modal content to avoid z-index issues:

```blade
<div data-accelade data-accelade-state='{"isOpen": false, "title": "Settings"}'>
    <button @click="$set('isOpen', true)">Open Settings</button>

    <x-accelade::teleport to="#modal-container">
        <div a-show="isOpen" class="modal-backdrop">
            <div class="modal">
                <h2 a-text="title"></h2>
                <p>Modal content here...</p>
                <button @click="$set('isOpen', false)">Close</button>
            </div>
        </div>
    </x-accelade::teleport>
</div>

{{-- At end of body --}}
<div id="modal-container"></div>
```

### Search Preview

Show search results in a different location:

```blade
<div data-accelade data-accelade-state='{"query": "", "results": []}'>
    <div class="search-box">
        <input a-model="query" placeholder="Search..." @input="performSearch()">
    </div>

    {{-- Results appear in sidebar --}}
    <x-accelade::teleport to="#search-sidebar">
        <div a-show="query.length > 0">
            <h4>Search Results</h4>
            <p>Searching for: <span a-text="query"></span></p>
        </div>
    </x-accelade::teleport>
</div>
```

### Footer Actions

Teleport form actions to footer:

```blade
<form data-accelade data-accelade-state='{"isDirty": false}'>
    <input @input="$set('isDirty', true)">

    <x-accelade::teleport to="#form-footer">
        <div class="form-actions">
            <button type="button" @click="resetForm()">Cancel</button>
            <button type="submit" a-class="{'opacity-50': !isDirty}" :disabled="!isDirty">
                Save Changes
            </button>
        </div>
    </x-accelade::teleport>
</form>

<footer id="form-footer" class="sticky bottom-0 p-4 bg-white border-t"></footer>
```

## Dynamic Targets

Change the teleport target at runtime:

```blade
<div data-accelade data-accelade-state='{"activePanel": "left"}'>
    <button @click="$set('activePanel', 'left')">Left Panel</button>
    <button @click="$set('activePanel', 'right')">Right Panel</button>

    <x-accelade::teleport to="#left-panel" id="dynamic-content">
        <div class="panel-content">
            <p>This content can move between panels</p>
        </div>
    </x-accelade::teleport>
</div>

<script>
// Watch for panel changes and update teleport target
document.addEventListener('DOMContentLoaded', () => {
    // Example: update target based on state
    Accelade.teleport.updateTarget('dynamic-content', '#right-panel');
});
</script>

<div id="left-panel"></div>
<div id="right-panel"></div>
```

## Best Practices

1. **Ensure target exists** - The target element must exist in the DOM when teleport initializes
2. **Use unique IDs** - Assign explicit IDs when you need JavaScript control
3. **Keep targets accessible** - Place targets where they make semantic sense
4. **Consider z-index** - Teleport helps avoid z-index stacking issues for modals/overlays
5. **Test disabled state** - Use disabled for responsive designs where teleport isn't needed

## Framework Attributes

Works with all framework attribute prefixes:

| Framework | Attributes |
|-----------|------------|
| Vanilla | `a-text`, `a-show`, `a-model` |
| Vue | `v-text`, `v-show`, `v-model` |
| React | `data-state-text`, `data-state-show` |
| Svelte | `s-text`, `s-show`, `s-model` |
| Angular | `ng-text`, `ng-show`, `ng-model` |

## Next Steps

- [Components](components.md) - Reactive components
- [Modal Component](modal.md) - Dialogs and slideovers
- [State Component](state.md) - Errors, flash & shared data
- [Notifications](notifications.md) - Toast notifications
</file>

<file path="docs/testing.md">
# Testing

This guide covers running tests and contributing to Accelade.

## Test Stack

- **PHP Tests**: [PEST](https://pestphp.com/) with Laravel plugin
- **E2E Tests**: [Playwright](https://playwright.dev/)
- **Static Analysis**: [Mago](https://mago.carthage.software/)
- **Code Formatting**: [Laravel Pint](https://laravel.com/docs/pint)

## Running Tests

### All Tests

```bash
# PHP tests only
composer test

# Full CI (format check + lint + tests)
composer ci
```

### PHP Tests

```bash
# Run all tests
composer test

# Run with coverage
composer test:coverage

# Run specific test file
./vendor/bin/pest tests/Unit/NotificationTest.php

# Run specific test
./vendor/bin/pest --filter="notification can set title"

# Run by group
./vendor/bin/pest --group=notifications
```

### E2E Tests

```bash
# Install Playwright browsers
npx playwright install chromium

# Run all E2E tests
npm run test:e2e

# Run with headed browser
npm run test:e2e -- --headed

# Run specific test file
npx playwright test tests/e2e/notifications.spec.ts

# Debug mode
npx playwright test --debug
```

### Code Quality

```bash
# Format code with Pint
composer format

# Check formatting (no changes)
composer format:test

# Run Mago static analysis
composer mago

# Auto-fix Mago issues
composer mago:fix

# Run all analysis
composer analyse
```

## Test Structure

```
tests/
├── Feature/                    # Feature/integration tests
│   ├── NotifyFacadeTest.php   # Notification facade tests
│   ├── RouteRegistrationTest.php
│   └── ServiceProviderTest.php
├── Unit/                       # Unit tests
│   ├── AcceladeTest.php       # Core class tests
│   ├── NotificationTest.php   # Notification entity tests
│   └── NotificationManagerTest.php
├── Pest.php                   # PEST configuration
└── TestCase.php               # Base test case

tests/e2e/                      # Playwright E2E tests
├── navigation.spec.ts         # SPA navigation tests
├── notifications.spec.ts      # Notification UI tests
└── components.spec.ts         # Component tests
```

## Writing PHP Tests

### Basic Test

```php
<?php

declare(strict_types=1);

it('can create a notification', function () {
    $notification = Notification::make()
        ->title('Test')
        ->body('Test body');

    expect($notification->title)->toBe('Test');
    expect($notification->body)->toBe('Test body');
});
```

### Feature Test

```php
<?php

declare(strict_types=1);

use Accelade\Facades\Notify;

it('stores notifications in session', function () {
    Notify::success('Test')->body('Body');

    $notifications = Notify::flush();

    expect($notifications)->toHaveCount(1);
    expect($notifications->first()->title)->toBe('Test');
});
```

### Grouped Tests

```php
<?php

declare(strict_types=1);

describe('Notification Status', function () {
    it('can set success status', function () {
        $notification = Notification::make()->success();
        expect($notification->status)->toBe('success');
    });

    it('can set danger status', function () {
        $notification = Notification::make()->danger();
        expect($notification->status)->toBe('danger');
    });
});
```

### Using Test Helpers

```php
<?php

use function Pest\Laravel\get;
use function Pest\Laravel\post;

it('registers core routes', function () {
    expect(Route::has('accelade.script'))->toBeTrue();
    expect(Route::has('accelade.update'))->toBeTrue();
});

it('serves javascript file', function () {
    get(route('accelade.script'))
        ->assertOk()
        ->assertHeader('Content-Type', 'application/javascript; charset=UTF-8');
});
```

## Writing E2E Tests

### Basic E2E Test

```typescript
import { test, expect } from '@playwright/test';

test.describe('Notifications', () => {
    test.beforeEach(async ({ page }) => {
        await page.goto('/demo/vanilla');
    });

    test('shows success notification', async ({ page }) => {
        await page.click('[data-testid="notify-success"]');

        const notification = page.locator('.accelade-notification');
        await expect(notification).toBeVisible();
        await expect(notification).toContainText('Success');
    });

    test('notification auto-dismisses', async ({ page }) => {
        await page.click('[data-testid="notify-info"]');

        const notification = page.locator('.accelade-notification');
        await expect(notification).toBeVisible();

        // Wait for auto-dismiss (default 5s)
        await expect(notification).toBeHidden({ timeout: 6000 });
    });
});
```

### Testing SPA Navigation

```typescript
test('navigates without full reload', async ({ page }) => {
    await page.goto('/demo/vanilla');

    // Store reference to check for reload
    await page.evaluate(() => {
        window.__navigationTest = true;
    });

    // Click SPA link
    await page.click('a[data-accelade-link]');

    // Verify no reload occurred
    const preserved = await page.evaluate(() => window.__navigationTest);
    expect(preserved).toBe(true);
});
```

### Testing Components

```typescript
test('counter increments on click', async ({ page }) => {
    await page.goto('/demo/vanilla');

    const count = page.locator('[a-text="count"]');
    await expect(count).toHaveText('0');

    await page.click('button:has-text("+1")');
    await expect(count).toHaveText('1');

    await page.click('button:has-text("+1")');
    await expect(count).toHaveText('2');
});
```

## Test Configuration

### PEST Configuration

```php
// tests/Pest.php
<?php

declare(strict_types=1);

use Accelade\Tests\TestCase;

pest()->extend(TestCase::class)->in('Unit', 'Feature');
```

### Base Test Case

```php
// tests/TestCase.php
<?php

declare(strict_types=1);

namespace Accelade\Tests;

use Accelade\AcceladeServiceProvider;
use Orchestra\Testbench\TestCase as Orchestra;

abstract class TestCase extends Orchestra
{
    protected function getPackageProviders($app): array
    {
        return [AcceladeServiceProvider::class];
    }

    protected function getPackageAliases($app): array
    {
        return [
            'Accelade' => \Accelade\Facades\Accelade::class,
            'Notify' => \Accelade\Facades\Notify::class,
        ];
    }

    protected function defineEnvironment($app): void
    {
        $app['config']->set('accelade.framework', 'vanilla');
    }
}
```

### Playwright Configuration

```typescript
// playwright.config.ts
import { defineConfig } from '@playwright/test';

export default defineConfig({
    testDir: './tests/e2e',
    timeout: 30000,
    use: {
        baseURL: process.env.ACCELADE_TEST_URL || 'http://localhost:8000',
        trace: 'on-first-retry',
    },
    projects: [
        { name: 'chromium', use: { browserName: 'chromium' } },
    ],
});
```

## CI/CD Integration

### GitHub Actions

```yaml
# .github/workflows/tests.yml
name: Tests

on: [push, pull_request]

jobs:
  php-tests:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        php: ['8.2', '8.3', '8.4']

    steps:
      - uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php }}

      - name: Install dependencies
        run: composer install

      - name: Run tests
        run: composer ci

  e2e-tests:
    runs-on: ubuntu-latest
    needs: php-tests

    steps:
      - uses: actions/checkout@v4

      - name: Setup
        run: |
          composer install
          npm ci
          npm run build

      - name: Install Playwright
        run: npx playwright install chromium --with-deps

      - name: Start server
        run: php artisan serve &

      - name: Run E2E tests
        run: npm run test:e2e
```

## Debugging Tests

### PHP Test Debugging

```php
// Dump and die
it('debugs state', function () {
    $notification = Notification::make()->success();
    dd($notification);  // Stops execution
    ray($notification); // Ray app (if installed)
});

// Output during test
it('shows output', function () {
    dump('Debug info');
    expect(true)->toBeTrue();
});
```

### E2E Test Debugging

```bash
# Run with headed browser
npx playwright test --headed

# Debug mode (step through)
npx playwright test --debug

# Generate trace
npx playwright test --trace on
```

### Playwright Inspector

```typescript
test('debug test', async ({ page }) => {
    await page.goto('/demo');
    await page.pause(); // Opens inspector
    await page.click('button');
});
```

## Contributing

1. Fork the repository
2. Create feature branch: `git checkout -b feature/my-feature`
3. Write tests for your changes
4. Run `composer ci` to verify
5. Commit: `git commit -m "Add feature"`
6. Push: `git push origin feature/my-feature`
7. Open Pull Request

### Code Standards

- Follow PSR-12 for PHP
- Use TypeScript for JavaScript
- Write tests for all new features
- Update documentation as needed

## Next Steps

- [Architecture](architecture.md) - Understanding internals
- [API Reference](api-reference.md) - Complete API
</file>

<file path="docs/thanks.md">
# Thanks & Credits

Accelade stands on the shoulders of giants. This page recognizes the projects, tools, and people that made Accelade possible.

---

## Open Source Projects

### Core Dependencies

| Project | Description | License |
|---------|-------------|---------|
| [Laravel](https://laravel.com) | The PHP framework that powers Accelade | MIT |
| [Blade](https://laravel.com/docs/blade) | Laravel's powerful templating engine | MIT |
| [Alpine.js](https://alpinejs.dev) | Inspiration for lightweight reactivity patterns | MIT |
| [Livewire](https://livewire.laravel.com) | Inspiration for server-sync concepts | MIT |
| [Inertia.js](https://inertiajs.com) | Inspiration for SPA navigation patterns | MIT |
| [NProgress](https://ricostacruz.com/nprogress) | Inspiration for progress bar implementation | MIT |

### JavaScript Libraries

| Library | Usage | License |
|---------|-------|---------|
| [TypeScript](https://www.typescriptlang.org) | Type-safe JavaScript development | Apache 2.0 |
| [Vite](https://vitejs.dev) | Frontend build tooling | MIT |
| [Prism.js](https://prismjs.com) | Syntax highlighting in documentation | MIT |
| [dom-to-image](https://github.com/tsayen/dom-to-image) | Code block image export | MIT |

### PHP Libraries

| Library | Usage | License |
|---------|-------|---------|
| [Pest](https://pestphp.com) | Testing framework | MIT |
| [Laravel Pint](https://laravel.com/docs/pint) | Code formatting | MIT |
| [PHPStan](https://phpstan.org) | Static analysis | MIT |

### CSS & Design

| Resource | Usage | License |
|----------|-------|---------|
| [Tailwind CSS](https://tailwindcss.com) | Utility-first CSS framework | MIT |
| [Inter Font](https://rsms.me/inter) | Documentation typography | OFL |
| [JetBrains Mono](https://www.jetbrains.com/lp/mono) | Code typography | OFL |
| [Heroicons](https://heroicons.com) | Icon set | MIT |

---

## API References & Documentation

The following resources were invaluable during development:

### Laravel Ecosystem

- [Laravel Documentation](https://laravel.com/docs) - Official Laravel docs
- [Laravel News](https://laravel-news.com) - Community news and tutorials
- [Laracasts](https://laracasts.com) - Video tutorials and training

### JavaScript Frameworks

These frameworks informed our multi-framework support:

- [Vue.js Documentation](https://vuejs.org/guide) - Vue.js official guide
- [React Documentation](https://react.dev) - React official documentation
- [Svelte Documentation](https://svelte.dev/docs) - Svelte official docs
- [Angular Documentation](https://angular.io/docs) - Angular official docs

### Web APIs

- [MDN Web Docs](https://developer.mozilla.org) - Web technology reference
- [Web.dev](https://web.dev) - Google's web development guidance
- [Can I Use](https://caniuse.com) - Browser compatibility tables

---

## Design Inspiration

Projects that inspired Accelade's design and architecture:

- **Alpine.js** - Lightweight, declarative approach to reactivity
- **Livewire** - Server-side state synchronization patterns
- **Inertia.js** - SPA navigation without building an API
- **htmx** - HTML-centric approach to interactivity
- **Stimulus** - Modest JavaScript for HTML you already have

---

## Contributors

Thank you to everyone who has contributed to Accelade:

### Core Team

- **[@fadymondy](https://github.com/fadymondy)** - Creator & Lead Maintainer

### Contributors

<!-- This section will be automatically updated -->
*Become a contributor! See our [Contributing Guide](/docs/contributing).*

---

## Sponsors

Special thanks to our sponsors who help fund development:

### Platinum Sponsors
*Your company could be here!*

### Gold Sponsors
*Support Accelade and see your logo here.*

### Silver Sponsors
*Thank you for your generous support.*

### Individual Sponsors
*Every contribution helps!*

[Become a sponsor](/docs/sponsor)

---

## Community

Thanks to everyone in the Laravel and PHP community who:

- Reports bugs and issues
- Answers questions on GitHub discussions
- Shares Accelade on social media
- Writes blog posts and tutorials
- Uses Accelade in their projects

---

## Special Thanks

- **Taylor Otwell** - For creating Laravel and inspiring the PHP community
- **Caleb Porzio** - For Alpine.js and Livewire, which inspired many patterns
- **Jonathan Reinink** - For Inertia.js and its elegant approach to SPAs
- **The Laravel Community** - For continuous support and encouragement

---

## Trademarks & Attributions

- Laravel is a trademark of Taylor Otwell
- Vue.js is a trademark of Evan You
- React is a trademark of Meta Platforms, Inc.
- Svelte is a trademark of Svelte contributors
- Angular is a trademark of Google LLC

All other trademarks are property of their respective owners.

---

## License

Accelade is open-source software licensed under the [MIT License](https://opensource.org/licenses/MIT).

```
MIT License

Copyright (c) 2024 Fady Mondy

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

*Want to be listed here? [Contribute to Accelade](/docs/contributing) or [become a sponsor](/docs/sponsor)!*
</file>

<file path="docs/toggle.md">
# Toggle Component

The Accelade Toggle component is a streamlined variant designed specifically for managing boolean values. It provides a simple interface for toggling state without the complexity of more comprehensive data management.

## Basic Usage

Create a simple show/hide toggle:

```blade
<x-accelade::toggle>
    <button @click.prevent="toggle()">Show Content</button>

    <div a-show="toggled">
        <p>This content can be toggled!</p>
        <button @click.prevent="setToggle(false)">Hide</button>
    </div>
</x-accelade::toggle>
```

## Component Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `data` | bool\|string\|array | false | Default value or comma-separated key names |

## Exposed Properties

The Toggle component exposes three properties to its slot:

| Property | Type | Description |
|----------|------|-------------|
| `toggled` | boolean | Current toggle state (single mode) |
| `toggle(key?)` | function | Toggle the current state |
| `setToggle(value)` | function | Set a specific state value |

## Setting Default State

Use the `data` prop to set the initial state:

```blade
{{-- Start with toggled = true --}}
<x-accelade::toggle :data="true">
    <div a-show="toggled">Visible by default!</div>
    <button @click.prevent="toggle()">Toggle</button>
</x-accelade::toggle>
```

## Multiple Toggles

Manage multiple boolean values by passing comma-separated keys:

```blade
<x-accelade::toggle data="isCompany, hasVatNumber, wantsNewsletter">
    {{-- Toggle specific keys --}}
    <button @click.prevent="toggle('isCompany')">Switch Account Type</button>

    {{-- Show/hide based on keys --}}
    <div a-show="isCompany">
        <input name="company_name" placeholder="Company Name">
    </div>

    {{-- Set specific values --}}
    <button @click.prevent="setToggle('hasVatNumber', true)">Enable VAT</button>

    <div a-show="hasVatNumber">
        <input name="vat_number" placeholder="VAT Number">
    </div>

    {{-- Toggle newsletter --}}
    <label>
        <input type="checkbox" @change="toggle('wantsNewsletter')">
        Subscribe to newsletter
    </label>
</x-accelade::toggle>
```

With multiple toggles, the `toggle()` and `setToggle()` methods require a key parameter:

- `toggle('keyName')` - Toggle a specific key
- `setToggle('keyName', true)` - Set a specific key to a value

## Array Data with Default Values

Pass an array to set different default values for each key:

```blade
<x-accelade::toggle :data="['showSidebar' => true, 'showFooter' => false]">
    <div a-show="showSidebar">Sidebar content...</div>
    <div a-show="showFooter">Footer content...</div>
</x-accelade::toggle>
```

## Use Cases

### Accordion

Build an accordion with multiple Toggle components:

```blade
<div class="accordion">
    <x-accelade::toggle>
        <div class="accordion-item">
            <button @click.prevent="toggle()" class="accordion-header">
                <span>Section 1</span>
                <span a-text="toggled ? '−' : '+'">+</span>
            </button>
            <div a-show="toggled" class="accordion-content">
                Content for section 1...
            </div>
        </div>
    </x-accelade::toggle>

    <x-accelade::toggle>
        <div class="accordion-item">
            <button @click.prevent="toggle()" class="accordion-header">
                <span>Section 2</span>
                <span a-text="toggled ? '−' : '+'">+</span>
            </button>
            <div a-show="toggled" class="accordion-content">
                Content for section 2...
            </div>
        </div>
    </x-accelade::toggle>
</div>
```

### Conditional Form Fields

Show/hide form fields based on user selection:

```blade
<x-accelade::toggle data="isCompany, needsShipping">
    <form>
        <input name="name" placeholder="Your name">

        <label>
            <input type="checkbox" @change="toggle('isCompany')">
            I'm registering as a company
        </label>

        <div a-show="isCompany" class="company-fields">
            <input name="company_name" placeholder="Company Name">
            <input name="vat_number" placeholder="VAT Number">
        </div>

        <label>
            <input type="checkbox" @change="toggle('needsShipping')">
            I need shipping
        </label>

        <div a-show="needsShipping" class="shipping-fields">
            <textarea name="address" placeholder="Shipping address"></textarea>
        </div>

        <button type="submit">Submit</button>
    </form>
</x-accelade::toggle>
```

### Dropdown Menu

Create a simple dropdown:

```blade
<x-accelade::toggle>
    <div class="dropdown">
        <button @click.prevent="toggle()">
            Menu
        </button>

        <div a-show="toggled" class="dropdown-menu">
            <a href="/profile">Profile</a>
            <a href="/settings">Settings</a>
            <button @click.prevent="setToggle(false)">Close</button>
        </div>
    </div>
</x-accelade::toggle>
```

### Modal Dialog

Simple modal implementation:

```blade
<x-accelade::toggle>
    <button @click.prevent="setToggle(true)">Open Modal</button>

    <div a-show="toggled" class="modal-backdrop">
        <div class="modal">
            <h2>Modal Title</h2>
            <p>Modal content goes here...</p>
            <button @click.prevent="setToggle(false)">Close</button>
        </div>
    </div>
</x-accelade::toggle>
```

### Expandable Card

Create an expandable card component:

```blade
<x-accelade::toggle>
    <div class="card">
        <div class="card-header">
            <h3>Card Title</h3>
            <button @click.prevent="toggle()">
                <span a-show="!toggled">Expand</span>
                <span a-show="toggled">Collapse</span>
            </button>
        </div>

        <div a-show="toggled" class="card-body">
            <p>Expanded content with more details...</p>
        </div>
    </div>
</x-accelade::toggle>
```

## Events

The Toggle component dispatches events when state changes:

```javascript
// Listen on element
element.addEventListener('toggle', (e) => {
    console.log('Key:', e.detail.key);
    console.log('Value:', e.detail.value);
    console.log('ID:', e.detail.id);
});

// Listen globally
document.addEventListener('accelade:toggle', (e) => {
    console.log('Toggle changed:', e.detail);
});
```

## Framework Attributes

Works with all framework attribute prefixes:

| Framework | Show Attribute | Text Attribute |
|-----------|---------------|----------------|
| Vanilla | `a-show` | `a-text` |
| Vue | `v-show` | `v-text` |
| React | `data-state-show` | `data-state-text` |
| Svelte | `s-show` | `s-text` |
| Angular | `ng-show` | `ng-text` |

## Comparison with Data Component

| Feature | Toggle | Data Component |
|---------|--------|----------------|
| Boolean values | ✅ Optimized | ✅ Supported |
| Multiple data types | ❌ | ✅ |
| Nested objects | ❌ | ✅ |
| Simple API | ✅ | ➖ |
| Form integration | ➖ | ✅ |

Use Toggle when you only need boolean state management. Use the Data component for more complex state needs.

## Best Practices

1. **Use for booleans only** - For complex state, use the Data component
2. **Name your keys clearly** - Use descriptive names like `isVisible`, `hasError`, `showDetails`
3. **Keep toggles focused** - One toggle component per logical unit
4. **Use `a-show` for visibility** - More performant than `a-if` for frequent toggles

## Next Steps

- [Components](components.md) - Reactive components
- [State Component](state.md) - Errors, flash & shared data
- [Modal Component](modal.md) - Dialogs and slideovers
</file>

<file path="resources/js/adapters/angular/AngularBindingAdapter.ts">
/**
 * AngularBindingAdapter - DOM bindings for Angular-style reactivity
 *
 * Uses subscription-based updates similar to Angular's change detection.
 */

import type { IBindingAdapter, IStateAdapter, CleanupFn } from '../types';
import type { AcceladeActions } from '../../core/types';
import type { CustomMethods } from '../../core/factories/ScriptExecutor';
import { ScriptExecutor } from '../../core/factories/ScriptExecutor';
import {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    parseClassObject,
} from '../../core/expressions';

/**
 * Binding record
 */
interface BindingRecord {
    element: HTMLElement;
    type: string;
    expression: string;
    cleanup: CleanupFn;
}

/**
 * AngularBindingAdapter - Handles DOM bindings with Angular-style patterns
 */
export class AngularBindingAdapter implements IBindingAdapter {
    private element: HTMLElement | null = null;
    private stateAdapter: IStateAdapter | null = null;
    private bindings: BindingRecord[] = [];
    private eventListeners: Array<{ element: HTMLElement; event: string; handler: EventListener }> = [];
    private ifPlaceholders: Map<HTMLElement, Comment> = new Map();
    private modelBound: WeakSet<Element> = new WeakSet();
    private unsubscribe: CleanupFn | null = null;

    /**
     * Initialize the binding adapter
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void {
        this.element = element;
        this.stateAdapter = stateAdapter;

        // Subscribe to state changes for reactive updates
        this.unsubscribe = stateAdapter.subscribe(() => {
            this.update();
        });
    }

    /**
     * Bind text content - Angular: {{ expression }} or [textContent]
     */
    bindText(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'text',
            expression,
            cleanup: () => {},
        });
        this.updateTextBinding(element, expression);
    }

    /**
     * Bind HTML content - Angular: [innerHTML]
     */
    bindHtml(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'html',
            expression,
            cleanup: () => {},
        });
        this.updateHtmlBinding(element, expression);
    }

    /**
     * Bind visibility - Angular: [hidden] or *ngIf
     */
    bindShow(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'show',
            expression,
            cleanup: () => {},
        });
        this.updateShowBinding(element, expression);
    }

    /**
     * Bind conditional rendering - Angular: *ngIf
     */
    bindIf(element: HTMLElement, expression: string): void {
        const placeholder = document.createComment('ng-if');
        this.ifPlaceholders.set(element, placeholder);

        this.bindings.push({
            element,
            type: 'if',
            expression,
            cleanup: () => {
                this.ifPlaceholders.delete(element);
            },
        });
        this.updateIfBinding(element, expression);
    }

    /**
     * Bind two-way input - Angular: [(ngModel)]
     */
    bindModel(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (this.modelBound.has(element)) return;
        this.modelBound.add(element);

        const inputElement = element as HTMLInputElement;
        const isCheckbox = inputElement.type === 'checkbox';
        const isRadio = inputElement.type === 'radio';
        const isNumber = inputElement.type === 'number' || inputElement.type === 'range';
        const eventType = isCheckbox || isRadio ? 'change' : 'input';

        // Update state from DOM
        const updateState = () => {
            if (!this.stateAdapter) return;

            if (isCheckbox) {
                this.stateAdapter.set(property, inputElement.checked);
            } else if (isRadio) {
                this.stateAdapter.set(property, inputElement.value);
            } else if (isNumber) {
                this.stateAdapter.set(property, parseFloat(element.value) || 0);
            } else {
                this.stateAdapter.set(property, element.value);
            }
        };

        element.addEventListener(eventType, updateState);
        this.eventListeners.push({ element, event: eventType, handler: updateState });

        this.bindings.push({
            element,
            type: 'model',
            expression: property,
            cleanup: () => {},
        });

        // Initial update
        this.updateModelBinding(element, property);
    }

    /**
     * Bind attribute - Angular: [attr.name]
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void {
        this.bindings.push({
            element,
            type: `attr:${attr}`,
            expression,
            cleanup: () => {},
        });
        this.updateAttributeBinding(element, attr, expression);
    }

    /**
     * Bind event handler - Angular: (click)
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void {
        const listener = (e: Event) => {
            if (!this.stateAdapter) return;
            ScriptExecutor.executeAction(
                handler,
                this.stateAdapter.getState(),
                actions,
                customMethods,
                e
            );
        };

        element.addEventListener(event, listener);
        this.eventListeners.push({ element, event, handler: listener });
    }

    /**
     * Bind class - Angular: [ngClass] or [class.name]
     */
    bindClass(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'class',
            expression,
            cleanup: () => {},
        });
        this.updateClassBinding(element, expression);
    }

    /**
     * Bind style - Angular: [ngStyle] or [style.property]
     */
    bindStyle(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'style',
            expression,
            cleanup: () => {},
        });
        this.updateStyleBinding(element, expression);
    }

    /**
     * Update all bindings (like Angular's change detection cycle)
     */
    update(): void {
        for (const binding of this.bindings) {
            switch (binding.type) {
                case 'text':
                    this.updateTextBinding(binding.element, binding.expression);
                    break;
                case 'html':
                    this.updateHtmlBinding(binding.element, binding.expression);
                    break;
                case 'show':
                    this.updateShowBinding(binding.element, binding.expression);
                    break;
                case 'if':
                    this.updateIfBinding(binding.element, binding.expression);
                    break;
                case 'model':
                    this.updateModelBinding(
                        binding.element as HTMLInputElement,
                        binding.expression
                    );
                    break;
                case 'class':
                    this.updateClassBinding(binding.element, binding.expression);
                    break;
                case 'style':
                    this.updateStyleBinding(binding.element, binding.expression);
                    break;
                default:
                    if (binding.type.startsWith('attr:')) {
                        const attr = binding.type.slice(5);
                        this.updateAttributeBinding(binding.element, attr, binding.expression);
                    }
            }
        }
    }

    /**
     * Update text binding
     */
    private updateTextBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.textContent = value;
    }

    /**
     * Update HTML binding
     */
    private updateHtmlBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.innerHTML = value;
    }

    /**
     * Update show binding
     */
    private updateShowBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const visible = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        element.style.display = visible ? '' : 'none';
    }

    /**
     * Update if binding
     */
    private updateIfBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const placeholder = this.ifPlaceholders.get(element);
        if (!placeholder) return;

        const result = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        const isInserted = element.parentNode !== null;

        if (result && !isInserted) {
            placeholder.replaceWith(element);
        } else if (!result && isInserted) {
            element.replaceWith(placeholder);
        }
    }

    /**
     * Update model binding
     */
    private updateModelBinding(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (!this.stateAdapter) return;

        const value = this.stateAdapter.get(property);
        const inputElement = element as HTMLInputElement;

        if (inputElement.type === 'checkbox') {
            inputElement.checked = Boolean(value);
        } else if (inputElement.type === 'radio') {
            inputElement.checked = inputElement.value === value;
        } else if (element.value !== String(value ?? '')) {
            element.value = value !== undefined ? String(value) : '';
        }
    }

    /**
     * Update attribute binding
     */
    private updateAttributeBinding(
        element: HTMLElement,
        attr: string,
        expression: string
    ): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (attr === 'class' && typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        } else if (value === false || value === null || value === undefined) {
            element.removeAttribute(attr);
        } else if (value === true) {
            element.setAttribute(attr, '');
        } else {
            element.setAttribute(attr, String(value));
        }
    }

    /**
     * Update class binding
     */
    private updateClassBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const classObj = parseClassObject(expression, this.stateAdapter.getState());
        Object.entries(classObj).forEach(([className, condition]) => {
            element.classList.toggle(className, Boolean(condition));
        });
    }

    /**
     * Update style binding
     */
    private updateStyleBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                element.style.setProperty(prop, val);
            });
        }
    }

    /**
     * Dispose all bindings
     */
    dispose(): void {
        // Unsubscribe from state changes
        if (this.unsubscribe) {
            this.unsubscribe();
            this.unsubscribe = null;
        }

        // Remove event listeners
        for (const { element, event, handler } of this.eventListeners) {
            element.removeEventListener(event, handler);
        }
        this.eventListeners = [];

        // Run cleanup functions
        for (const binding of this.bindings) {
            binding.cleanup();
        }
        this.bindings = [];

        // Clear placeholders
        this.ifPlaceholders.clear();

        // Clear references
        this.element = null;
        this.stateAdapter = null;
    }
}

export default AngularBindingAdapter;
</file>

<file path="resources/js/adapters/angular/index.ts">
/**
 * Angular Adapter Exports
 */

export { AngularStateAdapter } from './AngularStateAdapter';
export { AngularBindingAdapter } from './AngularBindingAdapter';
export { AngularAdapter } from './AngularAdapter';
export { AngularAdapter as default } from './AngularAdapter';
</file>

<file path="resources/js/adapters/react/components.tsx">
/**
 * React Components for Accelade
 */

import React, {
    createContext,
    useContext,
    type ReactNode,
    type ReactElement,
} from 'react';
import { useAccelade, type UseAcceladeResult, type UseAcceladeOptions } from './hooks';
import { navigate } from '../../core/router';

/**
 * State type
 */
type StateRecord = Record<string, unknown>;

/**
 * Context for Accelade state
 */
const AcceladeContext = createContext<UseAcceladeResult<StateRecord> | null>(null);

/**
 * AcceladeProvider props
 */
export interface AcceladeProviderProps<T extends StateRecord> {
    initialState: T;
    componentId?: string;
    syncProperties?: string[];
    scripts?: string[];
    children: ReactNode | ((accelade: UseAcceladeResult<T>) => ReactNode);
}

/**
 * AcceladeProvider - Context provider for Accelade state
 *
 * @example
 * ```tsx
 * <AcceladeProvider initialState={{ count: 0 }}>
 *   {({ state, actions }) => (
 *     <div>
 *       <span>{state.count}</span>
 *       <button onClick={() => actions.increment()}>+</button>
 *     </div>
 *   )}
 * </AcceladeProvider>
 * ```
 */
export function AcceladeProvider<T extends StateRecord>({
    initialState,
    componentId,
    syncProperties,
    scripts,
    children,
}: AcceladeProviderProps<T>): ReactElement {
    const options: UseAcceladeOptions = {
        componentId,
        syncProperties,
        scripts,
    };

    const accelade = useAccelade(initialState, options);

    return (
        <AcceladeContext.Provider value={accelade as UseAcceladeResult<StateRecord>}>
            {typeof children === 'function' ? children(accelade) : children}
        </AcceladeContext.Provider>
    );
}

/**
 * useAcceladeContext - Use Accelade state from context
 *
 * @example
 * ```tsx
 * function Counter() {
 *   const { state, actions } = useAcceladeContext();
 *   return <span>{state.count}</span>;
 * }
 * ```
 */
export function useAcceladeContext<T extends StateRecord = StateRecord>(): UseAcceladeResult<T> {
    const context = useContext(AcceladeContext);
    if (!context) {
        throw new Error('useAcceladeContext must be used within AcceladeProvider');
    }
    return context as UseAcceladeResult<T>;
}

/**
 * AcceladeLink props
 */
export interface AcceladeLinkProps {
    href: string;
    children: ReactNode;
    className?: string;
    activeClassName?: string;
    prefetch?: boolean;
    replace?: boolean;
    [key: string]: unknown;
}

/**
 * AcceladeLink - SPA navigation link component
 *
 * @example
 * ```tsx
 * <AcceladeLink href="/dashboard" activeClassName="text-blue-500">
 *   Dashboard
 * </AcceladeLink>
 * ```
 */
export function AcceladeLink({
    href,
    children,
    className = '',
    activeClassName = 'active',
    prefetch = false,
    replace = false,
    ...props
}: AcceladeLinkProps): ReactElement {
    const isActive =
        typeof window !== 'undefined' &&
        window.location.pathname === new URL(href, window.location.origin).pathname;

    const handleClick = (e: React.MouseEvent<HTMLAnchorElement>) => {
        // Allow ctrl/cmd click for new tab
        if (e.ctrlKey || e.metaKey || e.shiftKey) return;

        e.preventDefault();
        void navigate(href, { pushState: !replace });
    };

    // Prefetch on hover (optional enhancement)
    const handleMouseEnter = () => {
        if (prefetch && typeof window !== 'undefined') {
            // Could prefetch the page here
            // For now, just a placeholder for future enhancement
        }
    };

    return (
        <a
            href={href}
            className={`${className} ${isActive ? activeClassName : ''}`.trim()}
            onClick={handleClick}
            onMouseEnter={handleMouseEnter}
            {...props}
        >
            {children}
        </a>
    );
}

/**
 * Show component props - Conditional rendering based on state
 */
export interface ShowProps {
    when: unknown;
    fallback?: ReactNode;
    children: ReactNode;
}

/**
 * Show - Conditional rendering component
 *
 * @example
 * ```tsx
 * <Show when={state.isLoading} fallback={<Content />}>
 *   <Spinner />
 * </Show>
 * ```
 */
export function Show({ when, fallback = null, children }: ShowProps): ReactElement | null {
    return <>{when ? children : fallback}</>;
}

/**
 * For component props - List rendering
 */
export interface ForProps<T> {
    each: T[];
    fallback?: ReactNode;
    children: (item: T, index: number) => ReactNode;
}

/**
 * For - List rendering component
 *
 * @example
 * ```tsx
 * <For each={state.items} fallback={<p>No items</p>}>
 *   {(item, i) => <li key={i}>{item.name}</li>}
 * </For>
 * ```
 */
export function For<T>({ each, fallback = null, children }: ForProps<T>): ReactElement {
    if (!each || each.length === 0) {
        return <>{fallback}</>;
    }

    return <>{each.map((item, index) => children(item, index))}</>;
}

/**
 * Switch/Match components for conditional rendering
 */
export interface SwitchProps {
    children: ReactNode;
    fallback?: ReactNode;
}

export interface MatchProps {
    when: unknown;
    children: ReactNode;
}

/**
 * Match - Used inside Switch for pattern matching
 */
export function Match({ when, children }: MatchProps): ReactElement | null {
    // Match is handled by Switch, this just provides the structure
    return <>{when ? children : null}</>;
}

/**
 * Switch - Pattern matching component
 *
 * @example
 * ```tsx
 * <Switch fallback={<p>Unknown</p>}>
 *   <Match when={state.status === 'loading'}>Loading...</Match>
 *   <Match when={state.status === 'success'}>Done!</Match>
 *   <Match when={state.status === 'error'}>Error!</Match>
 * </Switch>
 * ```
 */
export function Switch({ children, fallback = null }: SwitchProps): ReactElement {
    const childArray = React.Children.toArray(children);

    for (const child of childArray) {
        if (React.isValidElement(child) && child.type === Match) {
            const matchProps = child.props as MatchProps;
            if (matchProps.when) {
                return <>{matchProps.children}</>;
            }
        }
    }

    return <>{fallback}</>;
}

export default {
    AcceladeProvider,
    useAcceladeContext,
    AcceladeLink,
    Show,
    For,
    Switch,
    Match,
};
</file>

<file path="resources/js/adapters/react/index.ts">
/**
 * React Adapter Exports
 */

// Core adapter
export { ReactStateAdapter } from './ReactStateAdapter';
export { ReactBindingAdapter } from './ReactBindingAdapter';
export { ReactAdapter } from './ReactAdapter';
export { ReactAdapter as default } from './ReactAdapter';

// Hooks
export {
    useAccelade,
    useAcceladeSync,
    type UseAcceladeResult,
    type UseAcceladeOptions,
} from './hooks';

// Components
export {
    AcceladeProvider,
    useAcceladeContext,
    AcceladeLink,
    Show,
    For,
    Switch,
    Match,
    type AcceladeProviderProps,
    type AcceladeLinkProps,
    type ShowProps,
    type ForProps,
    type SwitchProps,
    type MatchProps,
} from './components';
</file>

<file path="resources/js/adapters/react/ReactBindingAdapter.ts">
/**
 * ReactBindingAdapter - React-style DOM bindings
 *
 * Note: React's paradigm is fundamentally different from Vue/Vanilla.
 * Instead of directly manipulating DOM, React re-renders components.
 * This adapter provides binding metadata that React components can use.
 */

import type { IBindingAdapter, IStateAdapter, CleanupFn } from '../types';
import type { AcceladeActions } from '../../core/types';
import type { CustomMethods } from '../../core/factories/ScriptExecutor';
import { ScriptExecutor } from '../../core/factories/ScriptExecutor';
import {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    parseClassObject,
} from '../../core/expressions';

/**
 * Binding record for tracking
 */
interface BindingRecord {
    element: HTMLElement;
    type: string;
    expression: string;
    cleanup: CleanupFn;
}

/**
 * Event binding record
 */
interface EventBinding {
    element: HTMLElement;
    event: string;
    handler: string;
    listener: EventListener;
}

/**
 * ReactBindingAdapter - Handles DOM bindings for React integration
 *
 * This adapter is used when rendering server-side templates with React.
 * For pure React components, use the useAccelade hook instead.
 */
export class ReactBindingAdapter implements IBindingAdapter {
    private element: HTMLElement | null = null;
    private stateAdapter: IStateAdapter | null = null;
    private bindings: BindingRecord[] = [];
    private eventBindings: EventBinding[] = [];
    private ifPlaceholders: Map<HTMLElement, Comment> = new Map();
    private modelBound: WeakSet<Element> = new WeakSet();
    private unsubscribe: CleanupFn | null = null;

    /**
     * Initialize the binding adapter
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void {
        this.element = element;
        this.stateAdapter = stateAdapter;

        // Subscribe to state changes for updates
        this.unsubscribe = stateAdapter.subscribe(() => {
            this.update();
        });
    }

    /**
     * Bind text content
     */
    bindText(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'text',
            expression,
            cleanup: () => {},
        });
        this.updateTextBinding(element, expression);
    }

    /**
     * Bind HTML content
     */
    bindHtml(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'html',
            expression,
            cleanup: () => {},
        });
        this.updateHtmlBinding(element, expression);
    }

    /**
     * Bind visibility
     */
    bindShow(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'show',
            expression,
            cleanup: () => {},
        });
        this.updateShowBinding(element, expression);
    }

    /**
     * Bind conditional rendering
     */
    bindIf(element: HTMLElement, expression: string): void {
        const placeholder = document.createComment('state-if');
        this.ifPlaceholders.set(element, placeholder);

        this.bindings.push({
            element,
            type: 'if',
            expression,
            cleanup: () => {
                this.ifPlaceholders.delete(element);
            },
        });
        this.updateIfBinding(element, expression);
    }

    /**
     * Bind two-way input
     */
    bindModel(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (this.modelBound.has(element)) return;
        this.modelBound.add(element);

        const inputElement = element as HTMLInputElement;
        const isCheckbox = inputElement.type === 'checkbox';
        const isRadio = inputElement.type === 'radio';
        const isNumber = inputElement.type === 'number' || inputElement.type === 'range';
        const eventType = isCheckbox || isRadio ? 'change' : 'input';

        // Update state from DOM
        const updateState = () => {
            if (!this.stateAdapter) return;

            if (isCheckbox) {
                this.stateAdapter.set(property, inputElement.checked);
            } else if (isRadio) {
                this.stateAdapter.set(property, inputElement.value);
            } else if (isNumber) {
                this.stateAdapter.set(property, parseFloat(element.value) || 0);
            } else {
                this.stateAdapter.set(property, element.value);
            }
        };

        element.addEventListener(eventType, updateState);

        this.bindings.push({
            element,
            type: 'model',
            expression: property,
            cleanup: () => {
                element.removeEventListener(eventType, updateState);
            },
        });

        // Initial DOM update
        this.updateModelBinding(element, property);
    }

    /**
     * Bind attribute
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void {
        this.bindings.push({
            element,
            type: `attr:${attr}`,
            expression,
            cleanup: () => {},
        });
        this.updateAttributeBinding(element, attr, expression);
    }

    /**
     * Bind event handler
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void {
        const state = this.stateAdapter?.getState() ?? {};

        const listener = (e: Event) => {
            const currentState = this.stateAdapter?.getState() ?? {};
            ScriptExecutor.executeAction(handler, currentState, actions, customMethods, e);
        };

        element.addEventListener(event, listener);
        this.eventBindings.push({ element, event, handler, listener });
    }

    /**
     * Bind class object
     */
    bindClass(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'class',
            expression,
            cleanup: () => {},
        });
        this.updateClassBinding(element, expression);
    }

    /**
     * Bind style object
     */
    bindStyle(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'style',
            expression,
            cleanup: () => {},
        });
        this.updateStyleBinding(element, expression);
    }

    /**
     * Update all bindings
     */
    update(): void {
        for (const binding of this.bindings) {
            switch (binding.type) {
                case 'text':
                    this.updateTextBinding(binding.element, binding.expression);
                    break;
                case 'html':
                    this.updateHtmlBinding(binding.element, binding.expression);
                    break;
                case 'show':
                    this.updateShowBinding(binding.element, binding.expression);
                    break;
                case 'if':
                    this.updateIfBinding(binding.element, binding.expression);
                    break;
                case 'model':
                    this.updateModelBinding(
                        binding.element as HTMLInputElement,
                        binding.expression
                    );
                    break;
                case 'class':
                    this.updateClassBinding(binding.element, binding.expression);
                    break;
                case 'style':
                    this.updateStyleBinding(binding.element, binding.expression);
                    break;
                default:
                    if (binding.type.startsWith('attr:')) {
                        const attr = binding.type.slice(5);
                        this.updateAttributeBinding(binding.element, attr, binding.expression);
                    }
            }
        }
    }

    /**
     * Update text binding
     */
    private updateTextBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.textContent = value;
    }

    /**
     * Update HTML binding
     */
    private updateHtmlBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.innerHTML = value;
    }

    /**
     * Update show binding
     */
    private updateShowBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const visible = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        element.style.display = visible ? '' : 'none';
    }

    /**
     * Update if binding
     */
    private updateIfBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const placeholder = this.ifPlaceholders.get(element);
        if (!placeholder) return;

        const result = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        const isInserted = element.parentNode !== null;

        if (result && !isInserted) {
            placeholder.replaceWith(element);
        } else if (!result && isInserted) {
            element.replaceWith(placeholder);
        }
    }

    /**
     * Update model binding
     */
    private updateModelBinding(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (!this.stateAdapter) return;

        const value = this.stateAdapter.get(property);
        const inputElement = element as HTMLInputElement;

        if (inputElement.type === 'checkbox') {
            inputElement.checked = Boolean(value);
        } else if (inputElement.type === 'radio') {
            inputElement.checked = inputElement.value === value;
        } else if (element.value !== String(value ?? '')) {
            element.value = value !== undefined ? String(value) : '';
        }
    }

    /**
     * Update attribute binding
     */
    private updateAttributeBinding(
        element: HTMLElement,
        attr: string,
        expression: string
    ): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (attr === 'class' && typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        } else if (value === false || value === null || value === undefined) {
            element.removeAttribute(attr);
        } else if (value === true) {
            element.setAttribute(attr, '');
        } else {
            element.setAttribute(attr, String(value));
        }
    }

    /**
     * Update class binding
     */
    private updateClassBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const classObj = parseClassObject(expression, this.stateAdapter.getState());
        Object.entries(classObj).forEach(([className, condition]) => {
            element.classList.toggle(className, Boolean(condition));
        });
    }

    /**
     * Update style binding
     */
    private updateStyleBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                element.style.setProperty(prop, val);
            });
        }
    }

    /**
     * Dispose all bindings
     */
    dispose(): void {
        // Unsubscribe from state changes
        if (this.unsubscribe) {
            this.unsubscribe();
            this.unsubscribe = null;
        }

        // Remove event listeners
        for (const { element, event, listener } of this.eventBindings) {
            element.removeEventListener(event, listener);
        }
        this.eventBindings = [];

        // Run cleanup functions
        for (const binding of this.bindings) {
            binding.cleanup();
        }
        this.bindings = [];

        // Clear placeholders
        this.ifPlaceholders.clear();

        // Clear references
        this.element = null;
        this.stateAdapter = null;
    }
}

export default ReactBindingAdapter;
</file>

<file path="resources/js/adapters/svelte/index.ts">
/**
 * Svelte Adapter Exports
 */

export { SvelteStateAdapter } from './SvelteStateAdapter';
export { SvelteBindingAdapter } from './SvelteBindingAdapter';
export { SvelteAdapter } from './SvelteAdapter';
export { SvelteAdapter as default } from './SvelteAdapter';
</file>

<file path="resources/js/adapters/svelte/SvelteBindingAdapter.ts">
/**
 * SvelteBindingAdapter - DOM bindings for Svelte-style reactivity
 *
 * Uses store subscriptions for reactive updates.
 */

import type { IBindingAdapter, IStateAdapter, CleanupFn } from '../types';
import type { AcceladeActions } from '../../core/types';
import type { CustomMethods } from '../../core/factories/ScriptExecutor';
import { ScriptExecutor } from '../../core/factories/ScriptExecutor';
import {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    parseClassObject,
} from '../../core/expressions';

/**
 * Binding record
 */
interface BindingRecord {
    element: HTMLElement;
    type: string;
    expression: string;
    cleanup: CleanupFn;
}

/**
 * SvelteBindingAdapter - Handles DOM bindings with store subscriptions
 */
export class SvelteBindingAdapter implements IBindingAdapter {
    private element: HTMLElement | null = null;
    private stateAdapter: IStateAdapter | null = null;
    private bindings: BindingRecord[] = [];
    private eventListeners: Array<{ element: HTMLElement; event: string; handler: EventListener }> = [];
    private ifPlaceholders: Map<HTMLElement, Comment> = new Map();
    private modelBound: WeakSet<Element> = new WeakSet();
    private unsubscribe: CleanupFn | null = null;

    /**
     * Initialize the binding adapter
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void {
        this.element = element;
        this.stateAdapter = stateAdapter;

        // Subscribe to state changes for reactive updates
        this.unsubscribe = stateAdapter.subscribe(() => {
            this.update();
        });
    }

    /**
     * Bind text content
     */
    bindText(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'text',
            expression,
            cleanup: () => {},
        });
        this.updateTextBinding(element, expression);
    }

    /**
     * Bind HTML content
     */
    bindHtml(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'html',
            expression,
            cleanup: () => {},
        });
        this.updateHtmlBinding(element, expression);
    }

    /**
     * Bind visibility
     */
    bindShow(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'show',
            expression,
            cleanup: () => {},
        });
        this.updateShowBinding(element, expression);
    }

    /**
     * Bind conditional rendering
     */
    bindIf(element: HTMLElement, expression: string): void {
        const placeholder = document.createComment('svelte-if');
        this.ifPlaceholders.set(element, placeholder);

        this.bindings.push({
            element,
            type: 'if',
            expression,
            cleanup: () => {
                this.ifPlaceholders.delete(element);
            },
        });
        this.updateIfBinding(element, expression);
    }

    /**
     * Bind two-way input
     */
    bindModel(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (this.modelBound.has(element)) return;
        this.modelBound.add(element);

        const inputElement = element as HTMLInputElement;
        const isCheckbox = inputElement.type === 'checkbox';
        const isRadio = inputElement.type === 'radio';
        const isNumber = inputElement.type === 'number' || inputElement.type === 'range';
        const eventType = isCheckbox || isRadio ? 'change' : 'input';

        // Update state from DOM
        const updateState = () => {
            if (!this.stateAdapter) return;

            if (isCheckbox) {
                this.stateAdapter.set(property, inputElement.checked);
            } else if (isRadio) {
                this.stateAdapter.set(property, inputElement.value);
            } else if (isNumber) {
                this.stateAdapter.set(property, parseFloat(element.value) || 0);
            } else {
                this.stateAdapter.set(property, element.value);
            }
        };

        element.addEventListener(eventType, updateState);
        this.eventListeners.push({ element, event: eventType, handler: updateState });

        this.bindings.push({
            element,
            type: 'model',
            expression: property,
            cleanup: () => {},
        });

        // Initial update
        this.updateModelBinding(element, property);
    }

    /**
     * Bind attribute
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void {
        this.bindings.push({
            element,
            type: `attr:${attr}`,
            expression,
            cleanup: () => {},
        });
        this.updateAttributeBinding(element, attr, expression);
    }

    /**
     * Bind event handler
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void {
        const listener = (e: Event) => {
            if (!this.stateAdapter) return;
            ScriptExecutor.executeAction(
                handler,
                this.stateAdapter.getState(),
                actions,
                customMethods,
                e
            );
        };

        element.addEventListener(event, listener);
        this.eventListeners.push({ element, event, handler: listener });
    }

    /**
     * Bind class object
     */
    bindClass(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'class',
            expression,
            cleanup: () => {},
        });
        this.updateClassBinding(element, expression);
    }

    /**
     * Bind style object
     */
    bindStyle(element: HTMLElement, expression: string): void {
        this.bindings.push({
            element,
            type: 'style',
            expression,
            cleanup: () => {},
        });
        this.updateStyleBinding(element, expression);
    }

    /**
     * Update all bindings
     */
    update(): void {
        for (const binding of this.bindings) {
            switch (binding.type) {
                case 'text':
                    this.updateTextBinding(binding.element, binding.expression);
                    break;
                case 'html':
                    this.updateHtmlBinding(binding.element, binding.expression);
                    break;
                case 'show':
                    this.updateShowBinding(binding.element, binding.expression);
                    break;
                case 'if':
                    this.updateIfBinding(binding.element, binding.expression);
                    break;
                case 'model':
                    this.updateModelBinding(
                        binding.element as HTMLInputElement,
                        binding.expression
                    );
                    break;
                case 'class':
                    this.updateClassBinding(binding.element, binding.expression);
                    break;
                case 'style':
                    this.updateStyleBinding(binding.element, binding.expression);
                    break;
                default:
                    if (binding.type.startsWith('attr:')) {
                        const attr = binding.type.slice(5);
                        this.updateAttributeBinding(binding.element, attr, binding.expression);
                    }
            }
        }
    }

    /**
     * Update text binding
     */
    private updateTextBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.textContent = value;
    }

    /**
     * Update HTML binding
     */
    private updateHtmlBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const value = evaluateStringExpression(expression, this.stateAdapter.getState());
        element.innerHTML = value;
    }

    /**
     * Update show binding
     */
    private updateShowBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;
        const visible = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        element.style.display = visible ? '' : 'none';
    }

    /**
     * Update if binding
     */
    private updateIfBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const placeholder = this.ifPlaceholders.get(element);
        if (!placeholder) return;

        const result = evaluateBooleanExpression(expression, this.stateAdapter.getState());
        const isInserted = element.parentNode !== null;

        if (result && !isInserted) {
            placeholder.replaceWith(element);
        } else if (!result && isInserted) {
            element.replaceWith(placeholder);
        }
    }

    /**
     * Update model binding
     */
    private updateModelBinding(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (!this.stateAdapter) return;

        const value = this.stateAdapter.get(property);
        const inputElement = element as HTMLInputElement;

        if (inputElement.type === 'checkbox') {
            inputElement.checked = Boolean(value);
        } else if (inputElement.type === 'radio') {
            inputElement.checked = inputElement.value === value;
        } else if (element.value !== String(value ?? '')) {
            element.value = value !== undefined ? String(value) : '';
        }
    }

    /**
     * Update attribute binding
     */
    private updateAttributeBinding(
        element: HTMLElement,
        attr: string,
        expression: string
    ): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (attr === 'class' && typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        } else if (value === false || value === null || value === undefined) {
            element.removeAttribute(attr);
        } else if (value === true) {
            element.setAttribute(attr, '');
        } else {
            element.setAttribute(attr, String(value));
        }
    }

    /**
     * Update class binding
     */
    private updateClassBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const classObj = parseClassObject(expression, this.stateAdapter.getState());
        Object.entries(classObj).forEach(([className, condition]) => {
            element.classList.toggle(className, Boolean(condition));
        });
    }

    /**
     * Update style binding
     */
    private updateStyleBinding(element: HTMLElement, expression: string): void {
        if (!this.stateAdapter) return;

        const value = evaluateExpression(expression, this.stateAdapter.getState());

        if (typeof value === 'object' && value !== null) {
            Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                element.style.setProperty(prop, val);
            });
        }
    }

    /**
     * Dispose all bindings
     */
    dispose(): void {
        // Unsubscribe from state changes
        if (this.unsubscribe) {
            this.unsubscribe();
            this.unsubscribe = null;
        }

        // Remove event listeners
        for (const { element, event, handler } of this.eventListeners) {
            element.removeEventListener(event, handler);
        }
        this.eventListeners = [];

        // Run cleanup functions
        for (const binding of this.bindings) {
            binding.cleanup();
        }
        this.bindings = [];

        // Clear placeholders
        this.ifPlaceholders.clear();

        // Clear references
        this.element = null;
        this.stateAdapter = null;
    }
}

export default SvelteBindingAdapter;
</file>

<file path="resources/js/adapters/vanilla/index.ts">
/**
 * Vanilla Adapter Exports
 */

export { VanillaStateAdapter } from './VanillaStateAdapter';
export { VanillaBindingAdapter } from './VanillaBindingAdapter';
export { VanillaAdapter } from './VanillaAdapter';
export { VanillaAdapter as default } from './VanillaAdapter';
</file>

<file path="resources/js/adapters/vue/index.ts">
/**
 * Vue Adapter Exports
 */

export { VueStateAdapter } from './VueStateAdapter';
export { VueBindingAdapter } from './VueBindingAdapter';
export { VueAdapter } from './VueAdapter';
export { VueAdapter as default } from './VueAdapter';
</file>

<file path="resources/js/adapters/index.ts">
/**
 * Adapters - Export all adapter modules
 */

// Types
export type {
    FrameworkType,
    ComponentInstance,
    IStateAdapter,
    IBindingAdapter,
    IFrameworkAdapter,
    BindingAttributeMap,
    AdapterFactory,
    AdapterRegistration,
    AdapterConfig,
    EventBinding,
    CleanupFn,
} from './types';

// Base adapter
export { BaseAdapter } from './BaseAdapter';

// Vanilla adapter
export { VanillaAdapter, VanillaStateAdapter, VanillaBindingAdapter } from './vanilla';

// Vue adapter
export { VueAdapter, VueStateAdapter, VueBindingAdapter } from './vue';

// React adapter
export {
    ReactAdapter,
    ReactStateAdapter,
    ReactBindingAdapter,
    useAccelade,
    useAcceladeSync,
    AcceladeProvider,
    useAcceladeContext,
    AcceladeLink,
    Show,
    For,
    Switch,
    Match,
} from './react';

// Svelte adapter
export { SvelteAdapter, SvelteStateAdapter, SvelteBindingAdapter } from './svelte';

// Angular adapter
export { AngularAdapter, AngularStateAdapter, AngularBindingAdapter } from './angular';
</file>

<file path="resources/js/adapters/types.ts">
/**
 * Adapter Type Definitions
 * Interfaces for framework-specific adapters
 */

import type { AcceladeActions, AcceladeComponentConfig, StateChangeCallback } from '../core/types';
import type { CustomMethods } from '../core/factories/ScriptExecutor';

/**
 * Framework types supported by Accelade
 */
export type FrameworkType = 'vanilla' | 'vue' | 'react' | 'svelte' | 'angular';

/**
 * Component instance returned after initialization
 */
export interface ComponentInstance {
    id: string;
    element: HTMLElement;
    framework: FrameworkType;
    state: Record<string, unknown>;
    originalState: Record<string, unknown>;
    actions: AcceladeActions;
    customMethods: CustomMethods;
    syncProperties: Set<string>;
    stateAdapter: IStateAdapter;
    bindingAdapter: IBindingAdapter;
    dispose: () => void;
}

/**
 * State adapter interface - handles framework-specific reactivity
 */
export interface IStateAdapter {
    /**
     * Initialize state with given initial values
     */
    init(initialState: Record<string, unknown>): void;

    /**
     * Get current state (snapshot)
     */
    getState(): Record<string, unknown>;

    /**
     * Get a specific state value
     */
    get<T = unknown>(key: string): T | undefined;

    /**
     * Set a state value
     */
    set(key: string, value: unknown): void;

    /**
     * Set multiple state values at once
     */
    setMany(updates: Record<string, unknown>): void;

    /**
     * Subscribe to all state changes
     */
    subscribe(callback: StateChangeCallback): () => void;

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void;

    /**
     * Get framework-native reactive state (for templates)
     * Returns the native reactive object (Proxy, reactive(), useState result, etc.)
     */
    getReactiveState(): unknown;

    /**
     * Check if state has a specific key
     */
    has(key: string): boolean;

    /**
     * Get all state keys
     */
    keys(): string[];

    /**
     * Dispose adapter and cleanup subscriptions
     */
    dispose(): void;
}

/**
 * Binding adapter interface - handles framework-specific DOM bindings
 */
export interface IBindingAdapter {
    /**
     * Initialize bindings for an element
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void;

    /**
     * Bind text content (a-text, v-text, state:text)
     */
    bindText(element: HTMLElement, expression: string): void;

    /**
     * Bind HTML content (a-html, v-html)
     */
    bindHtml(element: HTMLElement, expression: string): void;

    /**
     * Bind visibility (a-show, v-show)
     */
    bindShow(element: HTMLElement, expression: string): void;

    /**
     * Bind conditional rendering (a-if, v-if)
     */
    bindIf(element: HTMLElement, expression: string): void;

    /**
     * Bind two-way input (a-model, v-model)
     */
    bindModel(element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement, property: string): void;

    /**
     * Bind attributes (a-bind:attr, :attr, v-bind:attr)
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void;

    /**
     * Bind event handler (a-on:event, @event, v-on:event)
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void;

    /**
     * Bind class object (a-class, v-class, :class)
     */
    bindClass(element: HTMLElement, expression: string): void;

    /**
     * Bind style object (a-style, v-style, :style)
     */
    bindStyle(element: HTMLElement, expression: string): void;

    /**
     * Update all bindings (for frameworks that need manual updates)
     */
    update(): void;

    /**
     * Dispose bindings and cleanup
     */
    dispose(): void;
}

/**
 * Framework adapter interface - combines state and binding adapters
 */
export interface IFrameworkAdapter {
    /**
     * Framework type identifier
     */
    readonly type: FrameworkType;

    /**
     * Create a state adapter instance
     */
    createStateAdapter(): IStateAdapter;

    /**
     * Create a binding adapter instance
     */
    createBindingAdapter(): IBindingAdapter;

    /**
     * Check if this framework is available in the current environment
     */
    isAvailable(): boolean;

    /**
     * Initialize a component with this framework
     */
    initComponent(element: HTMLElement, config: AcceladeComponentConfig): ComponentInstance;

    /**
     * Dispose a component
     */
    disposeComponent(instance: ComponentInstance): void;

    /**
     * Get attribute prefix for this framework
     * e.g., 'a-' for vanilla, 'v-' for vue, 'state:' for react
     */
    getAttributePrefix(): string;

    /**
     * Get event attribute prefix
     * e.g., 'a-on:' for vanilla, 'v-on:' or '@' for vue
     */
    getEventPrefix(): string;

    /**
     * Get script attribute selector for this framework
     * e.g., 'script[a-script]' for vanilla
     */
    getScriptSelector(): string;

    /**
     * Get binding attribute names for this framework
     */
    getBindingAttributes(): BindingAttributeMap;
}

/**
 * Mapping of binding types to attribute names per framework
 */
export interface BindingAttributeMap {
    text: string;       // a-text, v-text, state:text
    html: string;       // a-html, v-html
    show: string;       // a-show, v-show
    if: string;         // a-if, v-if
    model: string;      // a-model, v-model
    class: string;      // a-class, :class
    style: string;      // a-style, :style
    bind: string;       // a-bind:, v-bind:, :
    on: string;         // a-on:, v-on:, @
    cloak: string;      // a-cloak, v-cloak, data-accelade-cloak
}

/**
 * Adapter factory function type
 */
export type AdapterFactory = () => IFrameworkAdapter;

/**
 * Adapter registration entry
 */
export interface AdapterRegistration {
    type: FrameworkType;
    factory: AdapterFactory;
    priority: number;
    detectFn?: () => boolean;
}

/**
 * Base configuration for adapters
 */
export interface AdapterConfig {
    debug?: boolean;
    syncOnChange?: boolean;
    syncDebounce?: number;
}

/**
 * Event binding info
 */
export interface EventBinding {
    element: HTMLElement;
    event: string;
    handler: EventListener;
}

/**
 * Cleanup function type
 */
export type CleanupFn = () => void;
</file>

<file path="resources/js/core/bridge/BridgeFactory.ts">
/**
 * BridgeFactory - Handles Bridge component communication with PHP backend
 *
 * Bridge components provide two-way binding between PHP Blade components
 * and JavaScript, allowing:
 * - Access to PHP properties as reactive `props`
 * - Calling PHP methods via AJAX
 * - Receiving responses (redirects, toasts, data updates)
 */

import { navigate } from '../router';
import { emit as eventEmit } from '../events';
import { handleAjaxError, handleFetchError, type AcceladeErrorResponse } from '../errors/ErrorHandler';

/**
 * Bridge configuration from PHP
 */
export interface BridgeConfig {
    id: string;
    component: string;
    props: Record<string, unknown>;
    methods: string[];
    state: string; // Encrypted state payload
    callUrl: string;
    syncUrl: string;
}

/**
 * Bridge response from PHP
 */
export interface BridgeCallResponse {
    success: boolean;
    message?: string;
    data?: Record<string, unknown>;
    props?: Record<string, unknown>;
    state?: string;
    redirect?: string;
    refresh?: boolean;
    preserveScroll?: boolean;
    toast?: {
        type: string;
        title: string;
        body?: string;
    };
    events?: Array<{
        name: string;
        data: Record<string, unknown>;
    }>;
}

/**
 * Bridge instance for a component
 */
export interface BridgeInstance {
    id: string;
    config: BridgeConfig;
    props: Record<string, unknown>;
    call: (method: string, ...args: unknown[]) => Promise<BridgeCallResponse>;
    sync: (props: Record<string, unknown>) => Promise<void>;
    getState: () => string;
    dispose: () => void;
}

/**
 * Active bridge instances
 */
const instances = new Map<string, BridgeInstance>();

/**
 * CSRF token getter
 */
function getCsrfToken(): string {
    const meta = document.querySelector('meta[name="csrf-token"]');
    return meta?.getAttribute('content') ?? '';
}

/**
 * Create a bridge instance for a component
 */
export function createBridge(
    element: HTMLElement,
    componentId: string,
    setState: (key: string, value: unknown) => void,
    getState: () => Record<string, unknown>
): BridgeInstance | undefined {
    // Parse bridge config from data attribute
    const configJson = element.dataset.acceladeBridge;
    if (!configJson) {
        return undefined;
    }

    let config: BridgeConfig;
    try {
        config = JSON.parse(configJson);
    } catch {
        console.error('[Accelade Bridge] Invalid config JSON');
        return undefined;
    }

    // Current encrypted state
    let currentState = config.state;

    // Flag to prevent recursive setState calls when syncing from server
    let isSyncingFromServer = false;

    // Create props proxy that syncs changes
    const props = new Proxy({ ...config.props }, {
        set(target, prop, value) {
            const key = String(prop);
            target[key] = value;

            // Only update component state if not syncing from server
            // This prevents infinite recursion when props are updated from AJAX response
            if (!isSyncingFromServer) {
                setState(`props.${key}`, value);
            }

            return true;
        },
        get(target, prop) {
            return target[String(prop)];
        },
    });

    // Initialize component state with props (without triggering sync)
    isSyncingFromServer = true;
    for (const [key, value] of Object.entries(config.props)) {
        props[key] = value;
    }
    isSyncingFromServer = false;

    // Set initial state with all props at once
    setState('props', { ...config.props });

    /**
     * Call a PHP method via AJAX
     */
    async function call(method: string, ...args: unknown[]): Promise<BridgeCallResponse> {
        // Verify method is allowed
        if (!config.methods.includes(method)) {
            console.error(`[Accelade Bridge] Method '${method}' is not callable`);
            return { success: false, message: `Method '${method}' is not callable` };
        }

        try {
            const response = await fetch(config.callUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    'X-CSRF-TOKEN': getCsrfToken(),
                    'X-Requested-With': 'XMLHttpRequest',
                },
                body: JSON.stringify({
                    state: currentState,
                    method,
                    args,
                }),
            });

            const result: BridgeCallResponse = await response.json();

            // Handle error responses
            if (!response.ok || !result.success) {
                // Check for Accelade error response format
                const errorResult = result as unknown as AcceladeErrorResponse;
                if (errorResult._accelade) {
                    handleAjaxError(errorResult, response.status);
                }
                // Still return the result so caller can handle it
                return result;
            }

            // Update state if provided
            if (result.state) {
                currentState = result.state;
            }

            // Update props if provided (with sync flag to prevent recursion)
            if (result.props) {
                isSyncingFromServer = true;
                for (const [key, value] of Object.entries(result.props)) {
                    props[key] = value;
                }
                isSyncingFromServer = false;

                // Update component state all at once
                setState('props', { ...props });
            }

            // Handle redirect
            if (result.redirect) {
                navigate(result.redirect);
                return result;
            }

            // Handle refresh
            if (result.refresh) {
                if (result.preserveScroll) {
                    const scrollY = window.scrollY;
                    window.location.reload();
                    window.scrollTo(0, scrollY);
                } else {
                    window.location.reload();
                }
                return result;
            }

            // Handle toast (already triggered server-side, but also emit client-side)
            if (result.toast) {
                const Accelade = (window as unknown as Record<string, unknown>).Accelade as {
                    notify?: {
                        [key: string]: (title: string, body?: string) => void;
                    };
                };

                if (Accelade?.notify) {
                    const notifyMethod = Accelade.notify[result.toast.type];
                    if (typeof notifyMethod === 'function') {
                        notifyMethod(result.toast.title, result.toast.body ?? '');
                    }
                }
            }

            // Handle events
            if (result.events) {
                for (const event of result.events) {
                    eventEmit(event.name, event.data);
                }
            }

            return result;
        } catch (error) {
            // Handle network/fetch errors
            if (error instanceof Error) {
                handleFetchError(error, config.callUrl);
            }
            return {
                success: false,
                message: error instanceof Error ? error.message : 'Unknown error',
            };
        }
    }

    /**
     * Sync property changes to PHP
     */
    async function sync(propsToSync: Record<string, unknown>): Promise<void> {
        try {
            const response = await fetch(config.syncUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    'X-CSRF-TOKEN': getCsrfToken(),
                    'X-Requested-With': 'XMLHttpRequest',
                },
                body: JSON.stringify({
                    state: currentState,
                    props: propsToSync,
                }),
            });

            const result = await response.json();

            // Update state if provided
            if (result.state) {
                currentState = result.state;
            }

            // Update props if provided (with sync flag to prevent recursion)
            if (result.props) {
                isSyncingFromServer = true;
                for (const [key, value] of Object.entries(result.props)) {
                    props[key] = value;
                }
                isSyncingFromServer = false;

                // Update component state all at once
                setState('props', { ...props });
            }
        } catch (error) {
            // Handle network/fetch errors
            if (error instanceof Error) {
                handleFetchError(error, config.syncUrl);
            }
        }
    }

    /**
     * Get current encrypted state
     */
    function getBridgeState(): string {
        return currentState;
    }

    /**
     * Dispose the bridge instance
     */
    function dispose(): void {
        instances.delete(config.id);
    }

    const instance: BridgeInstance = {
        id: config.id,
        config,
        props,
        call,
        sync,
        getState: getBridgeState,
        dispose,
    };

    instances.set(config.id, instance);

    return instance;
}

/**
 * Get a bridge instance by ID
 */
export function getBridge(id: string): BridgeInstance | undefined {
    return instances.get(id);
}

/**
 * Get all bridge instances
 */
export function getAllBridges(): Map<string, BridgeInstance> {
    return new Map(instances);
}

/**
 * Create method proxies for a bridge instance
 * Returns an object where each method name maps to a function that calls the PHP method
 */
export function createMethodProxies(instance: BridgeInstance): Record<string, (...args: unknown[]) => Promise<BridgeCallResponse>> {
    const proxies: Record<string, (...args: unknown[]) => Promise<BridgeCallResponse>> = {};

    for (const methodName of instance.config.methods) {
        proxies[methodName] = (...args: unknown[]) => instance.call(methodName, ...args);
    }

    return proxies;
}

/**
 * Dispose a bridge instance
 */
export function disposeBridge(id: string): void {
    const instance = instances.get(id);
    if (instance) {
        instance.dispose();
    }
}

export default {
    create: createBridge,
    get: getBridge,
    getAll: getAllBridges,
    createMethodProxies,
    dispose: disposeBridge,
};
</file>

<file path="resources/js/core/bridge/index.ts">
/**
 * Bridge Module - Two-way binding between PHP and JavaScript
 */

export {
    createBridge,
    getBridge,
    getAllBridges,
    createMethodProxies,
    disposeBridge,
    type BridgeConfig,
    type BridgeCallResponse,
    type BridgeInstance,
} from './BridgeFactory';

export { default as BridgeFactory } from './BridgeFactory';
</file>

<file path="resources/js/core/debug/DebugManager.ts">
/**
 * DebugManager - Main debug controller for Accelade
 *
 * Provides a unified API for debugging Accelade applications.
 * Enables state inspection, time-travel debugging, and network monitoring.
 */

import { StateHistory, type StateSnapshot, type StateHistoryConfig } from './StateHistory';
import { NetworkInspector, type NetworkRecord, type NetworkInspectorConfig } from './NetworkInspector';
import type { ComponentInstance } from '../../adapters/types';

/**
 * Debug configuration
 */
export interface DebugConfig {
    enabled: boolean;
    stateHistory: Partial<StateHistoryConfig>;
    networkInspector: Partial<NetworkInspectorConfig>;
    logLevel: 'none' | 'error' | 'warn' | 'info' | 'debug';
}

/**
 * Devtools API exposed on window.Accelade.devtools
 */
export interface AcceladeDevtools {
    // State inspection
    getState(componentId?: string): Record<string, unknown> | null;
    setState(componentId: string, key: string, value: unknown): boolean;
    getComponents(): Map<string, ComponentInstance>;
    getComponent(componentId: string): ComponentInstance | undefined;

    // Time-travel debugging
    history: StateSnapshot[];
    currentHistoryIndex: number;
    goto(snapshotId: number): boolean;
    back(): boolean;
    forward(): boolean;
    canGoBack(): boolean;
    canGoForward(): boolean;
    clearHistory(): void;

    // Network inspection
    network: NetworkRecord[];
    replay(requestId: number): Promise<Response>;
    getNetworkStats(): ReturnType<NetworkInspector['getStats']>;
    clearNetwork(): void;

    // Debug utilities
    log(...args: unknown[]): void;
    warn(...args: unknown[]): void;
    error(...args: unknown[]): void;
    export(): string;
}

/**
 * DebugManager - Orchestrates all debug functionality
 */
export class DebugManager {
    private static instance: DebugManager | null = null;
    private config: DebugConfig = {
        enabled: false,
        stateHistory: { maxSnapshots: 50 },
        networkInspector: { maxRecords: 100, captureResponse: true },
        logLevel: 'warn',
    };
    private components: Map<string, ComponentInstance> = new Map();
    private stateHistory: StateHistory;
    private networkInspector: NetworkInspector;

    private constructor() {
        this.stateHistory = StateHistory.getInstance();
        this.networkInspector = NetworkInspector.getInstance();
    }

    /**
     * Get singleton instance
     */
    static getInstance(): DebugManager {
        if (!DebugManager.instance) {
            DebugManager.instance = new DebugManager();
        }
        return DebugManager.instance;
    }

    /**
     * Initialize debug manager
     */
    init(config?: Partial<DebugConfig>): void {
        if (config) {
            this.configure(config);
        }

        // Setup window.Accelade.devtools if enabled
        if (this.config.enabled && typeof window !== 'undefined') {
            this.exposeDevtools();
        }
    }

    /**
     * Configure debug settings
     */
    configure(config: Partial<DebugConfig>): void {
        this.config = { ...this.config, ...config };

        // Apply to sub-systems
        this.stateHistory.configure({
            ...this.config.stateHistory,
            enabled: this.config.enabled,
        });

        this.networkInspector.configure({
            ...this.config.networkInspector,
            enabled: this.config.enabled,
        });
    }

    /**
     * Enable/disable debug mode
     */
    setEnabled(enabled: boolean): void {
        this.config.enabled = enabled;
        this.stateHistory.setEnabled(enabled);
        this.networkInspector.setEnabled(enabled);

        if (enabled && typeof window !== 'undefined') {
            this.exposeDevtools();
            this.log('Debug mode enabled');
        } else {
            this.log('Debug mode disabled');
        }
    }

    /**
     * Check if debug mode is enabled
     */
    isEnabled(): boolean {
        return this.config.enabled;
    }

    /**
     * Register a component
     */
    registerComponent(instance: ComponentInstance): void {
        this.components.set(instance.id, instance);

        // Register state setter for time-travel
        if (instance.stateAdapter) {
            this.stateHistory.registerStateSetter(instance.id, (state) => {
                if (instance.stateAdapter) {
                    for (const [key, value] of Object.entries(state)) {
                        instance.stateAdapter.set(key, value);
                    }
                }
            });
        }
    }

    /**
     * Unregister a component
     */
    unregisterComponent(componentId: string): void {
        this.components.delete(componentId);
    }

    /**
     * Get all registered components
     */
    getComponents(): Map<string, ComponentInstance> {
        return new Map(this.components);
    }

    /**
     * Get a specific component
     */
    getComponent(componentId: string): ComponentInstance | undefined {
        return this.components.get(componentId);
    }

    /**
     * Get state from a component
     */
    getState(componentId?: string): Record<string, unknown> | null {
        if (componentId) {
            const component = this.components.get(componentId);
            return component?.stateAdapter?.getState() ?? null;
        }

        // Return all component states
        const allStates: Record<string, Record<string, unknown>> = {};
        for (const [id, component] of this.components) {
            const state = component.stateAdapter?.getState();
            if (state) {
                allStates[id] = state;
            }
        }
        return allStates;
    }

    /**
     * Set state on a component
     */
    setState(componentId: string, key: string, value: unknown): boolean {
        const component = this.components.get(componentId);
        if (!component?.stateAdapter) return false;

        component.stateAdapter.set(key, value);
        return true;
    }

    /**
     * Record a state change (called by adapters)
     */
    recordStateChange(
        componentId: string,
        key: string,
        oldValue: unknown,
        newValue: unknown,
        currentState: Record<string, unknown>
    ): void {
        this.stateHistory.record(componentId, key, oldValue, newValue, currentState);
    }

    /**
     * Get state history instance
     */
    getStateHistory(): StateHistory {
        return this.stateHistory;
    }

    /**
     * Get network inspector instance
     */
    getNetworkInspector(): NetworkInspector {
        return this.networkInspector;
    }

    /**
     * Log a debug message
     */
    log(...args: unknown[]): void {
        if (this.config.logLevel === 'debug' || this.config.logLevel === 'info') {
            console.log('[Accelade]', ...args);
        }
    }

    /**
     * Log a warning
     */
    warn(...args: unknown[]): void {
        if (this.config.logLevel !== 'none' && this.config.logLevel !== 'error') {
            console.warn('[Accelade]', ...args);
        }
    }

    /**
     * Log an error
     */
    error(...args: unknown[]): void {
        if (this.config.logLevel !== 'none') {
            console.error('[Accelade]', ...args);
        }
    }

    /**
     * Export all debug data
     */
    export(): string {
        const data = {
            components: Array.from(this.components.entries()).map(([id, c]) => ({
                id,
                state: c.stateAdapter?.getState() ?? {},
            })),
            stateHistory: JSON.parse(this.stateHistory.export()),
            networkInspector: JSON.parse(this.networkInspector.export()),
            config: this.config,
            timestamp: new Date().toISOString(),
        };

        return JSON.stringify(data, null, 2);
    }

    /**
     * Expose devtools on window.Accelade
     */
    private exposeDevtools(): void {
        const manager = this;

        const devtools: AcceladeDevtools = {
            // State inspection
            getState: (componentId?: string) => manager.getState(componentId),
            setState: (componentId: string, key: string, value: unknown) =>
                manager.setState(componentId, key, value),
            getComponents: () => manager.getComponents(),
            getComponent: (componentId: string) => manager.getComponent(componentId),

            // Time-travel (getters for reactive properties)
            get history() {
                return manager.stateHistory.getSnapshots();
            },
            get currentHistoryIndex() {
                return manager.stateHistory.getCurrentIndex();
            },
            goto: (snapshotId: number) => manager.stateHistory.goto(snapshotId),
            back: () => manager.stateHistory.back(),
            forward: () => manager.stateHistory.forward(),
            canGoBack: () => manager.stateHistory.canGoBack(),
            canGoForward: () => manager.stateHistory.canGoForward(),
            clearHistory: () => manager.stateHistory.clear(),

            // Network inspection
            get network() {
                return manager.networkInspector.getRecords();
            },
            replay: (requestId: number) => manager.networkInspector.replay(requestId),
            getNetworkStats: () => manager.networkInspector.getStats(),
            clearNetwork: () => manager.networkInspector.clear(),

            // Debug utilities
            log: (...args: unknown[]) => manager.log(...args),
            warn: (...args: unknown[]) => manager.warn(...args),
            error: (...args: unknown[]) => manager.error(...args),
            export: () => manager.export(),
        };

        // Attach to window.Accelade
        if (typeof window !== 'undefined') {
            const accelade = (window as unknown as Record<string, unknown>).Accelade as
                | Record<string, unknown>
                | undefined;

            if (accelade) {
                accelade.devtools = devtools;
                accelade.debug = true;
            }
        }
    }
}

export default DebugManager;
</file>

<file path="resources/js/core/debug/index.ts">
/**
 * Debug System Exports
 */

export {
    StateHistory,
    type StateSnapshot,
    type StateHistoryConfig,
} from './StateHistory';

export {
    NetworkInspector,
    type NetworkRecord,
    type NetworkInspectorConfig,
} from './NetworkInspector';

export {
    DebugManager,
    type DebugConfig,
    type AcceladeDevtools,
} from './DebugManager';

// Default export is DebugManager
export { DebugManager as default } from './DebugManager';
</file>

<file path="resources/js/core/debug/NetworkInspector.ts">
/**
 * NetworkInspector - Network request tracking for Accelade
 *
 * Tracks all sync requests and allows replay for debugging.
 */

/**
 * Network request record
 */
export interface NetworkRecord {
    id: number;
    timestamp: number;
    url: string;
    method: string;
    headers: Record<string, string>;
    payload: unknown;
    status: number | null;
    statusText: string | null;
    response: unknown;
    duration: number | null;
    error: string | null;
    componentId: string | null;
    property: string | null;
}

/**
 * Network inspector configuration
 */
export interface NetworkInspectorConfig {
    maxRecords: number;
    enabled: boolean;
    captureResponse: boolean;
}

/**
 * Request start data
 */
interface PendingRequest {
    startTime: number;
    record: NetworkRecord;
}

/**
 * NetworkInspector - Tracks network requests for debugging
 */
export class NetworkInspector {
    private static instance: NetworkInspector | null = null;
    private records: NetworkRecord[] = [];
    private pendingRequests: Map<number, PendingRequest> = new Map();
    private recordCounter = 0;
    private config: NetworkInspectorConfig = {
        maxRecords: 100,
        enabled: false,
        captureResponse: true,
    };
    private listeners: Set<(records: NetworkRecord[]) => void> = new Set();

    /**
     * Get singleton instance
     */
    static getInstance(): NetworkInspector {
        if (!NetworkInspector.instance) {
            NetworkInspector.instance = new NetworkInspector();
        }
        return NetworkInspector.instance;
    }

    /**
     * Configure inspector settings
     */
    configure(config: Partial<NetworkInspectorConfig>): void {
        this.config = { ...this.config, ...config };

        // Trim records if max reduced
        if (this.records.length > this.config.maxRecords) {
            const trimCount = this.records.length - this.config.maxRecords;
            this.records = this.records.slice(trimCount);
        }
    }

    /**
     * Enable/disable inspector
     */
    setEnabled(enabled: boolean): void {
        this.config.enabled = enabled;
    }

    /**
     * Check if enabled
     */
    isEnabled(): boolean {
        return this.config.enabled;
    }

    /**
     * Start tracking a request
     */
    startRequest(
        url: string,
        method: string,
        headers: Record<string, string>,
        payload: unknown,
        componentId?: string,
        property?: string
    ): number {
        const id = ++this.recordCounter;

        const record: NetworkRecord = {
            id,
            timestamp: Date.now(),
            url,
            method,
            headers: { ...headers },
            payload,
            status: null,
            statusText: null,
            response: null,
            duration: null,
            error: null,
            componentId: componentId ?? null,
            property: property ?? null,
        };

        this.pendingRequests.set(id, {
            startTime: performance.now(),
            record,
        });

        return id;
    }

    /**
     * Complete a request successfully
     */
    completeRequest(
        requestId: number,
        status: number,
        statusText: string,
        response: unknown
    ): void {
        const pending = this.pendingRequests.get(requestId);
        if (!pending) return;

        const { startTime, record } = pending;

        record.status = status;
        record.statusText = statusText;
        record.response = this.config.captureResponse ? response : '[response not captured]';
        record.duration = performance.now() - startTime;

        this.addRecord(record);
        this.pendingRequests.delete(requestId);
    }

    /**
     * Fail a request
     */
    failRequest(requestId: number, error: string): void {
        const pending = this.pendingRequests.get(requestId);
        if (!pending) return;

        const { startTime, record } = pending;

        record.status = 0;
        record.error = error;
        record.duration = performance.now() - startTime;

        this.addRecord(record);
        this.pendingRequests.delete(requestId);
    }

    /**
     * Add a completed record
     */
    private addRecord(record: NetworkRecord): void {
        if (!this.config.enabled) return;

        this.records.push(record);

        // Enforce max records
        if (this.records.length > this.config.maxRecords) {
            this.records.shift();
        }

        this.notifyListeners();
    }

    /**
     * Replay a request
     */
    async replay(requestId: number): Promise<Response> {
        const record = this.records.find((r) => r.id === requestId);
        if (!record) {
            throw new Error(`Network record ${requestId} not found`);
        }

        const newRequestId = this.startRequest(
            record.url,
            record.method,
            record.headers,
            record.payload,
            record.componentId ?? undefined,
            record.property ?? undefined
        );

        try {
            const response = await fetch(record.url, {
                method: record.method,
                headers: record.headers,
                body: record.payload ? JSON.stringify(record.payload) : undefined,
            });

            const responseData = await response.clone().json().catch(() => null);

            this.completeRequest(
                newRequestId,
                response.status,
                response.statusText,
                responseData
            );

            return response;
        } catch (e) {
            this.failRequest(newRequestId, String(e));
            throw e;
        }
    }

    /**
     * Get all records
     */
    getRecords(): NetworkRecord[] {
        return [...this.records];
    }

    /**
     * Get record by ID
     */
    getRecord(id: number): NetworkRecord | null {
        return this.records.find((r) => r.id === id) ?? null;
    }

    /**
     * Get records for a component
     */
    getComponentRecords(componentId: string): NetworkRecord[] {
        return this.records.filter((r) => r.componentId === componentId);
    }

    /**
     * Get failed requests
     */
    getFailedRequests(): NetworkRecord[] {
        return this.records.filter((r) => r.error !== null || (r.status && r.status >= 400));
    }

    /**
     * Get pending requests
     */
    getPendingRequests(): NetworkRecord[] {
        return Array.from(this.pendingRequests.values()).map((p) => p.record);
    }

    /**
     * Clear all records
     */
    clear(): void {
        this.records = [];
        this.notifyListeners();
    }

    /**
     * Subscribe to record changes
     */
    subscribe(callback: (records: NetworkRecord[]) => void): () => void {
        this.listeners.add(callback);
        return () => {
            this.listeners.delete(callback);
        };
    }

    /**
     * Notify listeners of changes
     */
    private notifyListeners(): void {
        const records = this.getRecords();
        for (const listener of this.listeners) {
            listener(records);
        }
    }

    /**
     * Get statistics
     */
    getStats(): {
        total: number;
        successful: number;
        failed: number;
        pending: number;
        averageDuration: number;
    } {
        const completed = this.records.filter((r) => r.duration !== null);
        const successful = this.records.filter(
            (r) => r.status !== null && r.status >= 200 && r.status < 400
        );
        const failed = this.records.filter(
            (r) => r.error !== null || (r.status !== null && r.status >= 400)
        );

        const totalDuration = completed.reduce((sum, r) => sum + (r.duration ?? 0), 0);
        const averageDuration = completed.length > 0 ? totalDuration / completed.length : 0;

        return {
            total: this.records.length,
            successful: successful.length,
            failed: failed.length,
            pending: this.pendingRequests.size,
            averageDuration: Math.round(averageDuration * 100) / 100,
        };
    }

    /**
     * Export records for debugging
     */
    export(): string {
        return JSON.stringify(
            {
                records: this.records,
                stats: this.getStats(),
                config: this.config,
            },
            null,
            2
        );
    }
}

export default NetworkInspector;
</file>

<file path="resources/js/core/debug/StateHistory.ts">
/**
 * StateHistory - Time-travel debugging for Accelade
 *
 * Records state snapshots and allows navigating back/forward through history.
 */

/**
 * State snapshot
 */
export interface StateSnapshot {
    id: number;
    timestamp: number;
    componentId: string;
    key: string;
    oldValue: unknown;
    newValue: unknown;
    state: Record<string, unknown>;
}

/**
 * State history configuration
 */
export interface StateHistoryConfig {
    maxSnapshots: number;
    enabled: boolean;
}

/**
 * StateHistory - Manages state snapshots for time-travel debugging
 */
export class StateHistory {
    private static instance: StateHistory | null = null;
    private snapshots: StateSnapshot[] = [];
    private currentIndex = -1;
    private snapshotCounter = 0;
    private config: StateHistoryConfig = {
        maxSnapshots: 50,
        enabled: false,
    };
    private listeners: Set<(snapshots: StateSnapshot[], currentIndex: number) => void> = new Set();
    private stateSetters: Map<string, (state: Record<string, unknown>) => void> = new Map();

    /**
     * Get singleton instance
     */
    static getInstance(): StateHistory {
        if (!StateHistory.instance) {
            StateHistory.instance = new StateHistory();
        }
        return StateHistory.instance;
    }

    /**
     * Configure history settings
     */
    configure(config: Partial<StateHistoryConfig>): void {
        this.config = { ...this.config, ...config };

        // Trim snapshots if max reduced
        if (this.snapshots.length > this.config.maxSnapshots) {
            const trimCount = this.snapshots.length - this.config.maxSnapshots;
            this.snapshots = this.snapshots.slice(trimCount);
            this.currentIndex = Math.max(0, this.currentIndex - trimCount);
        }
    }

    /**
     * Enable/disable history recording
     */
    setEnabled(enabled: boolean): void {
        this.config.enabled = enabled;
    }

    /**
     * Check if enabled
     */
    isEnabled(): boolean {
        return this.config.enabled;
    }

    /**
     * Register a state setter for a component
     */
    registerStateSetter(
        componentId: string,
        setter: (state: Record<string, unknown>) => void
    ): () => void {
        this.stateSetters.set(componentId, setter);
        return () => {
            this.stateSetters.delete(componentId);
        };
    }

    /**
     * Record a state change
     */
    record(
        componentId: string,
        key: string,
        oldValue: unknown,
        newValue: unknown,
        currentState: Record<string, unknown>
    ): void {
        if (!this.config.enabled) return;

        // If we're not at the end, truncate future history
        if (this.currentIndex < this.snapshots.length - 1) {
            this.snapshots = this.snapshots.slice(0, this.currentIndex + 1);
        }

        const snapshot: StateSnapshot = {
            id: ++this.snapshotCounter,
            timestamp: Date.now(),
            componentId,
            key,
            oldValue,
            newValue,
            state: { ...currentState },
        };

        this.snapshots.push(snapshot);
        this.currentIndex = this.snapshots.length - 1;

        // Enforce max snapshots
        if (this.snapshots.length > this.config.maxSnapshots) {
            this.snapshots.shift();
            this.currentIndex--;
        }

        this.notifyListeners();
    }

    /**
     * Go to a specific snapshot
     */
    goto(snapshotId: number): boolean {
        const index = this.snapshots.findIndex((s) => s.id === snapshotId);
        if (index === -1) return false;

        return this.gotoIndex(index);
    }

    /**
     * Go to a specific index
     */
    gotoIndex(index: number): boolean {
        if (index < 0 || index >= this.snapshots.length) return false;

        const snapshot = this.snapshots[index];
        const setter = this.stateSetters.get(snapshot.componentId);

        if (setter) {
            setter(snapshot.state);
            this.currentIndex = index;
            this.notifyListeners();
            return true;
        }

        return false;
    }

    /**
     * Go back one step
     */
    back(): boolean {
        if (this.currentIndex <= 0) return false;

        const prevIndex = this.currentIndex - 1;
        const snapshot = this.snapshots[prevIndex];
        const setter = this.stateSetters.get(snapshot.componentId);

        if (setter) {
            setter(snapshot.state);
            this.currentIndex = prevIndex;
            this.notifyListeners();
            return true;
        }

        return false;
    }

    /**
     * Go forward one step
     */
    forward(): boolean {
        if (this.currentIndex >= this.snapshots.length - 1) return false;

        const nextIndex = this.currentIndex + 1;
        const snapshot = this.snapshots[nextIndex];
        const setter = this.stateSetters.get(snapshot.componentId);

        if (setter) {
            setter(snapshot.state);
            this.currentIndex = nextIndex;
            this.notifyListeners();
            return true;
        }

        return false;
    }

    /**
     * Get all snapshots
     */
    getSnapshots(): StateSnapshot[] {
        return [...this.snapshots];
    }

    /**
     * Get current index
     */
    getCurrentIndex(): number {
        return this.currentIndex;
    }

    /**
     * Get current snapshot
     */
    getCurrentSnapshot(): StateSnapshot | null {
        return this.snapshots[this.currentIndex] ?? null;
    }

    /**
     * Check if can go back
     */
    canGoBack(): boolean {
        return this.currentIndex > 0;
    }

    /**
     * Check if can go forward
     */
    canGoForward(): boolean {
        return this.currentIndex < this.snapshots.length - 1;
    }

    /**
     * Clear all history
     */
    clear(): void {
        this.snapshots = [];
        this.currentIndex = -1;
        this.notifyListeners();
    }

    /**
     * Subscribe to history changes
     */
    subscribe(
        callback: (snapshots: StateSnapshot[], currentIndex: number) => void
    ): () => void {
        this.listeners.add(callback);
        return () => {
            this.listeners.delete(callback);
        };
    }

    /**
     * Notify listeners of changes
     */
    private notifyListeners(): void {
        const snapshots = this.getSnapshots();
        const currentIndex = this.currentIndex;

        for (const listener of this.listeners) {
            listener(snapshots, currentIndex);
        }
    }

    /**
     * Export history for debugging
     */
    export(): string {
        return JSON.stringify(
            {
                snapshots: this.snapshots,
                currentIndex: this.currentIndex,
                config: this.config,
            },
            null,
            2
        );
    }

    /**
     * Import history from export
     */
    import(data: string): void {
        try {
            const parsed = JSON.parse(data) as {
                snapshots: StateSnapshot[];
                currentIndex: number;
                config: StateHistoryConfig;
            };

            this.snapshots = parsed.snapshots;
            this.currentIndex = parsed.currentIndex;
            this.config = { ...this.config, ...parsed.config };
            this.notifyListeners();
        } catch (e) {
            console.error('StateHistory: Failed to import data', e);
        }
    }
}

export default StateHistory;
</file>

<file path="resources/js/core/echo/EchoFactory.ts">
/**
 * EchoFactory - Factory for creating Echo event listeners per component
 *
 * Handles parsing component config, setting up channel subscriptions,
 * processing event actions (redirect, refresh, toast), and cleanup.
 */

import { getEchoManager } from './EchoManager';
import type {
    EchoConfig,
    EchoEvent,
    EchoAction,
    AcceladeEventPayload,
    ChannelType,
} from './types';
import type { IStateAdapter } from '../../adapters/types';

/**
 * Echo instance info for a component
 */
export interface EchoInstance {
    componentId: string;
    config: EchoConfig;
    stateAdapter: IStateAdapter;
    unsubscribe: () => void;
}

/**
 * Parse Echo configuration from DOM element
 */
export function parseEchoConfig(element: HTMLElement): EchoConfig | null {
    const channel = element.getAttribute('data-echo-channel');
    if (!channel) {
        return null;
    }

    const isPrivate = element.getAttribute('data-echo-private') === 'true';
    const isPresence = element.getAttribute('data-echo-presence') === 'true';

    let channelType: ChannelType = 'public';
    if (isPresence) {
        channelType = 'presence';
    } else if (isPrivate) {
        channelType = 'private';
    }

    return {
        channel,
        channelType,
        listen: element.getAttribute('data-echo-listen') || '',
        preserveScroll: element.getAttribute('data-echo-preserve-scroll') === 'true',
    };
}

/**
 * Create an Echo listener for a component
 */
export function createEchoInstance(
    componentId: string,
    element: HTMLElement,
    stateAdapter: IStateAdapter
): EchoInstance | null {
    const config = parseEchoConfig(element);
    if (!config) {
        return null;
    }

    const manager = getEchoManager();
    if (!manager.isAvailable()) {
        // Update state to indicate not subscribed
        stateAdapter.set('subscribed', false);
        return null;
    }

    // Parse event names
    const events = config.listen
        .split(',')
        .map(e => e.trim())
        .filter(e => e.length > 0);

    if (events.length === 0) {
        console.warn('[Accelade] No events specified for Echo component');
        stateAdapter.set('subscribed', false);
        return null;
    }

    // Create event handler
    const handleEvent = (data: unknown, eventName: string) => {
        const payload = data as AcceladeEventPayload;

        // Add event to state
        const currentEvents = (stateAdapter.get('events') as EchoEvent[]) || [];
        const newEvent: EchoEvent = {
            name: eventName,
            data: payload as Record<string, unknown>,
            timestamp: Date.now(),
        };
        stateAdapter.set('events', [...currentEvents, newEvent]);

        // Process Accelade action if present
        if (payload._accelade) {
            processAction(payload._accelade, config);
        }

        // Dispatch custom event for advanced usage
        element.dispatchEvent(
            new CustomEvent('accelade:echo', {
                detail: { name: eventName, data: payload },
                bubbles: true,
            })
        );
    };

    // Subscribe to channel
    const unsubscribe = manager.subscribe(
        config.channel,
        config.channelType,
        events,
        handleEvent
    );

    // Update state to subscribed
    stateAdapter.set('subscribed', true);

    return {
        componentId,
        config,
        stateAdapter,
        unsubscribe,
    };
}

/**
 * Process an Accelade action from event payload
 */
function processAction(action: EchoAction, config: EchoConfig): void {
    switch (action.action) {
        case 'redirect':
            if (action.url) {
                // Use Accelade router if available, otherwise direct navigation
                if (typeof window !== 'undefined' && (window as any).Accelade?.router?.navigate) {
                    (window as any).Accelade.router.navigate(action.url);
                } else {
                    window.location.href = action.url;
                }
            }
            break;

        case 'refresh':
            if (config.preserveScroll) {
                // Store scroll position
                const scrollPos = { x: window.scrollX, y: window.scrollY };
                sessionStorage.setItem('accelade:scroll', JSON.stringify(scrollPos));
            }

            // Use Accelade router reload if available
            if (typeof window !== 'undefined' && (window as any).Accelade?.router?.instance) {
                const router = (window as any).Accelade.router.instance();
                if (router && typeof router.reload === 'function') {
                    router.reload();
                    restoreScrollIfNeeded(config);
                    return;
                }
            }

            // Fallback to standard reload
            window.location.reload();
            break;

        case 'toast':
            if (typeof window !== 'undefined' && (window as any).Accelade?.notify) {
                const notify = (window as any).Accelade.notify;
                const type = action.type || 'info';
                const title = action.title || action.message || '';
                const body = action.title ? (action.message || '') : '';

                switch (type) {
                    case 'success':
                        notify.success(title, body);
                        break;
                    case 'warning':
                        notify.warning(title, body);
                        break;
                    case 'danger':
                        notify.danger(title, body);
                        break;
                    case 'info':
                    default:
                        notify.info(title, body);
                        break;
                }
            }
            break;
    }
}

/**
 * Restore scroll position if preserve-scroll was enabled
 */
function restoreScrollIfNeeded(config: EchoConfig): void {
    if (!config.preserveScroll) return;

    // Try to restore after a short delay (after page update)
    setTimeout(() => {
        const stored = sessionStorage.getItem('accelade:scroll');
        if (stored) {
            try {
                const { x, y } = JSON.parse(stored);
                window.scrollTo(x, y);
            } catch (e) {
                // Ignore parse errors
            }
            sessionStorage.removeItem('accelade:scroll');
        }
    }, 100);
}

/**
 * Cleanup an Echo instance
 */
export function disposeEchoInstance(instance: EchoInstance): void {
    instance.unsubscribe();
    instance.stateAdapter.set('subscribed', false);
}

export const EchoFactory = {
    parseConfig: parseEchoConfig,
    create: createEchoInstance,
    dispose: disposeEchoInstance,
};
</file>

<file path="resources/js/core/echo/EchoManager.ts">
/**
 * EchoManager - Singleton manager for Laravel Echo connections
 *
 * Handles channel subscriptions, event listening, and cleanup.
 * Gracefully degrades if Laravel Echo is not available.
 */

import type {
    EchoInstance,
    EchoChannel,
    ChannelType,
    EchoSubscription,
} from './types';

/**
 * Callback function type for event listeners
 */
type EventCallback = (data: unknown, eventName: string) => void;

/**
 * Subscription entry for tracking
 */
interface SubscriptionEntry {
    channel: EchoChannel;
    type: ChannelType;
    listeners: Map<string, Set<EventCallback>>;
    refCount: number;
}

/**
 * EchoManager - Manages Laravel Echo channel subscriptions
 */
class EchoManager {
    private static instance: EchoManager | null = null;
    private echo: EchoInstance | null = null;
    private subscriptions: Map<string, SubscriptionEntry> = new Map();
    private initialized: boolean = false;

    private constructor() {
        // Private constructor for singleton
    }

    /**
     * Get the singleton instance
     */
    public static getInstance(): EchoManager {
        if (!EchoManager.instance) {
            EchoManager.instance = new EchoManager();
        }
        return EchoManager.instance;
    }

    /**
     * Initialize the manager with Laravel Echo
     * @returns true if Echo is available and initialized
     */
    public init(): boolean {
        if (this.initialized) {
            return this.echo !== null;
        }

        this.initialized = true;

        if (typeof window !== 'undefined' && window.Echo) {
            this.echo = window.Echo;
            return true;
        }

        console.warn(
            '[Accelade] Laravel Echo not found. Event component will not function. ' +
            'Make sure Laravel Echo is configured and window.Echo is available.'
        );
        return false;
    }

    /**
     * Check if Echo is available
     */
    public isAvailable(): boolean {
        if (!this.initialized) {
            this.init();
        }
        return this.echo !== null;
    }

    /**
     * Subscribe to a channel and listen for events
     * @param channelName The channel name
     * @param channelType The channel type (public, private, presence)
     * @param events Array of event names to listen for
     * @param callback Function to call when events are received
     * @returns Unsubscribe function
     */
    public subscribe(
        channelName: string,
        channelType: ChannelType,
        events: string[],
        callback: EventCallback
    ): () => void {
        if (!this.isAvailable() || !this.echo) {
            return () => {}; // No-op if Echo not available
        }

        const channelKey = this.getChannelKey(channelName, channelType);
        let entry = this.subscriptions.get(channelKey);

        // Create new subscription if needed
        if (!entry) {
            const channel = this.getChannel(channelName, channelType);
            entry = {
                channel,
                type: channelType,
                listeners: new Map(),
                refCount: 0,
            };
            this.subscriptions.set(channelKey, entry);
        }

        entry.refCount++;

        // Setup listeners for each event
        for (const eventName of events) {
            if (!entry.listeners.has(eventName)) {
                entry.listeners.set(eventName, new Set());

                // Setup the actual Echo listener
                entry.channel.listen(eventName, (data: unknown) => {
                    const callbacks = entry!.listeners.get(eventName);
                    if (callbacks) {
                        callbacks.forEach(cb => cb(data, eventName));
                    }
                });
            }

            entry.listeners.get(eventName)!.add(callback);
        }

        // Return unsubscribe function
        return () => {
            this.unsubscribe(channelKey, events, callback);
        };
    }

    /**
     * Unsubscribe from specific events on a channel
     */
    private unsubscribe(
        channelKey: string,
        events: string[],
        callback: EventCallback
    ): void {
        const entry = this.subscriptions.get(channelKey);
        if (!entry) return;

        // Remove callback from each event
        for (const eventName of events) {
            const callbacks = entry.listeners.get(eventName);
            if (callbacks) {
                callbacks.delete(callback);

                // If no more callbacks, stop listening to this event
                if (callbacks.size === 0) {
                    entry.channel.stopListening(eventName);
                    entry.listeners.delete(eventName);
                }
            }
        }

        entry.refCount--;

        // Leave channel if no more references
        if (entry.refCount <= 0) {
            this.leaveChannel(channelKey, entry.type);
            this.subscriptions.delete(channelKey);
        }
    }

    /**
     * Get or create a channel
     */
    private getChannel(name: string, type: ChannelType): EchoChannel {
        if (!this.echo) {
            throw new Error('Echo not initialized');
        }

        switch (type) {
            case 'private':
                return this.echo.private(name);
            case 'presence':
                return this.echo.join(name);
            case 'public':
            default:
                return this.echo.channel(name);
        }
    }

    /**
     * Leave a channel
     */
    private leaveChannel(channelKey: string, type: ChannelType): void {
        if (!this.echo) return;

        // Extract channel name from key
        const name = channelKey.replace(/^(public|private|presence):/, '');

        try {
            if (type === 'presence') {
                this.echo.leave(name);
            } else {
                this.echo.leaveChannel(
                    type === 'private' ? `private-${name}` : name
                );
            }
        } catch (error) {
            console.warn('[Accelade] Error leaving channel:', error);
        }
    }

    /**
     * Generate a unique key for a channel
     */
    private getChannelKey(name: string, type: ChannelType): string {
        return `${type}:${name}`;
    }

    /**
     * Get subscription count (for debugging)
     */
    public getSubscriptionCount(): number {
        return this.subscriptions.size;
    }

    /**
     * Cleanup all subscriptions
     */
    public cleanup(): void {
        for (const [key, entry] of this.subscriptions) {
            this.leaveChannel(key, entry.type);
        }
        this.subscriptions.clear();
    }
}

// Export singleton getter
export const getEchoManager = (): EchoManager => EchoManager.getInstance();

export { EchoManager };
</file>

<file path="resources/js/core/echo/index.ts">
/**
 * Echo Module - Laravel Echo integration for Accelade
 */

export * from './types';
export * from './EchoManager';
export * from './EchoFactory';
</file>

<file path="resources/js/core/echo/types.ts">
/**
 * Echo Types - TypeScript definitions for Laravel Echo integration
 */

/**
 * Channel types supported by Laravel Echo
 */
export type ChannelType = 'public' | 'private' | 'presence';

/**
 * Action types that can be triggered by broadcast events
 */
export type EchoActionType = 'redirect' | 'refresh' | 'toast';

/**
 * Configuration for the Event component
 */
export interface EchoConfig {
    /** The channel name to subscribe to */
    channel: string;
    /** Channel type: public, private, or presence */
    channelType: ChannelType;
    /** Comma-separated list of event names to listen for */
    listen: string;
    /** Whether to preserve scroll position on refresh */
    preserveScroll: boolean;
}

/**
 * Captured event data stored in component state
 */
export interface EchoEvent {
    /** The event name that was received */
    name: string;
    /** The event payload data */
    data: Record<string, unknown>;
    /** Timestamp when the event was received */
    timestamp: number;
}

/**
 * Action payload embedded in broadcast event data
 */
export interface EchoAction {
    /** The action type to execute */
    action: EchoActionType;
    /** URL for redirect action */
    url?: string;
    /** Toast message for toast action */
    message?: string;
    /** Toast type (success, info, warning, danger) */
    type?: 'success' | 'info' | 'warning' | 'danger';
    /** Toast title */
    title?: string;
}

/**
 * Accelade-specific payload in broadcast events
 */
export interface AcceladeEventPayload {
    _accelade?: EchoAction;
    [key: string]: unknown;
}

/**
 * Component state for the Event component
 */
export interface EchoComponentState {
    /** Whether the component is subscribed to the channel */
    subscribed: boolean;
    /** Array of captured events */
    events: EchoEvent[];
}

/**
 * Laravel Echo Channel interface (minimal)
 */
export interface EchoChannel {
    listen(event: string, callback: (data: unknown) => void): EchoChannel;
    stopListening(event: string): EchoChannel;
}

/**
 * Laravel Echo instance interface (minimal)
 */
export interface EchoInstance {
    channel(name: string): EchoChannel;
    private(name: string): EchoChannel;
    join(name: string): EchoChannel;
    leave(name: string): void;
    leaveChannel(name: string): void;
}

/**
 * Subscription info for tracking active subscriptions
 */
export interface EchoSubscription {
    /** The channel instance */
    channel: EchoChannel;
    /** Channel type */
    type: ChannelType;
    /** Events being listened to */
    events: string[];
    /** Cleanup function to unsubscribe */
    unsubscribe: () => void;
}

/**
 * Echo instance stored on callback for cleanup
 */
export interface EchoInstanceInfo {
    componentId: string;
    channel: string;
    channelType: ChannelType;
    events: string[];
    stateAdapter: unknown;
    preserveScroll: boolean;
}

declare global {
    interface Window {
        Echo?: EchoInstance;
    }
}
</file>

<file path="resources/js/core/errors/ErrorHandler.ts">
/**
 * ErrorHandler - Client-side error handling for Accelade
 *
 * Provides graceful error handling for AJAX responses and component errors.
 * Can show toast notifications, log errors, and handle special actions like
 * refresh or redirect based on server response.
 */

/**
 * Error configuration from server
 */
export interface ErrorConfig {
    suppressErrors: boolean;
    showToasts: boolean;
    logErrors: boolean;
    debug: boolean;
}

/**
 * Accelade error response structure
 */
export interface AcceladeErrorResponse {
    success: boolean;
    message?: string;
    errors?: Record<string, string[]>;
    _accelade?: {
        type?: 'validation' | 'http' | 'exception';
        status?: number;
        action?: 'refresh' | 'redirect';
        url?: string;
        toast?: {
            type: 'success' | 'info' | 'warning' | 'danger';
            title: string;
            body?: string;
        };
        debug?: {
            exception?: string;
            message?: string;
            file?: string;
            line?: number;
            trace?: Array<{
                file?: string;
                line?: number;
                function?: string;
                class?: string;
            }>;
        };
    };
}

/**
 * Default error configuration
 */
let config: ErrorConfig = {
    suppressErrors: true,
    showToasts: true,
    logErrors: true,
    debug: false,
};

/**
 * Initialize error handler with configuration
 */
export function init(errorConfig?: Partial<ErrorConfig>): void {
    if (errorConfig) {
        config = { ...config, ...errorConfig };
    }

    // Setup global error handlers if suppressing errors
    if (config.suppressErrors) {
        setupGlobalHandlers();
    }
}

/**
 * Get current configuration
 */
export function getConfig(): ErrorConfig {
    return { ...config };
}

/**
 * Setup global error handlers
 */
function setupGlobalHandlers(): void {
    // Handle unhandled promise rejections
    window.addEventListener('unhandledrejection', (event) => {
        if (config.suppressErrors) {
            event.preventDefault();
            handleError(event.reason, 'Unhandled Promise Rejection');
        }
    });

    // Handle runtime errors
    window.addEventListener('error', (event) => {
        if (config.suppressErrors) {
            // Only suppress Accelade-related errors
            const message = event.message || '';
            if (message.includes('Accelade') || message.includes('accelade')) {
                event.preventDefault();
                handleError(event.error || new Error(message), 'Runtime Error');
            }
        }
    });
}

/**
 * Handle an error
 */
export function handleError(error: unknown, context?: string): void {
    // Log to console if enabled
    if (config.logErrors) {
        const prefix = context ? `[Accelade ${context}]` : '[Accelade Error]';
        console.error(prefix, error);
    }

    // Show toast if enabled and notifications available
    if (config.showToasts) {
        const message = error instanceof Error ? error.message : String(error);
        showErrorToast('Error', message);
    }
}

/**
 * Handle an AJAX error response
 */
export function handleAjaxError(response: AcceladeErrorResponse, statusCode?: number): void {
    const accelade = response._accelade;

    // Log error if enabled
    if (config.logErrors) {
        console.error('[Accelade AJAX Error]', {
            status: statusCode,
            message: response.message,
            type: accelade?.type,
            debug: accelade?.debug,
        });
    }

    // Handle special actions
    if (accelade?.action === 'refresh') {
        // Refresh the page
        window.location.reload();
        return;
    }

    if (accelade?.action === 'redirect' && accelade.url) {
        // Redirect to URL
        window.location.href = accelade.url;
        return;
    }

    // Show toast notification
    if (config.showToasts && accelade?.toast) {
        showToast(
            accelade.toast.type,
            accelade.toast.title,
            accelade.toast.body
        );
    } else if (config.showToasts && response.message) {
        // Fallback toast
        showErrorToast('Error', response.message);
    }

    // Log debug info in development
    if (config.debug && accelade?.debug) {
        console.group('[Accelade Debug Info]');
        console.log('Exception:', accelade.debug.exception);
        console.log('Message:', accelade.debug.message);
        console.log('File:', accelade.debug.file);
        console.log('Line:', accelade.debug.line);
        if (accelade.debug.trace) {
            console.log('Trace:', accelade.debug.trace);
        }
        console.groupEnd();
    }
}

/**
 * Handle a fetch error (network error, timeout, etc.)
 */
export function handleFetchError(error: Error, url?: string): void {
    if (config.logErrors) {
        console.error('[Accelade Fetch Error]', {
            message: error.message,
            url,
        });
    }

    if (config.showToasts) {
        if (error.name === 'AbortError') {
            showWarningToast('Request Cancelled', 'The request was cancelled.');
        } else if (!navigator.onLine) {
            showWarningToast('No Connection', 'Please check your internet connection.');
        } else {
            showErrorToast('Network Error', 'Failed to connect to the server.');
        }
    }
}

/**
 * Handle validation errors
 */
export function handleValidationError(response: AcceladeErrorResponse): Record<string, string[]> | null {
    if (response._accelade?.type !== 'validation' || !response.errors) {
        return null;
    }

    // Log validation errors
    if (config.logErrors) {
        console.warn('[Accelade Validation Error]', response.errors);
    }

    // Show toast if enabled
    if (config.showToasts && response._accelade?.toast) {
        showToast(
            response._accelade.toast.type,
            response._accelade.toast.title,
            response._accelade.toast.body
        );
    }

    return response.errors;
}

/**
 * Show a toast notification
 */
function showToast(type: string, title: string, body?: string): void {
    const Accelade = (window as unknown as { Accelade?: { notify?: Record<string, (title: string, body?: string) => void> } }).Accelade;

    if (Accelade?.notify) {
        const notifyMethod = Accelade.notify[type];
        if (typeof notifyMethod === 'function') {
            notifyMethod(title, body ?? '');
            return;
        }
    }

    // Fallback: log to console
    console.warn(`[${type.toUpperCase()}] ${title}${body ? `: ${body}` : ''}`);
}

/**
 * Show an error toast
 */
function showErrorToast(title: string, body?: string): void {
    showToast('danger', title, body);
}

/**
 * Show a warning toast
 */
function showWarningToast(title: string, body?: string): void {
    showToast('warning', title, body);
}

/**
 * Create a wrapper for fetch that handles errors
 */
export function createErrorHandlingFetch(
    originalFetch: typeof fetch = window.fetch.bind(window)
): typeof fetch {
    return async (input: RequestInfo | URL, init?: RequestInit): Promise<Response> => {
        try {
            const response = await originalFetch(input, init);

            // Check for error responses
            if (!response.ok) {
                // Clone response to read body while preserving original
                const clone = response.clone();

                try {
                    const data = await clone.json() as AcceladeErrorResponse;

                    // Check if it's an Accelade error response
                    if (data._accelade) {
                        handleAjaxError(data, response.status);
                    }
                } catch {
                    // Not JSON or not Accelade response, ignore
                }
            }

            return response;
        } catch (error) {
            // Handle network errors
            if (error instanceof Error) {
                handleFetchError(error, typeof input === 'string' ? input : input.toString());
            }
            throw error;
        }
    };
}

/**
 * Process a response and handle any Accelade errors
 * Returns true if an error was handled, false otherwise
 */
export function processResponse(response: AcceladeErrorResponse): boolean {
    if (!response._accelade) {
        return false;
    }

    if (!response.success) {
        handleAjaxError(response);
        return true;
    }

    // Handle success toasts
    if (response._accelade.toast) {
        showToast(
            response._accelade.toast.type,
            response._accelade.toast.title,
            response._accelade.toast.body
        );
    }

    return false;
}

export default {
    init,
    getConfig,
    handleError,
    handleAjaxError,
    handleFetchError,
    handleValidationError,
    processResponse,
    createErrorHandlingFetch,
};
</file>

<file path="resources/js/core/events/EventBus.ts">
/**
 * EventBus - Global event bus for component communication
 *
 * Provides a simple pub/sub mechanism for decoupled communication
 * between components without direct references.
 */

/**
 * Event callback function type
 */
export type EventCallback<T = unknown> = (data: T) => void;

/**
 * Subscription entry for tracking listeners
 */
interface Subscription {
    callback: EventCallback;
    once: boolean;
}

/**
 * EventBus class - Singleton event bus for the application
 */
class EventBus {
    private static instance: EventBus | null = null;
    private listeners: Map<string, Set<Subscription>> = new Map();

    private constructor() {
        // Private constructor for singleton
    }

    /**
     * Get the singleton instance
     */
    public static getInstance(): EventBus {
        if (!EventBus.instance) {
            EventBus.instance = new EventBus();
        }
        return EventBus.instance;
    }

    /**
     * Emit an event with optional data
     * @param event The event name
     * @param data Optional data to pass to listeners
     */
    public emit<T = unknown>(event: string, data?: T): void {
        const subscriptions = this.listeners.get(event);
        if (!subscriptions) return;

        // Create a copy to safely iterate while potentially removing 'once' listeners
        const subscriptionsCopy = Array.from(subscriptions);

        for (const subscription of subscriptionsCopy) {
            try {
                subscription.callback(data as T);
            } catch (error) {
                console.error(`[Accelade EventBus] Error in listener for "${event}":`, error);
            }

            // Remove one-time listeners
            if (subscription.once) {
                subscriptions.delete(subscription);
            }
        }

        // Clean up empty sets
        if (subscriptions.size === 0) {
            this.listeners.delete(event);
        }
    }

    /**
     * Listen for an event
     * @param event The event name
     * @param callback Function to call when event is emitted
     * @returns Unsubscribe function
     */
    public on<T = unknown>(event: string, callback: EventCallback<T>): () => void {
        if (!this.listeners.has(event)) {
            this.listeners.set(event, new Set());
        }

        const subscription: Subscription = {
            callback: callback as EventCallback,
            once: false,
        };

        this.listeners.get(event)!.add(subscription);

        // Return unsubscribe function
        return () => {
            this.off(event, callback);
        };
    }

    /**
     * Listen for an event once (auto-removes after first call)
     * @param event The event name
     * @param callback Function to call when event is emitted
     * @returns Unsubscribe function
     */
    public once<T = unknown>(event: string, callback: EventCallback<T>): () => void {
        if (!this.listeners.has(event)) {
            this.listeners.set(event, new Set());
        }

        const subscription: Subscription = {
            callback: callback as EventCallback,
            once: true,
        };

        this.listeners.get(event)!.add(subscription);

        // Return unsubscribe function
        return () => {
            const subs = this.listeners.get(event);
            if (subs) {
                subs.delete(subscription);
                if (subs.size === 0) {
                    this.listeners.delete(event);
                }
            }
        };
    }

    /**
     * Remove a specific listener
     * @param event The event name
     * @param callback The callback to remove
     */
    public off<T = unknown>(event: string, callback: EventCallback<T>): void {
        const subscriptions = this.listeners.get(event);
        if (!subscriptions) return;

        for (const subscription of subscriptions) {
            if (subscription.callback === callback) {
                subscriptions.delete(subscription);
                break;
            }
        }

        // Clean up empty sets
        if (subscriptions.size === 0) {
            this.listeners.delete(event);
        }
    }

    /**
     * Remove all listeners for an event
     * @param event The event name (optional, removes all if not provided)
     */
    public clear(event?: string): void {
        if (event) {
            this.listeners.delete(event);
        } else {
            this.listeners.clear();
        }
    }

    /**
     * Check if an event has listeners
     * @param event The event name
     */
    public hasListeners(event: string): boolean {
        const subscriptions = this.listeners.get(event);
        return subscriptions !== undefined && subscriptions.size > 0;
    }

    /**
     * Get the number of listeners for an event
     * @param event The event name
     */
    public listenerCount(event: string): number {
        return this.listeners.get(event)?.size ?? 0;
    }

    /**
     * Get all registered event names
     */
    public eventNames(): string[] {
        return Array.from(this.listeners.keys());
    }
}

// Export singleton getter
export const getEventBus = (): EventBus => EventBus.getInstance();

// Export convenience functions
export const emit = <T = unknown>(event: string, data?: T): void => {
    getEventBus().emit(event, data);
};

export const on = <T = unknown>(event: string, callback: EventCallback<T>): (() => void) => {
    return getEventBus().on(event, callback);
};

export const once = <T = unknown>(event: string, callback: EventCallback<T>): (() => void) => {
    return getEventBus().once(event, callback);
};

export const off = <T = unknown>(event: string, callback: EventCallback<T>): void => {
    getEventBus().off(event, callback);
};

export { EventBus };
</file>

<file path="resources/js/core/events/index.ts">
/**
 * Events Module - Event bus for component communication
 */

export * from './EventBus';
</file>

<file path="resources/js/core/factories/DeferFactory.ts">
/**
 * DeferFactory - Handle deferred/async data loading
 */

import { ConfigFactory } from './ConfigFactory';
import { startProgress, doneProgress } from '../progress';

/**
 * Defer configuration
 */
export interface DeferConfig {
    url: string;
    method: string;
    acceptHeader: string;
    request?: Record<string, unknown> | string;
    headers?: Record<string, string>;
    poll?: number;
    manual?: boolean;
    watchValue?: string;
    watchDebounce?: number;
}

/**
 * Defer state
 */
export interface DeferState {
    processing: boolean;
    response: unknown;
    error: unknown;
}

/**
 * Defer result
 */
export interface DeferResult {
    success: boolean;
    data?: unknown;
    error?: Error;
}

/**
 * Defer instance for managing a single defer component
 */
export interface DeferInstance {
    id: string;
    config: DeferConfig;
    state: DeferState;
    reload: () => Promise<DeferResult>;
    dispose: () => void;
}

/**
 * DeferFactory - Manages deferred data loading
 */
export class DeferFactory {
    private static instances: Map<string, DeferInstance> = new Map();
    private static abortControllers: Map<string, AbortController> = new Map();
    private static pollTimers: Map<string, ReturnType<typeof setInterval>> = new Map();
    private static debounceTimers: Map<string, ReturnType<typeof setTimeout>> = new Map();

    /**
     * Parse defer configuration from an element
     */
    static parseConfig(element: HTMLElement): DeferConfig | null {
        const url = element.dataset.deferUrl;
        if (!url) {
            return null;
        }

        const method = element.dataset.deferMethod ?? 'GET';
        const acceptHeader = element.dataset.deferAccept ?? 'application/json';
        const poll = element.dataset.deferPoll ? parseInt(element.dataset.deferPoll, 10) : undefined;
        const manual = element.dataset.deferManual === 'true';
        const watchValue = element.dataset.deferWatch;
        const watchDebounce = element.dataset.deferWatchDebounce
            ? parseInt(element.dataset.deferWatchDebounce, 10)
            : 150;

        let request: Record<string, unknown> | string | undefined;
        if (element.dataset.deferRequest) {
            try {
                request = JSON.parse(element.dataset.deferRequest) as Record<string, unknown>;
            } catch {
                request = element.dataset.deferRequest;
            }
        }

        let headers: Record<string, string> | undefined;
        if (element.dataset.deferHeaders) {
            try {
                headers = JSON.parse(element.dataset.deferHeaders) as Record<string, string>;
            } catch {
                // Ignore invalid headers
            }
        }

        return {
            url,
            method: method.toUpperCase(),
            acceptHeader,
            request,
            headers,
            poll,
            manual,
            watchValue,
            watchDebounce,
        };
    }

    /**
     * Create a defer instance
     */
    static create(
        id: string,
        config: DeferConfig,
        setState: (key: string, value: unknown) => void,
        getState: () => Record<string, unknown>,
        dispatchEvent: (name: string, detail: unknown) => void
    ): DeferInstance {
        const state: DeferState = {
            processing: false,
            response: null,
            error: null,
        };

        const reload = async (): Promise<DeferResult> => {
            return this.fetch(id, config, setState, dispatchEvent);
        };

        const dispose = (): void => {
            this.dispose(id);
        };

        const instance: DeferInstance = {
            id,
            config,
            state,
            reload,
            dispose,
        };

        this.instances.set(id, instance);

        // Start polling if configured
        if (config.poll && config.poll > 0) {
            this.startPolling(id, config.poll, reload);
        }

        // Auto-load unless manual
        if (!config.manual) {
            reload();
        }

        return instance;
    }

    /**
     * Fetch data for a defer component
     */
    static async fetch(
        id: string,
        config: DeferConfig,
        setState: (key: string, value: unknown) => void,
        dispatchEvent: (name: string, detail: unknown) => void
    ): Promise<DeferResult> {
        // Cancel any pending request
        this.cancelPending(id);

        const abortController = new AbortController();
        this.abortControllers.set(id, abortController);

        // Set processing state
        setState('processing', true);
        setState('error', null);

        startProgress();

        try {
            // Resolve URL (support template literals)
            const url = this.resolveUrl(config.url);

            // Build headers
            const headers: Record<string, string> = {
                Accept: config.acceptHeader,
                ...config.headers,
            };

            // Add CSRF token for non-GET requests
            if (config.method !== 'GET') {
                headers['Content-Type'] = 'application/json';
                headers['X-CSRF-TOKEN'] = ConfigFactory.getCsrfToken();
            }

            // Build request options
            const requestOptions: RequestInit = {
                method: config.method,
                headers,
                signal: abortController.signal,
            };

            // Add body for non-GET requests
            if (config.method !== 'GET' && config.request) {
                if (typeof config.request === 'string') {
                    requestOptions.body = config.request;
                } else {
                    requestOptions.body = JSON.stringify(config.request);
                }
            }

            const response = await fetch(url, requestOptions);

            let data: unknown;
            const contentType = response.headers.get('content-type') ?? '';

            if (contentType.includes('application/json')) {
                data = await response.json();
            } else if (contentType.includes('text/')) {
                data = await response.text();
            } else {
                data = await response.blob();
            }

            doneProgress();

            // Update state
            setState('processing', false);
            setState('response', data);

            // Dispatch success event
            dispatchEvent('success', data);

            return { success: true, data };
        } catch (error) {
            doneProgress();

            if (error instanceof Error && error.name === 'AbortError') {
                setState('processing', false);
                return { success: false, error: new Error('Request aborted') };
            }

            const errorObj = error instanceof Error ? error : new Error(String(error));

            // Update state
            setState('processing', false);
            setState('error', errorObj.message);

            // Dispatch error event
            dispatchEvent('error', errorObj);

            return { success: false, error: errorObj };
        } finally {
            this.abortControllers.delete(id);
        }
    }

    /**
     * Resolve URL (support template literals with state values)
     */
    private static resolveUrl(url: string): string {
        // If URL contains template literal syntax, we need to evaluate it
        // For now, just return the URL as-is
        // Template literal evaluation happens at the binding level
        return url;
    }

    /**
     * Start polling for a defer component
     */
    private static startPolling(id: string, interval: number, reload: () => Promise<DeferResult>): void {
        // Clear any existing poll timer
        this.stopPolling(id);

        const timer = setInterval(() => {
            reload();
        }, interval);

        this.pollTimers.set(id, timer);
    }

    /**
     * Stop polling for a defer component
     */
    private static stopPolling(id: string): void {
        const timer = this.pollTimers.get(id);
        if (timer) {
            clearInterval(timer);
            this.pollTimers.delete(id);
        }
    }

    /**
     * Cancel pending request
     */
    static cancelPending(id: string): void {
        const controller = this.abortControllers.get(id);
        if (controller) {
            controller.abort();
            this.abortControllers.delete(id);
        }

        const debounceTimer = this.debounceTimers.get(id);
        if (debounceTimer) {
            clearTimeout(debounceTimer);
            this.debounceTimers.delete(id);
        }
    }

    /**
     * Dispose a defer instance
     */
    static dispose(id: string): void {
        this.cancelPending(id);
        this.stopPolling(id);
        this.instances.delete(id);
    }

    /**
     * Dispose all instances
     */
    static disposeAll(): void {
        for (const id of this.instances.keys()) {
            this.dispose(id);
        }
    }

    /**
     * Get an instance by ID
     */
    static getInstance(id: string): DeferInstance | undefined {
        return this.instances.get(id);
    }

    /**
     * Trigger reload with debounce (for watch functionality)
     */
    static triggerReloadDebounced(
        id: string,
        debounceMs: number,
        reload: () => Promise<DeferResult>
    ): void {
        // Clear existing debounce timer
        const existingTimer = this.debounceTimers.get(id);
        if (existingTimer) {
            clearTimeout(existingTimer);
        }

        // Set new debounce timer
        const timer = setTimeout(() => {
            this.debounceTimers.delete(id);
            reload();
        }, debounceMs);

        this.debounceTimers.set(id, timer);
    }
}

export default DeferFactory;
</file>

<file path="resources/js/core/factories/SyncFactory.ts">
/**
 * SyncFactory - Handle server synchronization
 */

import { ConfigFactory } from './ConfigFactory';
import { startProgress, doneProgress } from '../progress';

/**
 * Sync request options
 */
export interface SyncOptions {
    showProgress?: boolean;
    debounce?: boolean | number; // true = use default, number = custom ms
}

/**
 * Sync result
 */
export interface SyncResult {
    success: boolean;
    data?: unknown;
    error?: Error;
}

/**
 * Pending sync request
 */
interface PendingSyncRequest {
    componentId: string;
    property: string;
    value: unknown;
    resolve: (result: SyncResult) => void;
    reject: (error: Error) => void;
}

/**
 * SyncFactory - Manages state synchronization with server
 */
export class SyncFactory {
    private static pendingRequests: Map<string, PendingSyncRequest> = new Map();
    private static debounceTimers: Map<string, ReturnType<typeof setTimeout>> = new Map();
    private static abortControllers: Map<string, AbortController> = new Map();

    /**
     * Sync a single property to the server
     */
    static async sync(
        componentId: string,
        property: string,
        value: unknown,
        options: SyncOptions = {}
    ): Promise<SyncResult> {
        const { showProgress = true, debounce = true } = options;
        const key = `${componentId}:${property}`;

        // Cancel any pending request for this key
        this.cancelPending(key);

        return new Promise((resolve, reject) => {
            const request: PendingSyncRequest = {
                componentId,
                property,
                value,
                resolve,
                reject,
            };

            if (debounce) {
                const debounceTime = ConfigFactory.getSyncDebounce();
                const timer = setTimeout(() => {
                    this.executeSync(request, showProgress);
                }, debounceTime);
                this.debounceTimers.set(key, timer);
            } else {
                this.executeSync(request, showProgress);
            }

            this.pendingRequests.set(key, request);
        });
    }

    /**
     * Sync multiple properties at once (batch)
     */
    static async batchSync(
        componentId: string,
        updates: Record<string, unknown>,
        options: SyncOptions = {}
    ): Promise<SyncResult> {
        const { showProgress = true } = options;
        const url = ConfigFactory.getBatchUpdateUrl();
        const csrfToken = ConfigFactory.getCsrfToken();

        const abortController = new AbortController();
        const key = `batch:${componentId}`;
        this.abortControllers.set(key, abortController);

        if (showProgress) {
            startProgress();
        }

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRF-TOKEN': csrfToken,
                    'Accept': 'application/json',
                },
                body: JSON.stringify({
                    component: componentId,
                    updates: Object.entries(updates).map(([property, value]) => ({
                        property,
                        value,
                    })),
                }),
                signal: abortController.signal,
            });

            const data = await response.json();

            if (showProgress) {
                doneProgress();
            }

            return { success: response.ok, data };
        } catch (error) {
            if (showProgress) {
                doneProgress();
            }

            if (error instanceof Error && error.name === 'AbortError') {
                return { success: false, error: new Error('Request aborted') };
            }

            console.error('Accelade: Batch sync failed', error);
            return { success: false, error: error instanceof Error ? error : new Error(String(error)) };
        } finally {
            this.abortControllers.delete(key);
        }
    }

    /**
     * Execute a sync request
     */
    private static async executeSync(
        request: PendingSyncRequest,
        showProgress: boolean
    ): Promise<void> {
        const { componentId, property, value, resolve } = request;
        const url = ConfigFactory.getUpdateUrl();
        const csrfToken = ConfigFactory.getCsrfToken();
        const key = `${componentId}:${property}`;

        const abortController = new AbortController();
        this.abortControllers.set(key, abortController);

        if (showProgress) {
            startProgress();
        }

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRF-TOKEN': csrfToken,
                    'Accept': 'application/json',
                },
                body: JSON.stringify({
                    component: componentId,
                    property,
                    value,
                }),
                signal: abortController.signal,
            });

            const data = await response.json();

            if (showProgress) {
                doneProgress();
            }

            resolve({ success: response.ok, data });
        } catch (error) {
            if (showProgress) {
                doneProgress();
            }

            if (error instanceof Error && error.name === 'AbortError') {
                resolve({ success: false, error: new Error('Request aborted') });
                return;
            }

            console.error('Accelade: Sync failed', error);
            resolve({ success: false, error: error instanceof Error ? error : new Error(String(error)) });
        } finally {
            this.pendingRequests.delete(key);
            this.abortControllers.delete(key);
            this.debounceTimers.delete(key);
        }
    }

    /**
     * Cancel a pending request
     */
    static cancelPending(key: string): void {
        // Clear debounce timer
        const timer = this.debounceTimers.get(key);
        if (timer) {
            clearTimeout(timer);
            this.debounceTimers.delete(key);
        }

        // Abort in-flight request
        const controller = this.abortControllers.get(key);
        if (controller) {
            controller.abort();
            this.abortControllers.delete(key);
        }

        // Remove from pending
        this.pendingRequests.delete(key);
    }

    /**
     * Cancel all pending requests for a component
     */
    static cancelComponent(componentId: string): void {
        for (const key of this.pendingRequests.keys()) {
            if (key.startsWith(`${componentId}:`)) {
                this.cancelPending(key);
            }
        }
        this.cancelPending(`batch:${componentId}`);
    }

    /**
     * Cancel all pending requests
     */
    static cancelAll(): void {
        for (const key of this.pendingRequests.keys()) {
            this.cancelPending(key);
        }
        for (const key of this.abortControllers.keys()) {
            this.cancelPending(key);
        }
    }

    /**
     * Check if there are pending requests
     */
    static hasPending(): boolean {
        return this.pendingRequests.size > 0 || this.abortControllers.size > 0;
    }

    /**
     * Get pending request count
     */
    static getPendingCount(): number {
        return this.pendingRequests.size;
    }
}

export default SyncFactory;
</file>

<file path="resources/js/core/flash/FlashFactory.ts">
/**
 * FlashFactory - Factory for creating flash data instances per component
 *
 * Parses component configuration and sets up flash data access.
 */

import type { IStateAdapter } from '../../adapters/types';
import type { FlashConfig, FlashData, FlashObject } from './types';
import { FlashManager } from './FlashManager';

/**
 * Flash instance returned by factory
 */
export interface FlashInstance {
    /**
     * The flash object for template access
     */
    flash: FlashObject;

    /**
     * Cleanup function
     */
    dispose: () => void;
}

/**
 * FlashFactory class
 */
export class FlashFactory {
    /**
     * Parse flash configuration from element attributes
     */
    static parseConfig(element: HTMLElement): FlashConfig | null {
        if (!element.hasAttribute('data-accelade-flash')) {
            return null;
        }

        // Get initial flash data from attribute
        const flashDataAttr = element.getAttribute('data-flash-data');
        let data: FlashData = {};

        if (flashDataAttr) {
            try {
                data = JSON.parse(flashDataAttr);
            } catch (e) {
                console.warn('[Accelade Flash] Failed to parse flash data:', e);
            }
        }

        // Check for auto-clear option
        const autoClear = element.getAttribute('data-flash-auto-clear') === 'true';

        return {
            data,
            autoClear,
        };
    }

    /**
     * Create a flash instance for a component
     */
    static create(
        componentId: string,
        element: HTMLElement,
        stateAdapter: IStateAdapter
    ): FlashInstance | undefined {
        const config = this.parseConfig(element);
        if (!config) {
            return undefined;
        }

        const manager = FlashManager.getInstance();

        // Initialize or merge flash data from server
        if (Object.keys(config.data).length > 0) {
            manager.merge(config.data);
        }

        // Create flash object for templates
        const flash = manager.createFlashObject();

        // Update component state with flash data
        stateAdapter.set('flash', flash);

        // Subscribe to flash changes
        const unsubscribe = manager.subscribe((flashData) => {
            // Update component state when flash data changes
            stateAdapter.set('flash', manager.createFlashObject());
        });

        return {
            flash,
            dispose: () => {
                unsubscribe();
            },
        };
    }

    /**
     * Get the global FlashManager instance
     */
    static getManager(): FlashManager {
        return FlashManager.getInstance();
    }

    /**
     * Update flash data (used during SPA navigation)
     */
    static updateFlashData(data: FlashData): void {
        FlashManager.getInstance().set(data);
    }

    /**
     * Merge flash data (preserves existing)
     */
    static mergeFlashData(data: FlashData): void {
        FlashManager.getInstance().merge(data);
    }

    /**
     * Clear all flash data
     */
    static clearFlashData(): void {
        FlashManager.getInstance().clear();
    }
}

export default FlashFactory;
</file>

<file path="resources/js/core/flash/FlashManager.ts">
/**
 * FlashManager - Manages Laravel session flash data on the client
 *
 * Provides reactive access to flash data shared from Laravel backend.
 * Flash data persists across SPA navigation until consumed.
 */

import type { FlashData, FlashObject, FlashConfig } from './types';

/**
 * Callback for flash data changes
 */
export type FlashChangeCallback = (flashData: FlashData) => void;

/**
 * FlashManager singleton class
 */
export class FlashManager {
    private static instance: FlashManager | null = null;

    private data: FlashData = {};

    private listeners: Set<FlashChangeCallback> = new Set();

    /**
     * Get singleton instance
     */
    static getInstance(): FlashManager {
        if (!this.instance) {
            this.instance = new FlashManager();
        }
        return this.instance;
    }

    /**
     * Initialize with flash data from server
     */
    init(initialData?: FlashData): void {
        if (initialData) {
            this.data = { ...initialData };
            this.notifyListeners();
        }
    }

    /**
     * Merge new flash data (used during SPA navigation)
     */
    merge(newData: FlashData): void {
        this.data = { ...this.data, ...newData };
        this.notifyListeners();
    }

    /**
     * Set flash data (replaces existing)
     */
    set(data: FlashData): void {
        this.data = { ...data };
        this.notifyListeners();
    }

    /**
     * Get a flash value by key
     */
    get<T = unknown>(key: string, defaultValue?: T): T {
        const keys = key.split('.');
        let value: unknown = this.data;

        for (const k of keys) {
            if (value === null || value === undefined || typeof value !== 'object') {
                return defaultValue as T;
            }
            value = (value as Record<string, unknown>)[k];
        }

        return (value !== undefined ? value : defaultValue) as T;
    }

    /**
     * Check if a flash key exists and has a truthy value
     */
    has(key: string): boolean {
        const value = this.get(key);
        return value !== undefined && value !== null && value !== '';
    }

    /**
     * Get all flash data
     */
    all(): FlashData {
        return { ...this.data };
    }

    /**
     * Clear a specific flash key
     */
    forget(key: string): void {
        delete this.data[key];
        this.notifyListeners();
    }

    /**
     * Clear all flash data
     */
    clear(): void {
        this.data = {};
        this.notifyListeners();
    }

    /**
     * Subscribe to flash data changes
     */
    subscribe(callback: FlashChangeCallback): () => void {
        this.listeners.add(callback);

        return () => {
            this.listeners.delete(callback);
        };
    }

    /**
     * Create a FlashObject for use in templates
     */
    createFlashObject(): FlashObject {
        const self = this;

        // Create a proxy that exposes both data properties and methods
        return new Proxy({} as FlashObject, {
            get(target, prop: string) {
                // Built-in methods
                if (prop === 'has') {
                    return (key: string) => self.has(key);
                }
                if (prop === 'all') {
                    return () => self.all();
                }
                if (prop === 'get') {
                    return <T>(key: string, defaultValue?: T) => self.get(key, defaultValue);
                }

                // Access flash data properties directly
                return self.get(prop);
            },
            has(target, prop: string) {
                return self.has(prop);
            },
            ownKeys() {
                return Object.keys(self.data);
            },
            getOwnPropertyDescriptor(target, prop: string) {
                if (prop in self.data) {
                    return {
                        enumerable: true,
                        configurable: true,
                        value: self.get(prop),
                    };
                }
                // Methods are not enumerable
                if (['has', 'all', 'get'].includes(prop)) {
                    return {
                        enumerable: false,
                        configurable: true,
                        value: (target as Record<string, unknown>)[prop],
                    };
                }
                return undefined;
            },
        });
    }

    /**
     * Notify all listeners of data change
     */
    private notifyListeners(): void {
        const data = this.all();
        this.listeners.forEach(callback => {
            callback(data);
        });
    }

    /**
     * Reset manager (for testing)
     */
    reset(): void {
        this.data = {};
        this.listeners.clear();
    }

    /**
     * Reset singleton instance (for testing)
     */
    static resetInstance(): void {
        this.instance = null;
    }
}

export default FlashManager;
</file>

<file path="resources/js/core/flash/index.ts">
/**
 * Flash Module Exports
 */

export * from './types';
export * from './FlashManager';
export * from './FlashFactory';
</file>

<file path="resources/js/core/flash/types.ts">
/**
 * Flash Data Types
 *
 * Type definitions for Laravel session flash data integration.
 */

/**
 * Flash data object structure
 */
export interface FlashData {
    [key: string]: unknown;
}

/**
 * Flash object exposed to templates
 * Provides methods to check and access flash data
 */
export interface FlashObject extends FlashData {
    /**
     * Check if a flash key exists and has a truthy value
     */
    has: (key: string) => boolean;

    /**
     * Get all flash data as an object
     */
    all: () => FlashData;

    /**
     * Get a flash value by key with optional default
     */
    get: <T = unknown>(key: string, defaultValue?: T) => T;
}

/**
 * Flash component configuration from data attributes
 */
export interface FlashConfig {
    /**
     * Initial flash data from server
     */
    data: FlashData;

    /**
     * Whether to automatically clear flash on first read
     */
    autoClear?: boolean;
}
</file>

<file path="resources/js/core/interpolation/index.ts">
/**
 * Interpolation Module
 */

export { TextInterpolator, createTextInterpolator } from './TextInterpolator';
</file>

<file path="resources/js/core/interpolation/TextInterpolator.ts">
/**
 * TextInterpolator - Handles {{ }} text interpolation in the DOM
 *
 * Automatically finds and processes text nodes containing {{ expression }}
 * syntax, evaluating expressions against component state and shared data.
 */

import { getNestedValue } from '../expressions';
import { SharedDataManager } from '../shared';

/**
 * Interpolation binding info
 */
interface InterpolationBinding {
    node: Text;
    template: string;
    expressions: string[];
}

/**
 * Regex for matching {{ expression }} patterns
 * Note: We use two versions - one for testing (no 'g' flag) and one for extracting (with 'g' flag)
 */
const INTERPOLATION_REGEX = /\{\{\s*([^}]+?)\s*\}\}/g;
const INTERPOLATION_TEST_REGEX = /\{\{\s*[^}]+?\s*\}\}/;

/**
 * TextInterpolator class
 */
export class TextInterpolator {
    private bindings: InterpolationBinding[] = [];

    private state: Record<string, unknown> = {};

    private element: HTMLElement;

    private sharedUnsubscribe: (() => void) | null = null;

    constructor(element: HTMLElement, initialState: Record<string, unknown> = {}) {
        this.element = element;
        this.state = initialState;
    }

    /**
     * Initialize interpolation - find and process all text nodes
     */
    init(): void {
        this.processElement(this.element);
        this.subscribeToSharedChanges();
        this.update();
    }

    /**
     * Process an element and its children for interpolation
     */
    private processElement(element: Element): void {
        const walker = document.createTreeWalker(
            element,
            NodeFilter.SHOW_TEXT,
            {
                acceptNode: (node: Text) => {
                    // Skip script and style elements
                    const parent = node.parentElement;
                    if (parent && (parent.tagName === 'SCRIPT' || parent.tagName === 'STYLE')) {
                        return NodeFilter.FILTER_REJECT;
                    }

                    // Check if text contains interpolation (use non-global regex for testing)
                    if (node.textContent && INTERPOLATION_TEST_REGEX.test(node.textContent)) {
                        return NodeFilter.FILTER_ACCEPT;
                    }

                    return NodeFilter.FILTER_SKIP;
                },
            }
        );

        const textNodes: Text[] = [];
        let node: Text | null;
        while ((node = walker.nextNode() as Text | null)) {
            textNodes.push(node);
        }

        for (const textNode of textNodes) {
            this.processTextNode(textNode);
        }
    }

    /**
     * Process a single text node
     */
    private processTextNode(node: Text): void {
        const template = node.textContent || '';

        // Extract all expressions from the template
        const expressions: string[] = [];
        let match;
        const regex = new RegExp(INTERPOLATION_REGEX.source, 'g');
        while ((match = regex.exec(template)) !== null) {
            expressions.push(match[1].trim());
        }

        if (expressions.length > 0) {
            this.bindings.push({
                node,
                template,
                expressions,
            });
        }
    }

    /**
     * Subscribe to shared data changes
     */
    private subscribeToSharedChanges(): void {
        this.sharedUnsubscribe = SharedDataManager.getInstance().subscribeAll(() => {
            this.update();
        });
    }

    /**
     * Update state and re-render all bindings
     */
    setState(newState: Record<string, unknown>): void {
        this.state = newState;
        this.update();
    }

    /**
     * Update all interpolation bindings
     */
    update(): void {
        const context = this.buildContext();

        for (const binding of this.bindings) {
            const newText = this.interpolate(binding.template, context);
            if (binding.node.textContent !== newText) {
                binding.node.textContent = newText;
            }
        }
    }

    /**
     * Build evaluation context from state and shared data
     */
    private buildContext(): Record<string, unknown> {
        const shared = SharedDataManager.getInstance().all();
        return {
            ...this.state,
            $shared: shared,
            shared,  // Alias for convenience
        };
    }

    /**
     * Interpolate a template string with context
     */
    private interpolate(template: string, context: Record<string, unknown>): string {
        return template.replace(INTERPOLATION_REGEX, (_, expr: string) => {
            const trimmedExpr = expr.trim();
            const value = this.evaluateExpression(trimmedExpr, context);
            return value !== undefined && value !== null ? String(value) : '';
        });
    }

    /**
     * Evaluate an expression against context
     */
    private evaluateExpression(expr: string, context: Record<string, unknown>): unknown {
        try {
            // Simple property access (e.g., "count", "shared.user.name")
            if (/^[\w.$]+$/.test(expr)) {
                return getNestedValue(context, expr);
            }

            // Complex expression - use Function constructor
            const keys = Object.keys(context);
            const values = Object.values(context);
            const fn = new Function(...keys, `return ${expr}`) as (...args: unknown[]) => unknown;
            return fn(...values);
        } catch (e) {
            console.warn(`Accelade: Failed to evaluate expression "${expr}"`, e);
            return undefined;
        }
    }

    /**
     * Clean up bindings and subscriptions
     */
    destroy(): void {
        this.bindings = [];
        if (this.sharedUnsubscribe) {
            this.sharedUnsubscribe();
            this.sharedUnsubscribe = null;
        }
    }

    /**
     * Get the number of bindings
     */
    getBindingCount(): number {
        return this.bindings.length;
    }
}

/**
 * Create and initialize a text interpolator for an element
 */
export function createTextInterpolator(
    element: HTMLElement,
    state: Record<string, unknown> = {}
): TextInterpolator {
    const interpolator = new TextInterpolator(element, state);
    interpolator.init();
    return interpolator;
}

export default TextInterpolator;
</file>

<file path="resources/js/core/lazy/index.ts">
/**
 * Lazy Loading Module
 *
 * Provides lazy loading functionality for deferred content rendering.
 */

export {
    LazyLoaderManager,
    getLazyLoader,
    initLazy,
    registerLazy,
    loadLazy,
    configureLazy,
    type LazyConfig,
    type LazyInstance,
} from './LazyLoader';
</file>

<file path="resources/js/core/lazy/LazyLoader.ts">
/**
 * LazyLoader - Handles lazy loading of content
 *
 * Supports two modes:
 * 1. Inline mode: Content is already in the DOM but hidden, revealed after delay
 * 2. URL mode: Content is fetched from a URL via AJAX
 */

export interface LazyConfig {
    /** Delay before loading in milliseconds */
    delay?: number;
    /** Custom fetch options for URL mode */
    fetchOptions?: RequestInit;
}

export interface LazyInstance {
    id: string;
    element: HTMLElement;
    mode: 'inline' | 'url';
    url?: string;
    loaded: boolean;
    loading: boolean;
    show: boolean | string;
    conditional: boolean;
    delay: number;
    load: () => Promise<void>;
    reload: () => Promise<void>;
}

type LazyEventType = 'load' | 'loaded' | 'error';
type LazyEventCallback = (instance: LazyInstance, data?: unknown) => void;

/**
 * Lazy loader state for a condition
 */
interface ConditionState {
    lastValue: boolean;
    unsubscribe?: () => void;
}

class LazyLoaderManager {
    private instances: Map<string, LazyInstance> = new Map();
    private observers: Map<string, IntersectionObserver> = new Map();
    private eventListeners: Map<LazyEventType, Set<LazyEventCallback>> = new Map();
    private conditionStates: Map<string, ConditionState> = new Map();
    private globalConfig: LazyConfig = {
        delay: 0,
    };

    /**
     * Configure global lazy loading options
     */
    configure(config: Partial<LazyConfig>): void {
        this.globalConfig = { ...this.globalConfig, ...config };
    }

    /**
     * Initialize all lazy components on the page
     */
    init(): void {
        const elements = document.querySelectorAll<HTMLElement>('[data-accelade-lazy]');
        elements.forEach((el) => this.register(el));
    }

    /**
     * Register a lazy component
     */
    register(element: HTMLElement): LazyInstance | null {
        const id = element.dataset.lazyId;
        if (!id || this.instances.has(id)) {
            return this.instances.get(id!) ?? null;
        }

        const mode = (element.dataset.lazyMode || 'inline') as 'inline' | 'url';
        const url = element.dataset.lazyUrl;
        const showAttr = element.dataset.lazyShow || 'true';
        const conditional = element.dataset.lazyConditional === 'true';
        const delay = parseInt(element.dataset.lazyDelay || '0', 10);

        // Parse show value
        let show: boolean | string = showAttr === 'true';
        if (conditional) {
            show = showAttr; // Keep as expression string for conditional mode
        }

        const instance: LazyInstance = {
            id,
            element,
            mode,
            url,
            loaded: false,
            loading: false,
            show,
            conditional,
            delay: delay || this.globalConfig.delay || 0,
            load: () => this.load(id),
            reload: () => this.reload(id),
        };

        this.instances.set(id, instance);

        // Handle conditional mode
        if (conditional) {
            this.setupConditionalLoading(instance);
        } else if (show === true) {
            // Auto-load immediately or after delay
            this.scheduleLoad(instance);
        }

        return instance;
    }

    /**
     * Safely evaluate a simple boolean expression
     */
    private safeEvaluateExpression(expr: string, context: Record<string, unknown>): boolean {
        // Simple expression evaluator for common patterns
        // Supports: variable, !variable, variable === value, variable !== value
        const trimmed = expr.trim();

        // Handle negation
        if (trimmed.startsWith('!')) {
            const varName = trimmed.slice(1).trim();
            return !context[varName];
        }

        // Handle strict equality
        if (trimmed.includes('===')) {
            const [left, right] = trimmed.split('===').map((s) => s.trim());
            const leftVal = context[left];
            const rightVal = right.startsWith("'") || right.startsWith('"')
                ? right.slice(1, -1)
                : right === 'true' ? true : right === 'false' ? false : right;
            return leftVal === rightVal;
        }

        // Handle strict inequality
        if (trimmed.includes('!==')) {
            const [left, right] = trimmed.split('!==').map((s) => s.trim());
            const leftVal = context[left];
            const rightVal = right.startsWith("'") || right.startsWith('"')
                ? right.slice(1, -1)
                : right === 'true' ? true : right === 'false' ? false : right;
            return leftVal !== rightVal;
        }

        // Handle simple variable lookup
        if (/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(trimmed)) {
            return !!context[trimmed];
        }

        // For complex expressions, use Function constructor (safer than eval)
        try {
            const fn = new Function(...Object.keys(context), `return ${expr}`);
            return !!fn(...Object.values(context));
        } catch {
            return false;
        }
    }

    /**
     * Setup conditional loading that watches for state changes
     */
    private setupConditionalLoading(instance: LazyInstance): void {
        // Initial state
        const conditionState: ConditionState = {
            lastValue: false,
        };
        this.conditionStates.set(instance.id, conditionState);

        // We'll check the condition periodically or use MutationObserver
        // For now, use a simple polling approach that checks Accelade component state
        const checkCondition = (): boolean => {
            const showExpr = instance.show as string;

            // Try to evaluate the expression in the context of any Accelade component
            try {
                // Look for parent Accelade component
                const acceladeEl = instance.element.closest('[data-accelade]');
                if (acceladeEl) {
                    const stateAttr = acceladeEl.getAttribute('data-accelade-state');
                    if (stateAttr) {
                        const state = JSON.parse(stateAttr);
                        return this.safeEvaluateExpression(showExpr, state);
                    }
                }

                // Fallback: try with empty context
                return this.safeEvaluateExpression(showExpr, {});
            } catch {
                return false;
            }
        };

        // Check initially
        const initialValue = checkCondition();
        conditionState.lastValue = initialValue;

        if (initialValue) {
            this.scheduleLoad(instance);
        }

        // Setup observer for state changes
        const observer = new MutationObserver(() => {
            const newValue = checkCondition();
            if (newValue !== conditionState.lastValue) {
                conditionState.lastValue = newValue;
                if (newValue) {
                    this.scheduleLoad(instance);
                } else {
                    this.hide(instance.id);
                }
            }
        });

        // Observe parent Accelade component for attribute changes
        const acceladeEl = instance.element.closest('[data-accelade]');
        if (acceladeEl) {
            observer.observe(acceladeEl, {
                attributes: true,
                attributeFilter: ['data-accelade-state'],
            });
        }

        // Store for cleanup
        this.observers.set(instance.id, observer as unknown as IntersectionObserver);
    }

    /**
     * Schedule loading with delay
     */
    private scheduleLoad(instance: LazyInstance): void {
        if (instance.delay > 0) {
            setTimeout(() => this.load(instance.id), instance.delay);
        } else {
            // Use requestAnimationFrame for smooth initial render
            requestAnimationFrame(() => this.load(instance.id));
        }
    }

    /**
     * Load content for a lazy component
     */
    async load(id: string): Promise<void> {
        const instance = this.instances.get(id);
        if (!instance || instance.loading) return;

        instance.loading = true;
        this.emit('load', instance);

        try {
            if (instance.mode === 'url' && instance.url) {
                await this.loadFromUrl(instance);
            } else {
                await this.loadInline(instance);
            }

            instance.loaded = true;
            instance.loading = false;
            this.emit('loaded', instance);
        } catch (error) {
            instance.loading = false;
            this.emit('error', instance, error);
            console.error('Accelade: Failed to load lazy content', error);
        }
    }

    /**
     * Load content from URL
     */
    private async loadFromUrl(instance: LazyInstance): Promise<void> {
        const method = instance.element.dataset.lazyMethod || 'GET';
        const dataAttr = instance.element.dataset.lazyData;
        let body: string | undefined;
        const headers: Record<string, string> = {
            Accept: 'text/html',
            'X-Requested-With': 'XMLHttpRequest',
        };

        // Get CSRF token
        const csrfToken = document.querySelector<HTMLMetaElement>('meta[name="csrf-token"]')?.content;
        if (csrfToken) {
            headers['X-CSRF-TOKEN'] = csrfToken;
        }

        // Parse data for POST requests
        if (dataAttr && method === 'POST') {
            headers['Content-Type'] = 'application/json';
            body = dataAttr;
        }

        const response = await fetch(instance.url!, {
            method,
            headers,
            body,
            ...this.globalConfig.fetchOptions,
        });

        if (!response.ok) {
            throw new Error(`Failed to load lazy content: ${response.status}`);
        }

        const html = await response.text();
        const contentEl = instance.element.querySelector<HTMLElement>('[data-lazy-content]');

        if (contentEl) {
            contentEl.innerHTML = html;
        }

        this.showContent(instance);
    }

    /**
     * Load inline content (just reveal it)
     */
    private async loadInline(instance: LazyInstance): Promise<void> {
        // Small delay to ensure smooth animation
        await new Promise((resolve) => requestAnimationFrame(resolve));
        this.showContent(instance);
    }

    /**
     * Show the content and hide placeholder
     */
    private showContent(instance: LazyInstance): void {
        const placeholder = instance.element.querySelector<HTMLElement>('[data-lazy-placeholder]');
        const content = instance.element.querySelector<HTMLElement>('[data-lazy-content]');

        if (placeholder) {
            placeholder.classList.add('accelade-lazy-hiding');
            setTimeout(() => {
                placeholder.style.display = 'none';
            }, 200);
        }

        if (content) {
            content.style.display = '';
            // Trigger reflow
            void content.offsetHeight;
            content.classList.add('accelade-lazy-visible');
        }

        // Initialize any Accelade components inside the lazy content
        this.initAcceladeComponents(instance.element);
    }

    /**
     * Hide the content and show placeholder (for conditional loading)
     */
    hide(id: string): void {
        const instance = this.instances.get(id);
        if (!instance) return;

        const placeholder = instance.element.querySelector<HTMLElement>('[data-lazy-placeholder]');
        const content = instance.element.querySelector<HTMLElement>('[data-lazy-content]');

        if (content) {
            content.classList.remove('accelade-lazy-visible');
            setTimeout(() => {
                content.style.display = 'none';
            }, 200);
        }

        if (placeholder) {
            placeholder.style.display = '';
            placeholder.classList.remove('accelade-lazy-hiding');
        }
    }

    /**
     * Reload content (for conditional loading)
     */
    async reload(id: string): Promise<void> {
        const instance = this.instances.get(id);
        if (!instance) return;

        instance.loaded = false;
        await this.load(id);
    }

    /**
     * Initialize Accelade components within loaded content
     */
    private initAcceladeComponents(container: HTMLElement): void {
        // Check if Accelade is available globally
        const accelade = (window as unknown as Record<string, unknown>).Accelade as {
            initComponent?: (el: HTMLElement) => void;
        };

        if (accelade?.initComponent) {
            const components = container.querySelectorAll<HTMLElement>('[data-accelade]');
            components.forEach((el) => accelade.initComponent!(el));
        }
    }

    /**
     * Get a lazy instance by ID
     */
    get(id: string): LazyInstance | undefined {
        return this.instances.get(id);
    }

    /**
     * Get all lazy instances
     */
    getAll(): Map<string, LazyInstance> {
        return new Map(this.instances);
    }

    /**
     * Dispose a lazy instance
     */
    dispose(id: string): void {
        const observer = this.observers.get(id);
        if (observer) {
            observer.disconnect();
            this.observers.delete(id);
        }

        this.conditionStates.delete(id);
        this.instances.delete(id);
    }

    /**
     * Dispose all lazy instances
     */
    disposeAll(): void {
        this.observers.forEach((observer) => observer.disconnect());
        this.observers.clear();
        this.conditionStates.clear();
        this.instances.clear();
    }

    /**
     * Event handling
     */
    on(event: LazyEventType, callback: LazyEventCallback): () => void {
        if (!this.eventListeners.has(event)) {
            this.eventListeners.set(event, new Set());
        }
        this.eventListeners.get(event)!.add(callback);

        return () => {
            this.eventListeners.get(event)?.delete(callback);
        };
    }

    private emit(event: LazyEventType, instance: LazyInstance, data?: unknown): void {
        this.eventListeners.get(event)?.forEach((callback) => callback(instance, data));
    }
}

// Singleton instance
let lazyLoaderInstance: LazyLoaderManager | null = null;

export function getLazyLoader(): LazyLoaderManager {
    if (!lazyLoaderInstance) {
        lazyLoaderInstance = new LazyLoaderManager();
    }
    return lazyLoaderInstance;
}

export function initLazy(): void {
    getLazyLoader().init();
}

export function registerLazy(element: HTMLElement): LazyInstance | null {
    return getLazyLoader().register(element);
}

export function loadLazy(id: string): Promise<void> {
    return getLazyLoader().load(id);
}

export function configureLazy(config: Partial<LazyConfig>): void {
    getLazyLoader().configure(config);
}

export { LazyLoaderManager };
</file>

<file path="resources/js/core/link/index.ts">
/**
 * Link Module Exports
 */

export * from './types';
export * from './ConfirmDialog';
export * from './LinkManager';
</file>

<file path="resources/js/core/link/LinkManager.ts">
/**
 * LinkManager - Handles enhanced link functionality
 *
 * Manages link clicks with HTTP methods, confirmation dialogs,
 * request data, and navigation options.
 */

import type { LinkConfig, HttpMethod } from './types';
import { showConfirmDialog } from './ConfirmDialog';
import { getRouter } from '../router';

/**
 * Parse a link element's configuration from data attributes
 */
export function parseLinkConfig(element: HTMLAnchorElement): LinkConfig {
    const href = element.getAttribute('href') ?? '';

    // Parse HTTP method
    const methodAttr = element.getAttribute('data-method') ?? element.getAttribute('method');
    const method = (methodAttr?.toUpperCase() as HttpMethod) || 'GET';

    // Parse request data
    let data: Record<string, unknown> | undefined;
    const dataAttr = element.getAttribute('data-data');
    if (dataAttr) {
        try {
            data = JSON.parse(dataAttr);
        } catch {
            console.warn('[Accelade Link] Failed to parse data attribute:', dataAttr);
        }
    }

    // Parse headers
    let headers: Record<string, string> | undefined;
    const headersAttr = element.getAttribute('data-headers');
    if (headersAttr) {
        try {
            headers = JSON.parse(headersAttr);
        } catch {
            console.warn('[Accelade Link] Failed to parse headers attribute:', headersAttr);
        }
    }

    // Parse confirmation options
    const hasConfirm = element.hasAttribute('data-confirm') || element.hasAttribute('confirm');
    const confirmText = element.getAttribute('data-confirm-text') ??
        element.getAttribute('confirm-text') ??
        element.getAttribute('data-confirm') ??
        (hasConfirm ? 'Are you sure you want to continue?' : undefined);
    const confirmTitle = element.getAttribute('data-confirm-title') ?? element.getAttribute('confirm-title');
    const confirmButton = element.getAttribute('data-confirm-button') ?? element.getAttribute('confirm-button') ?? 'Confirm';
    const cancelButton = element.getAttribute('data-cancel-button') ?? element.getAttribute('cancel-button') ?? 'Cancel';
    const confirmDanger = element.hasAttribute('data-confirm-danger') || element.hasAttribute('confirm-danger');

    // Parse navigation options
    const preserveScroll = element.hasAttribute('data-preserve-scroll') || element.hasAttribute('preserve-scroll');
    const preserveState = element.hasAttribute('data-preserve-state') || element.hasAttribute('preserve-state');
    const prefetch = element.hasAttribute('data-prefetch') || element.hasAttribute('prefetch');
    const replace = element.hasAttribute('data-replace') || element.hasAttribute('replace');
    const away = element.hasAttribute('data-away') || element.hasAttribute('away');

    return {
        href,
        method,
        data,
        headers,
        away,
        confirm: hasConfirm || !!confirmText,
        confirmText,
        confirmTitle,
        confirmButton,
        cancelButton,
        confirmDanger,
        preserveScroll,
        preserveState,
        prefetch,
        replace,
    };
}

/**
 * Handle a link click with enhanced features
 */
export async function handleLinkClick(
    element: HTMLAnchorElement,
    event: MouseEvent
): Promise<boolean> {
    const config = parseLinkConfig(element);

    // Dispatch custom event before handling
    const beforeEvent = new CustomEvent('accelade:link-before', {
        detail: { href: config.href, method: config.method, data: config.data, cancelled: false },
        bubbles: true,
        cancelable: true,
    });
    element.dispatchEvent(beforeEvent);

    if (beforeEvent.defaultPrevented || (beforeEvent.detail as { cancelled: boolean }).cancelled) {
        return false;
    }

    // Handle external links (away)
    if (config.away) {
        // Show confirmation if needed
        if (config.confirm && config.confirmText) {
            const result = await showConfirmDialog({
                title: config.confirmTitle,
                text: config.confirmText,
                confirmButton: config.confirmButton ?? 'Continue',
                cancelButton: config.cancelButton ?? 'Cancel',
                danger: config.confirmDanger ?? false,
            });

            if (!result.confirmed) {
                return false;
            }
        }

        // Navigate away (full page)
        window.location.href = config.href;
        return true;
    }

    // Show confirmation dialog if needed
    if (config.confirm && config.confirmText) {
        const result = await showConfirmDialog({
            title: config.confirmTitle,
            text: config.confirmText,
            confirmButton: config.confirmButton ?? 'Confirm',
            cancelButton: config.cancelButton ?? 'Cancel',
            danger: config.confirmDanger ?? false,
        });

        if (!result.confirmed) {
            return false;
        }
    }

    // Handle non-GET methods (form-like submissions)
    if (config.method !== 'GET') {
        return handleFormSubmit(config);
    }

    // Handle GET navigation via router
    const router = getRouter();
    return router.navigate(config.href, {
        preserveScroll: config.preserveScroll,
        preserveState: config.preserveState,
        pushState: !config.replace,
        headers: config.headers,
    });
}

/**
 * Handle form-like submissions (POST, PUT, PATCH, DELETE)
 */
async function handleFormSubmit(config: LinkConfig): Promise<boolean> {
    try {
        // Get CSRF token
        const csrfToken = document.querySelector<HTMLMetaElement>('meta[name="csrf-token"]')?.content ??
            (document.querySelector<HTMLInputElement>('input[name="_token"]')?.value);

        const headers: Record<string, string> = {
            'Content-Type': 'application/json',
            'Accept': 'text/html, application/json',
            'X-Requested-With': 'XMLHttpRequest',
            'X-Accelade-SPA': 'true',
            ...(csrfToken ? { 'X-CSRF-TOKEN': csrfToken } : {}),
            ...(config.headers ?? {}),
        };

        // For methods other than GET/POST, add method spoofing
        const actualMethod = config.method === 'GET' || config.method === 'POST' ? config.method : 'POST';
        const data: Record<string, unknown> = {
            ...(config.data ?? {}),
        };

        // Add method spoofing for Laravel
        if (config.method !== 'GET' && config.method !== 'POST') {
            data._method = config.method;
        }

        const response = await fetch(config.href, {
            method: actualMethod,
            headers,
            body: Object.keys(data).length > 0 ? JSON.stringify(data) : undefined,
        });

        // Handle redirect responses
        if (response.redirected) {
            const router = getRouter();
            return router.navigate(response.url, {
                preserveScroll: config.preserveScroll,
                preserveState: config.preserveState,
                pushState: !config.replace,
            });
        }

        // Handle JSON responses
        const contentType = response.headers.get('content-type');
        if (contentType?.includes('application/json')) {
            const json = await response.json();

            // Check for redirect in JSON response
            if (json.redirect) {
                const router = getRouter();
                return router.navigate(json.redirect, {
                    preserveScroll: config.preserveScroll,
                    preserveState: config.preserveState,
                    pushState: !config.replace,
                });
            }

            // Dispatch event with response data
            document.dispatchEvent(new CustomEvent('accelade:link-response', {
                detail: { href: config.href, method: config.method, response: json },
            }));

            return true;
        }

        // Handle HTML responses (page update)
        if (contentType?.includes('text/html')) {
            const html = await response.text();
            const router = getRouter();

            // Get the final URL (may differ due to redirects)
            const finalUrl = response.url || config.href;

            // Update the page content
            // This is a simplified version - the router handles the full update
            return router.navigate(finalUrl, {
                preserveScroll: config.preserveScroll,
                preserveState: config.preserveState,
                pushState: !config.replace,
            });
        }

        return true;
    } catch (error) {
        console.error('[Accelade Link] Form submission failed:', error);

        // Dispatch error event
        document.dispatchEvent(new CustomEvent('accelade:link-error', {
            detail: { href: config.href, method: config.method, error },
        }));

        return false;
    }
}

/**
 * Setup prefetching for a link
 */
export function setupPrefetch(element: HTMLAnchorElement): void {
    const href = element.getAttribute('href');
    if (!href) return;

    // Prefetch on hover
    element.addEventListener('mouseenter', () => {
        const router = getRouter();
        void router.prefetch(href);
    }, { once: true });
}

/**
 * Initialize link handling for a container
 */
export function initLinks(container: HTMLElement = document.body): void {
    // Find all enhanced links
    const links = container.querySelectorAll<HTMLAnchorElement>(
        'a[data-accelade-link], a[a-link], a[data-spa-link]'
    );

    links.forEach((link) => {
        // Setup prefetching if enabled
        if (link.hasAttribute('data-prefetch') || link.hasAttribute('prefetch')) {
            setupPrefetch(link);
        }
    });
}

export default {
    parseLinkConfig,
    handleLinkClick,
    setupPrefetch,
    initLinks,
};
</file>

<file path="resources/js/core/link/types.ts">
/**
 * Link Component Types
 *
 * Type definitions for the enhanced Link component with
 * HTTP methods, confirmation dialogs, and navigation options.
 */

/**
 * Supported HTTP methods for link navigation
 */
export type HttpMethod = 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE';

/**
 * Link configuration parsed from data attributes
 */
export interface LinkConfig {
    /**
     * Target URL for navigation
     */
    href: string;

    /**
     * HTTP method (default: GET)
     */
    method: HttpMethod;

    /**
     * Request payload data
     */
    data?: Record<string, unknown>;

    /**
     * Custom HTTP headers
     */
    headers?: Record<string, string>;

    /**
     * Treat as external link (full page navigation)
     */
    away?: boolean;

    /**
     * Show confirmation dialog
     */
    confirm?: boolean;

    /**
     * Confirmation dialog message
     */
    confirmText?: string;

    /**
     * Confirmation dialog title
     */
    confirmTitle?: string;

    /**
     * Confirm button label
     */
    confirmButton?: string;

    /**
     * Cancel button label
     */
    cancelButton?: string;

    /**
     * Render confirm button in danger style (red)
     */
    confirmDanger?: boolean;

    /**
     * Preserve scroll position after navigation
     */
    preserveScroll?: boolean;

    /**
     * Preserve component state after navigation
     */
    preserveState?: boolean;

    /**
     * Enable prefetching
     */
    prefetch?: boolean;

    /**
     * Replace history instead of push
     */
    replace?: boolean;
}

/**
 * Confirmation dialog options
 */
export interface ConfirmDialogOptions {
    /**
     * Dialog title (optional)
     */
    title?: string;

    /**
     * Dialog message
     */
    text: string;

    /**
     * Confirm button label
     */
    confirmButton: string;

    /**
     * Cancel button label
     */
    cancelButton: string;

    /**
     * Use danger styling for confirm button
     */
    danger: boolean;
}

/**
 * Confirm dialog result
 */
export interface ConfirmDialogResult {
    /**
     * Whether user confirmed
     */
    confirmed: boolean;
}

/**
 * Link click event detail
 */
export interface LinkClickDetail {
    /**
     * Target URL
     */
    href: string;

    /**
     * HTTP method
     */
    method: HttpMethod;

    /**
     * Request data
     */
    data?: Record<string, unknown>;

    /**
     * Whether navigation was cancelled
     */
    cancelled: boolean;
}
</file>

<file path="resources/js/core/modal/index.ts">
/**
 * Modal Module
 *
 * Exports modal types and manager for modals and slideovers.
 */

export * from './types';
export { modalManager, default } from './ModalManager';
</file>

<file path="resources/js/core/modal/ModalFactory.ts">
/**
 * ModalFactory - Factory for creating and managing modal instances
 *
 * Integrates with BaseAdapter to setup modal components.
 */

import type { IStateAdapter } from '../../adapters/types';
import modalManagerInstance from './ModalManager';
import type { ModalInstance, ModalConfig } from './types';

// Re-export modalManager for use in router
export const modalManager = modalManagerInstance;

/**
 * Modal instance with adapter integration
 */
export interface ModalAdapterInstance {
    /**
     * Modal instance
     */
    modal: ModalInstance;

    /**
     * Dispose function
     */
    dispose: () => void;
}

/**
 * Create a modal instance from an element
 */
export function createModal(
    componentId: string,
    element: HTMLElement,
    stateAdapter: IStateAdapter
): ModalAdapterInstance | undefined {
    // Parse configuration from element
    const config = modalManagerInstance.parseConfig(element);

    // Set component ID if not set
    if (!config.id) {
        config.id = componentId;
    }

    // Register modal with manager
    const instance = modalManagerInstance.register(element, config);

    // Update state adapter with modal state
    stateAdapter.set('isOpen', instance.isOpen);

    // Expose modal methods in state for template access
    const modalObject = {
        close: instance.close,
        open: instance.open,
        setIsOpen: instance.setIsOpen,
    };

    // Add modal object to state for @click="modal.close" pattern
    stateAdapter.set('modal', modalObject);

    // Subscribe to open/close to update state
    const handleOpen = (): void => {
        stateAdapter.set('isOpen', true);
    };

    const handleClose = (): void => {
        stateAdapter.set('isOpen', false);
    };

    document.addEventListener('accelade:modal-open', ((e: CustomEvent) => {
        if (e.detail?.id === instance.id) {
            handleOpen();
        }
    }) as EventListener);

    document.addEventListener('accelade:modal-close', ((e: CustomEvent) => {
        if (e.detail?.id === instance.id) {
            handleClose();
        }
    }) as EventListener);

    return {
        modal: instance,
        dispose: () => instance.dispose(),
    };
}

/**
 * Initialize modal links on the page
 */
export function initModalLinks(): void {
    // Find all links with modal/slideover attributes
    document.querySelectorAll<HTMLAnchorElement>('a[data-modal], a[data-slideover]').forEach((link) => {
        // Skip if already initialized
        if (link.hasAttribute('data-modal-initialized')) return;
        link.setAttribute('data-modal-initialized', 'true');

        link.addEventListener('click', async (e) => {
            e.preventDefault();

            const href = link.getAttribute('href');
            if (!href) return;

            // Check for hash link (pre-loaded modal)
            if (href.startsWith('#')) {
                const name = href.slice(1);
                modalManager.openNamed(name);
                return;
            }

            // Parse options from link
            const options = modalManager.parseLinkOptions(link);
            if (!options) return;

            // Open modal with URL
            await modalManager.openUrl(href, {
                type: options.slideover ? 'slideover' : 'modal',
                maxWidth: options.maxWidth,
                position: options.position,
                slideoverPosition: options.slideoverPosition,
            });
        });
    });
}

/**
 * Initialize all modals on the page
 */
export function initModals(): void {
    // Initialize hash listener for named modals
    modalManager.initHashListener();

    // Initialize modal links
    initModalLinks();
}

export default {
    create: createModal,
    initLinks: initModalLinks,
    init: initModals,
};
</file>

<file path="resources/js/core/modal/types.ts">
/**
 * Modal Component Types
 *
 * Type definitions for the Modal/Slideover component with
 * async content loading and customizable appearance.
 */

/**
 * Modal max-width options
 */
export type ModalMaxWidth = 'sm' | 'md' | 'lg' | 'xl' | '2xl' | '3xl' | '4xl' | '5xl' | '6xl' | '7xl';

/**
 * Modal position (vertical alignment)
 */
export type ModalPosition = 'top' | 'center' | 'bottom';

/**
 * Slideover position (horizontal alignment)
 */
export type SlideoverPosition = 'left' | 'right';

/**
 * Modal type
 */
export type ModalType = 'modal' | 'slideover' | 'bottom-sheet';

/**
 * Modal configuration
 */
export interface ModalConfig {
    /**
     * Unique identifier for the modal
     */
    id?: string;

    /**
     * Modal name for pre-loaded/named modals
     */
    name?: string;

    /**
     * Type of modal (modal or slideover)
     */
    type: ModalType;

    /**
     * Maximum width of the modal
     */
    maxWidth: ModalMaxWidth;

    /**
     * Position for modal (top, center, bottom)
     */
    position: ModalPosition;

    /**
     * Position for slideover (left, right)
     */
    slideoverPosition: SlideoverPosition;

    /**
     * Require explicit close (disable ESC and outside click)
     */
    closeExplicitly: boolean;

    /**
     * Show close button
     */
    closeButton: boolean;

    /**
     * Open immediately on page load
     */
    opened: boolean;
}

/**
 * Modal instance
 */
export interface ModalInstance {
    /**
     * Unique ID
     */
    id: string;

    /**
     * Modal name (if named)
     */
    name?: string;

    /**
     * Configuration
     */
    config: ModalConfig;

    /**
     * Modal element
     */
    element: HTMLElement;

    /**
     * Whether modal is currently open
     */
    isOpen: boolean;

    /**
     * Open the modal
     */
    open: () => void;

    /**
     * Close the modal
     */
    close: () => void;

    /**
     * Set open state
     */
    setIsOpen: (open: boolean) => void;

    /**
     * Cleanup function
     */
    dispose: () => void;
}

/**
 * Modal open options for programmatic opening
 */
export interface ModalOpenOptions {
    /**
     * URL to load content from
     */
    url?: string;

    /**
     * HTML content to display
     */
    content?: string;

    /**
     * Modal type
     */
    type?: ModalType;

    /**
     * Max width
     */
    maxWidth?: ModalMaxWidth;

    /**
     * Position
     */
    position?: ModalPosition;

    /**
     * Slideover position
     */
    slideoverPosition?: SlideoverPosition;

    /**
     * Close explicitly
     */
    closeExplicitly?: boolean;

    /**
     * Show close button
     */
    closeButton?: boolean;

    /**
     * Callback when modal closes
     */
    onClose?: () => void;
}

/**
 * Link modal options parsed from data attributes
 */
export interface LinkModalOptions {
    /**
     * Open as modal
     */
    modal: boolean;

    /**
     * Open as slideover
     */
    slideover: boolean;

    /**
     * Open as bottom sheet
     */
    bottomSheet: boolean;

    /**
     * Max width override
     */
    maxWidth?: ModalMaxWidth;

    /**
     * Position override
     */
    position?: ModalPosition;

    /**
     * Slideover position override
     */
    slideoverPosition?: SlideoverPosition;
}

/**
 * Modal event detail
 */
export interface ModalEventDetail {
    /**
     * Modal ID
     */
    id: string;

    /**
     * Modal name
     */
    name?: string;

    /**
     * Whether modal is open
     */
    isOpen: boolean;
}
</file>

<file path="resources/js/core/notification/index.ts">
/**
 * Notification module exports.
 */

export * from './types';
export { NotificationManager } from './NotificationManager';
</file>

<file path="resources/js/core/notification/types.ts">
/**
 * Notification types (Filament-compatible).
 */

export type NotificationStatus = 'success' | 'info' | 'warning' | 'danger';

export type NotificationPosition =
    | 'top-left'
    | 'top-center'
    | 'top-right'
    | 'bottom-left'
    | 'bottom-center'
    | 'bottom-right';

export interface NotificationAction {
    name: string;
    label?: string;
    url?: string;
    openInNewTab?: boolean;
    close?: boolean;
    dispatch?: string;
    dispatchTo?: string;
}

export interface NotificationData {
    id: string;
    title: string;
    body: string;
    status: NotificationStatus;
    icon?: string;
    iconColor?: string;
    color?: string;
    position: NotificationPosition;
    duration: number;
    persistent: boolean;
    actions?: NotificationAction[];
    // Backward compatibility
    message?: string;
    type?: NotificationStatus;
}

export interface NotificationConfig {
    position: NotificationPosition;
    duration: number;
    maxVisible: number;
    pauseOnHover: boolean;
}

export const DEFAULT_CONFIG: NotificationConfig = {
    position: 'top-right',
    duration: 5000,
    maxVisible: 5,
    pauseOnHover: true,
};

export const STATUS_ICONS: Record<NotificationStatus, string> = {
    success: '<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>',
    info: '<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
    warning: '<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>',
    danger: '<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>',
};
</file>

<file path="resources/js/core/rehydrate/index.ts">
/**
 * Rehydrate Module Exports
 */

export { default as rehydrateManager, RehydrateManager } from './RehydrateManager';
export { initRehydrate, initRehydrateSystem, emit } from './RehydrateFactory';
export type { RehydrateConfig, RehydrateInstance, RehydrateEventDetail } from './types';
</file>

<file path="resources/js/core/rehydrate/RehydrateFactory.ts">
/**
 * Rehydrate Factory
 *
 * Factory for creating and managing rehydrate instances
 * with adapter integration.
 */

import rehydrateManager from './RehydrateManager';
import type { RehydrateInstance } from './types';

/**
 * Initialize rehydrate components within a container
 */
export function initRehydrate(container: HTMLElement | Document = document): RehydrateInstance[] {
    const instances: RehydrateInstance[] = [];

    // Find all rehydrate elements
    const elements = container.querySelectorAll<HTMLElement>('[data-accelade-rehydrate]');

    elements.forEach((element) => {
        const instance = rehydrateManager.register(element);
        if (instance) {
            instances.push(instance);
        }
    });

    return instances;
}

/**
 * Initialize the rehydrate system
 */
export function initRehydrateSystem(): void {
    rehydrateManager.init();
}

/**
 * Emit an event that can trigger rehydration
 */
export function emit(eventName: string, data?: unknown): void {
    rehydrateManager.emit(eventName, data);
}

// Re-export manager and types
export { rehydrateManager };
export type { RehydrateConfig, RehydrateInstance, RehydrateEventDetail } from './types';
</file>

<file path="resources/js/core/rehydrate/RehydrateManager.ts">
/**
 * Rehydrate Manager
 *
 * Manages rehydrate instances that enable selective section
 * reloading without full page refresh.
 */

import type { RehydrateConfig, RehydrateInstance, RehydrateEventDetail } from './types';

/**
 * Default configuration
 */
const defaultConfig: Partial<RehydrateConfig> = {
    on: [],
    poll: 0,
    preserveScroll: true,
};

/**
 * RehydrateManager singleton class
 */
class RehydrateManager {
    private instances: Map<string, RehydrateInstance> = new Map();
    private eventListeners: Map<string, Set<string>> = new Map(); // event -> instance IDs
    private initialized = false;

    /**
     * Initialize the rehydrate manager
     */
    init(): void {
        if (this.initialized) return;

        // Listen for custom Accelade events
        document.addEventListener('accelade:emit', this.handleEmit.bind(this) as EventListener);

        this.initialized = true;
    }

    /**
     * Handle emitted events
     */
    private handleEmit(e: CustomEvent<{ event: string; data?: unknown }>): void {
        const { event } = e.detail;
        this.triggerByEvent(event);
    }

    /**
     * Trigger rehydration for all instances listening to an event
     */
    triggerByEvent(eventName: string): void {
        const instanceIds = this.eventListeners.get(eventName);
        if (!instanceIds) return;

        instanceIds.forEach((id) => {
            const instance = this.instances.get(id);
            if (instance) {
                void instance.rehydrate();
            }
        });
    }

    /**
     * Emit an event that can trigger rehydration
     */
    emit(eventName: string, data?: unknown): void {
        document.dispatchEvent(
            new CustomEvent('accelade:emit', {
                detail: { event: eventName, data },
            })
        );
    }

    /**
     * Register a rehydrate instance
     */
    register(element: HTMLElement): RehydrateInstance | null {
        const config = this.parseConfig(element);
        if (!config) return null;

        // Check if already registered
        if (this.instances.has(config.id)) {
            return this.instances.get(config.id)!;
        }

        let pollInterval: ReturnType<typeof setInterval> | null = null;
        let isLoading = false;

        const instance: RehydrateInstance = {
            id: config.id,
            config,
            element,
            isLoading: false,

            rehydrate: async () => {
                if (isLoading) return;
                isLoading = true;
                instance.isLoading = true;

                try {
                    await this.rehydrateElement(instance);

                    // Dispatch success event
                    this.dispatchEvent('accelade:rehydrate', {
                        id: config.id,
                        success: true,
                    });
                } catch (error) {
                    console.error('Rehydrate failed:', error);

                    // Dispatch failure event
                    this.dispatchEvent('accelade:rehydrate', {
                        id: config.id,
                        success: false,
                    });
                } finally {
                    isLoading = false;
                    instance.isLoading = false;
                }
            },

            startPolling: () => {
                if (config.poll > 0 && !pollInterval) {
                    pollInterval = setInterval(() => {
                        void instance.rehydrate();
                    }, config.poll);
                }
            },

            stopPolling: () => {
                if (pollInterval) {
                    clearInterval(pollInterval);
                    pollInterval = null;
                }
            },

            dispose: () => {
                instance.stopPolling();
                this.unregisterEventListeners(config.id, config.on);
                this.instances.delete(config.id);
            },
        };

        // Store instance
        this.instances.set(config.id, instance);

        // Register event listeners
        this.registerEventListeners(config.id, config.on);

        // Start polling if configured
        if (config.poll > 0) {
            instance.startPolling();
        }

        return instance;
    }

    /**
     * Parse configuration from element data attributes
     */
    private parseConfig(element: HTMLElement): RehydrateConfig | null {
        const id = element.dataset.rehydrateId || `rehydrate-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;

        // Parse events
        let on: string[] = [];
        const onAttr = element.dataset.rehydrateOn;
        if (onAttr) {
            try {
                // Try parsing as JSON array
                on = JSON.parse(onAttr);
            } catch {
                // Single event string
                on = [onAttr];
            }
        }

        // Parse poll interval
        const pollAttr = element.dataset.rehydratePoll;
        const poll = pollAttr ? parseInt(pollAttr, 10) : 0;

        // Get URL (defaults to current page)
        const url = element.dataset.rehydrateUrl || window.location.href;

        // Preserve scroll
        const preserveScroll = element.hasAttribute('data-rehydrate-preserve-scroll');

        return {
            id,
            on,
            poll: isNaN(poll) ? 0 : poll,
            url,
            preserveScroll: preserveScroll || defaultConfig.preserveScroll!,
        };
    }

    /**
     * Register event listeners for an instance
     */
    private registerEventListeners(instanceId: string, events: string[]): void {
        events.forEach((event) => {
            if (!this.eventListeners.has(event)) {
                this.eventListeners.set(event, new Set());
            }
            this.eventListeners.get(event)!.add(instanceId);
        });
    }

    /**
     * Unregister event listeners for an instance
     */
    private unregisterEventListeners(instanceId: string, events: string[]): void {
        events.forEach((event) => {
            const listeners = this.eventListeners.get(event);
            if (listeners) {
                listeners.delete(instanceId);
                if (listeners.size === 0) {
                    this.eventListeners.delete(event);
                }
            }
        });
    }

    /**
     * Rehydrate an element by fetching fresh content
     */
    private async rehydrateElement(instance: RehydrateInstance): Promise<void> {
        const { element, config } = instance;

        // Save scroll position
        const scrollX = config.preserveScroll ? window.scrollX : 0;
        const scrollY = config.preserveScroll ? window.scrollY : 0;

        // Add loading class
        element.classList.add('accelade-rehydrating');

        try {
            // Fetch fresh content
            const response = await fetch(config.url, {
                method: 'GET',
                headers: {
                    'X-Accelade-Rehydrate': config.id,
                    'X-Requested-With': 'XMLHttpRequest',
                    'Accept': 'text/html',
                },
            });

            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }

            const html = await response.text();

            // Parse the response
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');

            // Find the matching rehydrate element in the response
            const newElement = doc.querySelector(`[data-rehydrate-id="${config.id}"]`);

            if (newElement) {
                // Update the content
                element.innerHTML = newElement.innerHTML;

                // Re-initialize any Accelade components inside
                if (window.Accelade?.init) {
                    window.Accelade.init(element);
                }
            }

            // Restore scroll position
            if (config.preserveScroll) {
                window.scrollTo({ top: scrollY, left: scrollX, behavior: 'instant' });
            }
        } finally {
            // Remove loading class
            element.classList.remove('accelade-rehydrating');
        }
    }

    /**
     * Dispatch a custom event
     */
    private dispatchEvent(name: string, detail: RehydrateEventDetail): void {
        document.dispatchEvent(new CustomEvent(name, { detail }));
    }

    /**
     * Get an instance by ID
     */
    get(id: string): RehydrateInstance | undefined {
        return this.instances.get(id);
    }

    /**
     * Get all registered instances
     */
    getAll(): RehydrateInstance[] {
        return Array.from(this.instances.values());
    }

    /**
     * Manually trigger rehydration for an instance by ID
     */
    async rehydrate(id: string): Promise<void> {
        const instance = this.instances.get(id);
        if (instance) {
            await instance.rehydrate();
        }
    }

    /**
     * Rehydrate all instances
     */
    async rehydrateAll(): Promise<void> {
        const promises = Array.from(this.instances.values()).map((instance) =>
            instance.rehydrate()
        );
        await Promise.all(promises);
    }

    /**
     * Dispose all instances
     */
    disposeAll(): void {
        this.instances.forEach((instance) => instance.dispose());
        this.instances.clear();
        this.eventListeners.clear();
    }
}

// Export singleton instance
const rehydrateManager = new RehydrateManager();
export default rehydrateManager;
export { RehydrateManager };
</file>

<file path="resources/js/core/rehydrate/types.ts">
/**
 * Rehydrate Component Types
 *
 * Type definitions for the Rehydrate component that enables
 * selective section reloading without full page refresh.
 */

/**
 * Rehydrate configuration parsed from data attributes
 */
export interface RehydrateConfig {
    /**
     * Unique identifier for the rehydrate instance
     */
    id: string;

    /**
     * Event name(s) that trigger rehydration
     */
    on: string[];

    /**
     * Polling interval in milliseconds (0 = disabled)
     */
    poll: number;

    /**
     * URL to fetch content from (defaults to current page)
     */
    url: string;

    /**
     * Preserve scroll position after rehydration
     */
    preserveScroll: boolean;
}

/**
 * Rehydrate instance
 */
export interface RehydrateInstance {
    /**
     * Unique ID
     */
    id: string;

    /**
     * Configuration
     */
    config: RehydrateConfig;

    /**
     * Component element
     */
    element: HTMLElement;

    /**
     * Whether rehydration is in progress
     */
    isLoading: boolean;

    /**
     * Trigger rehydration manually
     */
    rehydrate: () => Promise<void>;

    /**
     * Start polling (if configured)
     */
    startPolling: () => void;

    /**
     * Stop polling
     */
    stopPolling: () => void;

    /**
     * Cleanup function
     */
    dispose: () => void;
}

/**
 * Rehydrate event detail
 */
export interface RehydrateEventDetail {
    /**
     * Rehydrate instance ID
     */
    id: string;

    /**
     * Event that triggered rehydration (if any)
     */
    event?: string;

    /**
     * Whether rehydration was successful
     */
    success: boolean;
}
</file>

<file path="resources/js/core/shared/index.ts">
/**
 * Shared Data Module
 */

export { SharedDataManager } from './SharedDataManager';
export type { SharedDataChangeCallback } from './SharedDataManager';
</file>

<file path="resources/js/core/shared/SharedDataManager.ts">
/**
 * SharedDataManager - Manages globally shared data from Laravel backend
 *
 * Provides reactive access to data shared via Accelade::share() on the backend.
 * Data persists across SPA navigation and is available in all components.
 */

import type { SharedData } from '../types';

/**
 * Callback for shared data changes
 */
export type SharedDataChangeCallback = (
    key: string,
    newValue: unknown,
    oldValue: unknown
) => void;

/**
 * SharedDataManager class
 */
export class SharedDataManager {
    private static instance: SharedDataManager | null = null;

    private data: SharedData = {};

    private listeners: Map<string, Set<SharedDataChangeCallback>> = new Map();

    private globalListeners: Set<SharedDataChangeCallback> = new Set();

    /**
     * Get singleton instance
     */
    static getInstance(): SharedDataManager {
        if (!this.instance) {
            this.instance = new SharedDataManager();
        }
        return this.instance;
    }

    /**
     * Initialize with data from server
     */
    init(initialData?: SharedData): void {
        if (initialData) {
            this.data = { ...initialData };
        }
    }

    /**
     * Get a shared value by key
     */
    get<T = unknown>(key: string, defaultValue?: T): T {
        const keys = key.split('.');
        let value: unknown = this.data;

        for (const k of keys) {
            if (value === null || value === undefined || typeof value !== 'object') {
                return defaultValue as T;
            }
            value = (value as Record<string, unknown>)[k];
        }

        return (value !== undefined ? value : defaultValue) as T;
    }

    /**
     * Check if a key exists
     */
    has(key: string): boolean {
        const keys = key.split('.');
        let value: unknown = this.data;

        for (const k of keys) {
            if (value === null || value === undefined || typeof value !== 'object') {
                return false;
            }
            value = (value as Record<string, unknown>)[k];
        }

        return value !== undefined;
    }

    /**
     * Get all shared data
     */
    all(): SharedData {
        return { ...this.data };
    }

    /**
     * Set a shared value (client-side only, useful for optimistic updates)
     */
    set(key: string, value: unknown): void {
        const keys = key.split('.');
        const oldValue = this.get(key);

        if (keys.length === 1) {
            this.data[key] = value;
        } else {
            let current: Record<string, unknown> = this.data;
            for (let i = 0; i < keys.length - 1; i++) {
                const k = keys[i];
                if (!(k in current) || typeof current[k] !== 'object') {
                    current[k] = {};
                }
                current = current[k] as Record<string, unknown>;
            }
            current[keys[keys.length - 1]] = value;
        }

        this.notifyListeners(key, value, oldValue);
    }

    /**
     * Merge new data into shared data
     */
    merge(data: SharedData): void {
        for (const [key, value] of Object.entries(data)) {
            this.set(key, value);
        }
    }

    /**
     * Subscribe to changes for a specific key
     */
    subscribe(key: string, callback: SharedDataChangeCallback): () => void {
        if (!this.listeners.has(key)) {
            this.listeners.set(key, new Set());
        }
        this.listeners.get(key)!.add(callback);

        return () => {
            this.listeners.get(key)?.delete(callback);
        };
    }

    /**
     * Subscribe to all changes
     */
    subscribeAll(callback: SharedDataChangeCallback): () => void {
        this.globalListeners.add(callback);

        return () => {
            this.globalListeners.delete(callback);
        };
    }

    /**
     * Notify listeners of a change
     */
    private notifyListeners(key: string, newValue: unknown, oldValue: unknown): void {
        // Notify key-specific listeners
        this.listeners.get(key)?.forEach(callback => {
            callback(key, newValue, oldValue);
        });

        // Notify global listeners
        this.globalListeners.forEach(callback => {
            callback(key, newValue, oldValue);
        });
    }

    /**
     * Create a reactive proxy for shared data (for use in templates)
     */
    createProxy(): SharedData {
        const self = this;
        return new Proxy(this.data, {
            get(target, prop: string) {
                return self.get(prop);
            },
            set(target, prop: string, value) {
                self.set(prop, value);
                return true;
            },
            has(target, prop: string) {
                return self.has(prop);
            },
            ownKeys() {
                return Object.keys(self.data);
            },
            getOwnPropertyDescriptor(target, prop: string) {
                if (prop in self.data) {
                    return {
                        enumerable: true,
                        configurable: true,
                        value: self.get(prop),
                    };
                }
                return undefined;
            },
        });
    }

    /**
     * Reset shared data (useful for testing)
     */
    reset(): void {
        this.data = {};
        this.listeners.clear();
        this.globalListeners.clear();
    }

    /**
     * Reset singleton instance (for testing)
     */
    static resetInstance(): void {
        this.instance = null;
    }
}

export default SharedDataManager;
</file>

<file path="resources/js/core/state/index.ts">
/**
 * State Module Exports
 */

export { createState, initState } from './StateFactory';
export type {
    StateConfig,
    StateInstance,
    StateObject,
    StateHelpers,
    ValidationErrors,
    FlashData,
    SharedData,
} from './types';
</file>

<file path="resources/js/core/state/StateFactory.ts">
/**
 * State Factory
 *
 * Factory for creating State component instances that provide
 * unified access to errors, flash data, and shared data.
 */

import type {
    StateConfig,
    StateInstance,
    StateObject,
    StateHelpers,
    ValidationErrors,
    FlashData,
    SharedData,
} from './types';
import type { IStateAdapter } from '../../adapters/types';
import { SharedDataManager } from '../shared';

/**
 * Parse configuration from element data attributes
 */
function parseConfig(element: HTMLElement): StateConfig {
    const id = element.dataset.stateId || `state-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;

    // Parse errors
    let errors: ValidationErrors = {};
    const errorsAttr = element.dataset.stateErrors;
    if (errorsAttr) {
        try {
            errors = JSON.parse(errorsAttr);
        } catch {
            // Invalid JSON, keep empty
        }
    }

    // Parse flash data
    let flash: FlashData = {};
    const flashAttr = element.dataset.stateFlash;
    if (flashAttr) {
        try {
            flash = JSON.parse(flashAttr);
        } catch {
            // Invalid JSON, keep empty
        }
    }

    // Parse shared data (or get from global)
    let shared: SharedData = {};
    const sharedAttr = element.dataset.stateShared;
    if (sharedAttr) {
        try {
            shared = JSON.parse(sharedAttr);
        } catch {
            // Invalid JSON, keep empty
        }
    } else {
        // Use global shared data
        shared = SharedDataManager.getInstance().all();
    }

    return {
        id,
        errors,
        flash,
        shared,
    };
}

/**
 * Create state object from config
 */
function createStateObject(config: StateConfig): StateObject {
    // Convert raw errors to first-error-only format
    const errors: Record<string, string> = {};
    for (const [key, value] of Object.entries(config.errors)) {
        if (Array.isArray(value)) {
            errors[key] = value[0] || '';
        } else {
            errors[key] = value;
        }
    }

    return {
        errors,
        rawErrors: config.errors,
        hasErrors: Object.keys(config.errors).length > 0,
        flash: config.flash,
        shared: config.shared,
    };
}

/**
 * Create helper methods
 */
function createHelpers(state: StateObject): StateHelpers {
    return {
        hasError: (key: string): boolean => {
            return key in state.rawErrors;
        },

        getError: (key: string): string | null => {
            return state.errors[key] || null;
        },

        getErrors: (key: string): string[] => {
            const errors = state.rawErrors[key];
            if (!errors) return [];
            return Array.isArray(errors) ? errors : [errors];
        },

        hasFlash: (key: string): boolean => {
            return key in state.flash;
        },

        getFlash: <T = unknown>(key: string): T | null => {
            return (state.flash[key] as T) ?? null;
        },

        hasShared: (key: string): boolean => {
            // Support dot notation
            const keys = key.split('.');
            let current: unknown = state.shared;

            for (const k of keys) {
                if (current === null || current === undefined || typeof current !== 'object') {
                    return false;
                }
                if (!(k in (current as Record<string, unknown>))) {
                    return false;
                }
                current = (current as Record<string, unknown>)[k];
            }

            return true;
        },

        getShared: <T = unknown>(key: string): T | null => {
            // Support dot notation
            const keys = key.split('.');
            let current: unknown = state.shared;

            for (const k of keys) {
                if (current === null || current === undefined || typeof current !== 'object') {
                    return null;
                }
                current = (current as Record<string, unknown>)[k];
            }

            return (current as T) ?? null;
        },
    };
}

/**
 * Create a state instance
 */
export function createState(
    componentId: string,
    element: HTMLElement,
    stateAdapter: IStateAdapter
): StateInstance | null {
    const config = parseConfig(element);
    const stateObject = createStateObject(config);
    const helpers = createHelpers(stateObject);

    // Set initial state on the adapter
    stateAdapter.set('state', stateObject);
    stateAdapter.set('hasError', helpers.hasError);
    stateAdapter.set('getError', helpers.getError);
    stateAdapter.set('getErrors', helpers.getErrors);
    stateAdapter.set('hasFlash', helpers.hasFlash);
    stateAdapter.set('getFlash', helpers.getFlash);
    stateAdapter.set('hasShared', helpers.hasShared);
    stateAdapter.set('getShared', helpers.getShared);

    const instance: StateInstance = {
        id: config.id,
        config,
        element,
        state: stateObject,
        helpers,
        dispose: () => {
            // Cleanup if needed
        },
    };

    return instance;
}

/**
 * Initialize state components within a container
 */
export function initState(container: HTMLElement | Document = document): StateInstance[] {
    const instances: StateInstance[] = [];

    // This is typically handled by the adapter, but we can scan for standalone state components
    const elements = container.querySelectorAll<HTMLElement>('[data-accelade-state-component]');

    // Note: State components are typically initialized through the adapter
    // This function is for standalone initialization if needed

    return instances;
}

// Re-export types
export type { StateConfig, StateInstance, StateObject, StateHelpers, ValidationErrors, FlashData, SharedData } from './types';
</file>

<file path="resources/js/core/state/types.ts">
/**
 * State Component Types
 *
 * Type definitions for the State component that provides
 * unified access to errors, flash data, and shared data.
 */

/**
 * Validation errors object
 */
export interface ValidationErrors {
    [key: string]: string | string[];
}

/**
 * Flash data object
 */
export interface FlashData {
    [key: string]: unknown;
}

/**
 * Shared data object
 */
export interface SharedData {
    [key: string]: unknown;
}

/**
 * State object exposed to templates
 */
export interface StateObject {
    /**
     * First error message for each field
     */
    errors: Record<string, string>;

    /**
     * Raw error bag (all messages per field)
     */
    rawErrors: ValidationErrors;

    /**
     * Whether any errors exist
     */
    hasErrors: boolean;

    /**
     * Flash data values
     */
    flash: FlashData;

    /**
     * Shared data values
     */
    shared: SharedData;
}

/**
 * State helper methods
 */
export interface StateHelpers {
    /**
     * Check if a field has an error
     */
    hasError: (key: string) => boolean;

    /**
     * Get the first error for a field
     */
    getError: (key: string) => string | null;

    /**
     * Get all errors for a field
     */
    getErrors: (key: string) => string[];

    /**
     * Check if flash data exists
     */
    hasFlash: (key: string) => boolean;

    /**
     * Get flash data value
     */
    getFlash: <T = unknown>(key: string) => T | null;

    /**
     * Check if shared data exists
     */
    hasShared: (key: string) => boolean;

    /**
     * Get shared data value
     */
    getShared: <T = unknown>(key: string) => T | null;
}

/**
 * State configuration from data attributes
 */
export interface StateConfig {
    /**
     * Unique identifier
     */
    id: string;

    /**
     * Initial errors (from server)
     */
    errors: ValidationErrors;

    /**
     * Initial flash data (from server)
     */
    flash: FlashData;

    /**
     * Initial shared data (from server)
     */
    shared: SharedData;
}

/**
 * State instance
 */
export interface StateInstance {
    /**
     * Unique ID
     */
    id: string;

    /**
     * Configuration
     */
    config: StateConfig;

    /**
     * Component element
     */
    element: HTMLElement;

    /**
     * State object
     */
    state: StateObject;

    /**
     * Helper methods
     */
    helpers: StateHelpers;

    /**
     * Cleanup function
     */
    dispose: () => void;
}
</file>

<file path="resources/js/core/teleport/index.ts">
/**
 * Teleport Module Exports
 */

export {
    teleportManager,
    initTeleport,
    registerTeleport,
} from './TeleportManager';

export type {
    TeleportConfig,
    TeleportInstance,
    TeleportEventDetail,
} from './types';
</file>

<file path="resources/js/core/teleport/TeleportManager.ts">
/**
 * Teleport Manager
 *
 * Manages teleporting content from one DOM location to another
 * while preserving reactivity and component scope.
 */

import type { TeleportConfig, TeleportInstance, TeleportEventDetail } from './types';

/**
 * Parse configuration from element data attributes
 */
function parseConfig(element: HTMLElement): TeleportConfig {
    const id = element.dataset.teleportId ||
        `teleport-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;

    const to = element.dataset.teleportTo || '';
    const disabled = element.dataset.teleportDisabled === 'true';

    return {
        id,
        to,
        disabled,
    };
}

/**
 * Create a teleport instance
 */
function createTeleportInstance(element: HTMLElement): TeleportInstance {
    const config = parseConfig(element);

    // Create a placeholder comment to mark the original position
    const placeholder = document.createComment(`teleport:${config.id}`);

    // The content wrapper element
    let contentElement: HTMLElement | null = null;
    let targetElement: HTMLElement | null = null;
    let isTeleported = false;

    /**
     * Teleport the content to target
     */
    const teleport = (): boolean => {
        if (config.disabled || !config.to) {
            return false;
        }

        // Find target element
        targetElement = document.querySelector(config.to);
        if (!targetElement) {
            console.warn(`Accelade Teleport: Target "${config.to}" not found`);
            dispatchEvent(false, `Target "${config.to}" not found`);
            return false;
        }

        // Get the content (children of the source element)
        if (!contentElement) {
            // Create a wrapper for the teleported content
            contentElement = document.createElement('div');
            contentElement.dataset.teleportContent = config.id;
            contentElement.dataset.teleportFrom = config.id;

            // Move all children to the content wrapper
            while (element.firstChild) {
                contentElement.appendChild(element.firstChild);
            }

            // Insert placeholder
            element.appendChild(placeholder);
        }

        // Move content to target
        targetElement.appendChild(contentElement);
        isTeleported = true;

        // Mark source as teleported
        element.dataset.teleportActive = 'true';

        dispatchEvent(true);
        return true;
    };

    /**
     * Return content to original position
     */
    const returnContent = (): void => {
        if (!isTeleported || !contentElement) {
            return;
        }

        // Remove placeholder
        if (placeholder.parentNode === element) {
            element.removeChild(placeholder);
        }

        // Move content back
        while (contentElement.firstChild) {
            element.appendChild(contentElement.firstChild);
        }

        // Remove empty content wrapper from target
        if (contentElement.parentNode) {
            contentElement.parentNode.removeChild(contentElement);
        }

        contentElement = null;
        targetElement = null;
        isTeleported = false;

        delete element.dataset.teleportActive;
    };

    /**
     * Update target selector and re-teleport
     */
    const updateTarget = (selector: string): boolean => {
        // Return content first if already teleported
        if (isTeleported) {
            returnContent();
        }

        config.to = selector;
        return teleport();
    };

    /**
     * Dispatch teleport event
     */
    const dispatchEvent = (success: boolean, error?: string): void => {
        const detail: TeleportEventDetail = {
            id: config.id,
            to: config.to,
            success,
            error,
        };

        document.dispatchEvent(new CustomEvent('accelade:teleport', { detail }));
        element.dispatchEvent(new CustomEvent('teleport', { detail, bubbles: true }));
    };

    /**
     * Clean up
     */
    const dispose = (): void => {
        returnContent();
    };

    const instance: TeleportInstance = {
        id: config.id,
        config,
        sourceElement: element,
        get targetElement() { return targetElement; },
        get contentElement() { return contentElement; },
        get isTeleported() { return isTeleported; },
        teleport,
        return: returnContent,
        updateTarget,
        dispose,
    };

    return instance;
}

/**
 * Teleport Manager Singleton
 */
class TeleportManagerClass {
    private instances: Map<string, TeleportInstance> = new Map();
    private initialized = false;

    /**
     * Initialize the teleport system
     */
    init(): void {
        if (this.initialized) {
            return;
        }

        this.initialized = true;

        // Initialize existing teleport elements
        this.initTeleports();

        // Watch for new teleport elements via MutationObserver
        this.setupMutationObserver();
    }

    /**
     * Initialize all teleport elements in the document
     */
    initTeleports(container: HTMLElement | Document = document): void {
        const elements = container.querySelectorAll<HTMLElement>('[data-accelade-teleport]');

        elements.forEach((element) => {
            if (!element.dataset.teleportInitialized) {
                this.register(element);
            }
        });
    }

    /**
     * Register a teleport element
     */
    register(element: HTMLElement): TeleportInstance | null {
        if (element.dataset.teleportInitialized) {
            const existingId = element.dataset.teleportId;
            return existingId ? this.instances.get(existingId) || null : null;
        }

        const instance = createTeleportInstance(element);
        this.instances.set(instance.id, instance);
        element.dataset.teleportInitialized = 'true';
        element.dataset.teleportId = instance.id;

        // Auto-teleport if target is specified and not disabled
        if (instance.config.to && !instance.config.disabled) {
            // Wait for parent Accelade component to fully initialize bindings
            // Use setTimeout to ensure we run after all synchronous initialization
            // and after requestAnimationFrame callbacks from component init
            setTimeout(() => {
                // Double-check element is still in DOM
                if (element.isConnected) {
                    instance.teleport();
                }
            }, 50);
        }

        return instance;
    }

    /**
     * Unregister a teleport instance
     */
    unregister(id: string): void {
        const instance = this.instances.get(id);
        if (instance) {
            instance.dispose();
            this.instances.delete(id);
        }
    }

    /**
     * Get a teleport instance by ID
     */
    get(id: string): TeleportInstance | undefined {
        return this.instances.get(id);
    }

    /**
     * Get all teleport instances
     */
    getAll(): Map<string, TeleportInstance> {
        return new Map(this.instances);
    }

    /**
     * Teleport content by ID
     */
    teleport(id: string): boolean {
        const instance = this.instances.get(id);
        if (!instance) {
            console.warn(`Accelade Teleport: Instance "${id}" not found`);
            return false;
        }
        return instance.teleport();
    }

    /**
     * Return teleported content by ID
     */
    return(id: string): void {
        const instance = this.instances.get(id);
        if (instance) {
            instance.return();
        }
    }

    /**
     * Update target for a teleport instance
     */
    updateTarget(id: string, selector: string): boolean {
        const instance = this.instances.get(id);
        if (!instance) {
            return false;
        }
        return instance.updateTarget(selector);
    }

    /**
     * Setup mutation observer to auto-init new teleport elements
     */
    private setupMutationObserver(): void {
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node instanceof HTMLElement) {
                        // Check if the node itself is a teleport
                        if (node.hasAttribute('data-accelade-teleport')) {
                            this.register(node);
                        }
                        // Check descendants
                        this.initTeleports(node);
                    }
                });

                // Handle removed nodes
                mutation.removedNodes.forEach((node) => {
                    if (node instanceof HTMLElement) {
                        const id = node.dataset.teleportId;
                        if (id) {
                            this.unregister(id);
                        }
                        // Check descendants
                        node.querySelectorAll<HTMLElement>('[data-teleport-id]').forEach((el) => {
                            const childId = el.dataset.teleportId;
                            if (childId) {
                                this.unregister(childId);
                            }
                        });
                    }
                });
            });
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true,
        });
    }

    /**
     * Dispose all instances
     */
    dispose(): void {
        this.instances.forEach((instance) => {
            instance.dispose();
        });
        this.instances.clear();
    }
}

// Export singleton instance
export const teleportManager = new TeleportManagerClass();

/**
 * Initialize teleport system
 */
export function initTeleport(container?: HTMLElement | Document): void {
    teleportManager.init();
    if (container) {
        teleportManager.initTeleports(container);
    }
}

/**
 * Register a teleport element
 */
export function registerTeleport(element: HTMLElement): TeleportInstance | null {
    return teleportManager.register(element);
}

// Re-export types
export type { TeleportConfig, TeleportInstance, TeleportEventDetail } from './types';
</file>

<file path="resources/js/core/teleport/types.ts">
/**
 * Teleport Component Types
 *
 * Type definitions for the Teleport component that enables
 * relocating template sections to different DOM nodes.
 */

/**
 * Teleport configuration from data attributes
 */
export interface TeleportConfig {
    /**
     * Unique identifier for the teleport instance
     */
    id: string;

    /**
     * CSS selector for the target element
     */
    to: string;

    /**
     * Whether teleport is disabled (content stays in place)
     */
    disabled: boolean;
}

/**
 * Teleport instance
 */
export interface TeleportInstance {
    /**
     * Unique identifier
     */
    id: string;

    /**
     * Configuration
     */
    config: TeleportConfig;

    /**
     * Source element (placeholder)
     */
    sourceElement: HTMLElement;

    /**
     * Target element where content is teleported
     */
    targetElement: HTMLElement | null;

    /**
     * The actual content that was teleported
     */
    contentElement: HTMLElement | null;

    /**
     * Whether currently teleported
     */
    isTeleported: boolean;

    /**
     * Teleport the content to target
     */
    teleport: () => boolean;

    /**
     * Return content to original position
     */
    return: () => void;

    /**
     * Update target selector
     */
    updateTarget: (selector: string) => boolean;

    /**
     * Clean up
     */
    dispose: () => void;
}

/**
 * Teleport event detail
 */
export interface TeleportEventDetail {
    /**
     * Teleport instance ID
     */
    id: string;

    /**
     * Target selector
     */
    to: string;

    /**
     * Whether teleport succeeded
     */
    success: boolean;

    /**
     * Error message if failed
     */
    error?: string;
}
</file>

<file path="resources/js/core/toggle/index.ts">
/**
 * Toggle Module Exports
 */

export { ToggleFactory, createToggle, createToggleMethods } from './ToggleFactory';
export type { ToggleConfig, ToggleInstance, ToggleMethods, ToggleState } from './types';
</file>

<file path="resources/js/core/toggle/ToggleFactory.ts">
/**
 * Toggle Factory
 *
 * Creates Toggle instances for managing boolean state values.
 * Supports both single toggle mode and multi-key mode.
 */

import type { IStateAdapter } from '../../adapters/types';
import type { ToggleConfig, ToggleInstance, ToggleMethods } from './types';

/**
 * Default key for single toggle mode
 */
const DEFAULT_KEY = 'toggled';

/**
 * Parse toggle configuration from element
 */
function parseConfig(element: HTMLElement): ToggleConfig {
    const id = element.dataset.toggleId ||
        `toggle-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;

    const dataAttr = element.dataset.toggleData || '';
    const defaultValueAttr = element.dataset.toggleDefault;

    // Parse default value
    const defaultValue = defaultValueAttr === 'true';

    // Parse keys from data attribute
    let keys: string[] = [];
    if (dataAttr) {
        // Check if it's a boolean string (single toggle with default)
        if (dataAttr === 'true' || dataAttr === 'false') {
            keys = [DEFAULT_KEY];
        } else {
            // Parse comma-separated keys
            keys = dataAttr.split(',').map(k => k.trim()).filter(k => k.length > 0);
        }
    } else {
        keys = [DEFAULT_KEY];
    }

    return {
        id,
        keys,
        defaultValue,
    };
}

/**
 * Create initial toggle state
 */
function createInitialState(config: ToggleConfig): Record<string, boolean> {
    const state: Record<string, boolean> = {};

    for (const key of config.keys) {
        state[key] = config.defaultValue;
    }

    return state;
}

/**
 * Create a Toggle instance
 */
export function createToggle(
    componentId: string,
    element: HTMLElement,
    stateAdapter: IStateAdapter
): ToggleInstance | undefined {
    const config = parseConfig(element);
    const isMultiKey = config.keys.length > 1 || (config.keys.length === 1 && config.keys[0] !== DEFAULT_KEY);

    // Initialize state with toggle values
    const initialState = createInitialState(config);
    for (const [key, value] of Object.entries(initialState)) {
        // Only set if not already set in state
        if (stateAdapter.get(key) === undefined) {
            stateAdapter.set(key, value);
        }
    }

    /**
     * Toggle a value
     */
    const toggle = (key?: string): void => {
        const targetKey = isMultiKey ? key : DEFAULT_KEY;
        if (!targetKey) {
            console.warn('Toggle: Key required for multi-key toggle');
            return;
        }

        const currentValue = stateAdapter.get(targetKey);
        stateAdapter.set(targetKey, !currentValue);

        // Dispatch event
        dispatchToggleEvent(element, targetKey, !currentValue);
    };

    /**
     * Set a specific toggle value
     */
    const setToggle = (keyOrValue: string | boolean, value?: boolean): void => {
        if (isMultiKey) {
            // Multi-key mode: first arg is key, second is value
            if (typeof keyOrValue !== 'string') {
                console.warn('Toggle: Key must be a string in multi-key mode');
                return;
            }
            // Handle string 'true'/'false' from expression evaluation
            let targetValue: boolean;
            if (typeof value === 'boolean') {
                targetValue = value;
            } else if (value === 'true' || value === undefined) {
                targetValue = true;
            } else if (value === 'false') {
                targetValue = false;
            } else {
                targetValue = Boolean(value);
            }
            stateAdapter.set(keyOrValue, targetValue);
            dispatchToggleEvent(element, keyOrValue, targetValue);
        } else {
            // Single toggle mode: first arg is value
            // Handle string 'true'/'false' from expression evaluation
            let targetValue: boolean;
            if (typeof keyOrValue === 'boolean') {
                targetValue = keyOrValue;
            } else if (keyOrValue === 'true') {
                targetValue = true;
            } else if (keyOrValue === 'false') {
                targetValue = false;
            } else {
                targetValue = true; // default for unknown values
            }
            stateAdapter.set(DEFAULT_KEY, targetValue);
            dispatchToggleEvent(element, DEFAULT_KEY, targetValue);
        }
    };

    /**
     * Get toggled state
     */
    const getToggled = (key?: string): boolean => {
        const targetKey = isMultiKey ? key : DEFAULT_KEY;
        if (!targetKey) {
            return false;
        }
        return Boolean(stateAdapter.get(targetKey));
    };

    /**
     * Dispatch toggle event
     */
    const dispatchToggleEvent = (el: HTMLElement, key: string, value: boolean): void => {
        const detail = { key, value, id: config.id };
        el.dispatchEvent(new CustomEvent('toggle', { detail, bubbles: true }));
        document.dispatchEvent(new CustomEvent('accelade:toggle', { detail }));
    };

    /**
     * Dispose
     */
    const dispose = (): void => {
        // Cleanup if needed
    };

    return {
        id: config.id,
        config,
        element,
        isMultiKey,
        toggle,
        setToggle,
        getToggled,
        dispose,
    };
}

/**
 * Create toggle methods for template usage
 */
export function createToggleMethods(instance: ToggleInstance): ToggleMethods {
    return {
        toggle: instance.toggle,
        setToggle: instance.setToggle,
    };
}

/**
 * ToggleFactory namespace for module exports
 */
export const ToggleFactory = {
    parseConfig,
    create: createToggle,
    createMethods: createToggleMethods,
};
</file>

<file path="resources/js/core/toggle/types.ts">
/**
 * Toggle Component Types
 *
 * Types for the Toggle component which provides a simplified interface
 * for managing boolean state values.
 */

/**
 * Toggle configuration parsed from element attributes
 */
export interface ToggleConfig {
    /** Unique identifier for the toggle instance */
    id: string;
    /** Initial toggle keys with their default values */
    keys: string[];
    /** Default value for single toggle mode */
    defaultValue: boolean;
}

/**
 * Toggle state - can be a single boolean or multiple named booleans
 */
export type ToggleState = Record<string, boolean>;

/**
 * Toggle instance returned by the factory
 */
export interface ToggleInstance {
    /** Unique identifier */
    id: string;
    /** Configuration */
    config: ToggleConfig;
    /** The source element */
    element: HTMLElement;
    /** Whether this is multi-key mode */
    isMultiKey: boolean;
    /**
     * Toggle a value
     * @param key - Optional key for multi-toggle mode
     */
    toggle: (key?: string) => void;
    /**
     * Set a specific toggle value
     * @param keyOrValue - Key (for multi) or value (for single)
     * @param value - Value (only for multi-key mode)
     */
    setToggle: (keyOrValue: string | boolean, value?: boolean) => void;
    /**
     * Get the current toggled state
     * @param key - Optional key for multi-toggle mode
     */
    getToggled: (key?: string) => boolean;
    /** Dispose the toggle instance */
    dispose: () => void;
}

/**
 * Toggle methods exposed to templates
 */
export interface ToggleMethods {
    /** Toggle function */
    toggle: (key?: string) => void;
    /** Set toggle function */
    setToggle: (keyOrValue: string | boolean, value?: boolean) => void;
}
</file>

<file path="resources/js/core/transition/index.ts">
/**
 * Transition module exports
 */

export * from './types';
export * from './TransitionFactory';
</file>

<file path="resources/js/core/transition/TransitionFactory.ts">
/**
 * Transition Factory
 *
 * Creates Transition instances for CSS class-based enter/leave animations.
 * Similar to Vue/Alpine transitions with customizable classes.
 */

import type { IStateAdapter } from '../../adapters/types';
import type { TransitionConfig, TransitionInstance } from './types';
import { evaluateBooleanExpression } from '../expressions';

/**
 * Parse transition configuration from element
 */
function parseConfig(element: HTMLElement): TransitionConfig {
    const id = element.dataset.transitionId ||
        `transition-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;

    return {
        id,
        showExpression: element.dataset.transitionShow || 'true',
        enter: element.dataset.transitionEnter || 'transition ease-out duration-200',
        enterFrom: element.dataset.transitionEnterFrom || 'opacity-0',
        enterTo: element.dataset.transitionEnterTo || 'opacity-100',
        leave: element.dataset.transitionLeave || 'transition ease-in duration-150',
        leaveFrom: element.dataset.transitionLeaveFrom || 'opacity-100',
        leaveTo: element.dataset.transitionLeaveTo || 'opacity-0',
    };
}

/**
 * Parse classes string into array
 */
function parseClasses(classString: string): string[] {
    return classString.split(/\s+/).filter(c => c.length > 0);
}

/**
 * Add classes to element
 */
function addClasses(element: HTMLElement, classes: string[]): void {
    classes.forEach(c => element.classList.add(c));
}

/**
 * Remove classes from element
 */
function removeClasses(element: HTMLElement, classes: string[]): void {
    classes.forEach(c => element.classList.remove(c));
}

/**
 * Get transition duration from element's computed style
 */
function getTransitionDuration(element: HTMLElement): number {
    const style = window.getComputedStyle(element);
    const duration = style.transitionDuration || '0s';

    // Parse duration (can be "0.2s" or "200ms")
    const match = duration.match(/^([\d.]+)(s|ms)$/);
    if (match) {
        const value = parseFloat(match[1]);
        const unit = match[2];
        return unit === 's' ? value * 1000 : value;
    }

    return 200; // Default fallback
}

/**
 * Wait for next frame
 */
function nextFrame(): Promise<void> {
    return new Promise(resolve => {
        requestAnimationFrame(() => {
            requestAnimationFrame(() => resolve());
        });
    });
}

/**
 * Create a Transition instance
 */
export function createTransition(
    componentId: string,
    element: HTMLElement,
    stateAdapter: IStateAdapter
): TransitionInstance {
    const config = parseConfig(element);
    let isVisible = true;
    let isAnimating = false;

    // Parse all class sets
    const enterClasses = parseClasses(config.enter);
    const enterFromClasses = parseClasses(config.enterFrom);
    const enterToClasses = parseClasses(config.enterTo);
    const leaveClasses = parseClasses(config.leave);
    const leaveFromClasses = parseClasses(config.leaveFrom);
    const leaveToClasses = parseClasses(config.leaveTo);

    /**
     * Perform enter animation
     */
    const enter = async (): Promise<void> => {
        if (isAnimating) return;
        isAnimating = true;

        // Make visible
        element.style.display = '';

        // Add enter + enterFrom classes
        addClasses(element, enterClasses);
        addClasses(element, enterFromClasses);

        // Wait for next frame to ensure classes are applied
        await nextFrame();

        // Remove enterFrom, add enterTo
        removeClasses(element, enterFromClasses);
        addClasses(element, enterToClasses);

        // Get duration and wait for transition
        const duration = getTransitionDuration(element);

        await new Promise(resolve => setTimeout(resolve, duration));

        // Cleanup - remove transition classes
        removeClasses(element, enterClasses);
        removeClasses(element, enterToClasses);

        isVisible = true;
        isAnimating = false;
    };

    /**
     * Perform leave animation
     */
    const leave = async (): Promise<void> => {
        if (isAnimating) return;
        isAnimating = true;

        // Add leave + leaveFrom classes
        addClasses(element, leaveClasses);
        addClasses(element, leaveFromClasses);

        // Wait for next frame
        await nextFrame();

        // Remove leaveFrom, add leaveTo
        removeClasses(element, leaveFromClasses);
        addClasses(element, leaveToClasses);

        // Get duration and wait for transition
        const duration = getTransitionDuration(element);

        await new Promise(resolve => setTimeout(resolve, duration));

        // Cleanup - remove transition classes and hide
        removeClasses(element, leaveClasses);
        removeClasses(element, leaveToClasses);
        element.style.display = 'none';

        isVisible = false;
        isAnimating = false;
    };

    /**
     * Update visibility based on state
     */
    const update = (state: Record<string, unknown>): void => {
        const shouldShow = evaluateBooleanExpression(config.showExpression, state);

        if (shouldShow && !isVisible && !isAnimating) {
            enter();
        } else if (!shouldShow && isVisible && !isAnimating) {
            leave();
        }
    };

    /**
     * Force show with animation
     */
    const show = (): void => {
        if (!isVisible && !isAnimating) {
            enter();
        }
    };

    /**
     * Force hide with animation
     */
    const hide = (): void => {
        if (isVisible && !isAnimating) {
            leave();
        }
    };

    /**
     * Dispose
     */
    const dispose = (): void => {
        // Cleanup all possible classes
        removeClasses(element, enterClasses);
        removeClasses(element, enterFromClasses);
        removeClasses(element, enterToClasses);
        removeClasses(element, leaveClasses);
        removeClasses(element, leaveFromClasses);
        removeClasses(element, leaveToClasses);
    };

    // Initial state check - hide if show expression is false
    const initialState = stateAdapter.getState();
    const initialShow = evaluateBooleanExpression(config.showExpression, initialState);

    if (!initialShow) {
        element.style.display = 'none';
        isVisible = false;
    }

    // Subscribe to state changes
    const unsubscribe = stateAdapter.subscribe(() => {
        update(stateAdapter.getState());
    });

    return {
        id: config.id,
        config,
        element,
        get isVisible() {
            return isVisible;
        },
        update,
        show,
        hide,
        dispose: () => {
            unsubscribe();
            dispose();
        },
    };
}

/**
 * TransitionFactory namespace for module exports
 */
export const TransitionFactory = {
    parseConfig,
    create: createTransition,
};
</file>

<file path="resources/js/core/transition/types.ts">
/**
 * Transition Component Types
 *
 * Types for the Transition component which provides CSS class-based
 * enter/leave animations.
 */

/**
 * Transition configuration parsed from element attributes
 */
export interface TransitionConfig {
    /** Unique identifier for the transition instance */
    id: string;
    /** Expression to evaluate for show/hide state */
    showExpression: string;
    /** Classes applied during enter transition */
    enter: string;
    /** Classes applied at the start of enter transition */
    enterFrom: string;
    /** Classes applied at the end of enter transition */
    enterTo: string;
    /** Classes applied during leave transition */
    leave: string;
    /** Classes applied at the start of leave transition */
    leaveFrom: string;
    /** Classes applied at the end of leave transition */
    leaveTo: string;
}

/**
 * Transition instance returned by the factory
 */
export interface TransitionInstance {
    /** Unique identifier */
    id: string;
    /** Configuration */
    config: TransitionConfig;
    /** The transition element */
    element: HTMLElement;
    /** Current visibility state */
    isVisible: boolean;
    /** Update visibility based on expression */
    update: (state: Record<string, unknown>) => void;
    /** Force show with animation */
    show: () => void;
    /** Force hide with animation */
    hide: () => void;
    /** Dispose the transition instance */
    dispose: () => void;
}
</file>

<file path="resources/js/core/expressions.ts">
/**
 * Expression Evaluator - Shared expression evaluation logic
 */

/**
 * Evaluate an expression against state
 */
export function evaluateExpression(
    expr: string,
    state: Record<string, unknown>
): unknown {
    try {
        // Simple property access (e.g., "count", "user.name")
        if (/^[\w.]+$/.test(expr)) {
            return getNestedValue(state, expr);
        }

        // Create evaluation function with state variables in scope
        const keys = Object.keys(state);
        const values = Object.values(state);
        const fn = new Function(...keys, 'return ' + expr) as (...args: unknown[]) => unknown;
        return fn(...values);
    } catch {
        return undefined;
    }
}

/**
 * Evaluate a boolean expression
 */
export function evaluateBooleanExpression(
    expr: string,
    state: Record<string, unknown>
): boolean {
    const result = evaluateExpression(expr, state);
    return Boolean(result);
}

/**
 * Evaluate a string expression (with template interpolation)
 */
export function evaluateStringExpression(
    expr: string,
    state: Record<string, unknown>
): string {
    const result = evaluateExpression(expr, state);
    return result !== undefined ? String(result) : '';
}

/**
 * Get nested value from object using dot notation
 */
export function getNestedValue(obj: Record<string, unknown>, path: string): unknown {
    return path.split('.').reduce<unknown>(
        (current, key) => {
            if (current !== null && typeof current === 'object') {
                return (current as Record<string, unknown>)[key];
            }
            return undefined;
        },
        obj
    );
}

/**
 * Set nested value in object using dot notation
 */
export function setNestedValue(
    obj: Record<string, unknown>,
    path: string,
    value: unknown
): void {
    const keys = path.split('.');
    const lastKey = keys.pop();

    if (!lastKey) return;

    let current: Record<string, unknown> = obj;
    for (const key of keys) {
        if (!(key in current) || typeof current[key] !== 'object') {
            current[key] = {};
        }
        current = current[key] as Record<string, unknown>;
    }

    current[lastKey] = value;
}

/**
 * Interpolate mustache-style templates
 * e.g., "Hello {{ name }}" -> "Hello John"
 */
export function interpolate(
    template: string,
    state: Record<string, unknown>
): string {
    return template.replace(/\{\{\s*([\w.]+)\s*\}\}/g, (_, key: string) => {
        const value = getNestedValue(state, key);
        return value !== undefined ? String(value) : '';
    });
}

/**
 * Parse a class binding object expression
 * e.g., "{ active: isActive, 'text-red': hasError }" -> { active: true, 'text-red': false }
 */
export function parseClassObject(
    expr: string,
    state: Record<string, unknown>
): Record<string, boolean> {
    try {
        // If it's a simple property reference
        if (/^[\w.]+$/.test(expr)) {
            const value = getNestedValue(state, expr);
            if (typeof value === 'object' && value !== null) {
                return value as Record<string, boolean>;
            }
            return {};
        }

        // Parse as object expression
        const result = evaluateExpression(expr, state);
        if (typeof result === 'object' && result !== null) {
            return result as Record<string, boolean>;
        }
        return {};
    } catch {
        return {};
    }
}

/**
 * Parse a style binding object expression
 */
export function parseStyleObject(
    expr: string,
    state: Record<string, unknown>
): Record<string, string> {
    try {
        const result = evaluateExpression(expr, state);
        if (typeof result === 'object' && result !== null) {
            const styles: Record<string, string> = {};
            for (const [key, value] of Object.entries(result)) {
                if (value !== null && value !== undefined) {
                    styles[key] = String(value);
                }
            }
            return styles;
        }
        return {};
    } catch {
        return {};
    }
}

/**
 * Check if expression is a simple property reference
 */
export function isSimpleProperty(expr: string): boolean {
    return /^[\w.]+$/.test(expr);
}

/**
 * Check if expression contains operators
 */
export function hasOperators(expr: string): boolean {
    return /[+\-*/%<>=!&|?:]/.test(expr);
}

/**
 * Safe expression evaluation with error handling
 */
export function safeEvaluate<T>(
    expr: string,
    state: Record<string, unknown>,
    defaultValue: T
): T {
    try {
        const result = evaluateExpression(expr, state);
        return (result as T) ?? defaultValue;
    } catch {
        return defaultValue;
    }
}

export default {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    getNestedValue,
    setNestedValue,
    interpolate,
    parseClassObject,
    parseStyleObject,
    isSimpleProperty,
    hasOperators,
    safeEvaluate,
};
</file>

<file path="resources/js/core/state.ts">
/**
 * Accelade State Management
 * Framework-agnostic reactive state management
 */

import type {
    StateChangeCallback,
    StateSetOptions,
    StateChange,
    SyncUpdatePayload,
    BatchSyncUpdatePayload,
} from './types';

export interface AcceladeStateOptions {
    componentId?: string | null;
}

export class AcceladeState {
    private state: Record<string, unknown>;
    private listeners: Map<string, Set<StateChangeCallback>>;
    private syncEnabled: Set<string>;
    private componentId: string | null;
    private debounceTimers: Map<string, ReturnType<typeof setTimeout>>;

    constructor(initialState: Record<string, unknown> = {}, options: AcceladeStateOptions = {}) {
        this.state = { ...initialState };
        this.listeners = new Map();
        this.syncEnabled = new Set();
        this.componentId = options.componentId ?? null;
        this.debounceTimers = new Map();
    }

    /**
     * Get a state value
     */
    get<T = unknown>(key: string): T | undefined {
        return this.state[key] as T | undefined;
    }

    /**
     * Get all state
     */
    getAll(): Record<string, unknown> {
        return { ...this.state };
    }

    /**
     * Set a state value
     */
    set(key: string, value: unknown, options: StateSetOptions = {}): void {
        const oldValue = this.state[key];

        if (oldValue === value) return;

        this.state[key] = value;

        // Notify listeners
        this.notify(key, value, oldValue);

        // Sync to server if enabled
        if (options.sync !== false && this.syncEnabled.has(key)) {
            this.syncToServer(key, value);
        }
    }

    /**
     * Update multiple state values
     */
    setMany(updates: Record<string, unknown>, options: StateSetOptions = {}): void {
        const changes: StateChange[] = [];

        for (const [key, value] of Object.entries(updates)) {
            const oldValue = this.state[key];
            if (oldValue !== value) {
                this.state[key] = value;
                changes.push({ key, value, oldValue });
                this.notify(key, value, oldValue);
            }
        }

        // Batch sync if needed
        if (options.sync !== false && changes.length > 0) {
            const syncChanges = changes.filter(c => this.syncEnabled.has(c.key));
            if (syncChanges.length > 0) {
                this.batchSyncToServer(syncChanges);
            }
        }
    }

    /**
     * Enable sync for a property
     */
    enableSync(key: string): void {
        this.syncEnabled.add(key);
    }

    /**
     * Enable sync for multiple properties
     */
    enableSyncMany(keys: string[]): void {
        keys.forEach(key => this.syncEnabled.add(key));
    }

    /**
     * Subscribe to state changes
     */
    subscribe(key: string, callback: StateChangeCallback): () => void {
        if (!this.listeners.has(key)) {
            this.listeners.set(key, new Set());
        }
        this.listeners.get(key)!.add(callback);

        // Return unsubscribe function
        return () => {
            this.listeners.get(key)?.delete(callback);
        };
    }

    /**
     * Subscribe to all state changes
     */
    subscribeAll(callback: StateChangeCallback): () => void {
        const key = '*';
        if (!this.listeners.has(key)) {
            this.listeners.set(key, new Set());
        }
        this.listeners.get(key)!.add(callback);

        return () => {
            this.listeners.get(key)?.delete(callback);
        };
    }

    /**
     * Notify listeners of a change
     */
    private notify(key: string, newValue: unknown, oldValue: unknown): void {
        // Notify specific key listeners
        this.listeners.get(key)?.forEach(cb => cb(newValue, oldValue, key));

        // Notify wildcard listeners
        this.listeners.get('*')?.forEach(cb => cb(newValue, oldValue, key));
    }

    /**
     * Sync a single property to server (debounced)
     */
    private syncToServer(key: string, value: unknown): void {
        const debounce = window.AcceladeConfig?.syncDebounce ?? 300;

        // Clear existing timer
        const existingTimer = this.debounceTimers.get(key);
        if (existingTimer !== undefined) {
            clearTimeout(existingTimer);
        }

        // Set new debounced sync
        const timer = setTimeout(() => {
            void this.doSync(key, value);
            this.debounceTimers.delete(key);
        }, debounce);

        this.debounceTimers.set(key, timer);
    }

    /**
     * Perform the actual sync request
     */
    private async doSync(key: string, value: unknown): Promise<unknown> {
        const config = window.AcceladeConfig;

        try {
            const payload: SyncUpdatePayload = {
                component: this.componentId,
                property: key,
                value: value,
            };

            const response = await fetch(config?.updateUrl ?? '/accelade/update', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRF-TOKEN': config?.csrfToken ?? '',
                    'Accept': 'application/json',
                },
                body: JSON.stringify(payload),
            });

            if (!response.ok) {
                console.error('Accelade sync failed:', response.statusText);
            }

            return response.json() as Promise<unknown>;
        } catch (error) {
            console.error('Accelade sync error:', error);
            return undefined;
        }
    }

    /**
     * Batch sync multiple properties
     */
    private async batchSyncToServer(changes: StateChange[]): Promise<unknown> {
        const config = window.AcceladeConfig;

        try {
            const payload: BatchSyncUpdatePayload = {
                component: this.componentId,
                updates: changes.map(c => ({
                    property: c.key,
                    value: c.value,
                })),
            };

            const response = await fetch(config?.batchUpdateUrl ?? '/accelade/batch-update', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRF-TOKEN': config?.csrfToken ?? '',
                    'Accept': 'application/json',
                },
                body: JSON.stringify(payload),
            });

            return response.json() as Promise<unknown>;
        } catch (error) {
            console.error('Accelade batch sync error:', error);
            return undefined;
        }
    }
}

export default AcceladeState;
</file>

<file path="resources/js/core/utils.ts">
/**
 * Accelade Utilities
 */

import type { AcceladeComponentConfig } from './types';

/**
 * Parse data attributes from an element
 */
export function parseAcceladeElement(element: HTMLElement): AcceladeComponentConfig {
    const id = element.dataset.acceladeId ?? `accelade-${Math.random().toString(36).slice(2, 10)}`;

    let state: Record<string, unknown> = {};
    try {
        state = JSON.parse(element.dataset.acceladeState ?? '{}') as Record<string, unknown>;
    } catch {
        console.error('Accelade: Invalid state JSON', element.dataset.acceladeState);
    }

    let props: Record<string, unknown> = {};
    try {
        props = JSON.parse(element.dataset.acceladeProps ?? '{}') as Record<string, unknown>;
    } catch {
        console.error('Accelade: Invalid props JSON', element.dataset.acceladeProps);
    }

    return {
        id,
        state,
        sync: (element.dataset.acceladeSync ?? '').split(',').filter(Boolean),
        props,
    };
}

/**
 * Find all Accelade components in the DOM
 */
export function findAcceladeComponents(root: Document | Element = document): HTMLElement[] {
    return Array.from(root.querySelectorAll<HTMLElement>('[data-accelade]'));
}

/**
 * Debounce a function
 */
export function debounce<T extends (...args: unknown[]) => unknown>(
    fn: T,
    delay: number
): (...args: Parameters<T>) => void {
    let timer: ReturnType<typeof setTimeout> | null = null;
    return function (this: unknown, ...args: Parameters<T>): void {
        if (timer !== null) {
            clearTimeout(timer);
        }
        timer = setTimeout(() => fn.apply(this, args), delay);
    };
}

/**
 * Deep clone an object
 */
export function deepClone<T>(obj: T): T {
    return JSON.parse(JSON.stringify(obj)) as T;
}

/**
 * Check if a value is a plain object
 */
export function isObject(val: unknown): val is Record<string, unknown> {
    return val !== null && typeof val === 'object' && !Array.isArray(val);
}

/**
 * Merge objects deeply
 */
export function deepMerge<T extends Record<string, unknown>>(
    target: T,
    source: Partial<T>
): T {
    const result = { ...target } as T;

    for (const key of Object.keys(source) as Array<keyof T>) {
        const sourceValue = source[key];
        const targetValue = target[key];

        if (isObject(sourceValue) && isObject(targetValue)) {
            result[key] = deepMerge(
                targetValue as Record<string, unknown>,
                sourceValue as Record<string, unknown>
            ) as T[keyof T];
        } else if (sourceValue !== undefined) {
            result[key] = sourceValue as T[keyof T];
        }
    }

    return result;
}

/**
 * Get nested value from object using dot notation
 */
export function getNestedValue(obj: Record<string, unknown>, path: string): unknown {
    return path.split('.').reduce<unknown>(
        (current, key) => {
            if (current !== null && typeof current === 'object') {
                return (current as Record<string, unknown>)[key];
            }
            return undefined;
        },
        obj
    );
}

/**
 * Set nested value in object using dot notation
 */
export function setNestedValue(
    obj: Record<string, unknown>,
    path: string,
    value: unknown
): void {
    const keys = path.split('.');
    const lastKey = keys.pop();

    if (!lastKey) return;

    let current: Record<string, unknown> = obj;
    for (const key of keys) {
        if (!(key in current) || typeof current[key] !== 'object') {
            current[key] = {};
        }
        current = current[key] as Record<string, unknown>;
    }

    current[lastKey] = value;
}

export default {
    parseAcceladeElement,
    findAcceladeComponents,
    debounce,
    deepClone,
    isObject,
    deepMerge,
    getNestedValue,
    setNestedValue,
};
</file>

<file path="resources/js/registry/FrameworkRegistry.ts">
/**
 * FrameworkRegistry - Runtime framework detection and adapter management
 */

import type { IFrameworkAdapter, FrameworkType, AdapterRegistration, AdapterFactory } from '../adapters/types';
import { ConfigFactory } from '../core/factories/ConfigFactory';

/**
 * Detection strategies for each framework
 */
const DETECTION_STRATEGIES: Record<FrameworkType, () => boolean> = {
    vanilla: () => true, // Always available as fallback

    vue: () => {
        if (typeof window === 'undefined') return false;
        // Check for Vue global
        if ('Vue' in window) return true;
        // Check for Vue-compiled templates
        if (document.querySelector('[data-v-]')) return true;
        if (document.querySelector('[v-cloak]')) return true;
        return false;
    },

    react: () => {
        if (typeof window === 'undefined') return false;
        // Check for React global
        if ('React' in window) return true;
        // Check for React root
        if (document.querySelector('[data-reactroot]')) return true;
        // Check for React 18+ root
        if (document.querySelector('#__next')) return true;
        // Check for React fiber
        const root = document.getElementById('root');
        if (root && '_reactRootContainer' in root) return true;
        return false;
    },

    svelte: () => {
        if (typeof window === 'undefined') return false;
        // Check for Svelte-compiled class names
        if (document.querySelector('[class*="svelte-"]')) return true;
        // Check for SvelteKit
        if (document.querySelector('#svelte')) return true;
        return false;
    },

    angular: () => {
        if (typeof window === 'undefined') return false;
        // Check for Angular globals
        if ('ng' in window) return true;
        // Check for Angular version attribute
        if (document.querySelector('[ng-version]')) return true;
        // Check for Angular app
        if (document.querySelector('app-root')) return true;
        return false;
    },
};

/**
 * Framework priority (higher = preferred)
 */
const FRAMEWORK_PRIORITY: Record<FrameworkType, number> = {
    react: 100,
    vue: 90,
    svelte: 80,
    angular: 70,
    vanilla: 0, // Fallback
};

/**
 * FrameworkRegistry - Manages framework adapters and detection
 */
export class FrameworkRegistry {
    private static registrations: Map<FrameworkType, AdapterRegistration> = new Map();
    private static instances: Map<FrameworkType, IFrameworkAdapter> = new Map();
    private static detectedFramework: FrameworkType | null = null;
    private static initialized = false;

    /**
     * Register a framework adapter
     */
    static register(
        type: FrameworkType,
        factory: AdapterFactory,
        options: { priority?: number; detectFn?: () => boolean } = {}
    ): void {
        const registration: AdapterRegistration = {
            type,
            factory,
            priority: options.priority ?? FRAMEWORK_PRIORITY[type] ?? 50,
            detectFn: options.detectFn ?? DETECTION_STRATEGIES[type],
        };

        this.registrations.set(type, registration);
    }

    /**
     * Unregister a framework adapter
     */
    static unregister(type: FrameworkType): void {
        this.registrations.delete(type);
        this.instances.delete(type);

        if (this.detectedFramework === type) {
            this.detectedFramework = null;
        }
    }

    /**
     * Detect the framework to use
     */
    static detect(): FrameworkType {
        if (this.detectedFramework) {
            return this.detectedFramework;
        }

        // 1. Check explicit configuration (highest priority - don't validate with detectFn)
        const config = ConfigFactory.getGlobalConfig();
        if (config.framework && this.registrations.has(config.framework)) {
            this.detectedFramework = config.framework;
            return config.framework;
        }

        // 2. Check meta tag (explicit configuration - don't validate with detectFn)
        if (typeof document !== 'undefined') {
            const meta = document.querySelector<HTMLMetaElement>('meta[name="accelade-framework"]');
            if (meta?.content) {
                const framework = meta.content as FrameworkType;
                if (this.registrations.has(framework)) {
                    this.detectedFramework = framework;
                    return framework;
                }
            }
        }

        // 3. Auto-detect by checking registrations in priority order
        const sortedRegistrations = Array.from(this.registrations.values())
            .filter(reg => reg.type !== 'vanilla') // Exclude vanilla from auto-detect
            .sort((a, b) => b.priority - a.priority);

        for (const reg of sortedRegistrations) {
            if (reg.detectFn && reg.detectFn()) {
                this.detectedFramework = reg.type;
                return reg.type;
            }
        }

        // 4. Fallback to vanilla
        this.detectedFramework = 'vanilla';
        return 'vanilla';
    }

    /**
     * Get adapter for a specific framework
     */
    static getAdapter(type?: FrameworkType): IFrameworkAdapter {
        const framework = type ?? this.detect();

        // Return cached instance if available
        if (this.instances.has(framework)) {
            return this.instances.get(framework)!;
        }

        // Create new instance
        const registration = this.registrations.get(framework);
        if (!registration) {
            // Fallback to vanilla if framework not registered
            if (framework !== 'vanilla') {
                console.warn(`Accelade: Framework "${framework}" not registered, falling back to vanilla`);
                return this.getAdapter('vanilla');
            }
            throw new Error('Accelade: No adapters registered. Call FrameworkRegistry.register() first.');
        }

        const adapter = registration.factory();
        this.instances.set(framework, adapter);

        return adapter;
    }

    /**
     * Check if a framework is registered
     */
    static isRegistered(type: FrameworkType): boolean {
        return this.registrations.has(type);
    }

    /**
     * Check if a framework is available (registered and detected)
     */
    static isAvailable(type: FrameworkType): boolean {
        const registration = this.registrations.get(type);
        if (!registration) return false;
        if (!registration.detectFn) return true;
        return registration.detectFn();
    }

    /**
     * Get all registered framework types
     */
    static getRegistered(): FrameworkType[] {
        return Array.from(this.registrations.keys());
    }

    /**
     * Get all available frameworks (registered and detected)
     */
    static getAvailable(): FrameworkType[] {
        return this.getRegistered().filter(type => this.isAvailable(type));
    }

    /**
     * Get the currently detected framework
     */
    static getDetected(): FrameworkType | null {
        return this.detectedFramework;
    }

    /**
     * Force set the framework (bypasses detection)
     */
    static setFramework(type: FrameworkType): void {
        if (!this.registrations.has(type)) {
            throw new Error(`Accelade: Framework "${type}" is not registered`);
        }
        this.detectedFramework = type;
    }

    /**
     * Reset the registry (useful for testing)
     */
    static reset(): void {
        this.registrations.clear();
        this.instances.clear();
        this.detectedFramework = null;
        this.initialized = false;
    }

    /**
     * Initialize the registry with default adapters
     */
    static initialize(): void {
        if (this.initialized) return;
        this.initialized = true;
    }

    /**
     * Get registration info for a framework
     */
    static getRegistration(type: FrameworkType): AdapterRegistration | undefined {
        return this.registrations.get(type);
    }

    /**
     * Debug: Get detection status for all frameworks
     */
    static getDetectionStatus(): Record<FrameworkType, { registered: boolean; available: boolean; detected: boolean }> {
        const detected = this.detect();
        const status: Record<string, { registered: boolean; available: boolean; detected: boolean }> = {};

        for (const type of ['vanilla', 'vue', 'react', 'svelte', 'angular'] as FrameworkType[]) {
            status[type] = {
                registered: this.isRegistered(type),
                available: this.isAvailable(type),
                detected: type === detected,
            };
        }

        return status as Record<FrameworkType, { registered: boolean; available: boolean; detected: boolean }>;
    }
}

export default FrameworkRegistry;
</file>

<file path="resources/js/registry/index.ts">
/**
 * Registry - Export all registry modules
 */

export { FrameworkRegistry } from './FrameworkRegistry';
</file>

<file path="resources/views/components/demo/bridge-counter.blade.php">
{{-- Demo Bridge Counter Component --}}
<div class="bg-white rounded-xl shadow-lg p-6 max-w-md">
    <div class="text-center mb-6">
        <h3 class="text-lg font-semibold text-slate-800 mb-2">Bridge Counter</h3>
        <p class="text-sm text-slate-500">Two-way PHP/JS binding demo</p>
    </div>

    {{-- Counter Display --}}
    <div class="text-center mb-6">
        <div class="text-6xl font-bold text-indigo-600" a-text="props.count">{{ $count }}</div>
        <div class="text-sm text-slate-400 mt-2">
            Hello, <span a-text="props.name">{{ $name }}</span>!
        </div>
    </div>

    {{-- Name Input (two-way binding) --}}
    <div class="mb-4">
        <label class="block text-sm font-medium text-slate-700 mb-1">Your Name</label>
        <input
            type="text"
            a-model="props.name"
            class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="Enter your name..."
        >
    </div>

    {{-- Step Input --}}
    <div class="mb-4">
        <label class="block text-sm font-medium text-slate-700 mb-1">Step Value</label>
        <input
            type="number"
            a-model="props.step"
            min="1"
            class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
        >
    </div>

    {{-- Counter Buttons --}}
    <div class="flex gap-2 mb-4">
        <button
            @click="decrement()"
            class="flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
        >
            - Decrement
        </button>
        <button
            @click="increment()"
            class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
        >
            + Increment
        </button>
    </div>

    {{-- Action Buttons --}}
    <div class="flex gap-2 mb-4">
        <button
            @click="double()"
            class="flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors"
        >
            x2 Double
        </button>
        <button
            @click="reset()"
            class="flex-1 px-4 py-2 bg-slate-500 text-white rounded-lg hover:bg-slate-600 transition-colors"
        >
            Reset
        </button>
    </div>

    {{-- Save Button --}}
    <button
        @click="save()"
        class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors"
    >
        Save Counter
    </button>

    {{-- Update Name via Method --}}
    <div class="mt-4 pt-4 border-t border-slate-200">
        <button
            @click="updateName('Guest')"
            class="text-sm text-indigo-600 hover:text-indigo-800"
        >
            Set name to "Guest"
        </button>
    </div>
</div>
</file>

<file path="resources/views/components/layouts/partials/framework-icon.blade.php">
@props(['fw' => 'vanilla', 'size' => 'w-5 h-5'])

@switch($fw)
    @case('vanilla')
        <svg class="{{ $size }}" viewBox="0 0 630 630" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="630" height="630" fill="#f7df1e"/>
            <path d="M423.2 492.19c12.69 20.72 29.2 35.95 58.4 35.95 24.53 0 40.2-12.26 40.2-29.2 0-20.3-16.1-27.49-43.1-39.3l-14.8-6.35c-42.72-18.2-71.1-41-71.1-89.2 0-44.4 33.83-78.2 86.7-78.2 37.64 0 64.7 13.1 84.2 47.4l-46.1 29.6c-10.15-18.2-21.1-25.37-38.1-25.37-17.34 0-28.33 11-28.33 25.37 0 17.76 11 24.95 36.4 35.95l14.8 6.34c50.3 21.57 78.7 43.56 78.7 93 0 53.3-41.87 82.5-98.1 82.5-55 0-90.5-26.2-107.88-60.54l47.1-27.95zm-184.3 4.37c9.3 16.5 17.76 30.45 38.1 30.45 19.45 0 31.72-7.61 31.72-37.2v-201.3h59.2v202.1c0 61.3-35.94 89.2-88.4 89.2-47.4 0-74.85-24.53-88.81-54.07l48.2-29.15z" fill="#000"/>
        </svg>
        @break
    @case('vue')
        <svg class="{{ $size }}" viewBox="0 0 256 221" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid">
            <path d="M204.8 0H256L128 220.8 0 0h97.92L128 51.2 157.44 0h47.36z" fill="#41B883"/>
            <path d="M0 0l128 220.8L256 0h-51.2L128 132.48 50.56 0H0z" fill="#41B883"/>
            <path d="M50.56 0L128 133.12 204.8 0h-47.36L128 51.2 97.92 0H50.56z" fill="#35495E"/>
        </svg>
        @break
    @case('react')
        <svg class="{{ $size }}" viewBox="-11.5 -10.232 23 20.463" xmlns="http://www.w3.org/2000/svg">
            <circle r="2.05" fill="#61dafb"/>
            <g stroke="#61dafb" fill="none">
                <ellipse rx="11" ry="4.2"/>
                <ellipse rx="11" ry="4.2" transform="rotate(60)"/>
                <ellipse rx="11" ry="4.2" transform="rotate(120)"/>
            </g>
        </svg>
        @break
    @case('svelte')
        <svg class="{{ $size }}" viewBox="0 0 256 308" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid">
            <path d="M239.682 40.707C211.113-.182 154.69-12.301 113.895 13.69L42.247 59.356a82.198 82.198 0 0 0-37.135 55.056 86.566 86.566 0 0 0 8.536 55.576 82.425 82.425 0 0 0-12.296 30.719 87.596 87.596 0 0 0 14.964 66.244c28.574 40.893 84.997 53.007 125.787 27.016l71.648-45.664a82.182 82.182 0 0 0 37.135-55.057 86.601 86.601 0 0 0-8.53-55.577 82.397 82.397 0 0 0 12.29-30.718 87.573 87.573 0 0 0-14.963-66.244" fill="#FF3E00"/>
            <path d="M106.889 270.841c-23.102 6.007-47.497-3.036-61.103-22.648a52.685 52.685 0 0 1-9.003-39.85 49.978 49.978 0 0 1 1.713-6.693l1.35-4.115 3.671 2.697a92.447 92.447 0 0 0 28.036 14.007l2.663.808-.245 2.659a16.067 16.067 0 0 0 2.89 10.656 17.143 17.143 0 0 0 18.397 6.828 15.786 15.786 0 0 0 4.403-1.935l71.67-45.672a14.922 14.922 0 0 0 6.734-9.977 15.923 15.923 0 0 0-2.713-12.011 17.156 17.156 0 0 0-18.404-6.832 15.78 15.78 0 0 0-4.396 1.933l-27.35 17.434a52.298 52.298 0 0 1-14.553 6.391c-23.101 6.007-47.497-3.036-61.101-22.649a52.681 52.681 0 0 1-9.004-39.849 49.428 49.428 0 0 1 22.34-33.114l71.664-45.677a52.218 52.218 0 0 1 14.563-6.398c23.101-6.007 47.497 3.036 61.101 22.648a52.685 52.685 0 0 1 9.004 39.85 50.559 50.559 0 0 1-1.713 6.692l-1.35 4.116-3.67-2.693a92.373 92.373 0 0 0-28.037-14.013l-2.664-.809.246-2.658a16.099 16.099 0 0 0-2.89-10.656 17.143 17.143 0 0 0-18.398-6.828 15.786 15.786 0 0 0-4.402 1.935l-71.67 45.674a14.898 14.898 0 0 0-6.73 9.975 15.9 15.9 0 0 0 2.709 12.012 17.156 17.156 0 0 0 18.404 6.832 15.841 15.841 0 0 0 4.402-1.935l27.345-17.427a52.147 52.147 0 0 1 14.552-6.397c23.101-6.006 47.497 3.037 61.102 22.65a52.681 52.681 0 0 1 9.003 39.848 49.453 49.453 0 0 1-22.34 33.12l-71.664 45.673a52.218 52.218 0 0 1-14.563 6.398" fill="#FFF"/>
        </svg>
        @break
    @case('angular')
        <svg class="{{ $size }}" viewBox="0 0 256 272" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid">
            <path d="M.1 45.522L125.908.697l129.196 44.028-20.919 166.45-108.277 59.966-106.583-59.169L.1 45.522z" fill="#E23237"/>
            <path d="M255.104 44.725L125.908.697v270.444l108.277-59.866 20.919-166.55z" fill="#B52E31"/>
            <path d="M126.107 32.274L47.714 206.693l29.285-.498 15.739-39.347h70.325l17.233 39.845 27.99.498-82.179-174.917zm.2 55.882l26.496 55.383h-49.806l23.31-55.383z" fill="#FFF"/>
        </svg>
        @break
@endswitch
</file>

<file path="resources/views/components/layouts/demo.blade.php">
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <meta name="accelade-framework" content="{{ $framework }}">

    <title>Accelade Demo - {{ ucfirst($framework) }}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=instrument-sans:400,500,600,700" rel="stylesheet" />

    <!-- Tailwind CSS - Try Vite first, fallback to CDN -->
    @hasSection('vite')
        @yield('vite')
    @else
        @if(file_exists(public_path('build/manifest.json')))
            @vite(['resources/css/app.css'])
        @else
            <script src="https://cdn.tailwindcss.com"></script>
        @endif
    @endif

    @acceladeStyles
    @php
        // Set the framework for this page so the correct JS bundle is loaded
        app('accelade')->setFramework($framework);
    @endphp
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen font-sans antialiased">
    <div class="max-w-4xl mx-auto py-12 px-4">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-5xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-3">
                Accelade
            </h1>
            <p class="text-xl text-slate-600 mb-4">Reactive Blade templates with your favorite framework</p>
        </header>

        <!-- Framework Tabs (Full Page Reload - different JS runtimes) -->
        <nav class="flex justify-center gap-2 mb-10 flex-wrap">
            <a
                href="{{ route('demo.vanilla') }}"
                class="px-5 py-2.5 rounded-xl font-medium transition {{ $framework === 'vanilla' ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-200' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200' }}"
            >
                Vanilla
            </a>
            <a
                href="{{ route('demo.vue') }}"
                class="px-5 py-2.5 rounded-xl font-medium transition {{ $framework === 'vue' ? 'bg-green-600 text-white shadow-lg shadow-green-200' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200' }}"
            >
                Vue
            </a>
            <a
                href="{{ route('demo.react') }}"
                class="px-5 py-2.5 rounded-xl font-medium transition {{ $framework === 'react' ? 'bg-blue-600 text-white shadow-lg shadow-blue-200' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200' }}"
            >
                React
            </a>
            <a
                href="{{ route('demo.svelte') }}"
                class="px-5 py-2.5 rounded-xl font-medium transition {{ $framework === 'svelte' ? 'bg-orange-600 text-white shadow-lg shadow-orange-200' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200' }}"
            >
                Svelte
            </a>
            <a
                href="{{ route('demo.angular') }}"
                class="px-5 py-2.5 rounded-xl font-medium transition {{ $framework === 'angular' ? 'bg-red-600 text-white shadow-lg shadow-red-200' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200' }}"
            >
                Angular
            </a>
        </nav>

        <!-- Current Framework Badge -->
        <div class="text-center mb-8">
            <span class="inline-flex items-center gap-2 px-4 py-2 bg-white rounded-full border border-slate-200 shadow-sm">
                @if($framework === 'vanilla')
                    <span class="w-3 h-3 bg-indigo-500 rounded-full"></span>
                    <span class="text-sm font-medium text-slate-600">Using Vanilla JavaScript</span>
                @elseif($framework === 'vue')
                    <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                    <span class="text-sm font-medium text-slate-600">Using Vue.js 3</span>
                @elseif($framework === 'react')
                    <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
                    <span class="text-sm font-medium text-slate-600">Using React 18</span>
                @elseif($framework === 'svelte')
                    <span class="w-3 h-3 bg-orange-500 rounded-full"></span>
                    <span class="text-sm font-medium text-slate-600">Using Svelte 5</span>
                @elseif($framework === 'angular')
                    <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                    <span class="text-sm font-medium text-slate-600">Using Angular 17+</span>
                @endif
            </span>
        </div>

        <!-- Main Content Area (SPA replaces this) -->
        <main data-accelade-page>
            {{ $slot }}
        </main>

        <!-- Footer -->
        <footer class="text-center text-slate-400 text-sm mt-12">
            <p class="mb-1">
                <span class="font-semibold text-slate-600">Accelade</span> — Accelerate your Blade templates
            </p>
            <p>
                Built with Laravel {{ app()->version() }} | Framework: {{ $framework }}
            </p>
        </footer>
    </div>

    @acceladeScripts
    @acceladeNotifications
</body>
</html>
</file>

<file path="resources/views/components/bridge.blade.php">
@php
    $bridgeConfig = $getJsonConfig();

    // Build initial state from props for Accelade component
    $initialState = [
        'props' => json_decode($bridgeConfig, true)['props'] ?? [],
    ];

    // Render the inner component's view if no slot content provided
    $hasSlot = isset($slot) && !$slot->isEmpty();
    $innerContent = null;

    if (!$hasSlot && method_exists($component, 'render')) {
        $innerView = $component->render();
        if ($innerView instanceof \Illuminate\Contracts\View\View) {
            // Pass component's public properties to the view
            $innerContent = $innerView->with($component->data())->render();
        }
    }
@endphp

<div
    data-accelade
    data-accelade-bridge="{{ $bridgeConfig }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    {{ $attributes }}
>
    @if($hasSlot)
        {{ $slot }}
    @elseif($innerContent)
        {!! $innerContent !!}
    @endif
</div>
</file>

<file path="resources/views/components/content.blade.php">
@props([
    'html' => '',
    'as' => 'div',
])

@php
    $tag = $as;

    // Ensure the tag is a valid HTML element
    $validTags = ['div', 'span', 'article', 'section', 'aside', 'main', 'header', 'footer', 'nav', 'p', 'blockquote', 'pre', 'code', 'figure', 'figcaption', 'details', 'summary'];
    if (!in_array($tag, $validTags)) {
        $tag = 'div';
    }
@endphp

<{{ $tag }} {{ $attributes }}>
    {!! $html !!}
</{{ $tag }}>
</file>

<file path="resources/views/components/data.blade.php">
@props([
    'default' => [],
    'remember' => null,
    'localStorage' => null,
    'store' => null,
])

@php
    $dataId = 'data-' . \Illuminate\Support\Str::random(8);

    // Process default data
    $initialData = $default;

    // Convert to array if it's a string (JavaScript object notation)
    if (is_string($initialData) && !empty($initialData)) {
        // Keep as string for JS parsing
        $isJsObject = true;
    } else {
        $isJsObject = false;
        // Handle various PHP types
        if ($initialData instanceof \Illuminate\Contracts\Support\Arrayable) {
            $initialData = $initialData->toArray();
        } elseif ($initialData instanceof \Illuminate\Contracts\Support\Jsonable) {
            $initialData = json_decode($initialData->toJson(), true);
        } elseif ($initialData instanceof \JsonSerializable) {
            $initialData = $initialData->jsonSerialize();
        } elseif (is_object($initialData)) {
            $initialData = (array) $initialData;
        }

        if (!is_array($initialData)) {
            $initialData = [];
        }
    }

    // Generate the state JSON
    $stateJson = $isJsObject ? $initialData : json_encode($initialData);

    // Determine storage key for remember/localStorage
    $storageKey = $remember ?? $localStorage ?? null;

    // Reserved store names that cannot be used
    $reservedNames = ['data', 'form', 'toggle', 'state', 'store'];
    $isValidStore = $store && !in_array(strtolower($store), $reservedNames);
@endphp

<div
    data-accelade
    data-accelade-id="{{ $dataId }}"
    data-accelade-state="{{ $isJsObject ? '' : $stateJson }}"
    @if($isJsObject) data-accelade-state-js="{{ $stateJson }}" @endif
    @if($remember) data-accelade-remember="{{ $remember }}" @endif
    @if($localStorage) data-accelade-local-storage="{{ $localStorage }}" @endif
    @if($isValidStore) data-accelade-store="{{ $store }}" @endif
    data-accelade-cloak
    {{ $attributes }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/defer.blade.php">
@props([
    'url' => null,
    'method' => 'GET',
    'acceptHeader' => 'application/json',
    'request' => null,
    'headers' => null,
    'poll' => null,
    'manual' => false,
    'watchValue' => null,
    'watchDebounce' => 150,
])

@php
    $deferId = 'defer-' . \Illuminate\Support\Str::random(8);

    // Process request data
    $requestData = $request;
    if (is_array($requestData) || $requestData instanceof \Illuminate\Contracts\Support\Arrayable) {
        if ($requestData instanceof \Illuminate\Contracts\Support\Arrayable) {
            $requestData = $requestData->toArray();
        }
        $requestData = json_encode($requestData);
    }

    // Process headers
    $headersData = $headers;
    if (is_array($headersData) || $headersData instanceof \Illuminate\Contracts\Support\Arrayable) {
        if ($headersData instanceof \Illuminate\Contracts\Support\Arrayable) {
            $headersData = $headersData->toArray();
        }
        $headersData = json_encode($headersData);
    }

    // Initial state for the component
    $initialState = [
        'processing' => !$manual,
        'response' => null,
        'error' => null,
    ];
@endphp

<div
    data-accelade
    data-accelade-id="{{ $deferId }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    data-accelade-defer
    data-defer-url="{{ $url }}"
    data-defer-method="{{ strtoupper($method) }}"
    data-defer-accept="{{ $acceptHeader }}"
    @if($requestData) data-defer-request="{{ $requestData }}" @endif
    @if($headersData) data-defer-headers="{{ $headersData }}" @endif
    @if($poll) data-defer-poll="{{ $poll }}" @endif
    @if($manual) data-defer-manual="true" @endif
    @if($watchValue) data-defer-watch="{{ $watchValue }}" @endif
    @if($watchDebounce && $watchDebounce !== 150) data-defer-watch-debounce="{{ $watchDebounce }}" @endif
    data-accelade-cloak
    {{ $attributes }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/errors.blade.php">
@props([
    'bag' => 'default',
])

@php
    $errorsId = 'errors-' . \Illuminate\Support\Str::random(8);

    // Get the error bag
    $errorBag = $errors->getBag($bag);

    // Convert errors to array format
    $errorsArray = [];
    foreach ($errorBag->getMessages() as $key => $messages) {
        $errorsArray[$key] = $messages;
    }

    // Initial state with errors data
    $initialState = [
        'errors' => $errorsArray,
    ];
@endphp

<div
    data-accelade
    data-accelade-id="{{ $errorsId }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    data-accelade-errors
    data-accelade-cloak
    {{ $attributes }}
>
    <accelade:script>
        // Create errors helper object
        const errorsData = state.errors || {};

        return {
            errors: {
                // Check if a field has errors
                has(key) {
                    return errorsData.hasOwnProperty(key) && errorsData[key].length > 0;
                },

                // Get first error for a field
                first(key) {
                    if (errorsData.hasOwnProperty(key) && errorsData[key].length > 0) {
                        return errorsData[key][0];
                    }
                    return null;
                },

                // Get all errors for a field
                get(key) {
                    return errorsData[key] || [];
                },

                // Get all errors as object
                get all() {
                    return errorsData;
                },

                // Check if there are any errors
                get any() {
                    return Object.keys(errorsData).length > 0;
                },

                // Get count of all errors
                get count() {
                    return Object.values(errorsData).reduce((sum, arr) => sum + arr.length, 0);
                },

                // Get all keys that have errors
                get keys() {
                    return Object.keys(errorsData);
                }
            }
        };
    </accelade:script>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/event.blade.php">
@props([
    'channel' => null,
    'private' => false,
    'presence' => false,
    'listen' => '',
    'preserveScroll' => false,
])

@php
    $eventId = 'event-' . \Illuminate\Support\Str::random(8);

    // Initial state for the component
    $initialState = [
        'subscribed' => false,
        'events' => [],
    ];
@endphp

<div
    data-accelade
    data-accelade-id="{{ $eventId }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    data-accelade-echo
    @if($channel) data-echo-channel="{{ $channel }}" @endif
    data-echo-private="{{ $private ? 'true' : 'false' }}"
    data-echo-presence="{{ $presence ? 'true' : 'false' }}"
    @if($listen) data-echo-listen="{{ $listen }}" @endif
    data-echo-preserve-scroll="{{ $preserveScroll ? 'true' : 'false' }}"
    data-accelade-cloak
    {{ $attributes }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/flash.blade.php">
@props([
    'shared' => true,
])

@php
    $flashId = 'flash-' . \Illuminate\Support\Str::random(8);

    // Get flash data from session
    $flashData = [];

    // Collect all flash data from session
    if (session()->has('_flash.old')) {
        foreach (session()->get('_flash.old', []) as $key) {
            if (session()->has($key)) {
                $flashData[$key] = session()->get($key);
            }
        }
    }

    // Also check for explicit flash keys that are commonly used
    $commonFlashKeys = ['message', 'success', 'error', 'warning', 'info', 'status', 'notification'];
    foreach ($commonFlashKeys as $key) {
        if (session()->has($key) && !isset($flashData[$key])) {
            $flashData[$key] = session()->get($key);
        }
    }

    // If shared mode is enabled and Accelade::share is available, share flash data
    if ($shared && class_exists(\Accelade\Facades\Accelade::class)) {
        \Accelade\Facades\Accelade::share('flash', $flashData);
    }

    // Initial state for the component
    $initialState = [
        'flash' => $flashData,
    ];
@endphp

<div
    data-accelade
    data-accelade-id="{{ $flashId }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    data-accelade-flash
    data-flash-data="{{ json_encode($flashData) }}"
    @if(!$shared) data-flash-no-share @endif
    data-accelade-cloak
    {{ $attributes }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/lazy.blade.php">
@props([
    'url' => null,
    'show' => true,
    'shimmer' => false,
    'shimmerLines' => 3,
    'shimmerHeight' => null,
    'shimmerWidth' => null,
    'shimmerRounded' => false,
    'shimmerCircle' => false,
    'delay' => 0,
    'name' => null,
    'method' => 'GET',
    'data' => [],
])

@php
    $lazyId = 'lazy-' . \Illuminate\Support\Str::random(8);
    $showValue = is_bool($show) ? ($show ? 'true' : 'false') : $show;
    $isConditional = !is_bool($show);
    $hasUrl = !empty($url);

    // Shimmer styles
    $shimmerStyles = collect([
        $shimmerHeight ? "height: {$shimmerHeight}" : null,
        $shimmerWidth ? "width: {$shimmerWidth}" : null,
    ])->filter()->implode('; ');

    // Shimmer classes
    $shimmerClasses = collect([
        'accelade-shimmer-container',
        $shimmerRounded ? 'accelade-shimmer-rounded' : null,
        $shimmerCircle ? 'accelade-shimmer-circle' : null,
    ])->filter()->implode(' ');
@endphp

<div
    data-accelade-lazy
    data-lazy-id="{{ $lazyId }}"
    @if($hasUrl) data-lazy-url="{{ $url }}" @endif
    data-lazy-show="{{ $showValue }}"
    data-lazy-conditional="{{ $isConditional ? 'true' : 'false' }}"
    data-lazy-delay="{{ $delay }}"
    data-lazy-method="{{ strtoupper($method) }}"
    @if(!empty($data)) data-lazy-data="{{ json_encode($data) }}" @endif
    @if($name) data-lazy-name="{{ $name }}" @endif
    @if($hasUrl) data-lazy-mode="url" @else data-lazy-mode="inline" @endif
    {{ $attributes->class(['accelade-lazy-wrapper']) }}
>
    {{-- Placeholder content --}}
    <div class="accelade-lazy-placeholder" data-lazy-placeholder>
        @if(isset($placeholder))
            {{ $placeholder }}
        @elseif($shimmer)
            <div class="{{ $shimmerClasses }}" @if($shimmerStyles) style="{{ $shimmerStyles }}" @endif>
                @if($shimmerCircle)
                    <div class="accelade-shimmer-circle-inner"></div>
                @else
                    @for($i = 0; $i < $shimmerLines; $i++)
                        <div class="accelade-shimmer-line @if($i === $shimmerLines - 1 && $shimmerLines > 1) accelade-shimmer-line-short @endif"></div>
                    @endfor
                @endif
            </div>
        @else
            <div class="accelade-lazy-loading">
                <div class="accelade-lazy-spinner"></div>
            </div>
        @endif
    </div>

    {{-- Content container --}}
    <div class="accelade-lazy-content" data-lazy-content style="display: none;">
        @unless($hasUrl)
            {{-- Inline mode: content is already here but hidden --}}
            {{ $slot }}
        @endunless
    </div>
</div>
</file>

<file path="resources/views/components/modal.blade.php">
@props([
    'name' => null,
    'maxWidth' => null,
    'position' => null,
    'slideoverPosition' => null,
    'closeExplicitly' => false,
    'closeButton' => true,
    'opened' => false,
    'slideover' => false,
    'bottomSheet' => false,
])

@php
    $framework = config('accelade.framework', 'vanilla');
    $id = $attributes->get('id', 'modal-' . uniqid());

    // Determine default max-width based on type
    $defaultMaxWidth = $slideover ? 'md' : ($bottomSheet ? '2xl' : '2xl');
    $finalMaxWidth = $maxWidth ?? $defaultMaxWidth;

    // Determine default position
    $defaultPosition = 'center';
    $finalPosition = $position ?? $defaultPosition;

    // Slideover position
    $defaultSlideoverPosition = 'right';
    $finalSlideoverPosition = $slideoverPosition ?? $defaultSlideoverPosition;
@endphp

<div
    data-accelade
    data-accelade-modal
    data-modal-id="{{ $id }}"
    @if($name) data-modal-name="{{ $name }}" @endif
    @if($slideover) data-slideover @endif
    @if($bottomSheet) data-bottom-sheet @endif
    data-max-width="{{ $finalMaxWidth }}"
    data-position="{{ $finalPosition }}"
    data-slideover-position="{{ $finalSlideoverPosition }}"
    @if($closeExplicitly) data-close-explicitly @endif
    @if(!$closeButton) data-no-close-button @endif
    @if($opened) data-opened @endif
    data-accelade-state="{{ json_encode(['isOpen' => $opened, 'modal' => ['close' => null, 'open' => null, 'setIsOpen' => null]]) }}"
    {{ $attributes->except(['id', 'name', 'maxWidth', 'position', 'slideoverPosition', 'closeExplicitly', 'closeButton', 'opened', 'slideover', 'bottomSheet'])->merge(['style' => 'display: none;']) }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/persistent.blade.php">
@props([
    'id' => null,
])

@php
    $persistentId = $id ?? 'persistent-' . \Illuminate\Support\Str::random(8);
@endphp

<div
    data-accelade-persistent="{{ $persistentId }}"
    {{ $attributes }}
>
    {{ $slot }}
</div>
</file>

<file path="resources/views/components/rehydrate.blade.php">
@props([
    'on' => null,
    'poll' => null,
    'url' => null,
    'preserveScroll' => true,
])

@php
    $id = $attributes->get('id', 'rehydrate-' . uniqid());

    // Format events for data attribute
    $eventsJson = null;
    if ($on !== null) {
        if (is_array($on)) {
            $eventsJson = json_encode($on);
        } else {
            // Single event string
            $eventsJson = $on;
        }
    }
@endphp

<div
    data-accelade-rehydrate
    data-rehydrate-id="{{ $id }}"
    @if($eventsJson) data-rehydrate-on="{{ $eventsJson }}" @endif
    @if($poll) data-rehydrate-poll="{{ $poll }}" @endif
    @if($url) data-rehydrate-url="{{ $url }}" @endif
    @if($preserveScroll) data-rehydrate-preserve-scroll @endif
    {{ $attributes->except(['id', 'on', 'poll', 'url', 'preserveScroll']) }}
>{{ $slot }}</div>
</file>

<file path="resources/views/components/script.blade.php">
{{--
    Accelade Script Component

    Use this component to define custom JavaScript functions that have access to:
    - state: The reactive state object
    - actions: Built-in actions (increment, decrement, set, toggle, reset)
    - $set(key, value): Set a state value
    - $get(key): Get a state value
    - $toggle(key): Toggle a boolean state value
    - $navigate(url, options): Navigate to a URL using SPA
    - $watch(key, callback): Watch a state property (Vue only)

    The script should return an object with your custom methods:

    Example:
    <accelade:script>
        return {
            customIncrement() {
                $set('count', $get('count') + 5);
            },
            handleSubmit(event) {
                event.preventDefault();
                $navigate('/success');
            }
        };
    </accelade:script>
--}}

@php
    $framework = config('accelade.framework', 'vanilla');
@endphp

@if($framework === 'vanilla')
<script a-script>
{{ $slot }}
</script>
@elseif($framework === 'vue')
<script v-script>
{{ $slot }}
</script>
@else
<script state-script>
{{ $slot }}
</script>
@endif
</file>

<file path="resources/views/components/state.blade.php">
@props([
    'errors' => null,
    'flash' => null,
    'shared' => null,
])

@php
    $framework = config('accelade.framework', 'vanilla');
    $id = $attributes->get('id', 'state-' . uniqid());

    // Get validation errors from the error bag
    $validationErrors = [];
    if ($errors !== null) {
        // If errors passed explicitly
        $validationErrors = is_array($errors) ? $errors : [];
    } elseif (isset($__errorBag) && $__errorBag instanceof \Illuminate\Support\ViewErrorBag) {
        // Get errors from the default error bag
        $bag = $__errorBag->getBag('default');
        $validationErrors = $bag->toArray();
    } elseif (session()->has('errors')) {
        // Fall back to session errors
        $sessionErrors = session('errors');
        if ($sessionErrors instanceof \Illuminate\Support\ViewErrorBag) {
            $validationErrors = $sessionErrors->getBag('default')->toArray();
        }
    }

    // Get flash data
    $flashData = [];
    if ($flash !== null) {
        $flashData = is_array($flash) ? $flash : [];
    } else {
        // Get all flash data from session
        $flashData = session()->all();
        // Filter out internal Laravel keys
        $internalKeys = ['_token', '_previous', '_flash', 'errors'];
        $flashData = array_diff_key($flashData, array_flip($internalKeys));
    }

    // Get shared data
    $sharedData = [];
    if ($shared !== null) {
        $sharedData = is_array($shared) ? $shared : [];
    } else {
        // Get from Accelade shared data
        $sharedData = app('accelade')->allShared();
    }

    // Build state object for initial render
    $stateErrors = [];
    foreach ($validationErrors as $key => $messages) {
        $stateErrors[$key] = is_array($messages) ? ($messages[0] ?? '') : $messages;
    }

    $initialState = [
        'state' => [
            'errors' => $stateErrors,
            'rawErrors' => $validationErrors,
            'hasErrors' => !empty($validationErrors),
            'flash' => $flashData,
            'shared' => $sharedData,
        ],
    ];
@endphp

<div
    data-accelade
    data-accelade-state-component
    data-state-id="{{ $id }}"
    data-state-errors="{{ json_encode($validationErrors) }}"
    data-state-flash="{{ json_encode($flashData) }}"
    data-state-shared="{{ json_encode($sharedData) }}"
    data-accelade-state="{{ json_encode($initialState) }}"
    {{ $attributes->except(['id', 'errors', 'flash', 'shared']) }}
>{{ $slot }}</div>
</file>

<file path="resources/views/components/teleport.blade.php">
@props([
    'to' => null,
    'disabled' => false,
])

@php
    $id = $attributes->get('id', 'teleport-' . uniqid());
@endphp

<div
    data-accelade-teleport
    data-teleport-id="{{ $id }}"
    @if($to)
        data-teleport-to="{{ $to }}"
    @endif
    @if($disabled)
        data-teleport-disabled="true"
    @endif
    {{ $attributes->except(['id', 'to', 'disabled']) }}
>{{ $slot }}</div>
</file>

<file path="resources/views/demo/partials/_bridge.blade.php">
{{-- Bridge Component Section --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $modelAttr = match($prefix) {
        'v' => 'v-model',
        'data-state' => 'data-state-model',
        's' => 's-model',
        'ng' => 'ng-model',
        default => 'a-model',
    };

    // Create the bridge counter component - NO TRAIT REQUIRED!
    $bridgeCounter = new \Accelade\Components\Demo\BridgeCounter(
        count: 0,
        step: 1,
        name: 'World'
    );
@endphp

<!-- Demo: Bridge Components -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Bridge Components</h3>
        <span class="text-xs px-2 py-1 bg-green-500/20 text-green-500 rounded">No Trait Required</span>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Two-way binding between PHP Blade components and JavaScript.
        Any component works - no trait needed! Call PHP methods from the frontend.
    </p>

    <div class="space-y-4 mb-4">
        {{-- Feature Overview --}}
        <div class="rounded-xl p-4 border border-indigo-500/30" style="background: rgba(99, 102, 241, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-indigo-500/20 text-indigo-500 rounded">Features</span>
                What Bridge Components Do
            </h4>
            <ul class="space-y-2 text-sm" style="color: var(--docs-text-muted);">
                <li class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    <span><strong style="color: var(--docs-text);">No trait required</strong> - works with ANY component</span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    <span>Access PHP public properties as <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">props</code></span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    <span>Call PHP methods from JavaScript via AJAX</span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    <span>Two-way binding with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">{{ $modelAttr }}</code></span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    <span>Return toasts, redirects, or events from PHP</span>
                </li>
            </ul>
        </div>

        {{-- PHP Component Class --}}
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">PHP</span>
                Component Class (Plain Component)
            </h4>
            <div class="bg-slate-900 rounded-lg p-4 text-sm font-mono text-slate-100 overflow-x-auto">
                <pre class="whitespace-pre-wrap">use Accelade\Bridge\BridgeResponse;

class Counter extends Component
{
    // No trait needed!
    public int $count = 0;
    public int $step = 1;

    public function increment()
    {
        $this->count += $this->step;

        return BridgeResponse::success()
            ->toastSuccess('Done!');
    }
}</pre>
            </div>
        </div>

        {{-- Live Demo --}}
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Live Demo</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                This counter component is powered by PHP. Click the buttons to call PHP methods!
            </p>

            {{-- Bridge Counter with dynamic prefix attributes --}}
            <x-accelade::bridge :component="$bridgeCounter">
                <div class="rounded-xl p-6 max-w-md border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <div class="text-center mb-6">
                        <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Bridge Counter</h3>
                        <p class="text-sm" style="color: var(--docs-text-muted);">Two-way PHP/JS binding demo</p>
                    </div>

                    {{-- Counter Display --}}
                    <div class="text-center mb-6">
                        <div class="text-6xl font-bold text-indigo-500" {{ $textAttr }}="props.count">{{ $bridgeCounter->count }}</div>
                        <div class="text-sm mt-2" style="color: var(--docs-text-muted);">
                            Hello, <span {{ $textAttr }}="props.name">{{ $bridgeCounter->name }}</span>!
                        </div>
                    </div>

                    {{-- Name Input (two-way binding) --}}
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Your Name</label>
                        <input
                            type="text"
                            {{ $modelAttr }}="props.name"
                            class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-indigo-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                            placeholder="Enter your name..."
                        >
                    </div>

                    {{-- Step Input --}}
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Step Value</label>
                        <input
                            type="number"
                            {{ $modelAttr }}="props.step"
                            min="1"
                            class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-indigo-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                        >
                    </div>

                    {{-- Counter Buttons --}}
                    <div class="flex gap-2 mb-4">
                        <button
                            @click="decrement()"
                            class="flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                        >
                            - Decrement
                        </button>
                        <button
                            @click="increment()"
                            class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                        >
                            + Increment
                        </button>
                    </div>

                    {{-- Action Buttons --}}
                    <div class="flex gap-2 mb-4">
                        <button
                            @click="double()"
                            class="flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors"
                        >
                            x2 Double
                        </button>
                        <button
                            @click="reset()"
                            class="flex-1 px-4 py-2 rounded-lg transition-colors border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                        >
                            Reset
                        </button>
                    </div>

                    {{-- Save Button --}}
                    <button
                        @click="save()"
                        class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors"
                    >
                        Save Counter
                    </button>

                    {{-- Update Name via Method --}}
                    <div class="mt-4 pt-4 border-t border-[var(--docs-border)]">
                        <button
                            @click="updateName('Guest')"
                            class="text-sm text-indigo-500 hover:text-indigo-400"
                        >
                            Set name to "Guest"
                        </button>
                    </div>
                </div>
            </x-accelade::bridge>
        </div>

        {{-- Event Listener --}}
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="text-sm font-medium mb-2" style="color: var(--docs-text);">Event Listener</h4>
            <x-accelade::data :default="['lastEvent' => null, 'eventData' => null]">
                <div class="text-sm" style="color: var(--docs-text-muted);">
                    <div {{ $showAttr }}="!lastEvent">
                        Waiting for events from the bridge component...
                    </div>
                    <div {{ $showAttr }}="lastEvent" class="space-y-1">
                        <div class="text-green-500">
                            Event: <span {{ $textAttr }}="lastEvent" class="font-mono"></span>
                        </div>
                        <div class="font-mono text-xs" style="color: var(--docs-text-muted);">
                            Data: <span {{ $textAttr }}="JSON.stringify(eventData)"></span>
                        </div>
                    </div>
                </div>
                <accelade:script>
                    $on('counter-doubled', (data) => {
                        $set('lastEvent', 'counter-doubled');
                        $set('eventData', data);
                    });

                    $on('counter-saved', (data) => {
                        $set('lastEvent', 'counter-saved');
                        $set('eventData', data);
                    });
                </accelade:script>
            </x-accelade::data>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="bridge-usage.blade.php">
&lt;!-- Any component works - no trait required! --&gt;
&lt;?php
use Accelade\Bridge\BridgeResponse;

class MyComponent extends Component
{
    public string $name = '';
    public string $email = '';

    public function save()
    {
        // Save to database...

        return BridgeResponse::success()
            -&gt;toastSuccess('Saved!');
    }
}
?&gt;

&lt;!-- Use it in Blade with the bridge wrapper --&gt;
@@php
$myComponent = new MyComponent(name: 'John', email: 'john@example.com');
@@endphp

&lt;x-accelade::bridge :component="$myComponent"&gt;
    &lt;input {{ $modelAttr }}="props.name" placeholder="Name" /&gt;
    &lt;input {{ $modelAttr }}="props.email" placeholder="Email" /&gt;
    &lt;button @@click="save()"&gt;Save&lt;/button&gt;
&lt;/x-accelade::bridge&gt;
    </x-accelade::code-block>

    <div class="mt-4 p-4 bg-green-500/10 rounded-lg border border-green-500/30">
        <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <div>
                <h4 class="font-medium text-green-500 mb-1">Works with All Frameworks</h4>
                <p class="text-sm text-green-400">
                    Bridge components work with all Accelade framework prefixes:
                    <code class="bg-green-500/20 px-1 rounded">a-</code> (vanilla),
                    <code class="bg-green-500/20 px-1 rounded">v-</code> (Vue),
                    <code class="bg-green-500/20 px-1 rounded">data-state-</code> (React),
                    <code class="bg-green-500/20 px-1 rounded">s-</code> (Svelte),
                    <code class="bg-green-500/20 px-1 rounded">ng-</code> (Angular).
                </p>
            </div>
        </div>
    </div>

    <div class="mt-4 p-4 bg-amber-500/10 rounded-lg border border-amber-500/30">
        <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-amber-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
            <div>
                <h4 class="font-medium text-amber-500 mb-1">Security Note</h4>
                <p class="text-sm text-amber-400">
                    All public properties are exposed to the browser. Use Eloquent's <code class="bg-amber-500/20 px-1 rounded">$hidden</code>
                    property to hide sensitive model attributes. Never expose credentials or sensitive data.
                </p>
            </div>
        </div>
    </div>
</section>
</file>

<file path="resources/views/demo/sections/bridge.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="bridge">
    @include('accelade::demo.partials._bridge', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/content.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="content">
    @include('accelade::demo.partials._content')
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/counter.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    // Set framework before any components render
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="counter">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-indigo-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A simple reactive counter. No build tools required!</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter.blade.php">
&lt;x-accelade::counter :initial-count="0" /&gt;
        </x-accelade::code-block>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-indigo-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Counter that syncs state with the server (persisted across requests).</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter-sync.blade.php">
&lt;x-accelade::counter :initial-count="10" sync="count" /&gt;
        </x-accelade::code-block>
    </section>
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/data.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="data">
    @include('accelade::demo.partials._data-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/defer.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="defer">
    @include('accelade::demo.partials._defer-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/errors.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="errors">
    @include('accelade::demo.partials._errors-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/event-bus.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="event-bus">
    @include('accelade::demo.partials._event-bus', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/event.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="event">
    @include('accelade::demo.partials._event-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/flash.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);

    // Set demo flash messages for testing
    session()->flash('message', 'This is a demo flash message!');
    session()->flash('success', 'Operation completed successfully!');
    session()->flash('error', 'Oops! Something went wrong.');
    session()->flash('info', 'Here is some useful information.');
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="flash">
    @include('accelade::demo.partials._flash-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/lazy.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="lazy">
    @include('accelade::demo.partials._lazy-loading', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/link.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="link">
    @include('accelade::demo.partials._link-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/modal.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="modal">
    @include('accelade::demo.partials._modal-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/notifications.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="notifications">
    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4">
                    <x-accelade::code-block language="php" filename="Controller.php">
// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();
                    </x-accelade::code-block>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')"
                        class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm"
                    >
                        Success
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm"
                    >
                        Info
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')"
                        class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm"
                    >
                        Warning
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')"
                        class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm"
                    >
                        Danger
                    </button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Right</button>
                </div>
            </div>
        </div>

        <x-accelade::code-block language="javascript" filename="notifications.js">
// JavaScript API
window.Accelade.notify.success('Title', 'Message');
window.Accelade.notify.info('Title', 'Message');
window.Accelade.notify.warning('Title', 'Message');
window.Accelade.notify.danger('Title', 'Message');

// PHP (Backend)
Notify::success('Saved!')->message('Changes saved.');
        </x-accelade::code-block>

        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({
                    id: 'pos-' + Date.now(),
                    title: position,
                    message: 'Notification at ' + position,
                    type: 'info',
                    position: position,
                    duration: 3000,
                    dismissible: true
                });
            }
        </script>
    </section>
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/persistent.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="persistent">
    @include('accelade::demo.partials._persistent-layout', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/progress.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="progress">
    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Manual Controls -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="window.Accelade?.progress?.start()"
                        class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm"
                    >
                        Start Progress
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done()"
                        class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm"
                    >
                        Complete
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done(true)"
                        class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm"
                    >
                        Force Complete
                    </button>
                </div>
            </div>

            <!-- Simulated Request -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="testServerRequest()"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm"
                    >
                        Test Sync Request
                    </button>
                    <button
                        onclick="testSlowRequest()"
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm"
                    >
                        Test Slow Request (2s)
                    </button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>

        <!-- Progress Config -->
        <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
            <h3 class="font-medium text-slate-700 mb-4">Configure Progress Bar</h3>
            <div class="grid md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Color</label>
                    <input
                        type="color"
                        id="progress-color"
                        value="#6366f1"
                        onchange="updateProgressConfig()"
                        class="w-full h-10 rounded-lg cursor-pointer"
                    />
                </div>
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Height (px)</label>
                    <input
                        type="range"
                        id="progress-height"
                        min="2"
                        max="10"
                        value="3"
                        onchange="updateProgressConfig()"
                        class="w-full"
                    />
                </div>
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Position</label>
                    <select
                        id="progress-position"
                        onchange="updateProgressConfig()"
                        class="w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"
                    >
                        <option value="top">Top</option>
                        <option value="bottom">Bottom</option>
                    </select>
                </div>
            </div>
        </div>

        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';

                window.Accelade?.progress?.start();

                fetch('/accelade/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content,
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        component: 'demo-test',
                        property: 'testValue',
                        value: Date.now()
                    })
                })
                .then(res => res.json())
                .then(data => {
                    status.textContent = 'Success! Response: ' + JSON.stringify(data);
                    window.Accelade?.progress?.done();
                })
                .catch(err => {
                    status.textContent = 'Error: ' + err.message;
                    window.Accelade?.progress?.done();
                });
            }

            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';

                window.Accelade?.progress?.start();

                setTimeout(() => {
                    status.textContent = 'Slow request completed!';
                    window.Accelade?.progress?.done();
                }, 2000);
            }

            function updateProgressConfig() {
                const config = {
                    color: document.getElementById('progress-color').value,
                    height: parseInt(document.getElementById('progress-height').value),
                    position: document.getElementById('progress-position').value
                };
                window.Accelade?.progress?.configure(config);
            }
        </script>
    </section>

    <x-accelade::code-block language="javascript" filename="progress.js">
// Manual controls
window.Accelade.progress.start();
window.Accelade.progress.done();

// Configure progress bar
window.Accelade.progress.configure({
    color: '#6366f1',
    height: 3,
    position: 'top'
});
    </x-accelade::code-block>
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/rehydrate.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="rehydrate">
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/scripts.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    // Set framework before any components render
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="scripts">
    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-purple-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; that can access state.</p>

        @accelade(['count' => 0, 'message' => 'Click the buttons!'])
            <div class="text-center p-6 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl mb-6">
                <p class="text-2xl text-slate-800 mb-4 font-medium" {{ $prefix }}-text="message">
                    Click the buttons!
                </p>

                <p class="text-4xl font-bold text-indigo-600 mb-4" {{ $prefix }}-text="count">0</p>

                <div class="flex gap-2 justify-center">
                    <button
                        class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition shadow-lg shadow-indigo-200"
                        @click="addFive()"
                    >
                        +5
                    </button>
                    <button
                        class="px-6 py-3 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition shadow-lg shadow-purple-200"
                        @click="double()"
                    >
                        Double
                    </button>
                    <button
                        class="px-6 py-3 bg-slate-600 text-white rounded-xl font-medium hover:bg-slate-700 transition shadow-lg shadow-slate-200"
                        @click="reset('count')"
                    >
                        Reset
                    </button>
                </div>
            </div>

            <accelade:script>
                return {
                    addFive() {
                        $set('count', $get('count') + 5);
                        $set('message', 'Added 5!');
                    },
                    double() {
                        const current = $get('count');
                        $set('count', current * 2);
                        $set('message', 'Doubled to ' + (current * 2) + '!');
                    }
                };
            </accelade:script>
        @endaccelade

        <x-accelade::code-block language="javascript" filename="scripts.blade.php">
&lt;accelade:script&gt;
    return {
        addFive() {
            $set('count', $get('count') + 5);
        },
        double() {
            $set('count', $get('count') * 2);
        }
    };
&lt;/accelade:script&gt;
        </x-accelade::code-block>
    </section>
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/shared-data.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="shared-data">
    @include('accelade::demo.partials._shared-data', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/state.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="state">
    @include('accelade::demo.partials._state-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/teleport.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="teleport">
    @include('accelade::demo.partials._teleport-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/toggle.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="toggle">
    @include('accelade::demo.partials._toggle-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/demo/sections/transition.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="transition">
    @include('accelade::demo.partials._transition-component', ['prefix' => $prefix])
</x-accelade::layouts.demo-sidebar>
</file>

<file path="resources/views/docs/sections/api-reference.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="api-reference" :documentation="$documentation" :hasDemo="false">
    {{-- API Reference page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Complete API documentation for Accelade.</p>
        <div class="mt-4 flex flex-wrap justify-center gap-3">
            <a href="/docs/scripts" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--docs-bg-alt)] border border-[var(--docs-border)] hover:border-[var(--docs-accent)] transition">
                <span>📜</span>
                Custom Scripts
            </a>
            <a href="/docs/bridge" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--docs-bg-alt)] border border-[var(--docs-border)] hover:border-[var(--docs-accent)] transition">
                <span>🌉</span>
                Bridge
            </a>
            <a href="/docs/notifications" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--docs-bg-alt)] border border-[var(--docs-border)] hover:border-[var(--docs-accent)] transition">
                <span>🔔</span>
                Notifications
            </a>
        </div>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/architecture.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="architecture" :documentation="$documentation" :hasDemo="false">
    {{-- Architecture page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Understand the architecture and design decisions behind Accelade above.</p>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/bridge.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="bridge" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._bridge', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/code-block.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="code-block" :documentation="$documentation" :hasDemo="$hasDemo">
    <div class="space-y-8">
        {{-- Basic Example --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">Basic PHP Code</h3>
            <x-accelade::code-block language="php">
function greet(string $name): string
{
    return "Hello, {$name}!";
}

echo greet('World');
            </x-accelade::code-block>
        </section>

        {{-- With Filename --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">With Filename</h3>
            <x-accelade::code-block language="php" filename="app/Http/Controllers/UserController.php">
&lt;?php

namespace App\Http\Controllers;

use App\Models\User;
use Illuminate\Http\Request;

class UserController extends Controller
{
    public function index()
    {
        $users = User::query()
            ->where('active', true)
            ->orderBy('name')
            ->paginate(15);

        return view('users.index', compact('users'));
    }
}
            </x-accelade::code-block>
        </section>

        {{-- JavaScript Example --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">JavaScript</h3>
            <x-accelade::code-block language="javascript" filename="app.js">
// Accelade reactive state example
const counter = Accelade.state('counter', 0);

document.querySelector('#increment').addEventListener('click', () => {
    counter.value++;
});

counter.subscribe((value) => {
    console.log('Counter changed:', value);
});
            </x-accelade::code-block>
        </section>

        {{-- Blade Template --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">Blade Template</h3>
            <x-accelade::code-block language="blade" filename="resources/views/components/card.blade.php">
@@props(['title', 'description' => null])

&lt;div class="rounded-lg border p-6 shadow-sm"&gt;
    &lt;h3 class="text-lg font-semibold"&gt;@{{ $title }}&lt;/h3&gt;

    @@if($description)
        &lt;p class="mt-2 text-gray-600"&gt;@{{ $description }}&lt;/p&gt;
    @@endif

    &lt;div class="mt-4"&gt;
        @{{ $slot }}
    &lt;/div&gt;
&lt;/div&gt;
            </x-accelade::code-block>
        </section>

        {{-- Bash Commands --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">Shell Commands</h3>
            <x-accelade::code-block language="bash">
# Install Accelade via Composer
composer require accelade/accelade

# Publish configuration
php artisan vendor:publish --tag=accelade-config

# Build frontend assets
npm run build
            </x-accelade::code-block>
        </section>

        {{-- JSON Configuration --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">JSON Configuration</h3>
            <x-accelade::code-block language="json" filename="package.json">
{
    "name": "my-laravel-app",
    "private": true,
    "scripts": {
        "dev": "vite",
        "build": "vite build"
    },
    "devDependencies": {
        "laravel-vite-plugin": "^1.0",
        "vite": "^5.0"
    }
}
            </x-accelade::code-block>
        </section>

        {{-- CSS Example --}}
        <section>
            <h3 class="text-lg font-semibold mb-4" style="color: var(--docs-text)">CSS Styles</h3>
            <x-accelade::code-block language="css" filename="resources/css/custom.css">
/* Custom button styles */
.btn-primary {
    @apply px-4 py-2 bg-indigo-600 text-white rounded-lg;
    @apply hover:bg-indigo-700 transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-indigo-500;
}

.btn-primary:disabled {
    @apply opacity-50 cursor-not-allowed;
}
            </x-accelade::code-block>
        </section>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/configuration.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="configuration" :documentation="$documentation" :hasDemo="false">
    {{-- Configuration page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>See the configuration options above to customize Accelade for your project.</p>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/content.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="content" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._content')
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/contributing.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="contributing" :documentation="$documentation" :hasDemo="false">
    {{-- Contributing page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Join the Accelade community and help us build something amazing!</p>
        <div class="mt-4">
            <a href="https://github.com/accelade/accelade" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--docs-primary)] text-white hover:opacity-90 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                View on GitHub
            </a>
        </div>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/counter.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="counter" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-[var(--docs-bg-alt)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
            <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Counter Component</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">A simple reactive counter. No build tools required!</p>

        <div class="flex justify-center mb-4">
            <x-accelade::counter :initial-count="0" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter.blade.php">
&lt;x-accelade::counter :initial-count="0" /&gt;
        </x-accelade::code-block>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-[var(--docs-bg-alt)] rounded-xl p-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full animate-pulse"></span>
            <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Counter with Server Sync</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Counter that syncs state with the server (persisted across requests).</p>

        <div class="flex justify-center mb-4">
            <x-accelade::counter :initial-count="10" sync="count" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter-sync.blade.php">
&lt;x-accelade::counter :initial-count="10" sync="count" /&gt;
        </x-accelade::code-block>
    </section>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/data.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="data" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._data-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/defer.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="defer" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._defer-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/errors.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="errors" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._errors-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/event-bus.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="event-bus" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._event-bus', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/event.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="event" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._event-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/flash.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="flash" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._flash-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/frameworks.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="frameworks" :documentation="$documentation" :hasDemo="false">
    {{-- Frameworks page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Learn about using Accelade with different frontend frameworks above.</p>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/getting-started.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="getting-started" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
            <h3 class="text-lg font-semibold">Counter Component</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">A simple reactive counter. No build tools required!</p>

        <div class="flex justify-center mb-4">
            <x-accelade::counter :initial-count="0" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter.blade.php">
&lt;x-accelade::counter :initial-count="0" /&gt;
        </x-accelade::code-block>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full animate-pulse"></span>
            <h3 class="text-lg font-semibold">Counter with Server Sync</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Counter that syncs state with the server (persisted across requests).</p>

        <div class="flex justify-center mb-4">
            <x-accelade::counter :initial-count="10" sync="count" :framework="$framework" />
        </div>

        <x-accelade::code-block language="blade" filename="counter-sync.blade.php">
&lt;x-accelade::counter :initial-count="10" sync="count" /&gt;
        </x-accelade::code-block>
    </section>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/installation.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="installation" :documentation="$documentation" :hasDemo="false">
    {{-- Installation page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Follow the installation steps above to get started with Accelade.</p>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/lazy.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="lazy" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._lazy-loading', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/link.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="link" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._link-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/modal.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="modal" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._modal-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/navigation.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="navigation" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: SPA Navigation -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-cyan-500 rounded-full"></span>
            <h3 class="text-lg font-semibold">SPA Navigation</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo -->
        <div class="mb-4">
            <h4 class="text-sm font-medium text-center mb-3">SPA Navigation (Same Framework)</h4>
            <div class="flex gap-3 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('docs.section', ['section' => 'counter', 'framework' => $framework]) }}"
                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition"
                >
                    Go to Counter (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('docs.section', ['section' => 'navigation', 'framework' => $framework]) }}?time={{ time() }}"
                    class="px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-[var(--docs-text-muted)] text-center mt-2">Watch the page update without a full reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div>
            <h4 class="text-sm font-medium text-center mb-3">Preserve Scroll & State</h4>
            <div class="flex gap-3 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('docs.section', ['section' => 'navigation', 'framework' => $framework]) }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-4 py-2 bg-teal-600 text-white rounded-lg text-sm font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('docs.section', ['section' => 'navigation', 'framework' => $framework]) }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-4 py-2 bg-amber-600 text-white rounded-lg text-sm font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
            </div>
        </div>
    </section>

    <x-accelade::code-block language="blade" filename="navigation.blade.php">
&lt;x-accelade::link href="/page" :preserveScroll="true"&gt;
    Navigate with SPA
&lt;/x-accelade::link&gt;
    </x-accelade::code-block>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/notifications.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="notifications" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: Notifications -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-emerald-500 rounded-full"></span>
            <h3 class="text-lg font-semibold">Notifications</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-4">
            <h4 class="text-sm font-medium mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server
            </h4>
            <div class="bg-violet-500/10 rounded-lg p-4 border border-violet-500/20">
                <div class="flex flex-wrap gap-2 mb-3">
                    <a href="{{ route('docs.notify', 'success') }}" class="px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-xs font-medium hover:bg-emerald-700 transition">Success</a>
                    <a href="{{ route('docs.notify', 'info') }}" class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition">Info</a>
                    <a href="{{ route('docs.notify', 'warning') }}" class="px-3 py-1.5 bg-amber-600 text-white rounded-lg text-xs font-medium hover:bg-amber-700 transition">Warning</a>
                    <a href="{{ route('docs.notify', 'danger') }}" class="px-3 py-1.5 bg-red-600 text-white rounded-lg text-xs font-medium hover:bg-red-700 transition">Danger</a>
                </div>
            </div>
        </div>

        <!-- Frontend (JS) Notifications -->
        <div class="bg-[var(--docs-bg)] rounded-lg p-4 border border-[var(--docs-border)]">
            <h4 class="font-medium mb-3 text-sm flex items-center gap-2">
                <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                Frontend (JavaScript)
            </h4>
            <div class="flex flex-wrap gap-2">
                <button
                    onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')"
                    class="px-3 py-1.5 bg-emerald-600 text-white rounded-lg text-xs font-medium hover:bg-emerald-700 transition"
                >
                    Success
                </button>
                <button
                    onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')"
                    class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition"
                >
                    Info
                </button>
                <button
                    onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')"
                    class="px-3 py-1.5 bg-amber-600 text-white rounded-lg text-xs font-medium hover:bg-amber-700 transition"
                >
                    Warning
                </button>
                <button
                    onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')"
                    class="px-3 py-1.5 bg-red-600 text-white rounded-lg text-xs font-medium hover:bg-red-700 transition"
                >
                    Danger
                </button>
            </div>
        </div>
    </section>

    <x-accelade::code-block language="javascript" filename="notifications.js">
// JavaScript API
window.Accelade.notify.success('Title', 'Message');
window.Accelade.notify.info('Title', 'Message');
window.Accelade.notify.warning('Title', 'Message');
window.Accelade.notify.danger('Title', 'Message');

// PHP (Backend)
Notify::success('Saved!')->message('Changes saved.');
    </x-accelade::code-block>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/persistent.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="persistent" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._persistent-layout', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/progress.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="progress" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: Progress Bar Testing -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-amber-500 rounded-full animate-pulse"></span>
            <h3 class="text-lg font-semibold">Progress Bar Demo</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Test the progress bar with manual controls.</p>

        <div class="grid md:grid-cols-2 gap-4 mb-4">
            <!-- Manual Controls -->
            <div class="bg-[var(--docs-bg)] rounded-lg p-4 border border-[var(--docs-border)]">
                <h4 class="font-medium mb-3 text-sm">Manual Controls</h4>
                <div class="flex flex-wrap gap-2">
                    <button
                        onclick="window.Accelade?.progress?.start()"
                        class="px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-xs font-medium hover:bg-indigo-700 transition"
                    >
                        Start Progress
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done()"
                        class="px-3 py-1.5 bg-green-600 text-white rounded-lg text-xs font-medium hover:bg-green-700 transition"
                    >
                        Complete
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done(true)"
                        class="px-3 py-1.5 bg-red-600 text-white rounded-lg text-xs font-medium hover:bg-red-700 transition"
                    >
                        Force Complete
                    </button>
                </div>
            </div>

            <!-- Simulated Request -->
            <div class="bg-[var(--docs-bg)] rounded-lg p-4 border border-[var(--docs-border)]">
                <h4 class="font-medium mb-3 text-sm">Simulated Request</h4>
                <button
                    onclick="testSlowRequest()"
                    class="px-3 py-1.5 bg-purple-600 text-white rounded-lg text-xs font-medium hover:bg-purple-700 transition"
                >
                    Test Slow Request (2s)
                </button>
                <p id="request-status" class="text-xs text-[var(--docs-text-muted)] mt-2"></p>
            </div>
        </div>

        <script>
            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';
                window.Accelade?.progress?.start();
                setTimeout(() => {
                    status.textContent = 'Slow request completed!';
                    window.Accelade?.progress?.done();
                }, 2000);
            }
        </script>
    </section>

    <x-accelade::code-block language="javascript" filename="progress.js">
// Manual controls
window.Accelade.progress.start();
window.Accelade.progress.done();

// Configure progress bar
window.Accelade.progress.configure({
    color: '#6366f1',
    height: 3,
    position: 'top'
});
    </x-accelade::code-block>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/rehydrate.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="rehydrate" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/scripts.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="scripts" :documentation="$documentation" :hasDemo="$hasDemo">
    <!-- Demo: Custom Script Functions -->
    <section class="bg-[var(--docs-bg-secondary)] rounded-xl p-6 mb-6 border border-[var(--docs-border)]">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-2.5 h-2.5 bg-purple-500 rounded-full"></span>
            <h3 class="text-lg font-semibold">Custom Script Functions</h3>
        </div>
        <p class="text-[var(--docs-text-muted)] mb-4 text-sm">Define custom functions using &lt;accelade:script&gt; that can access state.</p>

        @accelade(['count' => 0, 'message' => 'Click the buttons!'])
            <div class="text-center p-6 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-lg mb-4">
                <p class="text-lg mb-3 font-medium" {{ $prefix }}-text="message">
                    Click the buttons!
                </p>

                <p class="text-3xl font-bold text-indigo-600 dark:text-indigo-400 mb-4" {{ $prefix }}-text="count">0</p>

                <div class="flex gap-2 justify-center">
                    <button
                        class="px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition"
                        @click="addFive()"
                    >
                        +5
                    </button>
                    <button
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 transition"
                        @click="double()"
                    >
                        Double
                    </button>
                    <button
                        class="px-4 py-2 bg-slate-600 text-white rounded-lg text-sm font-medium hover:bg-slate-700 transition"
                        @click="reset('count')"
                    >
                        Reset
                    </button>
                </div>
            </div>

            <accelade:script>
                return {
                    addFive() {
                        $set('count', $get('count') + 5);
                        $set('message', 'Added 5!');
                    },
                    double() {
                        const current = $get('count');
                        $set('count', current * 2);
                        $set('message', 'Doubled to ' + (current * 2) + '!');
                    }
                };
            </accelade:script>
        @endaccelade
    </section>

    <x-accelade::code-block language="javascript" filename="scripts.blade.php">
&lt;accelade:script&gt;
    return {
        addFive() {
            $set('count', $get('count') + 5);
        },
        double() {
            $set('count', $get('count') * 2);
        }
    };
&lt;/accelade:script&gt;
    </x-accelade::code-block>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/shared-data.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="shared-data" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._shared-data', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/sponsor.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="sponsor" :documentation="$documentation" :hasDemo="false">
    {{-- Sponsor page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Your support helps keep Accelade active and growing!</p>
        <div class="mt-4 flex flex-wrap justify-center gap-3">
            <a href="https://github.com/sponsors/fadymondy" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[#ea4aaa] text-white hover:opacity-90 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                Sponsor on GitHub
            </a>
            <a href="https://buymeacoffee.com/fadymondy" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[#FFDD00] text-black hover:opacity-90 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.216 6.415l-.132-.666c-.119-.598-.388-1.163-1.001-1.379-.197-.069-.42-.098-.57-.241-.152-.143-.196-.366-.231-.572-.065-.378-.125-.756-.192-1.133-.057-.325-.102-.69-.25-.987-.195-.4-.597-.634-.996-.788a5.723 5.723 0 00-.626-.194c-1-.263-2.05-.36-3.077-.416a25.834 25.834 0 00-3.7.062c-.915.083-1.88.184-2.75.5-.318.116-.646.256-.888.501-.297.302-.393.77-.177 1.146.154.267.415.456.692.58.36.162.737.284 1.123.366 1.075.238 2.189.331 3.287.37 1.218.05 2.437.01 3.65-.118.299-.033.598-.073.896-.119.352-.054.578-.513.474-.834-.124-.383-.457-.531-.834-.473-.466.074-.96.108-1.382.146-1.177.08-2.358.082-3.536.006a22.228 22.228 0 01-1.157-.107c-.086-.01-.18-.025-.258-.036-.243-.036-.484-.08-.724-.13-.111-.027-.111-.185 0-.212h.005c.277-.06.557-.108.838-.147h.002c.131-.009.263-.032.394-.048a25.076 25.076 0 013.426-.12c.674.019 1.347.067 2.017.144l.228.031c.267.04.533.088.798.145.392.085.895.113 1.07.542.055.137.08.288.111.431l.319 1.484a.237.237 0 01-.199.284h-.003c-.037.006-.075.01-.112.015a36.704 36.704 0 01-4.743.295 37.059 37.059 0 01-4.699-.304c-.14-.017-.293-.042-.417-.06-.326-.048-.649-.108-.973-.161-.393-.065-.768-.032-1.123.161-.29.16-.527.404-.675.701-.154.316-.199.66-.267 1-.069.34-.176.707-.135 1.056.087.753.613 1.365 1.37 1.502a39.69 39.69 0 0011.343.376.483.483 0 01.535.53l-.071.697-1.018 9.907c-.041.41-.047.832-.125 1.237-.122.637-.553 1.028-1.182 1.171-.577.131-1.165.2-1.756.205-.656.004-1.31-.025-1.966-.022-.699.004-1.556-.06-2.095-.58-.475-.458-.54-1.174-.605-1.793l-.731-7.013-.322-3.094c-.037-.351-.286-.695-.678-.678-.336.015-.718.3-.678.679l.228 2.185.949 9.112c.147 1.344 1.174 2.068 2.446 2.272.742.12 1.503.144 2.257.156.966.016 1.942.053 2.892-.122 1.408-.258 2.465-1.198 2.616-2.657.34-3.332.683-6.663 1.024-9.995l.215-2.087a.484.484 0 01.39-.426c.402-.078.787-.212 1.074-.518.455-.488.546-1.124.385-1.766zm-1.478.772c-.145.137-.363.201-.578.233-2.416.359-4.866.54-7.308.46-1.748-.06-3.477-.254-5.207-.498-.17-.024-.353-.055-.47-.18-.22-.236-.111-.71-.054-.995.052-.26.152-.609.463-.646.484-.057 1.046.148 1.526.22.577.088 1.156.159 1.737.212 2.48.226 5.002.19 7.472-.14.45-.06.899-.13 1.345-.21.399-.072.84-.206 1.08.206.166.281.188.657.162.974a.544.544 0 01-.169.364z"/></svg>
                Buy me a coffee
            </a>
        </div>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/state.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="state" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._state-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/teleport.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="teleport" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._teleport-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/testing.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="testing" :documentation="$documentation" :hasDemo="false">
    {{-- Testing page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Learn how to test your Accelade components above.</p>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/thanks.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => false])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="thanks" :documentation="$documentation" :hasDemo="false">
    {{-- Thanks page has no interactive demo --}}
    <div class="text-center py-8 text-[var(--docs-text-muted)]">
        <p>Accelade is built with love, powered by amazing open source projects.</p>
        <div class="mt-6 flex flex-wrap justify-center gap-4">
            <a href="https://laravel.com" target="_blank" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--docs-bg-alt)] hover:bg-[var(--docs-border)] transition">
                <img src="https://laravel.com/img/logomark.min.svg" alt="Laravel" class="w-5 h-5">
                Laravel
            </a>
            <a href="https://alpinejs.dev" target="_blank" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--docs-bg-alt)] hover:bg-[var(--docs-border)] transition">
                <img src="https://alpinejs.dev/alpine_long.svg" alt="Alpine.js" class="h-4">
            </a>
            <a href="https://tailwindcss.com" target="_blank" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--docs-bg-alt)] hover:bg-[var(--docs-border)] transition">
                <svg class="w-5 h-5 text-[#06B6D4]" fill="currentColor" viewBox="0 0 24 24"><path d="M12.001,4.8c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 C13.666,10.618,15.027,12,18.001,12c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C16.337,6.182,14.976,4.8,12.001,4.8z M6.001,12c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 c1.177,1.194,2.538,2.576,5.512,2.576c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C10.337,13.382,8.976,12,6.001,12z"/></svg>
                Tailwind CSS
            </a>
            <a href="https://vitejs.dev" target="_blank" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--docs-bg-alt)] hover:bg-[var(--docs-border)] transition">
                <svg class="w-5 h-5" viewBox="0 0 410 404" fill="none"><path d="M399.641 59.5246L215.643 388.545C211.844 395.338 202.084 395.378 198.228 388.618L10.5817 59.5563C6.38087 52.1896 12.6802 43.2665 21.0281 44.7586L205.223 77.6824C206.398 77.8924 207.601 77.8904 208.776 77.6763L389.119 44.8058C397.439 43.2894 403.768 52.1434 399.641 59.5246Z" fill="url(#paint0_linear)"/><path d="M292.965 1.5744L156.801 28.2552C154.563 28.6937 152.906 30.5903 152.771 32.8664L144.395 174.33C144.198 177.662 147.258 180.248 150.51 179.498L188.42 170.749C191.967 169.931 195.172 173.055 194.443 176.622L183.18 231.775C182.422 235.487 185.907 238.661 189.532 237.56L212.947 230.446C216.577 229.344 220.065 232.527 219.297 236.242L201.398 322.875C200.278 328.294 207.486 331.249 210.492 326.603L212.5 323.5L323.454 102.072C325.312 98.3645 322.108 94.137 318.036 94.9228L279.014 102.454C275.347 103.161 272.227 99.746 273.262 96.1583L298.731 7.86689C299.767 4.27314 296.636 0.855 292.965 1.5744Z" fill="url(#paint1_linear)"/><defs><linearGradient id="paint0_linear" x1="6.00017" y1="32.9999" x2="235" y2="344" gradientUnits="userSpaceOnUse"><stop stop-color="#41D1FF"/><stop offset="1" stop-color="#BD34FE"/></linearGradient><linearGradient id="paint1_linear" x1="194.651" y1="8.81818" x2="236.076" y2="292.989" gradientUnits="userSpaceOnUse"><stop stop-color="#FFBD4F"/><stop offset="1" stop-color="#FF980E"/></linearGradient></defs></svg>
                Vite
            </a>
        </div>
    </div>
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/toggle.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="toggle" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._toggle-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="resources/views/docs/sections/transition.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a', 'documentation' => null, 'hasDemo' => true])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.docs :framework="$framework" section="transition" :documentation="$documentation" :hasDemo="$hasDemo">
    @include('accelade::demo.partials._transition-component', ['prefix' => $prefix])
</x-accelade::layouts.docs>
</file>

<file path="routes/bridge.php">
<?php

declare(strict_types=1);

use Accelade\Http\Controllers\BridgeController;
use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Bridge Routes
|--------------------------------------------------------------------------
|
| These routes handle Bridge component AJAX requests for method calls
| and property synchronization.
|
*/

Route::prefix('accelade/bridge')->middleware('web')->group(function () {
    Route::post('/call', [BridgeController::class, 'call'])->name('accelade.bridge.call');
    Route::post('/sync', [BridgeController::class, 'sync'])->name('accelade.bridge.sync');
});
</file>

<file path="routes/web.php">
<?php

declare(strict_types=1);

use Accelade\Http\Controllers\AcceladeController;
use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Accelade Routes
|--------------------------------------------------------------------------
|
| Core routes for Accelade package functionality.
|
*/

// Core Accelade routes
Route::get('/accelade-v2.js', [AcceladeController::class, 'script'])
    ->name('accelade.script');

Route::post('/update', [AcceladeController::class, 'update'])
    ->name('accelade.update');

Route::post('/batch-update', [AcceladeController::class, 'batchUpdate'])
    ->name('accelade.batch-update');
</file>

<file path="src/Animation/AnimationPhase.php">
<?php

declare(strict_types=1);

namespace Accelade\Animation;

/**
 * Value object representing a single animation phase (enter or leave).
 */
readonly class AnimationPhase
{
    public function __construct(
        public string $transition,
        public string $from,
        public string $to,
    ) {}

    /**
     * Convert to array for JSON serialization.
     *
     * @return array<string, string>
     */
    public function toArray(): array
    {
        return [
            'transition' => $this->transition,
            'from' => $this->from,
            'to' => $this->to,
        ];
    }
}
</file>

<file path="src/Bridge/BridgeManager.php">
<?php

declare(strict_types=1);

namespace Accelade\Bridge;

use Illuminate\Support\Facades\Crypt;
use Illuminate\View\Component;
use ReflectionClass;
use ReflectionMethod;
use ReflectionProperty;

/**
 * Manages bridge component instances and state.
 *
 * Handles:
 * - Component instance storage and retrieval
 * - State serialization/deserialization
 * - Secure component fingerprinting
 * - Method calls on any component (no trait required)
 */
class BridgeManager
{
    /**
     * Registered bridge components.
     *
     * @var array<string, array{class: string, props: array}>
     */
    protected array $components = [];

    /**
     * Methods excluded from bridge calls.
     */
    protected array $excludedMethods = [
        'render',
        'resolveView',
        'data',
        'withAttributes',
        'withName',
        'shouldRender',
        'view',
        'flushCache',
        'forgetFactory',
        'forgetComponentsResolver',
        'resolveComponentsUsing',
    ];

    /**
     * Register a bridge component.
     */
    public function register(string $bridgeId, string $componentClass, array $props): void
    {
        $this->components[$bridgeId] = [
            'class' => $componentClass,
            'props' => $props,
        ];
    }

    /**
     * Get a registered component.
     */
    public function get(string $bridgeId): ?array
    {
        return $this->components[$bridgeId] ?? null;
    }

    /**
     * Check if a component is registered.
     */
    public function has(string $bridgeId): bool
    {
        return isset($this->components[$bridgeId]);
    }

    /**
     * Create a secure state payload for the frontend.
     */
    public function createPayload(string $bridgeId, string $componentClass, array $props): string
    {
        $payload = [
            'id' => $bridgeId,
            'class' => $componentClass,
            'props' => $props,
            'checksum' => $this->generateChecksum($bridgeId, $componentClass),
        ];

        return Crypt::encryptString(json_encode($payload));
    }

    /**
     * Decode and verify a state payload.
     */
    public function decodePayload(string $encrypted): ?array
    {
        try {
            $payload = json_decode(Crypt::decryptString($encrypted), true);

            if (! is_array($payload)) {
                return null;
            }

            // Verify checksum
            $expectedChecksum = $this->generateChecksum(
                $payload['id'] ?? '',
                $payload['class'] ?? ''
            );

            if (($payload['checksum'] ?? '') !== $expectedChecksum) {
                return null;
            }

            return $payload;
        } catch (\Throwable) {
            return null;
        }
    }

    /**
     * Generate a checksum for integrity verification.
     */
    protected function generateChecksum(string $bridgeId, string $componentClass): string
    {
        return hash_hmac('sha256', $bridgeId.$componentClass, config('app.key'));
    }

    /**
     * Create a component instance from payload.
     */
    public function createInstance(array $payload): ?Component
    {
        $componentClass = $payload['class'] ?? null;
        $props = $payload['props'] ?? [];

        if (! $componentClass || ! class_exists($componentClass)) {
            return null;
        }

        try {
            // Create instance with props as constructor arguments
            $instance = app()->make($componentClass, $props);

            // Update public properties with current values
            foreach ($props as $name => $value) {
                if (property_exists($instance, $name)) {
                    $instance->{$name} = $value;
                }
            }

            return $instance;
        } catch (\Throwable) {
            return null;
        }
    }

    /**
     * Get all public properties from a component.
     */
    public function getProps(Component $component): array
    {
        $reflection = new ReflectionClass($component);
        $props = [];

        foreach ($reflection->getProperties(ReflectionProperty::IS_PUBLIC) as $property) {
            $name = $property->getName();

            // Skip internal properties
            if (str_starts_with($name, '_') || str_starts_with($name, 'bridge')) {
                continue;
            }

            // Skip component infrastructure properties
            if (in_array($name, ['componentName', 'attributes', 'factory'], true)) {
                continue;
            }

            // Only include properties declared on the component class itself
            $declaringClass = $property->getDeclaringClass()->getName();
            if ($declaringClass === Component::class || $declaringClass === 'Illuminate\View\Component') {
                continue;
            }

            $value = $property->getValue($component);
            $props[$name] = $this->transformValue($value);
        }

        return $props;
    }

    /**
     * Transform a value for JSON serialization.
     */
    protected function transformValue(mixed $value): mixed
    {
        if ($value instanceof \Illuminate\Database\Eloquent\Model) {
            return $value->toArray();
        }

        if ($value instanceof \Illuminate\Support\Collection) {
            return $value->map(fn ($item) => $this->transformValue($item))->toArray();
        }

        if ($value instanceof \BackedEnum) {
            return $value->value;
        }

        if ($value instanceof \UnitEnum) {
            return $value->name;
        }

        if (is_object($value) && method_exists($value, 'toArray')) {
            return $value->toArray();
        }

        if (is_object($value) && method_exists($value, 'jsonSerialize')) {
            return $value->jsonSerialize();
        }

        return $value;
    }

    /**
     * Get callable methods from a component.
     */
    public function getMethods(Component $component): array
    {
        $reflection = new ReflectionClass($component);
        $methods = [];

        foreach ($reflection->getMethods(ReflectionMethod::IS_PUBLIC) as $method) {
            $name = $method->getName();

            // Skip excluded methods
            if (in_array($name, $this->excludedMethods, true)) {
                continue;
            }

            // Skip magic methods
            if (str_starts_with($name, '__')) {
                continue;
            }

            // Only include methods declared on the component class itself
            $declaringClass = $method->getDeclaringClass()->getName();
            if ($declaringClass === Component::class || $declaringClass === 'Illuminate\View\Component') {
                continue;
            }

            $methods[] = $name;
        }

        return $methods;
    }

    /**
     * Update component properties.
     */
    public function updateProps(Component $component, array $props): array
    {
        $reflection = new ReflectionClass($component);
        $updated = [];

        foreach ($props as $name => $value) {
            // Check if property exists and is public
            if (! $reflection->hasProperty($name)) {
                continue;
            }

            $property = $reflection->getProperty($name);
            if (! $property->isPublic()) {
                continue;
            }

            // Update the property
            $property->setValue($component, $value);
            $updated[$name] = $value;
        }

        return $updated;
    }

    /**
     * Call a method on a component.
     */
    public function callMethod(Component $component, string $method, array $args = []): BridgeResponse
    {
        $methods = $this->getMethods($component);

        if (! in_array($method, $methods, true)) {
            return BridgeResponse::error("Method '{$method}' is not callable via bridge.");
        }

        try {
            $result = $component->{$method}(...$args);

            // Handle different result types
            if ($result instanceof BridgeResponse) {
                return $result;
            }

            if ($result instanceof \Illuminate\Http\RedirectResponse) {
                return BridgeResponse::redirect($result->getTargetUrl());
            }

            if ($result instanceof \Illuminate\Http\Response) {
                return BridgeResponse::data(['response' => $result->getContent()]);
            }

            // Return success with any result
            return BridgeResponse::success([
                'result' => $result,
            ]);
        } catch (\Throwable $e) {
            return BridgeResponse::error($e->getMessage());
        }
    }

    /**
     * Get all registered components.
     */
    public function all(): array
    {
        return $this->components;
    }

    /**
     * Clear all registered components.
     */
    public function clear(): void
    {
        $this->components = [];
    }
}
</file>

<file path="src/Bridge/BridgeResponse.php">
<?php

declare(strict_types=1);

namespace Accelade\Bridge;

use Accelade\Facades\Notify;
use Illuminate\Contracts\Support\Arrayable;
use JsonSerializable;

/**
 * Response object for bridge method calls.
 *
 * Provides a fluent API for building responses that can include:
 * - Data/props updates
 * - Redirects
 * - Toast notifications
 * - Refresh commands
 * - Custom events
 */
class BridgeResponse implements Arrayable, JsonSerializable
{
    protected bool $success = true;

    protected ?string $message = null;

    protected array $data = [];

    protected ?string $redirect = null;

    protected bool $refresh = false;

    protected bool $preserveScroll = false;

    protected array $toast = [];

    protected array $events = [];

    protected array $props = [];

    /**
     * Create a new bridge response.
     */
    public function __construct(array $data = [])
    {
        $this->data = $data;
    }

    /**
     * Create a success response.
     */
    public static function success(array $data = []): static
    {
        $response = new static($data);
        $response->success = true;

        return $response;
    }

    /**
     * Create an error response.
     */
    public static function error(string $message, array $data = []): static
    {
        $response = new static($data);
        $response->success = false;
        $response->message = $message;

        return $response;
    }

    /**
     * Create a redirect response.
     */
    public static function redirect(string $url): static
    {
        $response = new static;
        $response->redirect = $url;

        return $response;
    }

    /**
     * Create a data response.
     */
    public static function data(array $data): static
    {
        return new static($data);
    }

    /**
     * Set the redirect URL.
     */
    public function redirectTo(string $url): static
    {
        $this->redirect = $url;

        return $this;
    }

    /**
     * Redirect to a named route.
     */
    public function redirectToRoute(string $route, array $parameters = []): static
    {
        $this->redirect = route($route, $parameters);

        return $this;
    }

    /**
     * Trigger a page refresh.
     */
    public function refresh(bool $preserveScroll = false): static
    {
        $this->refresh = true;
        $this->preserveScroll = $preserveScroll;

        return $this;
    }

    /**
     * Add a toast notification.
     */
    public function toast(string $type, string $title, string $body = ''): static
    {
        $this->toast = [
            'type' => $type,
            'title' => $title,
            'body' => $body,
        ];

        // Also trigger the notification via Notify facade
        match ($type) {
            'success' => Notify::success($title)->body($body),
            'info' => Notify::info($title)->body($body),
            'warning' => Notify::warning($title)->body($body),
            'danger', 'error' => Notify::danger($title)->body($body),
            default => Notify::info($title)->body($body),
        };

        return $this;
    }

    /**
     * Add a success toast.
     */
    public function toastSuccess(string $title, string $body = ''): static
    {
        return $this->toast('success', $title, $body);
    }

    /**
     * Add an info toast.
     */
    public function toastInfo(string $title, string $body = ''): static
    {
        return $this->toast('info', $title, $body);
    }

    /**
     * Add a warning toast.
     */
    public function toastWarning(string $title, string $body = ''): static
    {
        return $this->toast('warning', $title, $body);
    }

    /**
     * Add a danger/error toast.
     */
    public function toastDanger(string $title, string $body = ''): static
    {
        return $this->toast('danger', $title, $body);
    }

    /**
     * Emit an event.
     */
    public function emit(string $event, array $data = []): static
    {
        $this->events[] = [
            'name' => $event,
            'data' => $data,
        ];

        return $this;
    }

    /**
     * Set the updated props.
     */
    public function withProps(array $props): static
    {
        $this->props = $props;

        return $this;
    }

    /**
     * Set the data.
     */
    public function withData(array $data): static
    {
        $this->data = array_merge($this->data, $data);

        return $this;
    }

    /**
     * Set the success message.
     */
    public function withMessage(string $message): static
    {
        $this->message = $message;

        return $this;
    }

    /**
     * Convert the response to an array.
     */
    public function toArray(): array
    {
        $response = [
            'success' => $this->success,
        ];

        if ($this->message !== null) {
            $response['message'] = $this->message;
        }

        if (! empty($this->data)) {
            $response['data'] = $this->data;
        }

        if (! empty($this->props)) {
            $response['props'] = $this->props;
        }

        if ($this->redirect !== null) {
            $response['redirect'] = $this->redirect;
        }

        if ($this->refresh) {
            $response['refresh'] = true;
            $response['preserveScroll'] = $this->preserveScroll;
        }

        if (! empty($this->toast)) {
            $response['toast'] = $this->toast;
        }

        if (! empty($this->events)) {
            $response['events'] = $this->events;
        }

        return $response;
    }

    /**
     * Serialize to JSON.
     */
    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
</file>

<file path="src/Bridge/WithBridge.php">
<?php

declare(strict_types=1);

namespace Accelade\Bridge;

use Illuminate\Support\Str;
use ReflectionClass;
use ReflectionMethod;
use ReflectionProperty;

/**
 * Trait to enable Bridge functionality on Blade Components.
 *
 * Bridge Components provide two-way binding between PHP properties
 * and JavaScript, allowing frontend templates to:
 * - Access public PHP properties as reactive `props`
 * - Call public PHP methods via AJAX
 * - Receive responses (redirects, toasts, data updates)
 */
trait WithBridge
{
    /**
     * Unique identifier for this bridge instance.
     */
    protected string $bridgeId;

    /**
     * Middleware to apply to method calls.
     */
    protected array $bridgeMiddleware = [];

    /**
     * Properties that should be hidden from the bridge.
     */
    protected array $bridgeHidden = [];

    /**
     * Boot the bridge trait.
     */
    public function bootWithBridge(): void
    {
        $this->bridgeId = $this->generateBridgeId();
    }

    /**
     * Generate a unique bridge ID.
     */
    protected function generateBridgeId(): string
    {
        return 'bridge-'.Str::random(16);
    }

    /**
     * Get the bridge ID.
     */
    public function getBridgeId(): string
    {
        if (! isset($this->bridgeId)) {
            $this->bridgeId = $this->generateBridgeId();
        }

        return $this->bridgeId;
    }

    /**
     * Add middleware to be applied during method calls.
     */
    protected function middleware(string|array $middleware): static
    {
        $this->bridgeMiddleware = array_merge(
            $this->bridgeMiddleware,
            (array) $middleware
        );

        return $this;
    }

    /**
     * Get the middleware for bridge method calls.
     */
    public function getBridgeMiddleware(): array
    {
        return $this->bridgeMiddleware;
    }

    /**
     * Hide properties from the bridge.
     */
    protected function hiddenFromBridge(string|array $properties): static
    {
        $this->bridgeHidden = array_merge(
            $this->bridgeHidden,
            (array) $properties
        );

        return $this;
    }

    /**
     * Get all public properties that should be exposed to the bridge.
     */
    public function getBridgeProps(): array
    {
        $reflection = new ReflectionClass($this);
        $props = [];

        foreach ($reflection->getProperties(ReflectionProperty::IS_PUBLIC) as $property) {
            $name = $property->getName();

            // Skip hidden properties
            if (in_array($name, $this->bridgeHidden, true)) {
                continue;
            }

            // Skip internal properties
            if (str_starts_with($name, 'bridge') || str_starts_with($name, '_')) {
                continue;
            }

            // Skip properties from parent classes (like Component)
            if ($property->getDeclaringClass()->getName() !== static::class) {
                continue;
            }

            $value = $property->getValue($this);

            // Transform Eloquent models and collections
            $props[$name] = $this->transformValue($value);
        }

        return $props;
    }

    /**
     * Transform a value for JSON serialization.
     */
    protected function transformValue(mixed $value): mixed
    {
        if ($value instanceof \Illuminate\Database\Eloquent\Model) {
            return $value->toArray();
        }

        if ($value instanceof \Illuminate\Support\Collection) {
            return $value->map(fn ($item) => $this->transformValue($item))->toArray();
        }

        if ($value instanceof \BackedEnum) {
            return $value->value;
        }

        if ($value instanceof \UnitEnum) {
            return $value->name;
        }

        if (is_object($value) && method_exists($value, 'toArray')) {
            return $value->toArray();
        }

        if (is_object($value) && method_exists($value, 'jsonSerialize')) {
            return $value->jsonSerialize();
        }

        return $value;
    }

    /**
     * Get all public methods that can be called via the bridge.
     */
    public function getBridgeMethods(): array
    {
        $reflection = new ReflectionClass($this);
        $methods = [];

        // Methods to exclude (from Component class and this trait)
        $excluded = [
            'render',
            'resolveView',
            'data',
            'withAttributes',
            'withName',
            'shouldRender',
            'view',
            'flushCache',
            'forgetFactory',
            'forgetComponentsResolver',
            'resolveComponentsUsing',
            // Trait methods
            'bootWithBridge',
            'generateBridgeId',
            'getBridgeId',
            'middleware',
            'getBridgeMiddleware',
            'hiddenFromBridge',
            'getBridgeProps',
            'getBridgeMethods',
            'getBridgeConfig',
            'transformValue',
            'updateBridgeProps',
            'callBridgeMethod',
        ];

        foreach ($reflection->getMethods(ReflectionMethod::IS_PUBLIC) as $method) {
            $name = $method->getName();

            // Skip excluded methods
            if (in_array($name, $excluded, true)) {
                continue;
            }

            // Skip magic methods
            if (str_starts_with($name, '__')) {
                continue;
            }

            // Skip methods from parent classes
            if ($method->getDeclaringClass()->getName() !== static::class) {
                continue;
            }

            // Get method parameters
            $params = [];
            foreach ($method->getParameters() as $param) {
                $params[] = [
                    'name' => $param->getName(),
                    'optional' => $param->isOptional(),
                    'default' => $param->isOptional() ? $param->getDefaultValue() : null,
                ];
            }

            $methods[$name] = [
                'name' => $name,
                'params' => $params,
            ];
        }

        return $methods;
    }

    /**
     * Get the bridge configuration for the frontend.
     */
    public function getBridgeConfig(): array
    {
        return [
            'id' => $this->getBridgeId(),
            'component' => static::class,
            'props' => $this->getBridgeProps(),
            'methods' => array_keys($this->getBridgeMethods()),
        ];
    }

    /**
     * Update bridge properties from frontend.
     */
    public function updateBridgeProps(array $props): array
    {
        $reflection = new ReflectionClass($this);
        $updated = [];

        foreach ($props as $name => $value) {
            // Skip hidden properties
            if (in_array($name, $this->bridgeHidden, true)) {
                continue;
            }

            // Check if property exists and is public
            if (! $reflection->hasProperty($name)) {
                continue;
            }

            $property = $reflection->getProperty($name);
            if (! $property->isPublic()) {
                continue;
            }

            // Update the property
            $property->setValue($this, $value);
            $updated[$name] = $value;
        }

        return $updated;
    }

    /**
     * Call a bridge method.
     */
    public function callBridgeMethod(string $method, array $args = []): BridgeResponse
    {
        $methods = $this->getBridgeMethods();

        if (! isset($methods[$method])) {
            return BridgeResponse::error("Method '{$method}' is not callable via bridge.");
        }

        try {
            $result = $this->{$method}(...$args);

            // Handle different result types
            if ($result instanceof BridgeResponse) {
                return $result;
            }

            if ($result instanceof \Illuminate\Http\RedirectResponse) {
                return BridgeResponse::redirect($result->getTargetUrl());
            }

            if ($result instanceof \Illuminate\Http\Response) {
                return BridgeResponse::data(['response' => $result->getContent()]);
            }

            // Return updated props along with any result
            return BridgeResponse::success([
                'result' => $result,
                'props' => $this->getBridgeProps(),
            ]);
        } catch (\Throwable $e) {
            return BridgeResponse::error($e->getMessage());
        }
    }
}
</file>

<file path="src/Broadcasting/EventResponse.php">
<?php

declare(strict_types=1);

namespace Accelade\Broadcasting;

use Illuminate\Contracts\Support\Arrayable;
use JsonSerializable;

/**
 * EventResponse - Response helper for broadcast events
 *
 * Provides fluent methods to create broadcast payloads that trigger
 * client-side actions like redirect, refresh, or toast notifications.
 */
class EventResponse implements Arrayable, JsonSerializable
{
    /**
     * The action type to execute
     */
    protected string $action;

    /**
     * URL for redirect action
     */
    protected ?string $url = null;

    /**
     * Message for toast action
     */
    protected ?string $message = null;

    /**
     * Title for toast action
     */
    protected ?string $title = null;

    /**
     * Type for toast action (success, info, warning, danger)
     */
    protected string $type = 'info';

    /**
     * Additional custom data to include in the response
     */
    protected array $data = [];

    /**
     * Create a new event response
     */
    public function __construct(string $action)
    {
        $this->action = $action;
    }

    /**
     * Create a redirect response
     */
    public static function redirect(string $url): self
    {
        $response = new self('redirect');
        $response->url = $url;

        return $response;
    }

    /**
     * Create a redirect to a named route
     */
    public static function redirectToRoute(string $route, array $parameters = []): self
    {
        return self::redirect(route($route, $parameters));
    }

    /**
     * Create a refresh response
     */
    public static function refresh(): self
    {
        return new self('refresh');
    }

    /**
     * Create a toast notification response
     */
    public static function toast(string $message, string $type = 'info'): self
    {
        $response = new self('toast');
        $response->message = $message;
        $response->type = $type;

        return $response;
    }

    /**
     * Create a success toast
     */
    public static function success(string $message): self
    {
        return self::toast($message, 'success');
    }

    /**
     * Create an info toast
     */
    public static function info(string $message): self
    {
        return self::toast($message, 'info');
    }

    /**
     * Create a warning toast
     */
    public static function warning(string $message): self
    {
        return self::toast($message, 'warning');
    }

    /**
     * Create a danger toast
     */
    public static function danger(string $message): self
    {
        return self::toast($message, 'danger');
    }

    /**
     * Set the toast title
     */
    public function withTitle(string $title): self
    {
        $this->title = $title;

        return $this;
    }

    /**
     * Add custom data to the response
     */
    public function with(array $data): self
    {
        $this->data = array_merge($this->data, $data);

        return $this;
    }

    /**
     * Get the Accelade action payload
     */
    protected function getAcceladePayload(): array
    {
        $payload = ['action' => $this->action];

        if ($this->url !== null) {
            $payload['url'] = $this->url;
        }

        if ($this->message !== null) {
            $payload['message'] = $this->message;
        }

        if ($this->title !== null) {
            $payload['title'] = $this->title;
        }

        if ($this->action === 'toast') {
            $payload['type'] = $this->type;
        }

        return $payload;
    }

    /**
     * Convert to array
     */
    public function toArray(): array
    {
        return array_merge($this->data, [
            '_accelade' => $this->getAcceladePayload(),
        ]);
    }

    /**
     * Convert to JSON serializable
     */
    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
</file>

<file path="src/Compilers/AcceladeTagCompiler.php">
<?php

declare(strict_types=1);

namespace Accelade\Compilers;

use Illuminate\Container\Container;

class AcceladeTagCompiler
{
    protected Container $container;

    /**
     * Tags that should NOT be compiled as reactive components.
     * These remain as literal HTML for JavaScript to process.
     */
    protected array $excludedTags = [
        'script',
        'link',
        'style',
    ];

    public function __construct(Container $container)
    {
        $this->container = $container;
    }

    /**
     * Check if a component name should be excluded from compilation.
     */
    protected function isExcludedTag(string $component): bool
    {
        return in_array($component, $this->excludedTags, true);
    }

    /**
     * Compile Accelade tags in the template.
     */
    public function compile(string $template): string
    {
        // Compile self-closing <x-accelade:component /> tags
        $template = $this->compileSelfClosingTags($template);

        // Compile opening <x-accelade:component> tags
        $template = $this->compileOpeningTags($template);

        // Compile closing </x-accelade:component> tags
        $template = $this->compileClosingTags($template);

        return $template;
    }

    /**
     * Compile self-closing tags.
     */
    protected function compileSelfClosingTags(string $template): string
    {
        // Pattern: <accelade:component-name attr="value" /> (without x- prefix)
        $pattern = '/<accelade:([\w\-:.]+)\s*([^>]*?)\s*\/>/s';

        return preg_replace_callback($pattern, function ($matches) {
            $component = $matches[1];

            // Skip excluded tags - leave them as-is for JavaScript
            if ($this->isExcludedTag($component)) {
                return $matches[0];
            }

            $attributeString = $matches[2];
            $attributes = $this->parseAttributes($attributeString);

            return $this->buildComponentOutput($component, $attributes, true);
        }, $template);
    }

    /**
     * Compile opening tags.
     */
    protected function compileOpeningTags(string $template): string
    {
        // Pattern: <accelade:component-name attr="value"> (without x- prefix)
        $pattern = '/<accelade:([\w\-:.]+)\s*([^>]*?)(?<!\/)>/s';

        return preg_replace_callback($pattern, function ($matches) {
            $component = $matches[1];

            // Skip excluded tags - leave them as-is for JavaScript
            if ($this->isExcludedTag($component)) {
                return $matches[0];
            }

            $attributeString = $matches[2];
            $attributes = $this->parseAttributes($attributeString);

            return $this->buildComponentOutput($component, $attributes, false);
        }, $template);
    }

    /**
     * Compile closing tags.
     */
    protected function compileClosingTags(string $template): string
    {
        return preg_replace_callback(
            '/<\/accelade:([\w\-:.]+)>/',
            function ($matches) {
                $component = $matches[1];

                // Skip excluded tags - leave them as-is for JavaScript
                if ($this->isExcludedTag($component)) {
                    return $matches[0];
                }

                return '@endacceladeComponent';
            },
            $template
        );
    }

    /**
     * Build the component output directive.
     */
    protected function buildComponentOutput(string $component, array $attributes, bool $selfClosing): string
    {
        $attrString = $this->attributesToPhpArray($attributes);

        $output = "@acceladeComponent('{$component}', [{$attrString}])";

        if ($selfClosing) {
            // For self-closing tags, render the component view with state
            $output .= "\n@include('accelade::components.{$component}', ['state' => app('accelade')->getCurrentState()])\n";
            $output .= '@endacceladeComponent';
        }

        return $output;
    }

    /**
     * Parse attributes from the attribute string.
     */
    protected function parseAttributes(string $attributeString): array
    {
        $attributes = [];

        // Parse :binding attributes for reactive data (PHP expressions) FIRST
        preg_match_all('/:(\w[\w\-]*)=(["\'])(.*?)\2/s', $attributeString, $bindMatches, PREG_SET_ORDER);

        foreach ($bindMatches as $match) {
            $attributes['bind:'.$match[1]] = [
                'value' => $match[3],
                'type' => 'expression',
            ];
        }

        // Remove :binding attributes from string before parsing standard attributes
        $cleanedString = preg_replace('/:(\w[\w\-]*)=(["\'])(.*?)\2/s', '', $attributeString);

        // Parse standard attributes: name="value"
        preg_match_all('/(\w[\w\-]*)=(["\'])(.*?)\2/s', $cleanedString, $matches, PREG_SET_ORDER);

        foreach ($matches as $match) {
            $attributes[$match[1]] = [
                'value' => $match[3],
                'type' => 'string',
            ];
        }

        // Parse @event handlers
        preg_match_all('/@(\w+)=(["\'])(.*?)\2/s', $attributeString, $eventMatches, PREG_SET_ORDER);

        foreach ($eventMatches as $match) {
            $attributes['on:'.$match[1]] = [
                'value' => $match[3],
                'type' => 'event',
            ];
        }

        // Parse boolean attributes (just the attribute name)
        preg_match_all('/\s(\w[\w\-]*)(?=\s|$|\/?>)(?!=)/s', ' '.$attributeString, $boolMatches);

        foreach ($boolMatches[1] as $attr) {
            if (! isset($attributes[$attr]) && ! isset($attributes['bind:'.$attr])) {
                $attributes[$attr] = [
                    'value' => true,
                    'type' => 'boolean',
                ];
            }
        }

        return $attributes;
    }

    /**
     * Convert parsed attributes to PHP array string.
     */
    protected function attributesToPhpArray(array $attributes): string
    {
        $pairs = [];

        foreach ($attributes as $key => $attr) {
            if ($attr['type'] === 'expression') {
                // PHP expression - don't quote
                $pairs[] = "'{$key}' => {$attr['value']}";
            } elseif ($attr['type'] === 'boolean') {
                $pairs[] = "'{$key}' => true";
            } elseif ($attr['type'] === 'event') {
                $pairs[] = "'{$key}' => '{$attr['value']}'";
            } else {
                // String value - quote it
                $escaped = addslashes($attr['value']);
                $pairs[] = "'{$key}' => '{$escaped}'";
            }
        }

        return implode(', ', $pairs);
    }
}
</file>

<file path="src/Components/Demo/BridgeCounter.php">
<?php

declare(strict_types=1);

namespace Accelade\Components\Demo;

use Accelade\Bridge\BridgeResponse;
use Illuminate\Contracts\View\View;
use Illuminate\View\Component;

/**
 * Demo Bridge Counter Component.
 *
 * Demonstrates the Bridge component functionality:
 * - Public properties accessible as `props` in JavaScript
 * - Public methods callable from JavaScript via AJAX
 * - Two-way binding with a-model
 * - Toast notifications from PHP
 *
 * NOTE: No trait required! Any component works with Bridge.
 */
class BridgeCounter extends Component
{
    /**
     * The current count.
     */
    public int $count;

    /**
     * The step value for incrementing.
     */
    public int $step;

    /**
     * A name to display.
     */
    public string $name;

    /**
     * Create a new component instance.
     */
    public function __construct(
        int $count = 0,
        int $step = 1,
        string $name = 'World'
    ) {
        $this->count = $count;
        $this->step = $step;
        $this->name = $name;
    }

    /**
     * Increment the counter.
     */
    public function increment(): BridgeResponse
    {
        $this->count += $this->step;

        return BridgeResponse::success()
            ->withMessage('Counter incremented!')
            ->toastSuccess('Incremented!', "Counter is now {$this->count}");
    }

    /**
     * Decrement the counter.
     */
    public function decrement(): BridgeResponse
    {
        $this->count -= $this->step;

        return BridgeResponse::success()
            ->withMessage('Counter decremented!')
            ->toastInfo('Decremented!', "Counter is now {$this->count}");
    }

    /**
     * Reset the counter to zero.
     */
    public function reset(): BridgeResponse
    {
        $this->count = 0;

        return BridgeResponse::success()
            ->withMessage('Counter reset!')
            ->toastWarning('Reset!', 'Counter has been reset to 0');
    }

    /**
     * Double the current count.
     */
    public function double(): BridgeResponse
    {
        $this->count *= 2;

        return BridgeResponse::success()
            ->withMessage('Counter doubled!')
            ->emit('counter-doubled', ['count' => $this->count]);
    }

    /**
     * Save the counter (simulated).
     */
    public function save(): BridgeResponse
    {
        // Simulate saving to database
        // In a real app, you would save to database here

        return BridgeResponse::success()
            ->toastSuccess('Saved!', "Counter value {$this->count} has been saved.")
            ->emit('counter-saved', ['count' => $this->count, 'name' => $this->name]);
    }

    /**
     * Update the greeting name.
     */
    public function updateName(string $newName): BridgeResponse
    {
        $this->name = $newName;

        return BridgeResponse::success()
            ->toastInfo('Name Updated', "Hello, {$this->name}!");
    }

    /**
     * Get the view / contents that represent the component.
     */
    public function render(): View
    {
        return view('accelade::components.demo.bridge-counter');
    }
}
</file>

<file path="src/Components/AcceladeComponent.php">
<?php

declare(strict_types=1);

namespace Accelade\Components;

use Illuminate\Support\Str;
use Illuminate\View\Component;

abstract class AcceladeComponent extends Component
{
    /**
     * The component's reactive state.
     */
    protected array $state = [];

    /**
     * Properties that should sync with the server.
     */
    protected array $syncProperties = [];

    /**
     * Initialize the component state.
     */
    abstract protected function initializeState(): void;

    /**
     * Create a new component instance.
     */
    public function __construct()
    {
        $this->initializeState();
    }

    /**
     * Get the view / contents that represent the component.
     */
    public function render()
    {
        return view($this->viewName(), $this->viewData());
    }

    /**
     * Get the view name for this component.
     */
    protected function viewName(): string
    {
        $name = class_basename(static::class);
        $kebab = Str::kebab($name);

        return "accelade::components.{$kebab}";
    }

    /**
     * Get the data to pass to the view.
     */
    protected function viewData(): array
    {
        return [
            'state' => $this->state,
            'componentId' => $this->getComponentId(),
            'syncProperties' => $this->syncProperties,
        ];
    }

    /**
     * Generate a unique component ID.
     */
    protected function getComponentId(): string
    {
        $name = Str::kebab(class_basename(static::class));

        return $name.'-'.Str::random(8);
    }

    /**
     * Get the component state.
     */
    public function getState(): array
    {
        return $this->state;
    }

    /**
     * Set a state property.
     */
    protected function setState(string $key, mixed $value): void
    {
        $this->state[$key] = $value;
    }

    /**
     * Get sync properties.
     */
    public function getSyncProperties(): array
    {
        return $this->syncProperties;
    }

    /**
     * Convert the component to an array.
     */
    public function toArray(): array
    {
        return [
            'id' => $this->getComponentId(),
            'state' => $this->state,
            'sync' => $this->syncProperties,
        ];
    }
}
</file>

<file path="src/Components/Bridge.php">
<?php

declare(strict_types=1);

namespace Accelade\Components;

use Illuminate\Contracts\View\View;
use Illuminate\Support\Str;
use Illuminate\View\Component;
use ReflectionClass;
use ReflectionMethod;
use ReflectionProperty;

/**
 * Bridge Component - Wrapper for any Blade component.
 *
 * This component takes any Blade component instance and wraps it with
 * the necessary data attributes for JavaScript two-way binding.
 * No trait required on the wrapped component.
 *
 * Usage:
 * <x-accelade::bridge :component="$myComponent">
 *     <!-- Blade template with a-model, @click method calls, etc. -->
 * </x-accelade::bridge>
 */
class Bridge extends Component
{
    /**
     * The wrapped component instance.
     */
    public Component $component;

    /**
     * Unique identifier for this bridge instance.
     */
    public string $bridgeId;

    /**
     * The encrypted state payload.
     */
    public string $state;

    /**
     * Properties hidden from bridge.
     */
    protected array $hiddenProps = [];

    /**
     * Methods excluded from bridge.
     */
    protected array $excludedMethods = [
        'render',
        'resolveView',
        'data',
        'withAttributes',
        'withName',
        'shouldRender',
        'view',
        'flushCache',
        'forgetFactory',
        'forgetComponentsResolver',
        'resolveComponentsUsing',
        '__construct',
        '__get',
        '__set',
        '__isset',
        '__unset',
        '__call',
        '__callStatic',
        '__toString',
        '__invoke',
        '__clone',
        '__sleep',
        '__wakeup',
        '__serialize',
        '__unserialize',
        '__destruct',
        '__debugInfo',
    ];

    /**
     * Create a new component instance.
     */
    public function __construct(Component $component, array $hidden = [])
    {
        $this->component = $component;
        $this->hiddenProps = $hidden;
        $this->bridgeId = 'bridge-'.Str::random(16);

        // Create encrypted state payload
        $manager = app('accelade.bridge');
        $this->state = $manager->createPayload(
            $this->bridgeId,
            get_class($component),
            $this->getProps()
        );
    }

    /**
     * Get all public properties from the component.
     */
    public function getProps(): array
    {
        $reflection = new ReflectionClass($this->component);
        $props = [];

        foreach ($reflection->getProperties(ReflectionProperty::IS_PUBLIC) as $property) {
            $name = $property->getName();

            // Skip hidden properties
            if (in_array($name, $this->hiddenProps, true)) {
                continue;
            }

            // Skip internal properties
            if (str_starts_with($name, '_') || str_starts_with($name, 'bridge')) {
                continue;
            }

            // Skip component infrastructure properties
            if (in_array($name, ['componentName', 'attributes', 'factory'], true)) {
                continue;
            }

            // Only include properties declared on the component class itself
            $declaringClass = $property->getDeclaringClass()->getName();
            if ($declaringClass === Component::class || $declaringClass === 'Illuminate\View\Component') {
                continue;
            }

            $value = $property->getValue($this->component);
            $props[$name] = $this->transformValue($value);
        }

        return $props;
    }

    /**
     * Transform a value for JSON serialization.
     */
    protected function transformValue(mixed $value): mixed
    {
        if ($value instanceof \Illuminate\Database\Eloquent\Model) {
            return $value->toArray();
        }

        if ($value instanceof \Illuminate\Support\Collection) {
            return $value->map(fn ($item) => $this->transformValue($item))->toArray();
        }

        if ($value instanceof \BackedEnum) {
            return $value->value;
        }

        if ($value instanceof \UnitEnum) {
            return $value->name;
        }

        if (is_object($value) && method_exists($value, 'toArray')) {
            return $value->toArray();
        }

        if (is_object($value) && method_exists($value, 'jsonSerialize')) {
            return $value->jsonSerialize();
        }

        return $value;
    }

    /**
     * Get all callable public methods from the component.
     */
    public function getMethods(): array
    {
        $reflection = new ReflectionClass($this->component);
        $methods = [];

        foreach ($reflection->getMethods(ReflectionMethod::IS_PUBLIC) as $method) {
            $name = $method->getName();

            // Skip excluded methods
            if (in_array($name, $this->excludedMethods, true)) {
                continue;
            }

            // Skip magic methods
            if (str_starts_with($name, '__')) {
                continue;
            }

            // Only include methods declared on the component class itself
            $declaringClass = $method->getDeclaringClass()->getName();
            if ($declaringClass === Component::class || $declaringClass === 'Illuminate\View\Component') {
                continue;
            }

            $methods[] = $name;
        }

        return $methods;
    }

    /**
     * Get the JSON configuration for the frontend.
     */
    public function getJsonConfig(): string
    {
        return json_encode([
            'id' => $this->bridgeId,
            'component' => get_class($this->component),
            'props' => $this->getProps(),
            'methods' => $this->getMethods(),
            'state' => $this->state,
            'callUrl' => route('accelade.bridge.call'),
            'syncUrl' => route('accelade.bridge.sync'),
        ]);
    }

    /**
     * Get the view / contents that represent the component.
     */
    public function render(): View
    {
        return view('accelade::components.bridge');
    }
}
</file>

<file path="src/Components/Counter.php">
<?php

declare(strict_types=1);

namespace Accelade\Components;

class Counter extends AcceladeComponent
{
    /**
     * Properties that sync with server.
     */
    protected array $syncProperties = [];

    /**
     * Create a new component instance.
     */
    public function __construct(
        public int $initialCount = 0,
        public ?string $sync = null,
    ) {
        if ($this->sync) {
            $this->syncProperties = explode(',', $this->sync);
        }

        parent::__construct();
    }

    /**
     * Initialize the component state.
     */
    protected function initializeState(): void
    {
        $this->state = [
            'count' => $this->initialCount,
        ];
    }
}
</file>

<file path="src/Components/PersistentComponent.php">
<?php

declare(strict_types=1);

namespace Accelade\Components;

use Illuminate\View\Component;

/**
 * PersistentComponent - Base class for persistent layout components
 *
 * Extend this class to create layouts where certain elements persist
 * across SPA navigation (e.g., media players, chat widgets).
 *
 * Usage:
 * 1. Create a component extending PersistentComponent
 * 2. In your view, use $slot for the page content
 * 3. Add persistent elements outside the slot with data-accelade-persistent
 *
 * Example:
 * ```php
 * class VideoLayout extends PersistentComponent
 * {
 *     public function render()
 *     {
 *         return view('components.video-layout');
 *     }
 * }
 * ```
 *
 * ```blade
 * <div>
 *     <main data-accelade-page>
 *         {{ $slot }}
 *     </main>
 *
 *     <div data-accelade-persistent class="fixed bottom-0">
 *         <video src="..."></video>
 *     </div>
 * </div>
 * ```
 */
abstract class PersistentComponent extends Component
{
    /**
     * Whether to persist this layout across navigation.
     */
    public bool $persistent = true;

    /**
     * Get the data to pass to the view.
     */
    public function data(): array
    {
        return array_merge(parent::data(), [
            'persistent' => $this->persistent,
        ]);
    }
}
</file>

<file path="src/Console/InstallCommand.php">
<?php

declare(strict_types=1);

namespace Accelade\Console;

use Illuminate\Console\Command;

class InstallCommand extends Command
{
    /**
     * The name and signature of the console command.
     */
    protected $signature = 'accelade:install
                            {--framework=vue : The frontend framework to use (vue or react)}';

    /**
     * The console command description.
     */
    protected $description = 'Install Accelade and configure your application';

    /**
     * Execute the console command.
     */
    public function handle(): int
    {
        $framework = $this->option('framework');

        if (! in_array($framework, ['vue', 'react'], true)) {
            $this->error('Invalid framework. Choose "vue" or "react".');

            return self::FAILURE;
        }

        $this->info('Installing Accelade...');

        // Publish config
        $this->call('vendor:publish', [
            '--tag' => 'accelade-config',
            '--force' => true,
        ]);

        // Update the config with chosen framework
        $this->updateConfig($framework);

        $this->newLine();
        $this->info('Accelade installed successfully!');
        $this->newLine();

        $this->line('Add the following to your Blade layout:');
        $this->newLine();
        $this->line('  <head>');
        $this->line('      @acceladeStyles');
        $this->line('  </head>');
        $this->line('  <body>');
        $this->line('      <!-- Your content -->');
        $this->line('      @acceladeScripts');
        $this->line('  </body>');
        $this->newLine();

        $this->line('Example component usage:');
        $this->line('  <x-accelade:counter :initial-count="0" />');
        $this->newLine();

        return self::SUCCESS;
    }

    /**
     * Update the config file with the chosen framework.
     */
    protected function updateConfig(string $framework): void
    {
        $configPath = config_path('accelade.php');

        if (file_exists($configPath)) {
            $content = file_get_contents($configPath);
            $content = preg_replace(
                "/'framework' => env\('ACCELADE_FRAMEWORK', '.*?'\)/",
                "'framework' => env('ACCELADE_FRAMEWORK', '{$framework}')",
                $content
            );
            file_put_contents($configPath, $content);
        }

        $this->info("Configured to use {$framework} framework.");
    }
}
</file>

<file path="src/Docs/DocSection.php">
<?php

declare(strict_types=1);

namespace Accelade\Docs;

/**
 * Value object representing a documentation section.
 */
readonly class DocSection
{
    public string $slug;

    public string $label;

    public ?string $markdownFile;

    public ?string $demoPartial;

    public ?string $view;

    public bool $hasDemo;

    public string $package;

    public ?string $description;

    /** @var array<int, string> */
    public array $keywords;

    public function __construct(string $slug, string $label, ?DocSectionConfig $config = null)
    {
        $config ??= new DocSectionConfig;

        $this->slug = $slug;
        $this->label = $label;
        $this->markdownFile = $config->markdownFile;
        $this->demoPartial = $config->demoPartial;
        $this->view = $config->view;
        $this->hasDemo = $config->hasDemo;
        $this->package = $config->package;
        $this->description = $config->description;
        $this->keywords = $config->keywords;
    }

    /**
     * Get the full path to the markdown documentation file.
     */
    public function getMarkdownPath(DocsRegistry $registry): ?string
    {
        if ($this->markdownFile === null) {
            return null;
        }

        $packagePath = $registry->getPackagePath($this->package);

        if ($packagePath === null) {
            return null;
        }

        return $packagePath.'/'.$this->markdownFile;
    }

    /**
     * Get the view name for this section.
     */
    public function getViewName(): string
    {
        if ($this->view !== null) {
            return $this->view;
        }

        // Default view naming convention
        return $this->package === 'accelade'
            ? "accelade::docs.sections.{$this->slug}"
            : "{$this->package}::docs.sections.{$this->slug}";
    }

    /**
     * Get the demo partial view name.
     */
    public function getDemoPartial(): ?string
    {
        if (! $this->hasDemo) {
            return null;
        }

        if ($this->demoPartial !== null) {
            return $this->demoPartial;
        }

        // Default demo partial naming convention
        $partialSlug = str_replace('-', '-', $this->slug);

        return $this->package === 'accelade'
            ? "accelade::demo.partials._{$partialSlug}-component"
            : "{$this->package}::demo.partials._{$partialSlug}";
    }

    /**
     * Convert to array for JSON serialization.
     *
     * @return array<string, mixed>
     */
    public function toArray(): array
    {
        return [
            'slug' => $this->slug,
            'label' => $this->label,
            'markdownFile' => $this->markdownFile,
            'demoPartial' => $this->demoPartial,
            'view' => $this->view,
            'hasDemo' => $this->hasDemo,
            'package' => $this->package,
            'description' => $this->description,
            'keywords' => $this->keywords,
        ];
    }
}
</file>

<file path="src/Docs/DocSectionBuilder.php">
<?php

declare(strict_types=1);

namespace Accelade\Docs;

/**
 * Fluent builder for creating and registering documentation sections.
 */
class DocSectionBuilder
{
    protected string $slug;

    protected ?string $label = null;

    protected ?string $markdownFile = null;

    protected ?string $demoPartial = null;

    protected ?string $view = null;

    protected bool $hasDemo = false;

    protected string $package = 'accelade';

    protected ?string $description = null;

    /** @var array<int, string> */
    protected array $keywords = [];

    protected ?string $group = null;

    public function __construct(
        protected DocsRegistry $registry,
        string $slug,
    ) {
        $this->slug = $slug;
        $this->label = ucwords(str_replace('-', ' ', $slug));
    }

    /**
     * Set the display label.
     */
    public function label(string $label): self
    {
        $this->label = $label;

        return $this;
    }

    /**
     * Set the markdown documentation file (relative to package docs path).
     */
    public function markdown(string $file): self
    {
        $this->markdownFile = $file;

        return $this;
    }

    /**
     * Set the demo partial view name.
     */
    public function demo(?string $partial = null): self
    {
        $this->hasDemo = true;
        $this->demoPartial = $partial;

        return $this;
    }

    /**
     * Set the view name for the section.
     */
    public function view(string $view): self
    {
        $this->view = $view;

        return $this;
    }

    /**
     * Set the package this section belongs to.
     */
    public function package(string $package): self
    {
        $this->package = $package;

        return $this;
    }

    /**
     * Set the description for search.
     */
    public function description(string $description): self
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Set keywords for search.
     *
     * @param  array<int, string>  $keywords
     */
    public function keywords(array $keywords): self
    {
        $this->keywords = $keywords;

        return $this;
    }

    /**
     * Add this section to a navigation group.
     */
    public function inGroup(string $group): self
    {
        $this->group = $group;

        return $this;
    }

    /**
     * Build and register the section.
     */
    public function register(): DocsRegistry
    {
        $config = new DocSectionConfig([
            'markdownFile' => $this->markdownFile,
            'demoPartial' => $this->demoPartial,
            'view' => $this->view,
            'hasDemo' => $this->hasDemo,
            'package' => $this->package,
            'description' => $this->description,
            'keywords' => $this->keywords,
        ]);

        $section = new DocSection(
            slug: $this->slug,
            label: $this->label ?? ucwords(str_replace('-', ' ', $this->slug)),
            config: $config,
        );

        $this->registry->registerSection($section);

        if ($this->group !== null) {
            $this->registry->addToGroup($this->group, $this->slug);
        }

        return $this->registry;
    }
}
</file>

<file path="src/Docs/DocSectionConfig.php">
<?php

declare(strict_types=1);

namespace Accelade\Docs;

/**
 * Configuration object for DocSection optional parameters.
 */
readonly class DocSectionConfig
{
    public ?string $markdownFile;

    public ?string $demoPartial;

    public ?string $view;

    public bool $hasDemo;

    public string $package;

    public ?string $description;

    /** @var array<int, string> */
    public array $keywords;

    /**
     * @param  array<string, mixed>  $options
     */
    public function __construct(array $options = [])
    {
        $this->markdownFile = $options['markdownFile'] ?? null;
        $this->demoPartial = $options['demoPartial'] ?? null;
        $this->view = $options['view'] ?? null;
        $this->hasDemo = $options['hasDemo'] ?? false;
        $this->package = $options['package'] ?? 'accelade';
        $this->description = $options['description'] ?? null;
        $this->keywords = $options['keywords'] ?? [];
    }
}
</file>

<file path="src/Docs/DocsRegistry.php">
<?php

declare(strict_types=1);

namespace Accelade\Docs;

/**
 * Registry for documentation sections from Accelade ecosystem packages.
 *
 * Allows packages to register their documentation sections, demos,
 * and navigation items to be displayed in the unified docs portal.
 */
class DocsRegistry
{
    /**
     * Registered documentation sections.
     *
     * @var array<string, DocSection>
     */
    protected array $sections = [];

    /**
     * Sidebar navigation groups.
     *
     * @var array<string, array{label: string, icon: string, priority: int, sections: array<string>}>
     */
    protected array $groups = [];

    /**
     * Package base paths for documentation files.
     *
     * @var array<string, string>
     */
    protected array $packagePaths = [];

    /**
     * Framework prefixes for demo components.
     *
     * @var array<string, string>
     */
    protected array $frameworkPrefixes = [
        'vanilla' => 'a',
        'vue' => 'v',
        'react' => 'data-state',
        'svelte' => 's',
        'angular' => 'ng',
    ];

    /**
     * Register a package's documentation base path.
     */
    public function registerPackage(string $package, string $docsPath): self
    {
        $this->packagePaths[$package] = rtrim($docsPath, '/');

        return $this;
    }

    /**
     * Register a documentation section.
     */
    public function registerSection(DocSection $section): self
    {
        $this->sections[$section->slug] = $section;

        return $this;
    }

    /**
     * Register multiple sections at once.
     *
     * @param  array<int, DocSection>  $sections
     */
    public function registerSections(array $sections): self
    {
        foreach ($sections as $section) {
            $this->registerSection($section);
        }

        return $this;
    }

    /**
     * Register a navigation group.
     */
    public function registerGroup(string $key, string $label, string $icon = '', int $priority = 50): self
    {
        $this->groups[$key] = [
            'label' => $label,
            'icon' => $icon,
            'priority' => $priority,
            'sections' => [],
        ];

        return $this;
    }

    /**
     * Add a section to a navigation group.
     */
    public function addToGroup(string $groupKey, string $sectionSlug): self
    {
        if (isset($this->groups[$groupKey])) {
            $this->groups[$groupKey]['sections'][] = $sectionSlug;
        }

        return $this;
    }

    /**
     * Fluent API to register a section with all options.
     */
    public function section(string $slug): DocSectionBuilder
    {
        return new DocSectionBuilder($this, $slug);
    }

    /**
     * Get a section by slug.
     */
    public function getSection(string $slug): ?DocSection
    {
        return $this->sections[$slug] ?? null;
    }

    /**
     * Check if a section exists.
     */
    public function hasSection(string $slug): bool
    {
        return isset($this->sections[$slug]);
    }

    /**
     * Get all registered sections.
     *
     * @return array<string, DocSection>
     */
    public function getAllSections(): array
    {
        return $this->sections;
    }

    /**
     * Get sections that have demos.
     *
     * @return array<string>
     */
    public function getSectionsWithDemo(): array
    {
        return array_keys(array_filter(
            $this->sections,
            fn (DocSection $section) => $section->hasDemo
        ));
    }

    /**
     * Get navigation groups sorted by priority.
     *
     * @return array<string, array{label: string, icon: string, priority: int, sections: array<string>}>
     */
    public function getGroups(): array
    {
        $groups = $this->groups;

        uasort($groups, fn ($a, $b) => $a['priority'] <=> $b['priority']);

        return $groups;
    }

    /**
     * Get navigation structure for sidebar.
     *
     * @return array<int, array{key: string, label: string, icon: string, items: array<int, array{slug: string, label: string, hasDemo: bool}>}>
     */
    public function getNavigation(): array
    {
        $navigation = [];

        foreach ($this->getGroups() as $key => $group) {
            $items = [];

            foreach ($group['sections'] as $slug) {
                if (isset($this->sections[$slug])) {
                    $section = $this->sections[$slug];
                    $items[] = [
                        'slug' => $section->slug,
                        'label' => $section->label,
                        'hasDemo' => $section->hasDemo,
                    ];
                }
            }

            if (count($items) > 0) {
                $navigation[] = [
                    'key' => $key,
                    'label' => $group['label'],
                    'icon' => $group['icon'],
                    'items' => $items,
                ];
            }
        }

        return $navigation;
    }

    /**
     * Get framework prefixes.
     *
     * @return array<string, string>
     */
    public function getFrameworkPrefixes(): array
    {
        return $this->frameworkPrefixes;
    }

    /**
     * Get prefix for a framework.
     */
    public function getFrameworkPrefix(string $framework): string
    {
        return $this->frameworkPrefixes[$framework] ?? 'a';
    }

    /**
     * Check if framework is valid.
     */
    public function isValidFramework(string $framework): bool
    {
        return isset($this->frameworkPrefixes[$framework]);
    }

    /**
     * Get package documentation path.
     */
    public function getPackagePath(string $package): ?string
    {
        return $this->packagePaths[$package] ?? null;
    }

    /**
     * Get all package paths.
     *
     * @return array<string, string>
     */
    public function getPackagePaths(): array
    {
        return $this->packagePaths;
    }
}
</file>

<file path="src/Facades/Animation.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Accelade\Animation\AnimationPreset;
use Illuminate\Support\Facades\Facade;

/**
 * @method static \Accelade\Animation\AnimationManager new(string $name, string $enter, string $enterFrom, string $enterTo, string $leave, string $leaveFrom, string $leaveTo)
 * @method static AnimationPreset|null get(string $name)
 * @method static bool has(string $name)
 * @method static array<string, AnimationPreset> all()
 * @method static array<string, array<string, string>> toArray()
 *
 * @see \Accelade\Animation\AnimationManager
 */
class Animation extends Facade
{
    protected static function getFacadeAccessor(): string
    {
        return 'accelade.animation';
    }
}
</file>

<file path="src/Facades/Bridge.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Illuminate\Support\Facades\Facade;

/**
 * @method static void register(string $bridgeId, string $componentClass, array $props)
 * @method static array|null get(string $bridgeId)
 * @method static bool has(string $bridgeId)
 * @method static string createPayload(string $bridgeId, string $componentClass, array $props)
 * @method static array|null decodePayload(string $encrypted)
 * @method static \Illuminate\View\Component|null createInstance(array $payload)
 * @method static array all()
 * @method static void clear()
 *
 * @see \Accelade\Bridge\BridgeManager
 */
class Bridge extends Facade
{
    protected static function getFacadeAccessor(): string
    {
        return 'accelade.bridge';
    }
}
</file>

<file path="src/Facades/Docs.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Accelade\Docs\DocSection;
use Accelade\Docs\DocSectionBuilder;
use Accelade\Docs\DocsRegistry;
use Illuminate\Support\Facades\Facade;

/**
 * Facade for the Accelade documentation registry.
 *
 * @method static DocsRegistry registerPackage(string $package, string $docsPath)
 * @method static DocsRegistry registerSection(DocSection $section)
 * @method static DocsRegistry registerSections(array $sections)
 * @method static DocsRegistry registerGroup(string $key, string $label, string $icon = '', int $priority = 50)
 * @method static DocsRegistry addToGroup(string $groupKey, string $sectionSlug)
 * @method static DocSectionBuilder section(string $slug)
 * @method static DocSection|null getSection(string $slug)
 * @method static bool hasSection(string $slug)
 * @method static array getAllSections()
 * @method static array getSectionsWithDemo()
 * @method static array getGroups()
 * @method static array getNavigation()
 * @method static array getFrameworkPrefixes()
 * @method static string getFrameworkPrefix(string $framework)
 * @method static bool isValidFramework(string $framework)
 *
 * @see \Accelade\Docs\DocsRegistry
 */
class Docs extends Facade
{
    protected static function getFacadeAccessor(): string
    {
        return 'accelade.docs';
    }
}
</file>

<file path="src/Facades/Notify.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Accelade\Notification\Notification;
use Illuminate\Support\Facades\Facade;

/**
 * @method static Notification title(string $title)
 * @method static Notification success(string $title)
 * @method static Notification info(string $title)
 * @method static Notification warning(string $title)
 * @method static Notification danger(string $title)
 * @method static void push(Notification $notification)
 * @method static \Illuminate\Support\Collection all()
 * @method static \Illuminate\Support\Collection flush()
 * @method static void setDefault(\Closure $callback)
 *
 * @see \Accelade\Notification\NotificationManager
 */
class Notify extends Facade
{
    protected static function getFacadeAccessor(): string
    {
        return 'accelade.notify';
    }
}
</file>

<file path="src/Facades/SEO.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Illuminate\Support\Facades\Facade;

/**
 * SEO Facade for managing page metadata.
 *
 * @method static \Accelade\SEO\SEO title(?string $title) Set the page title
 * @method static string|null getTitle() Get the page title
 * @method static \Accelade\SEO\SEO description(?string $description) Set the page description
 * @method static string|null getDescription() Get the page description
 * @method static \Accelade\SEO\SEO keywords(string|array $keywords) Set page keywords
 * @method static array getKeywords() Get page keywords
 * @method static \Accelade\SEO\SEO canonical(?string $url) Set the canonical URL
 * @method static string|null getCanonical() Get the canonical URL
 * @method static \Accelade\SEO\SEO robots(?string $robots) Set robots meta tag
 * @method static string|null getRobots() Get robots meta tag
 * @method static \Accelade\SEO\SEO author(?string $author) Set author meta tag
 * @method static string|null getAuthor() Get author meta tag
 * @method static \Accelade\SEO\SEO openGraphType(?string $type) Set OpenGraph type
 * @method static \Accelade\SEO\SEO openGraphSiteName(?string $siteName) Set OpenGraph site name
 * @method static \Accelade\SEO\SEO openGraphTitle(?string $title) Set OpenGraph title
 * @method static \Accelade\SEO\SEO openGraphDescription(?string $description) Set OpenGraph description
 * @method static \Accelade\SEO\SEO openGraphUrl(?string $url) Set OpenGraph URL
 * @method static \Accelade\SEO\SEO openGraphImage(?string $image, ?string $alt = null) Set OpenGraph image
 * @method static \Accelade\SEO\SEO openGraphLocale(?string $locale) Set OpenGraph locale
 * @method static array getOpenGraph() Get all OpenGraph values
 * @method static \Accelade\SEO\SEO twitterCard(?string $card) Set Twitter card type
 * @method static \Accelade\SEO\SEO twitterSite(?string $site) Set Twitter site handle
 * @method static \Accelade\SEO\SEO twitterCreator(?string $creator) Set Twitter creator handle
 * @method static \Accelade\SEO\SEO twitterTitle(?string $title) Set Twitter title
 * @method static \Accelade\SEO\SEO twitterDescription(?string $description) Set Twitter description
 * @method static \Accelade\SEO\SEO twitterImage(?string $image, ?string $alt = null) Set Twitter image
 * @method static array getTwitter() Get all Twitter card values
 * @method static \Accelade\SEO\SEO metaByName(string $name, string $content) Add a meta tag by name
 * @method static \Accelade\SEO\SEO metaByProperty(string $property, string $content) Add a meta tag by property
 * @method static \Accelade\SEO\SEO meta(array $attributes) Add a custom meta tag
 * @method static array getMeta() Get all custom meta tags
 * @method static \Accelade\SEO\SEO reset() Reset all SEO values to defaults
 * @method static string|null buildTitle() Build the full title with separator and suffix
 * @method static string|null buildDescription() Get effective description
 * @method static array buildKeywords() Get effective keywords
 * @method static string|null buildCanonical() Get effective canonical URL
 * @method static array toArray() Convert SEO data to array
 * @method static string toHtml() Generate HTML meta tags
 * @method static string render() Render SEO tags as HTML string
 *
 * @see \Accelade\SEO\SEO
 */
class SEO extends Facade
{
    /**
     * Get the registered name of the component.
     */
    protected static function getFacadeAccessor(): string
    {
        return 'accelade.seo';
    }
}
</file>

<file path="src/Http/Controllers/AcceladeController.php">
<?php

declare(strict_types=1);

namespace Accelade\Http\Controllers;

use Accelade\Support\HybridReactivity;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Http\Response;
use Illuminate\Routing\Controller;

class AcceladeController extends Controller
{
    /**
     * Serve the Accelade JavaScript file.
     */
    public function script(): Response
    {
        $framework = config('accelade.framework', 'vanilla');

        // Try framework-specific first, then fall back to vanilla
        $path = __DIR__."/../../../dist/accelade-{$framework}.js";

        if (! file_exists($path)) {
            $path = __DIR__.'/../../../dist/accelade-vanilla.js';
        }

        if (! file_exists($path)) {
            $content = "console.error('Accelade: No JS file found');";

            return response($content, 200, [
                'Content-Type' => 'application/javascript',
            ]);
        }

        return response(file_get_contents($path), 200, [
            'Content-Type' => 'application/javascript',
            'Cache-Control' => 'no-cache, no-store, must-revalidate',
        ]);
    }

    /**
     * Handle a single state update from the client.
     */
    public function update(Request $request): JsonResponse
    {
        $validated = $request->validate([
            'component' => 'required|string',
            'property' => 'required|string',
            'value' => 'nullable',
        ]);

        $reactivity = new HybridReactivity($validated['component']);
        $reactivity->set($validated['property'], $validated['value']);

        return response()->json([
            'success' => true,
            'component' => $validated['component'],
            'property' => $validated['property'],
            'value' => $reactivity->get($validated['property']),
        ]);
    }

    /**
     * Handle batch state updates from the client.
     */
    public function batchUpdate(Request $request): JsonResponse
    {
        $validated = $request->validate([
            'component' => 'required|string',
            'updates' => 'required|array',
            'updates.*.property' => 'required|string',
            'updates.*.value' => 'nullable',
        ]);

        $reactivity = new HybridReactivity($validated['component']);
        $results = [];

        foreach ($validated['updates'] as $update) {
            $reactivity->set($update['property'], $update['value']);
            $results[$update['property']] = $reactivity->get($update['property']);
        }

        return response()->json([
            'success' => true,
            'component' => $validated['component'],
            'state' => $results,
        ]);
    }
}
</file>

<file path="src/Http/Controllers/BridgeController.php">
<?php

declare(strict_types=1);

namespace Accelade\Http\Controllers;

use Accelade\Bridge\BridgeManager;
use Accelade\Bridge\BridgeResponse;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Routing\Controller;

/**
 * Handles bridge component AJAX requests.
 *
 * Endpoints:
 * - POST /accelade/bridge/call - Call a component method
 * - POST /accelade/bridge/sync - Sync property changes
 */
class BridgeController extends Controller
{
    public function __construct(
        protected BridgeManager $manager
    ) {}

    /**
     * Call a method on a bridge component.
     */
    public function call(Request $request): JsonResponse
    {
        $validated = $request->validate([
            'state' => ['required', 'string'],
            'method' => ['required', 'string'],
            'args' => ['array'],
        ]);

        // Decode the state payload
        $payload = $this->manager->decodePayload($validated['state']);

        if (! $payload) {
            return response()->json(
                BridgeResponse::error('Invalid bridge state.')->toArray(),
                400
            );
        }

        // Create the component instance
        $component = $this->manager->createInstance($payload);

        if (! $component) {
            return response()->json(
                BridgeResponse::error('Failed to create component instance.')->toArray(),
                400
            );
        }

        // Call the method using BridgeManager
        $method = $validated['method'];
        $args = $validated['args'] ?? [];

        $response = $this->manager->callMethod($component, $method, $args);

        // Get updated props
        $props = $this->manager->getProps($component);

        // Update the state payload with new props
        $newPayload = $this->manager->createPayload(
            $payload['id'],
            $payload['class'],
            $props
        );

        $result = $response->toArray();
        $result['state'] = $newPayload;
        $result['props'] = $props;

        return response()->json($result);
    }

    /**
     * Sync property changes from the frontend.
     */
    public function sync(Request $request): JsonResponse
    {
        $validated = $request->validate([
            'state' => ['required', 'string'],
            'props' => ['required', 'array'],
        ]);

        // Decode the state payload
        $payload = $this->manager->decodePayload($validated['state']);

        if (! $payload) {
            return response()->json(
                BridgeResponse::error('Invalid bridge state.')->toArray(),
                400
            );
        }

        // Create the component instance
        $component = $this->manager->createInstance($payload);

        if (! $component) {
            return response()->json(
                BridgeResponse::error('Failed to create component instance.')->toArray(),
                400
            );
        }

        // Update the properties using BridgeManager
        $this->manager->updateProps($component, $validated['props']);

        // Get updated props
        $props = $this->manager->getProps($component);

        // Create new state payload
        $newPayload = $this->manager->createPayload(
            $payload['id'],
            $payload['class'],
            $props
        );

        return response()->json([
            'success' => true,
            'props' => $props,
            'state' => $newPayload,
        ]);
    }
}
</file>

<file path="src/Http/Controllers/NotifyDemoController.php">
<?php

declare(strict_types=1);

namespace Accelade\Http\Controllers;

use Accelade\Notification\Notification;
use Illuminate\Http\RedirectResponse;
use Illuminate\Http\Request;
use Illuminate\Routing\Controller;

class NotifyDemoController extends Controller
{
    public function show(Request $request, string $type): RedirectResponse
    {
        $manager = app('accelade.notify');

        match ($type) {
            'success' => $manager->success('Saved Successfully!')
                ->body('Your changes have been saved to the database.'),

            'info' => $manager->info('Did you know?')
                ->body('You can customize notifications with CSS variables.'),

            'warning' => $manager->warning('Please Review')
                ->body('Some fields may need your attention before proceeding.'),

            'danger' => $manager->danger('Action Failed')
                ->body('Unable to complete the request. Please try again.'),

            'persistent' => Notification::make()
                ->title('Important Notice')
                ->body('This notification will stay until you dismiss it.')
                ->info()
                ->persistent()
                ->send(),

            'actions' => Notification::make()
                ->title('New Message')
                ->body('You have received a new message from John.')
                ->info()
                ->actions([
                    ['name' => 'view', 'label' => 'View Message', 'url' => '#'],
                    ['name' => 'dismiss', 'label' => 'Dismiss', 'close' => true],
                ])
                ->send(),

            'custom' => Notification::make()
                ->title('Custom Styled')
                ->body('This uses custom icon and colors.')
                ->status('success')
                ->icon('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/></svg>')
                ->seconds(8)
                ->send(),

            default => $manager->info('Unknown Type')
                ->body("Type '{$type}' is not recognized."),
        };

        return redirect()->back();
    }
}
</file>

<file path="src/Notification/Notification.php">
<?php

declare(strict_types=1);

namespace Accelade\Notification;

use JsonSerializable;

/**
 * Notification with Filament-compatible fluent API.
 */
class Notification implements JsonSerializable
{
    public string $id;

    public string $title = '';

    public string $body = '';

    public string $status = 'success';

    public string $icon = '';

    public string $iconColor = '';

    public string $color = '';

    public string $position = 'top-right';

    public int $duration = 5000;

    public bool $persistent = false;

    public array $actions = [];

    public function __construct(?string $title = null)
    {
        $this->id = uniqid('notif-');
        if ($title !== null) {
            $this->title = $title;
        }
    }

    public static function make(?string $title = null): self
    {
        return new self($title);
    }

    public function title(string $title): self
    {
        $this->title = $title;

        return $this;
    }

    public function body(string $body): self
    {
        $this->body = $body;

        return $this;
    }

    /** @deprecated Use body() instead */
    public function message(string $message): self
    {
        return $this->body($message);
    }

    public function icon(string $icon): self
    {
        $this->icon = $icon;

        return $this;
    }

    public function iconColor(string $color): self
    {
        $this->iconColor = $color;

        return $this;
    }

    public function color(string $color): self
    {
        $this->color = $color;

        return $this;
    }

    public function status(string $status): self
    {
        $this->status = $status;

        return $this;
    }

    public function success(): self
    {
        $this->status = 'success';

        return $this;
    }

    public function info(): self
    {
        $this->status = 'info';

        return $this;
    }

    public function warning(): self
    {
        $this->status = 'warning';

        return $this;
    }

    public function danger(): self
    {
        $this->status = 'danger';

        return $this;
    }

    public function position(string $position): self
    {
        $this->position = $position;

        return $this;
    }

    public function duration(int $milliseconds): self
    {
        $this->duration = $milliseconds;
        $this->persistent = false;

        return $this;
    }

    public function seconds(int $seconds): self
    {
        return $this->duration($seconds * 1000);
    }

    /** @deprecated Use seconds() instead */
    public function autoDismiss(int $seconds): self
    {
        return $this->seconds($seconds);
    }

    public function persistent(): self
    {
        $this->persistent = true;
        $this->duration = 0;

        return $this;
    }

    public function actions(array $actions): self
    {
        $this->actions = $actions;

        return $this;
    }

    public function getId(): string
    {
        return $this->id;
    }

    public function send(): self
    {
        app('accelade.notify')->push($this);

        return $this;
    }

    public function jsonSerialize(): array
    {
        return [
            'id' => $this->id,
            'title' => $this->title,
            'body' => $this->body,
            'status' => $this->status,
            'icon' => $this->icon,
            'iconColor' => $this->iconColor,
            'color' => $this->color,
            'position' => $this->position,
            'duration' => $this->persistent ? 0 : $this->duration,
            'persistent' => $this->persistent,
            'actions' => $this->actions,
        ];
    }
}
</file>

<file path="src/Notification/NotificationManager.php">
<?php

declare(strict_types=1);

namespace Accelade\Notification;

use Closure;
use Illuminate\Session\Store as SessionStore;
use Illuminate\Support\Collection;

/**
 * Manages notifications with session persistence.
 */
class NotificationManager
{
    protected const SESSION_KEY = 'accelade.notifications';

    protected Collection $notifications;

    protected ?SessionStore $session = null;

    protected ?Closure $defaultCallback = null;

    protected string $defaultPosition = 'top-right';

    protected int $defaultDuration = 5000;

    public function __construct()
    {
        $this->notifications = collect();
    }

    public function setSession(SessionStore $session): void
    {
        $this->session = $session;
        $this->loadFromSession();
    }

    public function setDefault(Closure $callback): void
    {
        $this->defaultCallback = $callback;
    }

    public function defaultPosition(string $position): self
    {
        $this->defaultPosition = $position;

        return $this;
    }

    public function defaultDuration(int $milliseconds): self
    {
        $this->defaultDuration = $milliseconds;

        return $this;
    }

    public function make(): Notification
    {
        $notification = Notification::make();
        $notification->position = $this->defaultPosition;
        $notification->duration = $this->defaultDuration;

        if ($this->defaultCallback) {
            ($this->defaultCallback)($notification);
        }

        return $notification;
    }

    public function title(string $title): Notification
    {
        return $this->make()->title($title);
    }

    public function success(string $title): Notification
    {
        $notification = $this->title($title)->success();
        $this->push($notification);

        return $notification;
    }

    public function info(string $title): Notification
    {
        $notification = $this->title($title)->info();
        $this->push($notification);

        return $notification;
    }

    public function warning(string $title): Notification
    {
        $notification = $this->title($title)->warning();
        $this->push($notification);

        return $notification;
    }

    public function danger(string $title): Notification
    {
        $notification = $this->title($title)->danger();
        $this->push($notification);

        return $notification;
    }

    public function push(Notification $notification): void
    {
        $this->notifications->push($notification);
        $this->saveToSession();
    }

    public function all(): Collection
    {
        return $this->notifications;
    }

    public function flush(): Collection
    {
        $notifications = $this->notifications;
        $this->notifications = collect();
        $this->saveToSession();

        return $notifications;
    }

    public function close(string $id): void
    {
        $this->notifications = $this->notifications->reject(
            fn (Notification $n) => $n->getId() === $id
        );
        $this->saveToSession();
    }

    public function toArray(): array
    {
        return $this->notifications->toArray();
    }

    protected function loadFromSession(): void
    {
        if ($this->session?->has(self::SESSION_KEY)) {
            $data = $this->session->get(self::SESSION_KEY, []);
            $this->notifications = collect($data)->map(
                fn ($d) => $this->hydrate($d)
            );
        }
    }

    protected function saveToSession(): void
    {
        $this->session?->put(
            self::SESSION_KEY,
            $this->notifications->map(fn ($n) => $n->jsonSerialize())->toArray()
        );
    }

    protected function hydrate(array $data): Notification
    {
        $n = new Notification($data['title'] ?? '');
        $n->id = $data['id'] ?? uniqid('notif-');
        $n->body = $data['body'] ?? $data['message'] ?? '';
        $n->status = $data['status'] ?? $data['type'] ?? 'success';
        $n->icon = $data['icon'] ?? '';
        $n->iconColor = $data['iconColor'] ?? '';
        $n->color = $data['color'] ?? '';
        $n->position = $data['position'] ?? $this->defaultPosition;
        $n->duration = $data['duration'] ?? $this->defaultDuration;
        $n->persistent = $data['persistent'] ?? false;
        $n->actions = $data['actions'] ?? [];

        return $n;
    }
}
</file>

<file path="src/Support/HybridReactivity.php">
<?php

declare(strict_types=1);

namespace Accelade\Support;

use Illuminate\Support\Facades\Cache;

class HybridReactivity
{
    protected string $componentId;

    protected array $state = [];

    protected array $syncedProperties = [];

    public function __construct(string $componentId)
    {
        $this->componentId = $componentId;
        $this->loadState();
    }

    /**
     * Load state from cache.
     */
    public function loadState(): void
    {
        $this->state = Cache::get($this->getCacheKey(), []);
    }

    /**
     * Save state to cache.
     */
    public function saveState(): void
    {
        Cache::put(
            $this->getCacheKey(),
            $this->state,
            config('accelade.state_ttl', 3600)
        );
    }

    /**
     * Set a state property.
     */
    public function set(string $key, mixed $value): void
    {
        $this->state[$key] = $value;
        $this->saveState();
    }

    /**
     * Get a state property.
     */
    public function get(string $key, mixed $default = null): mixed
    {
        return $this->state[$key] ?? $default;
    }

    /**
     * Get all state.
     */
    public function all(): array
    {
        return $this->state;
    }

    /**
     * Check if a property exists.
     */
    public function has(string $key): bool
    {
        return array_key_exists($key, $this->state);
    }

    /**
     * Remove a property from state.
     */
    public function forget(string $key): void
    {
        unset($this->state[$key]);
        $this->saveState();
    }

    /**
     * Clear all state for this component.
     */
    public function clear(): void
    {
        $this->state = [];
        Cache::forget($this->getCacheKey());
    }

    /**
     * Get the cache key for this component.
     */
    protected function getCacheKey(): string
    {
        return "accelade.state.{$this->componentId}";
    }

    /**
     * Enable sync for a property.
     */
    public function enableSync(string $property): void
    {
        if (! in_array($property, $this->syncedProperties, true)) {
            $this->syncedProperties[] = $property;
        }
    }

    /**
     * Check if a property is synced.
     */
    public function isSynced(string $property): bool
    {
        return in_array($property, $this->syncedProperties, true);
    }
}
</file>

<file path="src/Support/SharedData.php">
<?php

declare(strict_types=1);

namespace Accelade\Support;

use Closure;
use Illuminate\Contracts\Support\Arrayable;
use Illuminate\Contracts\Support\Jsonable;
use JsonSerializable;

class SharedData implements Arrayable, Jsonable, JsonSerializable
{
    /**
     * The shared data store.
     *
     * @var array<string, mixed>
     */
    protected array $data = [];

    /**
     * Lazy-loaded shared data (closures).
     *
     * @var array<string, Closure>
     */
    protected array $lazy = [];

    /**
     * Share data globally across the application.
     *
     * @param  array<string, mixed>|string  $key
     */
    public function share(array|string $key, mixed $value = null): self
    {
        if (is_array($key)) {
            foreach ($key as $k => $v) {
                $this->share($k, $v);
            }

            return $this;
        }

        if ($value instanceof Closure) {
            $this->lazy[$key] = $value;
        } else {
            $this->data[$key] = $value;
        }

        return $this;
    }

    /**
     * Get a shared value by key.
     */
    public function get(string $key, mixed $default = null): mixed
    {
        if (array_key_exists($key, $this->data)) {
            return $this->data[$key];
        }

        if (array_key_exists($key, $this->lazy)) {
            $this->data[$key] = ($this->lazy[$key])();
            unset($this->lazy[$key]);

            return $this->data[$key];
        }

        return $default;
    }

    /**
     * Check if a shared key exists.
     */
    public function has(string $key): bool
    {
        return array_key_exists($key, $this->data) || array_key_exists($key, $this->lazy);
    }

    /**
     * Remove a shared key.
     */
    public function forget(string $key): self
    {
        unset($this->data[$key], $this->lazy[$key]);

        return $this;
    }

    /**
     * Clear all shared data.
     */
    public function flush(): self
    {
        $this->data = [];
        $this->lazy = [];

        return $this;
    }

    /**
     * Get all shared data as an array.
     *
     * @return array<string, mixed>
     */
    public function all(): array
    {
        // Resolve all lazy values
        foreach ($this->lazy as $key => $closure) {
            $this->data[$key] = $closure();
        }
        $this->lazy = [];

        return $this->data;
    }

    /**
     * Convert to array.
     *
     * @return array<string, mixed>
     */
    public function toArray(): array
    {
        return $this->all();
    }

    /**
     * Convert to JSON.
     */
    public function toJson($options = 0): string
    {
        return json_encode($this->jsonSerialize(), $options | JSON_THROW_ON_ERROR);
    }

    /**
     * Prepare for JSON serialization.
     *
     * @return array<string, mixed>
     */
    public function jsonSerialize(): array
    {
        return $this->all();
    }

    /**
     * Merge additional data into shared data.
     *
     * @param  array<string, mixed>  $data
     */
    public function merge(array $data): self
    {
        foreach ($data as $key => $value) {
            $this->share($key, $value);
        }

        return $this;
    }

    /**
     * Get the count of shared items.
     */
    public function count(): int
    {
        return count($this->data) + count($this->lazy);
    }

    /**
     * Check if shared data is empty.
     */
    public function isEmpty(): bool
    {
        return $this->count() === 0;
    }

    /**
     * Check if shared data is not empty.
     */
    public function isNotEmpty(): bool
    {
        return ! $this->isEmpty();
    }
}
</file>

<file path="tests/e2e/accelade-demo.spec.ts">
import { test, expect } from '@playwright/test';

/**
 * Accelade Demo E2E Tests
 *
 * Tests all Accelade features across all supported frameworks.
 * Uses baseURL from playwright.config.ts (configurable via ACCELADE_TEST_URL env var)
 */

const FRAMEWORKS = ['vanilla', 'vue', 'react', 'svelte', 'angular'] as const;
type Framework = typeof FRAMEWORKS[number];

// Demo route prefix (matches config default)
const DEMO_PREFIX = '/demo';

// All frameworks now support reactive state
const REACTIVE_FRAMEWORKS: Framework[] = ['vanilla', 'vue', 'react', 'svelte', 'angular'];

test.describe('Accelade Demo Tests', () => {
    for (const framework of FRAMEWORKS) {
        test.describe(`${framework.charAt(0).toUpperCase() + framework.slice(1)} Framework`, () => {

            test('page loads correctly', async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);

                // Check page title
                await expect(page).toHaveTitle(/Accelade Demo/);

                // Check framework badge
                const badge = page.locator('.inline-flex.items-center span.text-sm');
                await expect(badge).toBeVisible();

                // Check Accelade is loaded
                const acceladeLoaded = await page.evaluate(() => {
                    return typeof window.Accelade !== 'undefined';
                });
                expect(acceladeLoaded).toBe(true);
            });

            test('counter component works', async ({ page }) => {
                // Skip non-reactive frameworks until adapters are fixed
                test.skip(!REACTIVE_FRAMEWORKS.includes(framework), `${framework} adapter needs reactivity fixes`);

                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find counter section
                const counterSection = page.locator('section').filter({ hasText: 'Counter Component' }).first();
                await expect(counterSection).toBeVisible();

                // Get initial count
                const countDisplay = counterSection.locator('.text-4xl');
                const initialCount = await countDisplay.textContent();
                expect(initialCount?.trim()).toBe('0');

                // Click increment button
                const incrementBtn = counterSection.locator('button', { hasText: '+' });
                await incrementBtn.click();
                await page.waitForTimeout(100);

                // Verify count increased (use regex to handle whitespace)
                await expect(countDisplay).toHaveText(/^\s*1\s*$/);

                // Click decrement button
                const decrementBtn = counterSection.locator('button', { hasText: '-' });
                await decrementBtn.click();
                await page.waitForTimeout(100);

                // Verify count decreased
                await expect(countDisplay).toHaveText(/^\s*0\s*$/);
            });

            test('counter with server sync displays correctly', async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find sync counter section
                const syncSection = page.locator('section').filter({ hasText: 'Counter with Server Sync' }).first();
                await expect(syncSection).toBeVisible();

                // Check initial count is 10
                const countDisplay = syncSection.locator('.text-4xl');
                await expect(countDisplay).toHaveText('10');
            });

            test('custom script functions work', async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find custom script section
                const scriptSection = page.locator('section').filter({ hasText: 'Custom Script Functions' }).first();
                await expect(scriptSection).toBeVisible();

                // Get initial count
                const countDisplay = scriptSection.locator('.text-4xl');
                await expect(countDisplay).toHaveText('0');

                // Click +5 button
                const addFiveBtn = scriptSection.locator('button', { hasText: '+5' });
                await addFiveBtn.click();
                await page.waitForTimeout(100);

                // Verify count is 5
                await expect(countDisplay).toHaveText('5');

                // Click Double button
                const doubleBtn = scriptSection.locator('button', { hasText: 'Double' });
                await doubleBtn.click();
                await page.waitForTimeout(100);

                // Verify count is 10
                await expect(countDisplay).toHaveText('10');

                // Click Reset button
                const resetBtn = scriptSection.locator('button', { hasText: 'Reset' });
                await resetBtn.click();
                await page.waitForTimeout(100);

                // Verify count is 0
                await expect(countDisplay).toHaveText('0');
            });

            test('progress bar manual controls work', async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find progress bar section
                const progressSection = page.locator('section').filter({ hasText: 'Progress Bar Demo' }).first();
                await expect(progressSection).toBeVisible();

                // Scroll to progress section first
                await progressSection.scrollIntoViewIfNeeded();

                // Click Start Progress button
                const startBtn = progressSection.locator('button', { hasText: 'Start Progress' });
                await startBtn.click();

                // Wait for progress bar to appear (transition takes 200ms)
                await page.waitForTimeout(300);

                // Check progress bar is visible via JS (avoids timing issues)
                const isVisible = await page.evaluate(() => {
                    const el = document.getElementById('accelade-progress');
                    if (!el) return false;
                    const opacity = parseFloat(getComputedStyle(el).opacity);
                    return opacity > 0.5;
                });
                expect(isVisible).toBe(true);

                // Complete progress bar directly via JS (more reliable than clicking)
                await page.evaluate(() => {
                    window.Accelade?.progress?.done();
                });

                // Wait for completion animation (200ms speed + 200ms fade + extra buffer)
                await page.waitForTimeout(800);

                // Progress bar should be hidden
                const isHidden = await page.evaluate(() => {
                    const el = document.getElementById('accelade-progress');
                    if (!el) return true;
                    const opacity = parseFloat(getComputedStyle(el).opacity);
                    return opacity < 0.5;
                });
                expect(isHidden).toBe(true);
            });

            test('SPA navigation within same framework works', async ({ page }) => {
                // Skip non-reactive frameworks until adapters are fixed
                test.skip(!REACTIVE_FRAMEWORKS.includes(framework), `${framework} adapter needs reactivity fixes`);

                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find SPA navigation section
                const spaSection = page.locator('section').filter({ hasText: 'SPA Navigation' }).first();
                await expect(spaSection).toBeVisible();

                // Modify counter first to verify state change
                const counterSection = page.locator('section').filter({ hasText: 'Counter Component' }).first();
                const incrementBtn = counterSection.locator('button', { hasText: '+' });
                await incrementBtn.click();
                await page.waitForTimeout(100);
                await incrementBtn.click();
                await page.waitForTimeout(100);

                // Verify counter is at 2 (use regex to handle whitespace)
                const countDisplay = counterSection.locator('.text-4xl');
                await expect(countDisplay).toHaveText(/^\s*2\s*$/);

                // Click SPA reload link
                const spaReloadLink = spaSection.locator('a', { hasText: 'Reload This Page (SPA)' });
                await spaReloadLink.click();

                // Wait for SPA navigation
                await page.waitForTimeout(500);

                // Counter should reset to 0 (state not preserved)
                const newCountDisplay = page.locator('section').filter({ hasText: 'Counter Component' }).first().locator('.text-4xl');
                await expect(newCountDisplay).toHaveText(/^\s*0\s*$/);

                // Page should still be on same framework
                await expect(page).toHaveURL(new RegExp(`${DEMO_PREFIX}/${framework}`));
            });

            test('framework tabs show all options', async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Check all framework tabs exist
                const nav = page.locator('nav').first();

                await expect(nav.locator('a', { hasText: 'Vanilla' })).toBeVisible();
                await expect(nav.locator('a', { hasText: 'Vue' })).toBeVisible();
                await expect(nav.locator('a', { hasText: 'React' })).toBeVisible();
                await expect(nav.locator('a', { hasText: 'Svelte' })).toBeVisible();
                await expect(nav.locator('a', { hasText: 'Angular' })).toBeVisible();
            });
        });
    }

    test.describe('Cross-Framework Navigation', () => {
        test('switching frameworks does full page reload', async ({ page }) => {
            // Start on vanilla
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Click Vue tab
            const vueTab = page.locator('nav a', { hasText: 'Vue' });
            await vueTab.click();

            // Should navigate to Vue demo
            await page.waitForURL(/\/demo\/vue/);

            // Check Vue framework badge
            const badge = page.locator('.inline-flex.items-center span.text-sm');
            await expect(badge).toContainText('Vue');
        });
    });

    test.describe('Window API', () => {
        test('Accelade global is available', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Check that Accelade is on window
            const result = await page.evaluate(() => {
                return {
                    hasAccelade: typeof window.Accelade !== 'undefined',
                    hasInit: typeof window.Accelade?.init === 'function',
                    hasNavigate: typeof window.Accelade?.navigate === 'function',
                    hasProgress: typeof window.Accelade?.progress !== 'undefined',
                    hasRouter: typeof window.Accelade?.router !== 'undefined',
                };
            });

            expect(result.hasAccelade).toBe(true);
            expect(result.hasInit).toBe(true);
            expect(result.hasNavigate).toBe(true);
            expect(result.hasProgress).toBe(true);
            expect(result.hasRouter).toBe(true);
        });

        test('Progress bar API works', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Test progress API
            const result = await page.evaluate(() => {
                const hasStart = typeof window.Accelade?.progress?.start === 'function';
                const hasDone = typeof window.Accelade?.progress?.done === 'function';
                const hasConfigure = typeof window.Accelade?.progress?.configure === 'function';

                // Start progress
                window.Accelade?.progress?.start();

                return { hasStart, hasDone, hasConfigure };
            });

            expect(result.hasStart).toBe(true);
            expect(result.hasDone).toBe(true);
            expect(result.hasConfigure).toBe(true);

            // Verify progress element was created
            await page.waitForTimeout(100);
            const progressExists = await page.evaluate(() => {
                return document.getElementById('accelade-progress') !== null;
            });
            expect(progressExists).toBe(true);
        });
    });

    test.describe('Notifications', () => {
        for (const framework of FRAMEWORKS) {
            test(`${framework}: success notification displays`, async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Find notification section
                const notifySection = page.locator('section').filter({ hasText: 'Notifications' }).first();
                await notifySection.scrollIntoViewIfNeeded();

                // Click success button
                const successBtn = notifySection.locator('[data-testid="notify-success"]');
                await successBtn.click();

                // Wait for notification to appear
                await page.waitForTimeout(100);

                // Check notification is visible
                const notification = page.locator('.accelade-notif-success');
                await expect(notification).toBeVisible();
                await expect(notification).toContainText('Success!');
            });

            test(`${framework}: info notification displays`, async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                // Click info button
                const infoBtn = page.locator('[data-testid="notify-info"]');
                await infoBtn.click();

                await page.waitForTimeout(100);

                const notification = page.locator('.accelade-notif-info');
                await expect(notification).toBeVisible();
                await expect(notification).toContainText('Info');
            });

            test(`${framework}: warning notification displays`, async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                const warningBtn = page.locator('[data-testid="notify-warning"]');
                await warningBtn.click();

                await page.waitForTimeout(100);

                const notification = page.locator('.accelade-notif-warning');
                await expect(notification).toBeVisible();
                await expect(notification).toContainText('Warning');
            });

            test(`${framework}: danger notification displays`, async ({ page }) => {
                await page.goto(`${DEMO_PREFIX}/${framework}`);
                await page.waitForLoadState('networkidle');

                const dangerBtn = page.locator('[data-testid="notify-danger"]');
                await dangerBtn.click();

                await page.waitForTimeout(100);

                const notification = page.locator('.accelade-notif-danger');
                await expect(notification).toBeVisible();
                await expect(notification).toContainText('Error');
            });
        }

        test('notification can be dismissed', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Show notification
            const successBtn = page.locator('[data-testid="notify-success"]');
            await successBtn.click();
            await page.waitForTimeout(100);

            // Find and click dismiss button
            const notification = page.locator('.accelade-notif-success');
            await expect(notification).toBeVisible();

            const closeBtn = notification.locator('.accelade-notif-close');
            await closeBtn.click();

            // Wait for dismiss animation
            await page.waitForTimeout(400);

            // Notification should be removed
            await expect(notification).not.toBeVisible();
        });

        test('notification auto-dismisses after duration', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Show notification with 3s duration via custom position button
            await page.evaluate(() => {
                window.Accelade?.notify?.show({
                    id: 'test-auto-dismiss',
                    title: 'Auto Dismiss Test',
                    message: 'This should auto-dismiss',
                    type: 'info',
                    position: 'top-right',
                    duration: 1000, // 1 second
                    dismissible: true
                });
            });

            await page.waitForTimeout(100);

            // Should be visible initially
            const notification = page.locator('#test-auto-dismiss');
            await expect(notification).toBeVisible();

            // Wait for auto-dismiss (1s + 300ms animation)
            await page.waitForTimeout(1500);

            // Should be gone
            await expect(notification).not.toBeVisible();
        });

        test('notify API is available on window', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            const result = await page.evaluate(() => {
                return {
                    hasNotify: typeof window.Accelade?.notify !== 'undefined',
                    hasSuccess: typeof window.Accelade?.notify?.success === 'function',
                    hasInfo: typeof window.Accelade?.notify?.info === 'function',
                    hasWarning: typeof window.Accelade?.notify?.warning === 'function',
                    hasDanger: typeof window.Accelade?.notify?.danger === 'function',
                    hasShow: typeof window.Accelade?.notify?.show === 'function',
                    hasDismiss: typeof window.Accelade?.notify?.dismiss === 'function',
                };
            });

            expect(result.hasNotify).toBe(true);
            expect(result.hasSuccess).toBe(true);
            expect(result.hasInfo).toBe(true);
            expect(result.hasWarning).toBe(true);
            expect(result.hasDanger).toBe(true);
            expect(result.hasShow).toBe(true);
            expect(result.hasDismiss).toBe(true);
        });

        test('notification positions work correctly', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/vanilla`);
            await page.waitForLoadState('networkidle');

            // Test top-right (default)
            await page.evaluate(() => {
                window.Accelade?.notify?.show({
                    id: 'pos-test-1',
                    title: 'Top Right',
                    message: '',
                    type: 'info',
                    position: 'top-right',
                    duration: 5000,
                    dismissible: true
                });
            });

            await page.waitForTimeout(100);

            // Check container has correct class
            const container = page.locator('#accelade-notifications-top-right');
            await expect(container).toBeVisible();
            await expect(container).toHaveClass(/accelade-notifications-top-right/);
        });
    });
});

// TypeScript declarations for window.Accelade
declare global {
    interface Window {
        Accelade?: {
            init: () => void;
            navigate: (url: string) => void;
            progress?: {
                start: () => void;
                done: () => void;
                configure: (config: unknown) => void;
            };
            router?: unknown;
            notify?: {
                success: (title: string, message?: string) => void;
                info: (title: string, message?: string) => void;
                warning: (title: string, message?: string) => void;
                danger: (title: string, message?: string) => void;
                show: (data: {
                    id: string;
                    title: string;
                    message: string;
                    type: string;
                    position: string;
                    duration: number;
                    dismissible: boolean;
                }) => void;
                dismiss: (id: string) => void;
            };
        };
    }
}
</file>

<file path="tests/e2e/shared-data.spec.ts">
import { test, expect } from '@playwright/test';

/**
 * Shared Data E2E Tests
 *
 * Tests the shared data feature that allows passing data from Laravel backend
 * to JavaScript frontend, making it available globally via window.Accelade.shared
 */

const DEMO_PREFIX = '/demo';

test.describe('Shared Data Feature', () => {
    test.describe('Shared Data Demo Page', () => {
        test('page loads with shared data', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Check page loaded
            await expect(page).toHaveTitle(/Accelade Demo/);

            // Check Accelade is loaded
            const acceladeLoaded = await page.evaluate(() => {
                return typeof window.Accelade !== 'undefined';
            });
            expect(acceladeLoaded).toBe(true);
        });

        test('shared data is available on window.Accelade.shared', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Check shared API exists
            const result = await page.evaluate(() => {
                return {
                    hasShared: typeof window.Accelade?.shared !== 'undefined',
                    hasGet: typeof window.Accelade?.shared?.get === 'function',
                    hasHas: typeof window.Accelade?.shared?.has === 'function',
                    hasAll: typeof window.Accelade?.shared?.all === 'function',
                    hasSet: typeof window.Accelade?.shared?.set === 'function',
                    hasSubscribe: typeof window.Accelade?.shared?.subscribe === 'function',
                    hasSubscribeAll: typeof window.Accelade?.shared?.subscribeAll === 'function',
                };
            });

            expect(result.hasShared).toBe(true);
            expect(result.hasGet).toBe(true);
            expect(result.hasHas).toBe(true);
            expect(result.hasAll).toBe(true);
            expect(result.hasSet).toBe(true);
            expect(result.hasSubscribe).toBe(true);
            expect(result.hasSubscribeAll).toBe(true);
        });

        test('can get shared app name', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Click button to get app name
            const getAppNameBtn = page.locator('[data-testid="get-app-name"]');
            await getAppNameBtn.click();

            await page.waitForTimeout(100);

            // Check result displays
            const result = page.locator('#shared-value-result');
            await expect(result).toContainText('appName');
        });

        test('can get nested shared data using dot notation', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Click button to get user name (nested)
            const getUserNameBtn = page.locator('[data-testid="get-user-name"]');
            await getUserNameBtn.click();

            await page.waitForTimeout(100);

            // Check result displays the user name
            const result = page.locator('#shared-value-result');
            await expect(result).toContainText('user.name');
            await expect(result).toContainText('John Doe');
        });

        test('can get theme setting from nested shared data', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Click button to get theme
            const getThemeBtn = page.locator('[data-testid="get-theme"]');
            await getThemeBtn.click();

            await page.waitForTimeout(100);

            // Check result displays the theme
            const result = page.locator('#shared-value-result');
            await expect(result).toContainText('settings.theme');
            await expect(result).toContainText('dark');
        });

        test('can toggle theme (modify shared data)', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Get initial theme
            const themeDisplay = page.locator('#theme-display');
            await expect(themeDisplay).toContainText('dark');

            // Click toggle theme button
            const toggleBtn = page.locator('[data-testid="toggle-theme"]');
            await toggleBtn.click();

            await page.waitForTimeout(100);

            // Theme should now be light
            await expect(themeDisplay).toContainText('light');

            // Toggle again
            await toggleBtn.click();
            await page.waitForTimeout(100);

            // Theme should be dark again
            await expect(themeDisplay).toContainText('dark');
        });

        test('can update app name and subscription is notified', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Type new app name
            const input = page.locator('[data-testid="new-app-name-input"]');
            await input.fill('New App Name');

            // Click update button
            const updateBtn = page.locator('[data-testid="update-app-name"]');
            await updateBtn.click();

            await page.waitForTimeout(100);

            // Check app name display updated
            const appNameDisplay = page.locator('#app-name-display');
            await expect(appNameDisplay).toContainText('New App Name');

            // Check change log shows the update
            const changeLog = page.locator('#change-log');
            await expect(changeLog).toContainText('appName');
            await expect(changeLog).toContainText('New App Name');
        });

        test('shared data displays all values from backend', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Check the shared data display shows all expected keys
            const sharedDataDisplay = page.locator('#shared-data-display');
            await expect(sharedDataDisplay).toContainText('appName');
            await expect(sharedDataDisplay).toContainText('currentTime');
            await expect(sharedDataDisplay).toContainText('user');
            await expect(sharedDataDisplay).toContainText('settings');
        });

        test('displays user name from shared data', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Check user name display
            const userNameDisplay = page.locator('#user-name-display');
            await expect(userNameDisplay).toContainText('John Doe');
        });
    });

    test.describe('Shared Data API', () => {
        test('shared.get returns correct values', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            const result = await page.evaluate(() => {
                return {
                    appName: window.Accelade?.shared?.get('appName'),
                    userName: window.Accelade?.shared?.get('user.name'),
                    theme: window.Accelade?.shared?.get('settings.theme'),
                    missing: window.Accelade?.shared?.get('nonexistent', 'default'),
                };
            });

            expect(result.appName).toBeDefined();
            expect(result.userName).toBe('John Doe');
            expect(result.theme).toBe('dark');
            expect(result.missing).toBe('default');
        });

        test('shared.has returns correct boolean', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            const result = await page.evaluate(() => {
                return {
                    hasAppName: window.Accelade?.shared?.has('appName'),
                    hasUser: window.Accelade?.shared?.has('user'),
                    hasMissing: window.Accelade?.shared?.has('nonexistent'),
                };
            });

            expect(result.hasAppName).toBe(true);
            expect(result.hasUser).toBe(true);
            expect(result.hasMissing).toBe(false);
        });

        test('shared.all returns all shared data', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            const result = await page.evaluate(() => {
                return window.Accelade?.shared?.all();
            });

            expect(result).toHaveProperty('appName');
            expect(result).toHaveProperty('user');
            expect(result).toHaveProperty('settings');
            expect(result).toHaveProperty('currentTime');
        });

        test('shared.set updates values', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            await page.evaluate(() => {
                window.Accelade?.shared?.set('testKey', 'testValue');
            });

            const result = await page.evaluate(() => {
                return window.Accelade?.shared?.get('testKey');
            });

            expect(result).toBe('testValue');
        });

        test('shared.subscribe is called on value change', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Set up subscription and track calls
            const result = await page.evaluate(() => {
                return new Promise<{ key: string; newValue: unknown; oldValue: unknown }>((resolve) => {
                    window.Accelade?.shared?.subscribe('testSubscribe', (key, newValue, oldValue) => {
                        resolve({ key, newValue, oldValue });
                    });

                    // Trigger the change
                    window.Accelade?.shared?.set('testSubscribe', 'newValue');
                });
            });

            expect(result.key).toBe('testSubscribe');
            expect(result.newValue).toBe('newValue');
        });

        test('shared.subscribeAll is called on any change', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            const result = await page.evaluate(() => {
                return new Promise<{ key: string; newValue: unknown }>((resolve) => {
                    window.Accelade?.shared?.subscribeAll((key, newValue) => {
                        if (key === 'globalTestKey') {
                            resolve({ key, newValue });
                        }
                    });

                    // Trigger the change
                    window.Accelade?.shared?.set('globalTestKey', 'globalValue');
                });
            });

            expect(result.key).toBe('globalTestKey');
            expect(result.newValue).toBe('globalValue');
        });
    });

    test.describe('SPA Navigation with Shared Data', () => {
        test('shared data persists across SPA navigation', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Modify shared data
            await page.evaluate(() => {
                window.Accelade?.shared?.set('persistTest', 'beforeNavigation');
            });

            // Navigate to vanilla demo via SPA link
            const vanillaLink = page.locator('a', { hasText: 'Vanilla Demo' }).first();
            await vanillaLink.click();

            // Wait for navigation
            await page.waitForURL(/\/demo\/vanilla/);
            await page.waitForLoadState('networkidle');

            // Check shared data still exists
            // Note: Due to page reload, server-set shared data will be available
            // but client-set data may be reset depending on navigation type
            const hasShared = await page.evaluate(() => {
                return typeof window.Accelade?.shared !== 'undefined';
            });

            expect(hasShared).toBe(true);
        });
    });

    test.describe('Text Interpolation', () => {
        test('displays component state using {{ }} syntax', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Check that text interpolation rendered the greeting
            const textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('Hello');
            expect(textContent).toContain('World');
        });

        test('updates interpolated text when state changes', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Get initial count value (should be 0)
            const initialText = await page.textContent('.accelade-ready');
            expect(initialText).toContain('0 times');

            // Click the increment button
            const incrementBtn = page.locator('[data-testid="increment-btn"]');
            await incrementBtn.click();

            // Wait for update
            await page.waitForTimeout(100);

            // Check count is now 1
            const updatedText = await page.textContent('.accelade-ready');
            expect(updatedText).toContain('1 times');
        });

        test('displays shared data in interpolated text', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Check that shared data is interpolated
            const textContent = await page.textContent('.accelade-ready');

            // Should show app name from shared data
            expect(textContent).toContain('Accelade Demo');

            // Should show user name from shared data
            expect(textContent).toContain('John Doe');

            // Should show theme from shared data
            expect(textContent).toContain('dark');
        });

        test('updates interpolated shared data when changed', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Verify initial shared data display
            let textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('dark');

            // Update theme in shared data
            await page.evaluate(() => {
                window.Accelade?.shared?.set('settings.theme', 'light');
            });

            // Wait for update
            await page.waitForTimeout(100);

            // Check that interpolated text updated
            textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('light');
        });

        test('toggles greeting via button click', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Check initial greeting
            let textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('Hello');

            // Click toggle greeting button
            const toggleBtn = page.locator('button', { hasText: 'Toggle Greeting' });
            await toggleBtn.click();

            // Wait for update
            await page.waitForTimeout(100);

            // Check greeting changed
            textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('Welcome');
        });

        test('toggles name via button click', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            // Check initial name
            let textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('World');

            // Click toggle name button
            const toggleBtn = page.locator('button', { hasText: 'Toggle Name' });
            await toggleBtn.click();

            // Wait for update
            await page.waitForTimeout(100);

            // Check name changed
            textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('Accelade');
        });

        test('increments count multiple times', async ({ page }) => {
            await page.goto(`${DEMO_PREFIX}/shared-data`);
            await page.waitForLoadState('networkidle');

            // Wait for Accelade to initialize
            await page.waitForTimeout(200);

            const incrementBtn = page.locator('[data-testid="increment-btn"]');

            // Click multiple times
            for (let i = 1; i <= 5; i++) {
                await incrementBtn.click();
                await page.waitForTimeout(50);
            }

            // Check count is 5
            const textContent = await page.textContent('.accelade-ready');
            expect(textContent).toContain('5 times');
        });
    });
});

// TypeScript declarations for window.Accelade.shared
declare global {
    interface Window {
        Accelade?: {
            shared?: {
                get: <T = unknown>(key: string, defaultValue?: T) => T;
                has: (key: string) => boolean;
                all: () => Record<string, unknown>;
                set: (key: string, value: unknown) => void;
                merge: (data: Record<string, unknown>) => void;
                subscribe: (key: string, callback: (key: string, newValue: unknown, oldValue: unknown) => void) => () => void;
                subscribeAll: (callback: (key: string, newValue: unknown, oldValue: unknown) => void) => () => void;
                instance: () => unknown;
            };
            [key: string]: unknown;
        };
    }
}
</file>

<file path="tests/Feature/ContentComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Blade;

beforeEach(function () {
    // Set up the view path for testing
    $this->app['config']->set('view.paths', [
        __DIR__.'/../../resources/views',
    ]);
});

it('renders basic html content', function () {
    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => '<p>Hello World</p>',
    ]);

    expect($html)->toContain('<p>Hello World</p>');
    expect($html)->toContain('<div');
    expect($html)->toContain('</div>');
});

it('uses div as default wrapper element', function () {
    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => '<span>Content</span>',
    ]);

    expect($html)->toContain('<div');
    expect($html)->toContain('</div>');
});

it('can use custom wrapper element with as attribute', function () {
    $html = Blade::render('<x-accelade::content as="article" :html="$html" />', [
        'html' => '<p>Article content</p>',
    ]);

    expect($html)->toContain('<article');
    expect($html)->toContain('</article>');
    expect($html)->not->toContain('<div');
});

it('can use section as wrapper element', function () {
    $html = Blade::render('<x-accelade::content as="section" :html="$html" />', [
        'html' => '<h2>Section Title</h2>',
    ]);

    expect($html)->toContain('<section');
    expect($html)->toContain('</section>');
});

it('can use span as wrapper element', function () {
    $html = Blade::render('<x-accelade::content as="span" :html="$html" />', [
        'html' => 'Inline content',
    ]);

    expect($html)->toContain('<span');
    expect($html)->toContain('</span>');
});

it('falls back to div for invalid tag names', function () {
    $html = Blade::render('<x-accelade::content as="script" :html="$html" />', [
        'html' => '<p>Safe content</p>',
    ]);

    expect($html)->toContain('<div');
    expect($html)->not->toContain('<script');
});

it('passes additional attributes to wrapper element', function () {
    $html = Blade::render('<x-accelade::content class="prose dark:prose-invert" id="content" :html="$html" />', [
        'html' => '<p>Styled content</p>',
    ]);

    expect($html)->toContain('class="prose dark:prose-invert"');
    expect($html)->toContain('id="content"');
});

it('renders markdown-converted html', function () {
    // Simulating pre-rendered Markdown
    $markdownHtml = '<h1>Title</h1><p>This is a <strong>bold</strong> paragraph.</p><ul><li>Item 1</li><li>Item 2</li></ul>';

    $html = Blade::render('<x-accelade::content as="article" class="prose" :html="$html" />', [
        'html' => $markdownHtml,
    ]);

    expect($html)->toContain('<article');
    expect($html)->toContain('class="prose"');
    expect($html)->toContain('<h1>Title</h1>');
    expect($html)->toContain('<strong>bold</strong>');
    expect($html)->toContain('<ul>');
    expect($html)->toContain('<li>Item 1</li>');
});

it('renders empty content when html is empty', function () {
    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => '',
    ]);

    expect($html)->toContain('<div');
    expect($html)->toContain('</div>');
    // Should be essentially empty between tags
    expect(trim(strip_tags($html)))->toBe('');
});

it('preserves html entities', function () {
    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => '<p>&copy; 2024 &mdash; All rights reserved</p>',
    ]);

    expect($html)->toContain('&copy;');
    expect($html)->toContain('&mdash;');
});

it('renders code blocks correctly', function () {
    $codeHtml = '<pre><code class="language-php">&lt;?php echo "Hello"; ?&gt;</code></pre>';

    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => $codeHtml,
    ]);

    expect($html)->toContain('<pre>');
    expect($html)->toContain('<code class="language-php">');
    expect($html)->toContain('&lt;?php');
});

it('can use blockquote as wrapper', function () {
    $html = Blade::render('<x-accelade::content as="blockquote" class="border-l-4 pl-4" :html="$html" />', [
        'html' => 'A wise quote',
    ]);

    expect($html)->toContain('<blockquote');
    expect($html)->toContain('class="border-l-4 pl-4"');
    expect($html)->toContain('A wise quote');
});

it('can use figure as wrapper', function () {
    $html = Blade::render('<x-accelade::content as="figure" :html="$html" />', [
        'html' => '<img src="/image.jpg" alt="Image"><figcaption>Caption</figcaption>',
    ]);

    expect($html)->toContain('<figure');
    expect($html)->toContain('</figure>');
    expect($html)->toContain('<img src="/image.jpg"');
});

it('supports data attributes', function () {
    $html = Blade::render('<x-accelade::content data-testid="content-block" data-section="main" :html="$html" />', [
        'html' => '<p>Test content</p>',
    ]);

    expect($html)->toContain('data-testid="content-block"');
    expect($html)->toContain('data-section="main"');
});

it('renders complex nested html', function () {
    $complexHtml = '
        <div class="card">
            <div class="card-header">
                <h3>Card Title</h3>
            </div>
            <div class="card-body">
                <p>Card content with <a href="#">link</a></p>
            </div>
        </div>
    ';

    $html = Blade::render('<x-accelade::content :html="$html" />', [
        'html' => $complexHtml,
    ]);

    expect($html)->toContain('class="card"');
    expect($html)->toContain('class="card-header"');
    expect($html)->toContain('<h3>Card Title</h3>');
    expect($html)->toContain('<a href="#">link</a>');
});
</file>

<file path="tests/Feature/DataComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Collection;
use Illuminate\Support\Facades\Blade;

beforeEach(function () {
    // Set up the view path for testing
    $this->app['config']->set('view.paths', [
        __DIR__.'/../../resources/views',
    ]);
});

it('renders with default empty state', function () {
    $html = Blade::render('<x-accelade::data>Content</x-accelade::data>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-id');
    expect($html)->toContain('data-accelade-state="[]"');
    expect($html)->toContain('Content');
});

it('renders with initial data from array', function () {
    $html = Blade::render('<x-accelade::data :default="$data">Content</x-accelade::data>', [
        'data' => ['count' => 0, 'name' => 'John'],
    ]);

    expect($html)->toContain('data-accelade-state');
    // The state should be JSON encoded
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('count', 0);
    expect($decoded)->toHaveKey('name', 'John');
});

it('renders with initial data from collection', function () {
    $collection = new Collection(['count' => 5, 'active' => true]);

    $html = Blade::render('<x-accelade::data :default="$data">Content</x-accelade::data>', [
        'data' => $collection,
    ]);

    expect($html)->toContain('data-accelade-state');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('count', 5);
    expect($decoded)->toHaveKey('active', true);
});

it('renders with javascript object notation string', function () {
    $html = Blade::render('<x-accelade::data :default="$data">Content</x-accelade::data>', [
        'data' => '{ count: 0, items: [] }',
    ]);

    expect($html)->toContain('data-accelade-state-js');
    expect($html)->toContain('{ count: 0, items: [] }');
});

it('sets remember attribute for session storage', function () {
    $html = Blade::render('<x-accelade::data remember="my-form-data">Content</x-accelade::data>');

    expect($html)->toContain('data-accelade-remember="my-form-data"');
});

it('sets local-storage attribute for localStorage', function () {
    $html = Blade::render('<x-accelade::data local-storage="user-preferences">Content</x-accelade::data>');

    expect($html)->toContain('data-accelade-local-storage="user-preferences"');
});

it('sets store attribute for global stores', function () {
    $html = Blade::render('<x-accelade::data store="cart">Content</x-accelade::data>');

    expect($html)->toContain('data-accelade-store="cart"');
});

it('rejects reserved store names', function () {
    $reservedNames = ['data', 'form', 'toggle', 'state', 'store'];

    foreach ($reservedNames as $name) {
        $html = Blade::render('<x-accelade::data :store="$name">Content</x-accelade::data>', [
            'name' => $name,
        ]);

        expect($html)->not->toContain('data-accelade-store');
    }
});

it('allows non-reserved store names', function () {
    $html = Blade::render('<x-accelade::data store="myStore">Content</x-accelade::data>');

    expect($html)->toContain('data-accelade-store="myStore"');
});

it('generates unique IDs for each component', function () {
    $html1 = Blade::render('<x-accelade::data>Content 1</x-accelade::data>');
    $html2 = Blade::render('<x-accelade::data>Content 2</x-accelade::data>');

    preg_match('/data-accelade-id="([^"]*)"/', $html1, $matches1);
    preg_match('/data-accelade-id="([^"]*)"/', $html2, $matches2);

    expect($matches1[1])->not->toBe($matches2[1]);
});

it('passes additional attributes to wrapper element', function () {
    $html = Blade::render('<x-accelade::data class="my-class" id="my-component">Content</x-accelade::data>');

    expect($html)->toContain('class="my-class"');
    expect($html)->toContain('id="my-component"');
});

it('includes cloak attribute for hiding until ready', function () {
    $html = Blade::render('<x-accelade::data>Content</x-accelade::data>');

    expect($html)->toContain('data-accelade-cloak');
});

it('renders slot content correctly', function () {
    $html = Blade::render('
        <x-accelade::data :default="$data">
            <button>Click me</button>
            <span>Count: 0</span>
        </x-accelade::data>
    ', [
        'data' => ['count' => 0],
    ]);

    expect($html)->toContain('<button>Click me</button>');
    expect($html)->toContain('<span>Count: 0</span>');
});

it('can combine remember and default data', function () {
    $html = Blade::render('<x-accelade::data :default="$data" remember="form-data">Content</x-accelade::data>', [
        'data' => ['name' => '', 'email' => ''],
    ]);

    expect($html)->toContain('data-accelade-remember="form-data"');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('name');
    expect($decoded)->toHaveKey('email');
});

it('can combine localStorage and default data', function () {
    $html = Blade::render('<x-accelade::data :default="$data" local-storage="settings">Content</x-accelade::data>', [
        'data' => ['theme' => 'dark', 'language' => 'en'],
    ]);

    expect($html)->toContain('data-accelade-local-storage="settings"');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('theme', 'dark');
    expect($decoded)->toHaveKey('language', 'en');
});

it('can combine store and default data', function () {
    $html = Blade::render('<x-accelade::data :default="$data" store="cartStore">Content</x-accelade::data>', [
        'data' => ['items' => [], 'total' => 0],
    ]);

    expect($html)->toContain('data-accelade-store="cartStore"');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('items');
    expect($decoded)->toHaveKey('total', 0);
});

it('handles empty string for remember attribute', function () {
    $html = Blade::render('<x-accelade::data remember="">Content</x-accelade::data>');

    // Empty string should not set the attribute
    expect($html)->not->toContain('data-accelade-remember=""');
});

it('handles empty string for localStorage attribute', function () {
    $html = Blade::render('<x-accelade::data local-storage="">Content</x-accelade::data>');

    // Empty string should not set the attribute
    expect($html)->not->toContain('data-accelade-local-storage=""');
});

it('handles nested array data', function () {
    $html = Blade::render('<x-accelade::data :default="$data">Content</x-accelade::data>', [
        'data' => [
            'user' => [
                'name' => 'John',
                'email' => 'john@example.com',
            ],
            'preferences' => [
                'theme' => 'dark',
                'notifications' => true,
            ],
        ],
    ]);

    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);

    expect($decoded)->toHaveKey('user');
    expect($decoded['user'])->toHaveKey('name', 'John');
    expect($decoded)->toHaveKey('preferences');
    expect($decoded['preferences'])->toHaveKey('theme', 'dark');
});

it('renders with data attributes for styling', function () {
    $html = Blade::render('<x-accelade::data data-testid="test-component">Content</x-accelade::data>');

    expect($html)->toContain('data-testid="test-component"');
});
</file>

<file path="tests/Feature/DeferComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Blade;

beforeEach(function () {
    // Set up the view path for testing
    $this->app['config']->set('view.paths', [
        __DIR__.'/../../resources/views',
    ]);
});

it('renders with required url attribute', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-id');
    expect($html)->toContain('data-accelade-defer');
    expect($html)->toContain('data-defer-url="/api/data"');
    expect($html)->toContain('Content');
});

it('uses GET method by default', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-method="GET"');
});

it('can specify HTTP method', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" method="POST">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-method="POST"');
});

it('uppercases HTTP method', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" method="post">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-method="POST"');
});

it('uses application/json accept header by default', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-accept="application/json"');
});

it('can specify custom accept header', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" accept-header="text/html">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-accept="text/html"');
});

it('can specify request data as array', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" method="POST" :request="$data">Content</x-accelade::defer>', [
        'data' => ['name' => 'John', 'email' => 'john@example.com'],
    ]);

    expect($html)->toContain('data-defer-request');
    // Verify the JSON is present
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-defer-request="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('name', 'John');
    expect($decoded)->toHaveKey('email', 'john@example.com');
});

it('can specify custom headers', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" :headers="$headers">Content</x-accelade::defer>', [
        'headers' => ['Authorization' => 'Bearer token123', 'X-Custom' => 'value'],
    ]);

    expect($html)->toContain('data-defer-headers');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-defer-headers="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('Authorization', 'Bearer token123');
    expect($decoded)->toHaveKey('X-Custom', 'value');
});

it('can enable polling with interval', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" poll="5000">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-poll="5000"');
});

it('can be set to manual mode', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" :manual="true">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-manual="true"');
});

it('can watch a value for changes', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" watch-value="form.amount">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-watch="form.amount"');
});

it('can specify watch debounce time', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" watch-value="search" :watch-debounce="300">Content</x-accelade::defer>');

    expect($html)->toContain('data-defer-watch="search"');
    expect($html)->toContain('data-defer-watch-debounce="300"');
});

it('does not include debounce attribute when using default value', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" watch-value="search">Content</x-accelade::defer>');

    expect($html)->not->toContain('data-defer-watch-debounce');
});

it('includes cloak attribute for hiding until ready', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    expect($html)->toContain('data-accelade-cloak');
});

it('generates unique IDs for each component', function () {
    $html1 = Blade::render('<x-accelade::defer url="/api/data1">Content 1</x-accelade::defer>');
    $html2 = Blade::render('<x-accelade::defer url="/api/data2">Content 2</x-accelade::defer>');

    preg_match('/data-accelade-id="([^"]*)"/', $html1, $matches1);
    preg_match('/data-accelade-id="([^"]*)"/', $html2, $matches2);

    expect($matches1[1])->not->toBe($matches2[1]);
});

it('passes additional attributes to wrapper element', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" class="my-class" id="my-defer">Content</x-accelade::defer>');

    expect($html)->toContain('class="my-class"');
    expect($html)->toContain('id="my-defer"');
});

it('renders slot content correctly', function () {
    $html = Blade::render('
        <x-accelade::defer url="/api/quote">
            <p>Loading...</p>
            <button>Reload</button>
        </x-accelade::defer>
    ');

    expect($html)->toContain('<p>Loading...</p>');
    expect($html)->toContain('<button>Reload</button>');
});

it('includes initial state with processing response and error', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    expect($html)->toContain('data-accelade-state');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('processing');
    expect($decoded)->toHaveKey('response');
    expect($decoded)->toHaveKey('error');
});

it('sets processing to true when not manual', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data">Content</x-accelade::defer>');

    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded['processing'])->toBeTrue();
});

it('sets processing to false when manual', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" :manual="true">Content</x-accelade::defer>');

    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded['processing'])->toBeFalse();
});

it('supports all HTTP methods', function () {
    $methods = ['GET', 'POST', 'PUT', 'PATCH', 'DELETE'];

    foreach ($methods as $method) {
        $html = Blade::render('<x-accelade::defer url="/api/data" :method="$method">Content</x-accelade::defer>', [
            'method' => $method,
        ]);

        expect($html)->toContain("data-defer-method=\"{$method}\"");
    }
});

it('can combine multiple features', function () {
    $html = Blade::render('
        <x-accelade::defer
            url="/api/search"
            method="POST"
            :request="$data"
            :headers="$headers"
            poll="10000"
            watch-value="query"
            :watch-debounce="500"
            class="search-defer"
        >
            Content
        </x-accelade::defer>
    ', [
        'data' => ['q' => ''],
        'headers' => ['X-API-Key' => 'secret'],
    ]);

    expect($html)->toContain('data-defer-url="/api/search"');
    expect($html)->toContain('data-defer-method="POST"');
    expect($html)->toContain('data-defer-request');
    expect($html)->toContain('data-defer-headers');
    expect($html)->toContain('data-defer-poll="10000"');
    expect($html)->toContain('data-defer-watch="query"');
    expect($html)->toContain('data-defer-watch-debounce="500"');
    expect($html)->toContain('class="search-defer"');
});

it('handles collection as request data', function () {
    $html = Blade::render('<x-accelade::defer url="/api/data" method="POST" :request="$data">Content</x-accelade::defer>', [
        'data' => collect(['items' => [1, 2, 3]]),
    ]);

    expect($html)->toContain('data-defer-request');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-defer-request="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('items');
    expect($decoded['items'])->toBe([1, 2, 3]);
});
</file>

<file path="tests/Feature/ErrorsComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Blade;
use Illuminate\Support\MessageBag;
use Illuminate\Support\ViewErrorBag;

beforeEach(function () {
    // Set up the view path for testing
    $this->app['config']->set('view.paths', [
        __DIR__.'/../../resources/views',
    ]);
});

it('renders with no errors', function () {
    // Create empty error bag
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-id');
    expect($html)->toContain('data-accelade-errors');
    expect($html)->toContain('Content');
});

it('includes errors in state', function () {
    // Create error bag with errors
    $messageBag = new MessageBag([
        'name' => ['The name field is required.'],
        'email' => ['The email field is required.', 'The email must be valid.'],
    ]);
    $errors = new ViewErrorBag;
    $errors->put('default', $messageBag);
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    expect($html)->toContain('data-accelade-state');

    // Extract and verify state
    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state)->toHaveKey('errors');
    expect($state['errors'])->toHaveKey('name');
    expect($state['errors'])->toHaveKey('email');
    expect($state['errors']['name'])->toBe(['The name field is required.']);
    expect($state['errors']['email'])->toBe(['The email field is required.', 'The email must be valid.']);
});

it('generates unique IDs for each component', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html1 = Blade::render('<x-accelade::errors>Content 1</x-accelade::errors>');
    $html2 = Blade::render('<x-accelade::errors>Content 2</x-accelade::errors>');

    preg_match('/data-accelade-id="([^"]*)"/', $html1, $matches1);
    preg_match('/data-accelade-id="([^"]*)"/', $html2, $matches2);

    expect($matches1[1])->not->toBe($matches2[1]);
});

it('includes cloak attribute', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    expect($html)->toContain('data-accelade-cloak');
});

it('passes additional attributes to wrapper element', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors class="my-errors" id="form-errors">Content</x-accelade::errors>');

    expect($html)->toContain('class="my-errors"');
    expect($html)->toContain('id="form-errors"');
});

it('renders slot content correctly', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('
        <x-accelade::errors>
            <div class="error-container">
                <p>Error messages here</p>
            </div>
        </x-accelade::errors>
    ');

    expect($html)->toContain('<div class="error-container">');
    expect($html)->toContain('<p>Error messages here</p>');
});

it('includes script with error helper methods', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    expect($html)->toContain('accelade:script');
    expect($html)->toContain('errors');
    expect($html)->toContain('has(key)');
    expect($html)->toContain('first(key)');
});

it('supports custom error bag', function () {
    // Create custom error bag
    $defaultBag = new MessageBag(['name' => ['Default error']]);
    $customBag = new MessageBag(['title' => ['Custom bag error']]);

    $errors = new ViewErrorBag;
    $errors->put('default', $defaultBag);
    $errors->put('custom', $customBag);
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors bag="custom">Content</x-accelade::errors>');

    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state['errors'])->toHaveKey('title');
    expect($state['errors'])->not->toHaveKey('name');
    expect($state['errors']['title'])->toBe(['Custom bag error']);
});

it('handles empty error bag gracefully', function () {
    $errors = new ViewErrorBag;
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state['errors'])->toBe([]);
});

it('handles special characters in error messages', function () {
    $messageBag = new MessageBag([
        'field' => ['Error with "quotes" and <html> & special chars'],
    ]);
    $errors = new ViewErrorBag;
    $errors->put('default', $messageBag);
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    // Should be properly JSON encoded
    expect($html)->toContain('data-accelade-state');

    // Verify it can be decoded
    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state['errors']['field'][0])->toContain('quotes');
    expect($state['errors']['field'][0])->toContain('special chars');
});

it('handles nested field names', function () {
    $messageBag = new MessageBag([
        'user.name' => ['The user name is required.'],
        'user.email' => ['The user email is required.'],
        'items.0.name' => ['Item name is required.'],
    ]);
    $errors = new ViewErrorBag;
    $errors->put('default', $messageBag);
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state['errors'])->toHaveKey('user.name');
    expect($state['errors'])->toHaveKey('user.email');
    expect($state['errors'])->toHaveKey('items.0.name');
});

it('handles multiple errors per field', function () {
    $messageBag = new MessageBag([
        'password' => [
            'The password must be at least 8 characters.',
            'The password must contain a number.',
            'The password must contain a special character.',
        ],
    ]);
    $errors = new ViewErrorBag;
    $errors->put('default', $messageBag);
    view()->share('errors', $errors);

    $html = Blade::render('<x-accelade::errors>Content</x-accelade::errors>');

    preg_match('/data-accelade-state="([^"]*)"/', $html, $matches);
    $state = json_decode(html_entity_decode($matches[1]), true);

    expect($state['errors']['password'])->toHaveCount(3);
    expect($state['errors']['password'][0])->toContain('8 characters');
    expect($state['errors']['password'][1])->toContain('number');
    expect($state['errors']['password'][2])->toContain('special character');
});
</file>

<file path="tests/Feature/EventComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Blade;

beforeEach(function () {
    // Set up the view path for testing
    $this->app['config']->set('view.paths', [
        __DIR__.'/../../resources/views',
    ]);
});

it('renders with channel attribute', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content</x-accelade::event>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-id');
    expect($html)->toContain('data-accelade-echo');
    expect($html)->toContain('data-echo-channel="orders"');
    expect($html)->toContain('Content');
});

it('includes listen attribute', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated,OrderUpdated">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-listen="OrderCreated,OrderUpdated"');
});

it('defaults to public channel', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-private="false"');
    expect($html)->toContain('data-echo-presence="false"');
});

it('can specify private channel', function () {
    $html = Blade::render('<x-accelade::event channel="user.1" :private="true" listen="MessageReceived">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-private="true"');
    expect($html)->toContain('data-echo-presence="false"');
});

it('can specify presence channel', function () {
    $html = Blade::render('<x-accelade::event channel="chat.room.1" :presence="true" listen="UserJoined">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-presence="true"');
});

it('defaults preserve scroll to false', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-preserve-scroll="false"');
});

it('can enable preserve scroll', function () {
    $html = Blade::render('<x-accelade::event channel="dashboard" :preserve-scroll="true" listen="DataUpdated">Content</x-accelade::event>');

    expect($html)->toContain('data-echo-preserve-scroll="true"');
});

it('includes cloak attribute for hiding until ready', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content</x-accelade::event>');

    expect($html)->toContain('data-accelade-cloak');
});

it('generates unique IDs for each component', function () {
    $html1 = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content 1</x-accelade::event>');
    $html2 = Blade::render('<x-accelade::event channel="users" listen="UserCreated">Content 2</x-accelade::event>');

    preg_match('/data-accelade-id="([^"]*)"/', $html1, $matches1);
    preg_match('/data-accelade-id="([^"]*)"/', $html2, $matches2);

    expect($matches1[1])->not->toBe($matches2[1]);
});

it('passes additional attributes to wrapper element', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated" class="my-class" id="my-event">Content</x-accelade::event>');

    expect($html)->toContain('class="my-class"');
    expect($html)->toContain('id="my-event"');
});

it('renders slot content correctly', function () {
    $html = Blade::render('
        <x-accelade::event channel="orders" listen="OrderCreated">
            <p>Listening for events...</p>
            <span>Status indicator</span>
        </x-accelade::event>
    ');

    expect($html)->toContain('<p>Listening for events...</p>');
    expect($html)->toContain('<span>Status indicator</span>');
});

it('includes initial state with subscribed and events', function () {
    $html = Blade::render('<x-accelade::event channel="orders" listen="OrderCreated">Content</x-accelade::event>');

    expect($html)->toContain('data-accelade-state');
    $decoded = json_decode(html_entity_decode(
        preg_match('/data-accelade-state="([^"]*)"/', $html, $matches) ? $matches[1] : '{}'
    ), true);
    expect($decoded)->toHaveKey('subscribed');
    expect($decoded)->toHaveKey('events');
    expect($decoded['subscribed'])->toBeFalse();
    expect($decoded['events'])->toBe([]);
});

it('can combine multiple features', function () {
    $html = Blade::render('
        <x-accelade::event
            channel="user.123"
            :private="true"
            listen="MessageReceived,NotificationReceived"
            :preserve-scroll="true"
            class="event-listener"
        >
            Content
        </x-accelade::event>
    ');

    expect($html)->toContain('data-echo-channel="user.123"');
    expect($html)->toContain('data-echo-private="true"');
    expect($html)->toContain('data-echo-listen="MessageReceived,NotificationReceived"');
    expect($html)->toContain('data-echo-preserve-scroll="true"');
    expect($html)->toContain('class="event-listener"');
});

it('renders without channel attribute', function () {
    $html = Blade::render('<x-accelade::event listen="GlobalEvent">Content</x-accelade::event>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-echo');
    expect($html)->not->toContain('data-echo-channel=""');
});

it('renders without listen attribute', function () {
    $html = Blade::render('<x-accelade::event channel="orders">Content</x-accelade::event>');

    expect($html)->toContain('data-accelade');
    expect($html)->toContain('data-accelade-echo');
    expect($html)->not->toContain('data-echo-listen=""');
});
</file>

<file path="tests/Feature/FlashComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

beforeEach(function () {
    config(['accelade.flash.enabled' => true]);
});

function makeFlashView(array $props = []): string
{
    $defaults = [
        'shared' => true,
        'slot' => new HtmlString(''),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/flash.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders flash component', function () {
    $html = makeFlashView();

    expect($html)
        ->toContain('data-accelade')
        ->toContain('data-accelade-flash');
});

it('includes flash data from session in state', function () {
    session()->flash('success', 'Test message');

    $html = makeFlashView();

    expect($html)
        ->toContain('data-flash-data')
        ->toContain('Test message');
});

it('renders with multiple flash messages', function () {
    session()->flash('success', 'Success message');
    session()->flash('error', 'Error message');
    session()->flash('info', 'Info message');

    $html = makeFlashView();

    expect($html)
        ->toContain('Success message')
        ->toContain('Error message')
        ->toContain('Info message');
});

it('generates unique component id', function () {
    $view1 = makeFlashView();
    $view2 = makeFlashView();

    // Extract IDs
    preg_match('/data-accelade-id="([^"]+)"/', $view1, $matches1);
    preg_match('/data-accelade-id="([^"]+)"/', $view2, $matches2);

    expect($matches1[1])->not->toBe($matches2[1]);
});

it('includes cloak attribute for FOUC prevention', function () {
    $html = makeFlashView();

    expect($html)->toContain('data-accelade-cloak');
});

it('respects shared prop', function () {
    session()->flash('message', 'Test');

    $html = makeFlashView(['shared' => false]);

    expect($html)->toContain('data-flash-no-share');
});

it('handles empty flash data gracefully', function () {
    $html = makeFlashView();

    // Should still render with empty flash data
    expect($html)
        ->toContain('data-accelade-flash')
        ->toContain('data-flash-data');
});

it('includes slot content', function () {
    $html = makeFlashView([
        'slot' => new HtmlString('<div class="test-slot">Test Content</div>'),
    ]);

    expect($html)->toContain('Test Content');
});

it('passes additional attributes to wrapper', function () {
    $html = makeFlashView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'my-custom-class',
            'id' => 'my-flash',
        ]),
    ]);

    expect($html)
        ->toContain('class="my-custom-class"')
        ->toContain('id="my-flash"');
});

it('collects common flash keys from session', function () {
    // Set various common flash keys
    session()->put('message', 'Test message');
    session()->put('success', 'Success!');
    session()->put('warning', 'Warning!');
    session()->put('error', 'Error!');
    session()->put('info', 'Info!');
    session()->put('status', 'Status!');

    $html = makeFlashView();

    // Should collect common flash keys
    expect($html)
        ->toContain('Test message')
        ->toContain('Success!');
});
</file>

<file path="tests/Feature/LazyComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Blade;

test('lazy component renders wrapper with data attributes', function () {
    $html = Blade::render('<x-accelade::lazy>Content</x-accelade::lazy>');

    expect($html)->toContain('data-accelade-lazy');
    expect($html)->toContain('data-lazy-id="lazy-');
    expect($html)->toContain('data-lazy-show="true"');
    expect($html)->toContain('data-lazy-mode="inline"');
});

test('lazy component renders placeholder by default', function () {
    $html = Blade::render('<x-accelade::lazy>Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-placeholder');
    expect($html)->toContain('accelade-lazy-spinner');
});

test('lazy component renders shimmer when enabled', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true">Content</x-accelade::lazy>');

    expect($html)->toContain('accelade-shimmer-container');
    expect($html)->toContain('accelade-shimmer-line');
});

test('lazy component renders custom shimmer lines', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" :shimmer-lines="5">Content</x-accelade::lazy>');

    // Count shimmer line divs (class contains "accelade-shimmer-line" but short line also matches)
    // We count the opening divs with accelade-shimmer-line class
    preg_match_all('/<div class="accelade-shimmer-line/', $html, $matches);
    expect(count($matches[0]))->toBe(5);
});

test('lazy component renders shimmer with custom height', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" shimmer-height="200px">Content</x-accelade::lazy>');

    expect($html)->toContain('height: 200px');
});

test('lazy component renders shimmer with custom width', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" shimmer-width="50%">Content</x-accelade::lazy>');

    expect($html)->toContain('width: 50%');
});

test('lazy component renders rounded shimmer', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" :shimmer-rounded="true">Content</x-accelade::lazy>');

    expect($html)->toContain('accelade-shimmer-rounded');
});

test('lazy component renders circle shimmer', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" :shimmer-circle="true">Content</x-accelade::lazy>');

    expect($html)->toContain('accelade-shimmer-circle');
    expect($html)->toContain('accelade-shimmer-circle-inner');
});

test('lazy component renders custom placeholder', function () {
    $html = Blade::render('
        <x-accelade::lazy>
            <x-slot:placeholder>
                <div class="custom-loading">Loading...</div>
            </x-slot:placeholder>
            Content
        </x-accelade::lazy>
    ');

    expect($html)->toContain('custom-loading');
    expect($html)->toContain('Loading...');
});

test('lazy component includes content in inline mode', function () {
    $html = Blade::render('<x-accelade::lazy>Hello World</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-content');
    expect($html)->toContain('Hello World');
});

test('lazy component renders with url mode', function () {
    $html = Blade::render('<x-accelade::lazy url="/api/content">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-url="/api/content"');
    expect($html)->toContain('data-lazy-mode="url"');
});

test('lazy component does not include slot content in url mode', function () {
    $html = Blade::render('<x-accelade::lazy url="/api/content">Secret Content</x-accelade::lazy>');

    expect($html)->not->toContain('Secret Content');
});

test('lazy component renders with delay', function () {
    $html = Blade::render('<x-accelade::lazy :delay="500">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-delay="500"');
});

test('lazy component renders with conditional show as string', function () {
    $html = Blade::render('<x-accelade::lazy show="isVisible">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-show="isVisible"');
    expect($html)->toContain('data-lazy-conditional="true"');
});

test('lazy component renders with name attribute', function () {
    $html = Blade::render('<x-accelade::lazy name="my-section">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-name="my-section"');
});

test('lazy component renders with POST method', function () {
    $html = Blade::render('<x-accelade::lazy url="/api/content" method="POST">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-method="POST"');
});

test('lazy component renders with data attribute', function () {
    $html = Blade::render('<x-accelade::lazy url="/api/content" :data="[\'key\' => \'value\']">Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-data=');
    expect($html)->toContain('key');
    expect($html)->toContain('value');
});

test('lazy component renders hidden content container', function () {
    $html = Blade::render('<x-accelade::lazy>Content</x-accelade::lazy>');

    expect($html)->toContain('data-lazy-content');
    expect($html)->toContain('style="display: none;"');
});

test('lazy component merges custom classes', function () {
    $html = Blade::render('<x-accelade::lazy class="my-custom-class">Content</x-accelade::lazy>');

    expect($html)->toContain('accelade-lazy-wrapper');
    expect($html)->toContain('my-custom-class');
});

test('lazy component renders short last shimmer line', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" :shimmer-lines="3">Content</x-accelade::lazy>');

    expect($html)->toContain('accelade-shimmer-line-short');
});

test('lazy component with single shimmer line has no short line', function () {
    $html = Blade::render('<x-accelade::lazy :shimmer="true" :shimmer-lines="1">Content</x-accelade::lazy>');

    expect($html)->not->toContain('accelade-shimmer-line-short');
});
</file>

<file path="tests/Feature/ModalComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeModalView(array $props = []): string
{
    $defaults = [
        'name' => null,
        'maxWidth' => null,
        'position' => null,
        'slideoverPosition' => null,
        'closeExplicitly' => false,
        'closeButton' => true,
        'opened' => false,
        'slideover' => false,
        'bottomSheet' => false,
        'slot' => new HtmlString('<p>Modal Content</p>'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/modal.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic modal', function () {
    $html = makeModalView();

    expect($html)
        ->toContain('data-accelade')
        ->toContain('data-accelade-modal')
        ->toContain('Modal Content');
});

it('renders with name attribute', function () {
    $html = makeModalView(['name' => 'test-modal']);

    expect($html)->toContain('data-modal-name="test-modal"');
});

it('renders as slideover when slideover is true', function () {
    $html = makeModalView(['slideover' => true]);

    expect($html)->toContain('data-slideover');
});

it('renders with custom max-width', function () {
    $html = makeModalView(['maxWidth' => '4xl']);

    expect($html)->toContain('data-max-width="4xl"');
});

it('renders with default max-width 2xl for modal', function () {
    $html = makeModalView();

    expect($html)->toContain('data-max-width="2xl"');
});

it('renders with default max-width md for slideover', function () {
    $html = makeModalView(['slideover' => true]);

    expect($html)->toContain('data-max-width="md"');
});

it('renders with custom position', function () {
    $html = makeModalView(['position' => 'top']);

    expect($html)->toContain('data-position="top"');
});

it('renders with default position center', function () {
    $html = makeModalView();

    expect($html)->toContain('data-position="center"');
});

it('renders with slideover position right by default', function () {
    $html = makeModalView(['slideover' => true]);

    expect($html)->toContain('data-slideover-position="right"');
});

it('renders with slideover position left', function () {
    $html = makeModalView(['slideover' => true, 'slideoverPosition' => 'left']);

    expect($html)->toContain('data-slideover-position="left"');
});

it('renders with close-explicitly attribute', function () {
    $html = makeModalView(['closeExplicitly' => true]);

    expect($html)->toContain('data-close-explicitly');
});

it('does not render close-explicitly when false', function () {
    $html = makeModalView(['closeExplicitly' => false]);

    expect($html)->not->toContain('data-close-explicitly');
});

it('renders without close button when closeButton is false', function () {
    $html = makeModalView(['closeButton' => false]);

    expect($html)->toContain('data-no-close-button');
});

it('does not have no-close-button when closeButton is true', function () {
    $html = makeModalView(['closeButton' => true]);

    expect($html)->not->toContain('data-no-close-button');
});

it('renders with opened attribute', function () {
    $html = makeModalView(['opened' => true]);

    expect($html)->toContain('data-opened');
});

it('does not render opened attribute when false', function () {
    $html = makeModalView(['opened' => false]);

    expect($html)->not->toContain('data-opened');
});

it('renders with initial state', function () {
    $html = makeModalView();

    expect($html)->toContain('data-accelade-state=');
});

it('renders slot content', function () {
    $html = makeModalView([
        'slot' => new HtmlString('<h1>Custom Title</h1><p>Custom content</p>'),
    ]);

    expect($html)
        ->toContain('Custom Title')
        ->toContain('Custom content');
});

it('has display none style by default', function () {
    $html = makeModalView();

    expect($html)->toContain('display: none');
});

it('merges additional attributes', function () {
    $html = makeModalView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'custom-class',
            'id' => 'my-modal',
        ]),
    ]);

    expect($html)
        ->toContain('class="custom-class')
        ->toContain('id="my-modal"');
});

it('generates unique id when not provided', function () {
    $html = makeModalView();

    expect($html)->toMatch('/data-modal-id="modal-[a-f0-9]+"/');
});

it('uses provided id attribute', function () {
    $html = makeModalView([
        'attributes' => new ComponentAttributeBag(['id' => 'specific-modal']),
    ]);

    expect($html)->toContain('data-modal-id="specific-modal"');
});

it('renders all max-width options', function () {
    $sizes = ['sm', 'md', 'lg', 'xl', '2xl', '3xl', '4xl', '5xl', '6xl', '7xl'];

    foreach ($sizes as $size) {
        $html = makeModalView(['maxWidth' => $size]);
        expect($html)->toContain("data-max-width=\"{$size}\"");
    }
});

it('renders all position options for modal', function () {
    $positions = ['top', 'center', 'bottom'];

    foreach ($positions as $position) {
        $html = makeModalView(['position' => $position]);
        expect($html)->toContain("data-position=\"{$position}\"");
    }
});

it('renders all slideover position options', function () {
    $positions = ['left', 'right'];

    foreach ($positions as $position) {
        $html = makeModalView(['slideover' => true, 'slideoverPosition' => $position]);
        expect($html)->toContain("data-slideover-position=\"{$position}\"");
    }
});

it('renders as bottom sheet when bottomSheet is true', function () {
    $html = makeModalView(['bottomSheet' => true]);

    expect($html)->toContain('data-bottom-sheet');
});

it('does not render bottom-sheet attribute when false', function () {
    $html = makeModalView(['bottomSheet' => false]);

    expect($html)->not->toContain('data-bottom-sheet');
});

it('renders with default max-width 2xl for bottom sheet', function () {
    $html = makeModalView(['bottomSheet' => true]);

    expect($html)->toContain('data-max-width="2xl"');
});

it('renders bottom sheet with custom max-width', function () {
    $html = makeModalView(['bottomSheet' => true, 'maxWidth' => 'lg']);

    expect($html)->toContain('data-max-width="lg"');
});

it('renders bottom sheet without slideover attribute', function () {
    $html = makeModalView(['bottomSheet' => true]);

    // Check that data-slideover is not present (but data-slideover-position is ok)
    expect($html)
        ->toContain('data-bottom-sheet')
        ->not->toMatch('/\sdata-slideover[^-]/');
});
</file>

<file path="tests/Feature/NotifyFacadeTest.php">
<?php

declare(strict_types=1);

use Accelade\Facades\Notify;
use Accelade\Notification\Notification;

test('notify facade creates success notification', function () {
    $notification = Notify::success('Success!');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->status)->toBe('success');
});

test('notify facade creates info notification', function () {
    $notification = Notify::info('Info!');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->status)->toBe('info');
});

test('notify facade creates warning notification', function () {
    $notification = Notify::warning('Warning!');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->status)->toBe('warning');
});

test('notify facade creates danger notification', function () {
    $notification = Notify::danger('Danger!');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->status)->toBe('danger');
});

test('notify facade stores notifications', function () {
    Notify::success('First');
    Notify::info('Second');

    expect(Notify::all())->toHaveCount(2);
});

test('notify facade flushes notifications', function () {
    Notify::success('Test');

    $flushed = Notify::flush();

    expect($flushed)->toHaveCount(1);
    expect(Notify::all())->toBeEmpty();
});

test('notify facade make returns chainable notification', function () {
    $notification = Notify::make()
        ->title('Custom')
        ->body('Body')
        ->warning()
        ->position('bottom-left');

    expect($notification->title)->toBe('Custom');
    expect($notification->body)->toBe('Body');
    expect($notification->status)->toBe('warning');
    expect($notification->position)->toBe('bottom-left');
});

test('notify facade title returns chainable notification', function () {
    $notification = Notify::title('Title')
        ->body('Body')
        ->danger();

    expect($notification->title)->toBe('Title');
    expect($notification->body)->toBe('Body');
    expect($notification->status)->toBe('danger');
});

test('notify facade can set defaults', function () {
    Notify::defaultPosition('bottom-center');
    Notify::defaultDuration(10000);

    $notification = Notify::make();

    expect($notification->position)->toBe('bottom-center');
    expect($notification->duration)->toBe(10000);
});

test('accelade notify singleton is registered', function () {
    $manager = app('accelade.notify');

    expect($manager)->toBeInstanceOf(\Accelade\Notification\NotificationManager::class);
});

test('same notify instance is returned', function () {
    $first = app('accelade.notify');
    $second = app('accelade.notify');

    expect($first)->toBe($second);
});
</file>

<file path="tests/Feature/RehydrateComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeRehydrateView(array $props = []): string
{
    $defaults = [
        'on' => null,
        'poll' => null,
        'url' => null,
        'preserveScroll' => true,
        'slot' => new HtmlString('<p>Rehydrate Content</p>'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/rehydrate.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic rehydrate component', function () {
    $html = makeRehydrateView();

    expect($html)
        ->toContain('data-accelade-rehydrate')
        ->toContain('Rehydrate Content');
});

it('renders with single event listener', function () {
    $html = makeRehydrateView(['on' => 'item-created']);

    expect($html)->toContain('data-rehydrate-on="item-created"');
});

it('renders with multiple event listeners as array', function () {
    $html = makeRehydrateView(['on' => ['item-created', 'item-updated', 'item-deleted']]);

    expect($html)
        ->toContain('data-rehydrate-on=')
        ->toContain('item-created')
        ->toContain('item-updated')
        ->toContain('item-deleted');
});

it('renders with poll interval', function () {
    $html = makeRehydrateView(['poll' => 5000]);

    expect($html)->toContain('data-rehydrate-poll="5000"');
});

it('renders without poll attribute when poll is null', function () {
    $html = makeRehydrateView(['poll' => null]);

    expect($html)->not->toContain('data-rehydrate-poll');
});

it('renders with custom URL', function () {
    $html = makeRehydrateView(['url' => '/api/data']);

    expect($html)->toContain('data-rehydrate-url="/api/data"');
});

it('renders without url attribute when url is null', function () {
    $html = makeRehydrateView(['url' => null]);

    expect($html)->not->toContain('data-rehydrate-url');
});

it('renders with preserve scroll attribute', function () {
    $html = makeRehydrateView(['preserveScroll' => true]);

    expect($html)->toContain('data-rehydrate-preserve-scroll');
});

it('renders without preserve scroll attribute when false', function () {
    $html = makeRehydrateView(['preserveScroll' => false]);

    expect($html)->not->toContain('data-rehydrate-preserve-scroll');
});

it('generates unique id when not provided', function () {
    $html = makeRehydrateView();

    expect($html)->toMatch('/data-rehydrate-id="rehydrate-[a-f0-9]+"/');
});

it('uses provided id attribute', function () {
    $html = makeRehydrateView([
        'attributes' => new ComponentAttributeBag(['id' => 'my-rehydrate']),
    ]);

    expect($html)->toContain('data-rehydrate-id="my-rehydrate"');
});

it('renders slot content', function () {
    $html = makeRehydrateView([
        'slot' => new HtmlString('<div class="custom">Custom Content</div>'),
    ]);

    expect($html)
        ->toContain('custom')
        ->toContain('Custom Content');
});

it('merges additional attributes', function () {
    $html = makeRehydrateView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'my-class',
            'data-testid' => 'rehydrate-test',
        ]),
    ]);

    expect($html)
        ->toContain('class="my-class"')
        ->toContain('data-testid="rehydrate-test"');
});

it('renders with both event and poll', function () {
    $html = makeRehydrateView([
        'on' => 'data-updated',
        'poll' => 10000,
    ]);

    expect($html)
        ->toContain('data-rehydrate-on="data-updated"')
        ->toContain('data-rehydrate-poll="10000"');
});

it('renders with all props combined', function () {
    $html = makeRehydrateView([
        'on' => ['created', 'updated'],
        'poll' => 3000,
        'url' => '/refresh',
        'preserveScroll' => true,
        'attributes' => new ComponentAttributeBag(['id' => 'full-rehydrate']),
    ]);

    expect($html)
        ->toContain('data-accelade-rehydrate')
        ->toContain('data-rehydrate-id="full-rehydrate"')
        ->toContain('data-rehydrate-on=')
        ->toContain('data-rehydrate-poll="3000"')
        ->toContain('data-rehydrate-url="/refresh"')
        ->toContain('data-rehydrate-preserve-scroll');
});
</file>

<file path="tests/Feature/SEOFacadeTest.php">
<?php

declare(strict_types=1);

use Accelade\Facades\SEO;
use Accelade\SEO\SEO as SEOClass;

test('seo facade is registered', function () {
    $seo = app('accelade.seo');

    expect($seo)->toBeInstanceOf(SEOClass::class);
});

test('seo singleton returns same instance', function () {
    $first = app('accelade.seo');
    $second = app('accelade.seo');

    expect($first)->toBe($second);
});

test('seo facade sets title', function () {
    SEO::title('Facade Title');

    expect(SEO::getTitle())->toBe('Facade Title');
});

test('seo facade sets description', function () {
    SEO::description('Facade Description');

    expect(SEO::getDescription())->toBe('Facade Description');
});

test('seo facade sets keywords', function () {
    SEO::keywords('php, laravel');

    expect(SEO::getKeywords())->toBe(['php', 'laravel']);
});

test('seo facade sets canonical', function () {
    SEO::canonical('https://example.com');

    expect(SEO::getCanonical())->toBe('https://example.com');
});

test('seo facade sets robots', function () {
    SEO::robots('noindex, nofollow');

    expect(SEO::getRobots())->toBe('noindex, nofollow');
});

test('seo facade sets author', function () {
    SEO::author('John Doe');

    expect(SEO::getAuthor())->toBe('John Doe');
});

test('seo facade sets opengraph properties', function () {
    SEO::openGraphType('article');
    SEO::openGraphSiteName('My Site');
    SEO::openGraphTitle('OG Title');

    $og = SEO::getOpenGraph();

    expect($og['type'])->toBe('article');
    expect($og['site_name'])->toBe('My Site');
    expect($og['title'])->toBe('OG Title');
});

test('seo facade sets twitter card properties', function () {
    SEO::twitterCard('summary_large_image');
    SEO::twitterSite('@example');
    SEO::twitterCreator('@johndoe');

    $twitter = SEO::getTwitter();

    expect($twitter['card'])->toBe('summary_large_image');
    expect($twitter['site'])->toBe('@example');
    expect($twitter['creator'])->toBe('@johndoe');
});

test('seo facade adds custom meta', function () {
    SEO::metaByName('theme-color', '#ffffff');
    SEO::metaByProperty('article:section', 'Technology');

    $meta = SEO::getMeta();

    expect($meta)->toHaveCount(2);
});

test('seo facade supports fluent chaining', function () {
    $result = SEO::title('Title')
        ->description('Description')
        ->keywords('php, laravel')
        ->canonical('https://example.com');

    expect($result)->toBeInstanceOf(SEOClass::class);
});

test('seo facade renders html', function () {
    SEO::reset();
    SEO::title('Test Title');
    SEO::description('Test Description');

    $html = SEO::toHtml();

    expect($html)->toContain('<title>Test Title</title>');
    expect($html)->toContain('<meta name="description" content="Test Description">');
});

test('seo facade reset clears all values', function () {
    SEO::title('Title');
    SEO::description('Description');

    SEO::reset();

    expect(SEO::getTitle())->toBeNull();
    expect(SEO::getDescription())->toBeNull();
});

test('seo facade converts to array', function () {
    SEO::reset();
    SEO::title('Title');

    $array = SEO::toArray();

    expect($array)->toBeArray();
    expect($array)->toHaveKey('title');
});
</file>

<file path="tests/Feature/ServiceProviderTest.php">
<?php

declare(strict_types=1);

use Accelade\Accelade;
use Accelade\Notification\NotificationManager;

describe('Service Provider Registration', function () {
    it('registers the accelade singleton', function () {
        expect(app()->bound('accelade'))->toBeTrue();
        expect(app('accelade'))->toBeInstanceOf(Accelade::class);
    });

    it('registers the notify singleton', function () {
        expect(app()->bound('accelade.notify'))->toBeTrue();
        expect(app('accelade.notify'))->toBeInstanceOf(NotificationManager::class);
    });

    it('returns same instance for accelade singleton', function () {
        $instance1 = app('accelade');
        $instance2 = app('accelade');

        expect($instance1)->toBe($instance2);
    });

    it('returns same instance for notify singleton', function () {
        $instance1 = app('accelade.notify');
        $instance2 = app('accelade.notify');

        expect($instance1)->toBe($instance2);
    });

    it('loads config from accelade.php', function () {
        expect(config('accelade'))->toBeArray();
        expect(config('accelade.framework'))->toBe('vanilla');
    });
});

describe('Blade Directives', function () {
    it('registers acceladeScripts directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('acceladeScripts');
    });

    it('registers acceladeStyles directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('acceladeStyles');
    });

    it('registers accelade directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('accelade');
    });

    it('registers endaccelade directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('endaccelade');
    });

    it('registers acceladeComponent directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('acceladeComponent');
    });

    it('registers endacceladeComponent directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('endacceladeComponent');
    });

    it('registers acceladeNotifications directive', function () {
        $directives = app('blade.compiler')->getCustomDirectives();

        expect($directives)->toHaveKey('acceladeNotifications');
    });
});

describe('View Loading', function () {
    it('loads views from accelade namespace', function () {
        // Check that accelade view namespace is registered
        $hints = app('view')->getFinder()->getHints();

        expect($hints)->toHaveKey('accelade');
    });

    it('can resolve accelade component views', function () {
        // The component namespace should be registered
        $namespaces = app('blade.compiler')->getClassComponentNamespaces();

        expect($namespaces)->toHaveKey('accelade');
        expect($namespaces['accelade'])->toBe('Accelade\\Components');
    });
});
</file>

<file path="tests/Feature/SharedDataFeatureTest.php">
<?php

declare(strict_types=1);

use Accelade\Facades\Accelade;

describe('Accelade Shared Data Feature', function () {
    describe('facade share method', function () {
        it('can share data via facade', function () {
            Accelade::share('appName', 'Test App');

            expect(Accelade::getShared('appName'))->toBe('Test App');
        });

        it('can share multiple values via facade', function () {
            Accelade::share([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);

            expect(Accelade::getShared('key1'))->toBe('value1')
                ->and(Accelade::getShared('key2'))->toBe('value2');
        });

        it('can get all shared data via facade', function () {
            Accelade::share('test', 'value');

            $all = Accelade::allShared();

            expect($all)->toHaveKey('test')
                ->and($all['test'])->toBe('value');
        });

        it('can access SharedData instance via facade', function () {
            $shared = Accelade::shared();

            expect($shared)->toBeInstanceOf(\Accelade\Support\SharedData::class);
        });

        it('returns fluent interface from share', function () {
            $result = Accelade::share('key', 'value');

            expect($result)->toBeInstanceOf(\Accelade\Accelade::class);
        });
    });

    describe('scripts output', function () {
        it('includes shared data in scripts output', function () {
            Accelade::share('testKey', 'testValue');

            $scripts = Accelade::scripts();

            expect($scripts)->toContain('shared')
                ->and($scripts)->toContain('testKey')
                ->and($scripts)->toContain('testValue');
        });

        it('includes nested shared data in scripts output', function () {
            Accelade::share('user', [
                'name' => 'John',
                'email' => 'john@example.com',
            ]);

            $scripts = Accelade::scripts();

            expect($scripts)->toContain('John')
                ->and($scripts)->toContain('john@example.com');
        });

        it('includes shared key in config when no data', function () {
            // Clear any existing shared data
            Accelade::shared()->flush();

            $scripts = Accelade::scripts();

            // Check that shared is in the AcceladeConfig section (before the JS bundle)
            expect($scripts)->toContain('AcceladeConfig')
                ->and($scripts)->toContain('shared');
        });
    });

    describe('lazy shared data', function () {
        it('resolves closures when getting scripts', function () {
            $called = false;
            Accelade::share('lazy', function () use (&$called) {
                $called = true;

                return 'resolved';
            });

            expect($called)->toBeFalse();

            $scripts = Accelade::scripts();

            expect($called)->toBeTrue()
                ->and($scripts)->toContain('resolved');
        });
    });
});
</file>

<file path="tests/Feature/StateComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeStateView(array $props = []): string
{
    $defaults = [
        'errors' => null,
        'flash' => null,
        'shared' => null,
        'slot' => new HtmlString('<p>State Content</p>'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/state.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic state component', function () {
    $html = makeStateView();

    expect($html)
        ->toContain('data-accelade')
        ->toContain('data-accelade-state-component')
        ->toContain('State Content');
});

it('renders with explicit errors array', function () {
    $errors = [
        'email' => ['The email field is required.'],
        'password' => ['The password must be at least 8 characters.'],
    ];

    $html = makeStateView(['errors' => $errors]);

    expect($html)
        ->toContain('data-state-errors')
        ->toContain('email')
        ->toContain('password');
});

it('renders with flash data', function () {
    $flash = [
        'success' => 'Item created successfully!',
        'info' => 'Welcome back.',
    ];

    $html = makeStateView(['flash' => $flash]);

    expect($html)
        ->toContain('data-state-flash')
        ->toContain('success')
        ->toContain('Item created successfully!');
});

it('renders with shared data', function () {
    $shared = [
        'user' => ['name' => 'John', 'email' => 'john@example.com'],
        'settings' => ['theme' => 'dark'],
    ];

    $html = makeStateView(['shared' => $shared]);

    expect($html)
        ->toContain('data-state-shared')
        ->toContain('user')
        ->toContain('John');
});

it('generates unique id when not provided', function () {
    $html = makeStateView();

    expect($html)->toMatch('/data-state-id="state-[a-f0-9]+"/');
});

it('uses provided id attribute', function () {
    $html = makeStateView([
        'attributes' => new ComponentAttributeBag(['id' => 'my-state']),
    ]);

    expect($html)->toContain('data-state-id="my-state"');
});

it('renders slot content', function () {
    $html = makeStateView([
        'slot' => new HtmlString('<div class="custom">Custom Content</div>'),
    ]);

    expect($html)
        ->toContain('custom')
        ->toContain('Custom Content');
});

it('merges additional attributes', function () {
    $html = makeStateView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'my-class',
            'data-testid' => 'state-test',
        ]),
    ]);

    expect($html)
        ->toContain('class="my-class"')
        ->toContain('data-testid="state-test"');
});

it('includes initial state with errors structure', function () {
    $errors = ['name' => ['Name is required']];

    $html = makeStateView(['errors' => $errors]);

    // HTML entities are escaped, so look for the escaped version
    expect($html)
        ->toContain('data-accelade-state=')
        ->toMatch('/&quot;hasErrors&quot;:true/');
});

it('includes initial state with hasErrors false when no errors', function () {
    $html = makeStateView(['errors' => []]);

    expect($html)
        ->toContain('data-accelade-state=')
        ->toMatch('/&quot;hasErrors&quot;:false/');
});

it('converts raw errors to first-error-only format in state', function () {
    $errors = [
        'email' => ['First error', 'Second error', 'Third error'],
    ];

    $html = makeStateView(['errors' => $errors]);

    // The state should include the rawErrors with all messages
    // HTML entities are escaped
    expect($html)
        ->toMatch('/&quot;rawErrors&quot;/')
        ->toContain('First error');
});

it('renders with all data combined', function () {
    $html = makeStateView([
        'errors' => ['field' => ['Error message']],
        'flash' => ['success' => 'Success message'],
        'shared' => ['key' => 'value'],
        'attributes' => new ComponentAttributeBag(['id' => 'combined-state']),
    ]);

    expect($html)
        ->toContain('data-accelade-state-component')
        ->toContain('data-state-id="combined-state"')
        ->toContain('data-state-errors')
        ->toContain('data-state-flash')
        ->toContain('data-state-shared')
        ->toContain('data-accelade-state=');
});

it('json encodes errors properly', function () {
    $errors = ['field' => ['Message with "quotes" and special chars']];

    $html = makeStateView(['errors' => $errors]);

    // Should be properly escaped
    expect($html)
        ->toContain('data-state-errors=')
        ->not->toContain('Message with "quotes"'); // Should be escaped
});

it('handles empty arrays for all data', function () {
    $html = makeStateView([
        'errors' => [],
        'flash' => [],
        'shared' => [],
    ]);

    expect($html)
        ->toContain('data-state-errors="[]"')
        ->toContain('data-state-flash="[]"')
        ->toContain('data-state-shared="[]"');
});

it('handles nested shared data', function () {
    $shared = [
        'user' => [
            'profile' => [
                'name' => 'John Doe',
                'settings' => ['theme' => 'dark'],
            ],
        ],
    ];

    $html = makeStateView(['shared' => $shared]);

    expect($html)
        ->toContain('data-state-shared')
        ->toContain('profile')
        ->toContain('John Doe');
});

it('handles multiple errors per field', function () {
    $errors = [
        'password' => [
            'The password must be at least 8 characters.',
            'The password must contain at least one uppercase letter.',
            'The password must contain at least one number.',
        ],
    ];

    $html = makeStateView(['errors' => $errors]);

    expect($html)
        ->toContain('data-state-errors')
        ->toContain('8 characters')
        ->toContain('uppercase');
});
</file>

<file path="tests/Feature/TeleportComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeTeleportView(array $props = []): string
{
    $defaults = [
        'to' => null,
        'disabled' => false,
        'slot' => new HtmlString('<p>Teleport Content</p>'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/teleport.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic teleport component', function () {
    $html = makeTeleportView(['to' => '#footer']);

    expect($html)
        ->toContain('data-accelade-teleport')
        ->toContain('data-teleport-to="#footer"')
        ->toContain('Teleport Content');
});

it('renders with target selector', function () {
    $html = makeTeleportView(['to' => '.modal-container']);

    expect($html)->toContain('data-teleport-to=".modal-container"');
});

it('renders with complex CSS selector', function () {
    $html = makeTeleportView(['to' => '#app > .notifications']);

    expect($html)->toContain('data-teleport-to="#app &gt; .notifications"');
});

it('renders without target when to is null', function () {
    $html = makeTeleportView(['to' => null]);

    expect($html)
        ->toContain('data-accelade-teleport')
        ->not->toContain('data-teleport-to');
});

it('renders with disabled attribute', function () {
    $html = makeTeleportView(['to' => '#target', 'disabled' => true]);

    expect($html)->toContain('data-teleport-disabled="true"');
});

it('renders without disabled attribute when false', function () {
    $html = makeTeleportView(['to' => '#target', 'disabled' => false]);

    expect($html)->not->toContain('data-teleport-disabled');
});

it('generates unique id when not provided', function () {
    $html = makeTeleportView(['to' => '#target']);

    expect($html)->toMatch('/data-teleport-id="teleport-[a-f0-9]+"/');
});

it('uses provided id attribute', function () {
    $html = makeTeleportView([
        'to' => '#target',
        'attributes' => new ComponentAttributeBag(['id' => 'my-teleport']),
    ]);

    expect($html)->toContain('data-teleport-id="my-teleport"');
});

it('renders slot content', function () {
    $html = makeTeleportView([
        'to' => '#target',
        'slot' => new HtmlString('<div class="custom">Custom Content</div>'),
    ]);

    expect($html)
        ->toContain('custom')
        ->toContain('Custom Content');
});

it('merges additional attributes', function () {
    $html = makeTeleportView([
        'to' => '#target',
        'attributes' => new ComponentAttributeBag([
            'class' => 'my-class',
            'data-testid' => 'teleport-test',
        ]),
    ]);

    expect($html)
        ->toContain('class="my-class"')
        ->toContain('data-testid="teleport-test"');
});

it('renders with all props combined', function () {
    $html = makeTeleportView([
        'to' => '#my-target',
        'disabled' => true,
        'attributes' => new ComponentAttributeBag(['id' => 'full-teleport', 'class' => 'teleport-wrapper']),
    ]);

    expect($html)
        ->toContain('data-accelade-teleport')
        ->toContain('data-teleport-id="full-teleport"')
        ->toContain('data-teleport-to="#my-target"')
        ->toContain('data-teleport-disabled="true"')
        ->toContain('class="teleport-wrapper"');
});

it('renders with reactive content', function () {
    $html = makeTeleportView([
        'to' => '#target',
        'slot' => new HtmlString('<span a-text="dynamicValue">Default</span>'),
    ]);

    expect($html)
        ->toContain('a-text="dynamicValue"')
        ->toContain('Default');
});

it('handles special characters in target selector', function () {
    $html = makeTeleportView(['to' => '#target-123']);

    expect($html)->toContain('data-teleport-to="#target-123"');
});

it('handles ID selector', function () {
    $html = makeTeleportView(['to' => '#notification-area']);

    expect($html)->toContain('data-teleport-to="#notification-area"');
});

it('handles class selector', function () {
    $html = makeTeleportView(['to' => '.modal-body']);

    expect($html)->toContain('data-teleport-to=".modal-body"');
});

it('handles multiple class selector', function () {
    $html = makeTeleportView(['to' => '.container.main']);

    expect($html)->toContain('data-teleport-to=".container.main"');
});
</file>

<file path="tests/Feature/ToggleComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeToggleView(array $props = []): string
{
    $defaults = [
        'data' => false,
        'slot' => new HtmlString('<p>Toggle Content</p>'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/toggle.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic toggle component', function () {
    $html = makeToggleView();

    expect($html)
        ->toContain('data-accelade')
        ->toContain('data-accelade-toggle')
        ->toContain('Toggle Content');
});

it('generates unique id when not provided', function () {
    $html = makeToggleView();

    expect($html)->toMatch('/data-toggle-id="toggle-[a-f0-9]+"/');
});

it('uses provided id attribute', function () {
    $html = makeToggleView([
        'attributes' => new ComponentAttributeBag(['id' => 'my-toggle']),
    ]);

    expect($html)->toContain('data-toggle-id="my-toggle"');
});

it('renders with default false state', function () {
    $html = makeToggleView(['data' => false]);

    // Debug: dump the HTML to see what's actually rendered
    // dump($html);

    expect($html)
        ->toContain('data-toggle-default="false"')
        ->toContain('&quot;toggled&quot;:false');
});

it('renders with default true state', function () {
    $html = makeToggleView(['data' => true]);

    expect($html)
        ->toContain('data-toggle-default="true"')
        ->toContain('&quot;toggled&quot;:true');
});

it('renders with string true data', function () {
    $html = makeToggleView(['data' => 'true']);

    expect($html)
        ->toContain('data-toggle-data="true"')
        ->toContain('&quot;toggled&quot;:true');
});

it('renders with string false data', function () {
    $html = makeToggleView(['data' => 'false']);

    expect($html)
        ->toContain('data-toggle-data="false"')
        ->toContain('&quot;toggled&quot;:false');
});

it('renders with single named key', function () {
    $html = makeToggleView(['data' => 'isVisible']);

    expect($html)
        ->toContain('data-toggle-data="isVisible"')
        ->toContain('&quot;isVisible&quot;:false');
});

it('renders with multiple named keys', function () {
    $html = makeToggleView(['data' => 'isCompany, hasVatNumber']);

    expect($html)
        ->toContain('data-toggle-data="isCompany, hasVatNumber"')
        ->toContain('&quot;isCompany&quot;:false')
        ->toContain('&quot;hasVatNumber&quot;:false');
});

it('renders with multiple keys and spaces', function () {
    $html = makeToggleView(['data' => 'key1,  key2,key3']);

    expect($html)
        ->toContain('&quot;key1&quot;:false')
        ->toContain('&quot;key2&quot;:false')
        ->toContain('&quot;key3&quot;:false');
});

it('renders slot content', function () {
    $html = makeToggleView([
        'slot' => new HtmlString('<div class="custom">Custom Content</div>'),
    ]);

    expect($html)
        ->toContain('custom')
        ->toContain('Custom Content');
});

it('merges additional attributes', function () {
    $html = makeToggleView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'my-class',
            'data-testid' => 'toggle-test',
        ]),
    ]);

    expect($html)
        ->toContain('class="my-class"')
        ->toContain('data-testid="toggle-test"');
});

it('renders with all props combined', function () {
    $html = makeToggleView([
        'data' => 'showPanel, enableFeature',
        'attributes' => new ComponentAttributeBag(['id' => 'full-toggle', 'class' => 'toggle-wrapper']),
    ]);

    expect($html)
        ->toContain('data-accelade')
        ->toContain('data-accelade-toggle')
        ->toContain('data-toggle-id="full-toggle"')
        ->toContain('data-toggle-data="showPanel, enableFeature"')
        ->toContain('class="toggle-wrapper"')
        ->toContain('&quot;showPanel&quot;:false')
        ->toContain('&quot;enableFeature&quot;:false');
});

it('renders with reactive content in slot', function () {
    $html = makeToggleView([
        'slot' => new HtmlString('<div a-show="toggled">Visible when toggled</div>'),
    ]);

    expect($html)
        ->toContain('a-show="toggled"')
        ->toContain('Visible when toggled');
});

it('handles array data with boolean values', function () {
    $html = makeToggleView([
        'data' => ['isOpen' => true, 'isActive' => false],
    ]);

    expect($html)
        ->toContain('&quot;isOpen&quot;:true')
        ->toContain('&quot;isActive&quot;:false');
});

it('renders toggle with event handlers in slot', function () {
    $html = makeToggleView([
        'slot' => new HtmlString('<button @click.prevent="toggle()">Toggle</button>'),
    ]);

    expect($html)
        ->toContain('@click.prevent="toggle()"')
        ->toContain('Toggle');
});

it('renders multi-toggle with keyed event handlers', function () {
    $html = makeToggleView([
        'data' => 'panel1, panel2',
        'slot' => new HtmlString('<button @click.prevent="toggle(\'panel1\')">Toggle Panel 1</button>'),
    ]);

    expect($html)
        ->toContain('@click.prevent="toggle(\'panel1\')"')
        ->toContain('Toggle Panel 1');
});

it('renders setToggle usage in slot', function () {
    $html = makeToggleView([
        'slot' => new HtmlString('<button @click.prevent="setToggle(true)">Show</button>'),
    ]);

    expect($html)
        ->toContain('@click.prevent="setToggle(true)"')
        ->toContain('Show');
});

it('handles empty string data', function () {
    $html = makeToggleView(['data' => '']);

    expect($html)
        ->toContain('data-accelade-toggle')
        ->toContain('&quot;toggled&quot;:false');
});
</file>

<file path="tests/Feature/TransitionComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;

beforeEach(function () {
    // Reset animation manager between tests
    app()->forgetInstance('accelade.animation');
});

it('renders basic transition component', function () {
    $view = View::make('accelade::components.transition', [
        'slot' => 'Hello World',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-accelade-transition')
        ->toContain('data-transition-show="true"')
        ->toContain('Hello World');
});

it('renders with show expression', function () {
    $view = View::make('accelade::components.transition', [
        'show' => 'toggled',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-show="toggled"');
});

it('renders with animation preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'fade',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter="transition-opacity ease-out duration-200"')
        ->toContain('data-transition-enter-from="opacity-0"')
        ->toContain('data-transition-enter-to="opacity-100"')
        ->toContain('data-transition-leave="transition-opacity ease-in duration-150"')
        ->toContain('data-transition-leave-from="opacity-100"')
        ->toContain('data-transition-leave-to="opacity-0"');
});

it('renders with slide-left preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'slide-left',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter="transition ease-out duration-300"')
        ->toContain('data-transition-enter-from="opacity-0 -translate-x-full"')
        ->toContain('data-transition-enter-to="opacity-100 translate-x-0"');
});

it('renders with slide-right preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'slide-right',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter-from="opacity-0 translate-x-full"');
});

it('renders with custom classes', function () {
    $view = View::make('accelade::components.transition', [
        'enter' => 'custom-enter',
        'enterFrom' => 'custom-enter-from',
        'enterTo' => 'custom-enter-to',
        'leave' => 'custom-leave',
        'leaveFrom' => 'custom-leave-from',
        'leaveTo' => 'custom-leave-to',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter="custom-enter"')
        ->toContain('data-transition-enter-from="custom-enter-from"')
        ->toContain('data-transition-enter-to="custom-enter-to"')
        ->toContain('data-transition-leave="custom-leave"')
        ->toContain('data-transition-leave-from="custom-leave-from"')
        ->toContain('data-transition-leave-to="custom-leave-to"');
});

it('custom classes override preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'fade',
        'enter' => 'custom-enter-override',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter="custom-enter-override"')
        ->toContain('data-transition-enter-from="opacity-0"'); // Still from preset
});

it('generates unique id when not provided', function () {
    $view = View::make('accelade::components.transition', [
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)->toContain('data-transition-id="transition-');
});

it('uses provided id attribute', function () {
    $view = View::make('accelade::components.transition', [
        'attributes' => new \Illuminate\View\ComponentAttributeBag(['id' => 'my-transition']),
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)->toContain('data-transition-id="my-transition"');
});

it('renders slot content', function () {
    $view = View::make('accelade::components.transition', [
        'slot' => new HtmlString('<div class="nested">Nested content</div>'),
    ]);

    $html = $view->render();

    expect($html)->toContain('<div class="nested">Nested content</div>');
});

it('merges additional attributes', function () {
    $view = View::make('accelade::components.transition', [
        'attributes' => new \Illuminate\View\ComponentAttributeBag([
            'class' => 'my-class',
            'data-custom' => 'value',
        ]),
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('class="my-class"')
        ->toContain('data-custom="value"');
});

it('renders with default preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'default',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter="transition ease-out duration-200"')
        ->toContain('data-transition-enter-from="opacity-0 scale-95"')
        ->toContain('data-transition-enter-to="opacity-100 scale-100"');
});

it('renders with scale preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'scale',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    expect($html)
        ->toContain('data-transition-enter-from="opacity-0 scale-0"')
        ->toContain('data-transition-enter-to="opacity-100 scale-100"');
});

it('falls back to defaults for unknown preset', function () {
    $view = View::make('accelade::components.transition', [
        'animation' => 'nonexistent-preset',
        'slot' => 'Content',
    ]);

    $html = $view->render();

    // Should use default values since preset doesn't exist
    expect($html)
        ->toContain('data-transition-enter="transition ease-out duration-200"')
        ->toContain('data-transition-enter-from="opacity-0"');
});
</file>

<file path="tests/Unit/Exceptions/ExceptionHandlerTest.php">
<?php

declare(strict_types=1);

use Accelade\Exceptions\ExceptionHandler;
use Illuminate\Http\Request;
use Illuminate\Validation\ValidationException;
use Symfony\Component\HttpKernel\Exception\HttpException;
use Symfony\Component\HttpKernel\Exception\NotFoundHttpException;

describe('ExceptionHandler', function (): void {
    describe('isAcceladeRequest', function (): void {
        it('returns false for non-AJAX requests', function (): void {
            $request = Request::create('/test', 'GET');

            expect(ExceptionHandler::isAcceladeRequest($request))->toBeFalse();
        });

        it('returns true for accelade route prefix', function (): void {
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            expect(ExceptionHandler::isAcceladeRequest($request))->toBeTrue();
        });

        it('returns true for _accelade route prefix', function (): void {
            $request = Request::create('/_accelade/update', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            expect(ExceptionHandler::isAcceladeRequest($request))->toBeTrue();
        });

        it('returns true for X-Accelade header', function (): void {
            $request = Request::create('/any/route', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');
            $request->headers->set('X-Accelade', 'true');

            expect(ExceptionHandler::isAcceladeRequest($request))->toBeTrue();
        });

        it('returns true for Accept header with accelade', function (): void {
            $request = Request::create('/any/route', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');
            $request->headers->set('Accept', 'application/json, accelade');

            expect(ExceptionHandler::isAcceladeRequest($request))->toBeTrue();
        });
    });

    describe('handle', function (): void {
        it('creates a closure that handles exceptions', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);

            $closure = ExceptionHandler::handle($handler);

            expect($closure)->toBeInstanceOf(Closure::class);
        });

        it('returns null for non-Accelade requests', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/test', 'GET');
            $exception = new \Exception('Test error');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            expect($result)->toBeNull();
        });

        it('handles validation exceptions for Accelade requests', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            // Create a real validator to generate a ValidationException
            $validator = \Illuminate\Support\Facades\Validator::make(
                ['email' => 'invalid'],
                ['email' => 'email']
            );

            $exception = new ValidationException($validator);

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            expect($result)->toBeInstanceOf(\Illuminate\Http\JsonResponse::class);
            expect($result->getStatusCode())->toBe(422);

            $data = $result->getData(true);
            expect($data['success'])->toBeFalse();
            expect($data['_accelade']['type'])->toBe('validation');
            expect($data['errors'])->toBeArray();
        });

        it('handles HTTP exceptions for Accelade requests', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new NotFoundHttpException('Resource not found');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            expect($result)->toBeInstanceOf(\Illuminate\Http\JsonResponse::class);
            expect($result->getStatusCode())->toBe(404);

            $data = $result->getData(true);
            expect($data['success'])->toBeFalse();
            expect($data['_accelade']['type'])->toBe('http');
            expect($data['_accelade']['status'])->toBe(404);
        });

        it('handles 419 CSRF token mismatch with refresh action', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new HttpException(419, 'Page Expired');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            expect($result)->toBeInstanceOf(\Illuminate\Http\JsonResponse::class);
            expect($result->getStatusCode())->toBe(419);

            $data = $result->getData(true);
            expect($data['_accelade']['action'])->toBe('refresh');
        });

        it('handles generic exceptions for Accelade requests', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new \RuntimeException('Something went wrong');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            expect($result)->toBeInstanceOf(\Illuminate\Http\JsonResponse::class);
            expect($result->getStatusCode())->toBe(500);

            $data = $result->getData(true);
            expect($data['success'])->toBeFalse();
            expect($data['_accelade']['type'])->toBe('exception');
        });

        it('allows custom handler to process exceptions first', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new \RuntimeException('Custom error');
            $customResponse = response()->json(['custom' => true], 418);

            $customHandler = function ($e, $req) use ($customResponse) {
                return $customResponse;
            };

            $closure = ExceptionHandler::handle($handler, $customHandler);
            $result = $closure($exception, $request);

            expect($result)->toBe($customResponse);
        });

        it('falls through to default handler if custom handler returns null', function (): void {
            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new \RuntimeException('Test error');

            $customHandler = function ($e, $req) {
                return null;
            };

            $closure = ExceptionHandler::handle($handler, $customHandler);
            $result = $closure($exception, $request);

            expect($result)->toBeInstanceOf(\Illuminate\Http\JsonResponse::class);
            expect($result->getStatusCode())->toBe(500);
        });
    });

    describe('debug mode', function (): void {
        it('includes debug info when APP_DEBUG is true', function (): void {
            config(['app.debug' => true]);

            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new \RuntimeException('Debug test error');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            $data = $result->getData(true);
            expect($data['_accelade']['debug'])->toBeArray();
            expect($data['_accelade']['debug']['exception'])->toBe('RuntimeException');
            expect($data['_accelade']['debug']['message'])->toBe('Debug test error');
        });

        it('excludes debug info when APP_DEBUG is false', function (): void {
            config(['app.debug' => false]);

            $handler = Mockery::mock(\Illuminate\Foundation\Exceptions\Handler::class);
            $request = Request::create('/accelade/bridge/call', 'POST');
            $request->headers->set('X-Requested-With', 'XMLHttpRequest');

            $exception = new \RuntimeException('Secret error');

            $closure = ExceptionHandler::handle($handler);
            $result = $closure($exception, $request);

            $data = $result->getData(true);
            expect($data['_accelade']['debug'] ?? null)->toBeNull();
        });
    });
});
</file>

<file path="tests/Unit/AcceladeTest.php">
<?php

declare(strict_types=1);

use Accelade\Accelade;

describe('Accelade Scripts', function () {
    it('returns script tag', function () {
        $accelade = app('accelade');
        $scripts = $accelade->scripts();

        expect($scripts)->toContain('<script');
        expect($scripts)->toContain('</script>');
    });

    it('includes framework configuration', function () {
        $accelade = app('accelade');
        $scripts = $accelade->scripts();

        expect($scripts)->toContain('AcceladeConfig');
        expect($scripts)->toContain('framework');
    });
});

describe('Accelade Styles', function () {
    it('returns style tag with CSS', function () {
        $accelade = app('accelade');
        $styles = $accelade->styles();

        expect($styles)->toContain('<style');
        expect($styles)->toContain('</style>');
    });

    it('includes notification styles', function () {
        $accelade = app('accelade');
        $styles = $accelade->styles();

        expect($styles)->toContain('accelade-notifications');
    });

    it('includes CSS variables for customization', function () {
        $accelade = app('accelade');
        $styles = $accelade->styles();

        expect($styles)->toContain('--accelade-notif');
    });
});

describe('Accelade Configuration', function () {
    it('uses configured framework', function () {
        config(['accelade.framework' => 'vue']);
        $accelade = new Accelade(app());

        expect(config('accelade.framework'))->toBe('vue');
    });

    it('uses configured prefix', function () {
        config(['accelade.prefix' => 'custom-prefix']);

        expect(config('accelade.prefix'))->toBe('custom-prefix');
    });
});
</file>

<file path="tests/Unit/EventResponseTest.php">
<?php

declare(strict_types=1);

use Accelade\Broadcasting\EventResponse;

it('creates redirect response', function () {
    $response = EventResponse::redirect('/orders/123');
    $array = $response->toArray();

    expect($array)->toHaveKey('_accelade');
    expect($array['_accelade'])->toHaveKey('action', 'redirect');
    expect($array['_accelade'])->toHaveKey('url', '/orders/123');
});

it('creates redirect to route response', function () {
    // Mock the route function
    $response = EventResponse::redirect('https://example.com/orders/123');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('redirect');
    expect($array['_accelade']['url'])->toBe('https://example.com/orders/123');
});

it('creates refresh response', function () {
    $response = EventResponse::refresh();
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('refresh');
});

it('creates toast response with default type', function () {
    $response = EventResponse::toast('Hello World');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Hello World');
    expect($array['_accelade']['type'])->toBe('info');
});

it('creates toast response with custom type', function () {
    $response = EventResponse::toast('Success!', 'success');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Success!');
    expect($array['_accelade']['type'])->toBe('success');
});

it('creates success toast shorthand', function () {
    $response = EventResponse::success('Operation successful');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Operation successful');
    expect($array['_accelade']['type'])->toBe('success');
});

it('creates info toast shorthand', function () {
    $response = EventResponse::info('Information message');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Information message');
    expect($array['_accelade']['type'])->toBe('info');
});

it('creates warning toast shorthand', function () {
    $response = EventResponse::warning('Warning message');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Warning message');
    expect($array['_accelade']['type'])->toBe('warning');
});

it('creates danger toast shorthand', function () {
    $response = EventResponse::danger('Error message');
    $array = $response->toArray();

    expect($array['_accelade']['action'])->toBe('toast');
    expect($array['_accelade']['message'])->toBe('Error message');
    expect($array['_accelade']['type'])->toBe('danger');
});

it('adds title to toast response', function () {
    $response = EventResponse::success('Order created successfully')
        ->withTitle('New Order');
    $array = $response->toArray();

    expect($array['_accelade']['title'])->toBe('New Order');
    expect($array['_accelade']['message'])->toBe('Order created successfully');
});

it('adds custom data to response', function () {
    $response = EventResponse::redirect('/orders/123')
        ->with(['order_id' => 123, 'status' => 'paid']);
    $array = $response->toArray();

    expect($array)->toHaveKey('order_id', 123);
    expect($array)->toHaveKey('status', 'paid');
    expect($array)->toHaveKey('_accelade');
});

it('merges multiple custom data', function () {
    $response = EventResponse::toast('Hello')
        ->with(['key1' => 'value1'])
        ->with(['key2' => 'value2']);
    $array = $response->toArray();

    expect($array)->toHaveKey('key1', 'value1');
    expect($array)->toHaveKey('key2', 'value2');
});

it('is json serializable', function () {
    $response = EventResponse::success('Test');
    $json = json_encode($response);
    $decoded = json_decode($json, true);

    expect($decoded)->toHaveKey('_accelade');
    expect($decoded['_accelade']['action'])->toBe('toast');
});

it('implements arrayable interface', function () {
    $response = EventResponse::refresh();

    expect($response)->toBeInstanceOf(\Illuminate\Contracts\Support\Arrayable::class);
    expect($response->toArray())->toBeArray();
});

it('chain methods return self', function () {
    $response = EventResponse::toast('Test')
        ->withTitle('Title')
        ->with(['data' => 'value']);

    expect($response)->toBeInstanceOf(EventResponse::class);
});
</file>

<file path="tests/Unit/FlashMiddlewareTest.php">
<?php

declare(strict_types=1);

use Accelade\Facades\Accelade;
use Accelade\Http\Middleware\ShareAcceladeData;
use Illuminate\Http\Request;
use Illuminate\Http\Response;

beforeEach(function () {
    Accelade::shared()->flush();
});

it('shares csrf token', function () {
    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    expect(Accelade::shared()->has('csrf_token'))->toBeTrue();
});

it('shares flash data when enabled', function () {
    config(['accelade.flash.enabled' => true]);

    session()->flash('success', 'Test flash');

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    expect(Accelade::shared()->has('flash'))->toBeTrue();
});

it('does not share flash data when disabled', function () {
    config(['accelade.flash.enabled' => false]);

    session()->flash('success', 'Test flash');

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    expect(Accelade::shared()->has('flash'))->toBeFalse();
});

it('respects flash keys config', function () {
    config([
        'accelade.flash.enabled' => true,
        'accelade.flash.keys' => ['success', 'error'],
    ]);

    session()->put('success', 'Success message');
    session()->put('info', 'Info message');
    session()->put('custom', 'Custom message');

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    $flashData = Accelade::shared()->get('flash');

    // Should only include configured keys
    expect($flashData)
        ->toHaveKey('success')
        ->not->toHaveKey('info')
        ->not->toHaveKey('custom');
});

it('collects all common flash keys when keys config is null', function () {
    config([
        'accelade.flash.enabled' => true,
        'accelade.flash.keys' => null,
    ]);

    session()->put('message', 'Message');
    session()->put('success', 'Success');
    session()->put('error', 'Error');
    session()->put('warning', 'Warning');
    session()->put('info', 'Info');
    session()->put('status', 'Status');
    session()->put('notification', 'Notification');
    session()->put('alert', 'Alert');

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    $flashData = Accelade::shared()->get('flash');

    expect($flashData)
        ->toHaveKey('message')
        ->toHaveKey('success')
        ->toHaveKey('error')
        ->toHaveKey('warning')
        ->toHaveKey('info')
        ->toHaveKey('status')
        ->toHaveKey('notification')
        ->toHaveKey('alert');
});

it('continues middleware chain', function () {
    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $responseBody = 'Test Response';
    $response = $middleware->handle($request, fn () => new Response($responseBody));

    expect($response->getContent())->toBe($responseBody);
});

it('handles missing session gracefully', function () {
    config(['accelade.flash.enabled' => true]);

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $response = $middleware->handle($request, fn () => new Response);

    // Should not throw exception
    expect($response)->toBeInstanceOf(Response::class);
});

it('uses lazy loading for flash data', function () {
    config(['accelade.flash.enabled' => true]);

    $middleware = new ShareAcceladeData;
    $request = Request::create('/test', 'GET');

    $middleware->handle($request, fn () => new Response);

    // Flash should be registered but not evaluated until accessed
    expect(Accelade::shared()->has('flash'))->toBeTrue();

    // Now access it to trigger evaluation
    $flash = Accelade::shared()->get('flash');
    expect($flash)->toBeArray();
});
</file>

<file path="tests/Unit/NotificationManagerTest.php">
<?php

declare(strict_types=1);

use Accelade\Notification\Notification;
use Accelade\Notification\NotificationManager;

test('manager starts with empty collection', function () {
    $manager = new NotificationManager;

    expect($manager->all())->toBeEmpty();
});

test('manager can create notification via make', function () {
    $manager = new NotificationManager;

    $notification = $manager->make();

    expect($notification)->toBeInstanceOf(Notification::class);
});

test('manager can create success notification', function () {
    $manager = new NotificationManager;

    $notification = $manager->success('Success Title');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->status)->toBe('success');
    expect($notification->title)->toBe('Success Title');
});

test('manager can create info notification', function () {
    $manager = new NotificationManager;

    $notification = $manager->info('Info Title');

    expect($notification->status)->toBe('info');
    expect($notification->title)->toBe('Info Title');
});

test('manager can create warning notification', function () {
    $manager = new NotificationManager;

    $notification = $manager->warning('Warning Title');

    expect($notification->status)->toBe('warning');
    expect($notification->title)->toBe('Warning Title');
});

test('manager can create danger notification', function () {
    $manager = new NotificationManager;

    $notification = $manager->danger('Danger Title');

    expect($notification->status)->toBe('danger');
    expect($notification->title)->toBe('Danger Title');
});

test('manager adds notification to collection', function () {
    $manager = new NotificationManager;

    $manager->success('Test');

    expect($manager->all())->toHaveCount(1);
});

test('manager can push multiple notifications', function () {
    $manager = new NotificationManager;

    $manager->success('First');
    $manager->info('Second');
    $manager->warning('Third');

    expect($manager->all())->toHaveCount(3);
});

test('manager can flush notifications', function () {
    $manager = new NotificationManager;

    $manager->success('One');
    $manager->info('Two');

    $flushed = $manager->flush();

    expect($flushed)->toHaveCount(2);
    expect($manager->all())->toBeEmpty();
});

test('manager can close notification by id', function () {
    $manager = new NotificationManager;

    $notification = $manager->success('Test');
    $id = $notification->getId();

    expect($manager->all())->toHaveCount(1);

    $manager->close($id);

    expect($manager->all())->toBeEmpty();
});

test('manager can convert to array', function () {
    $manager = new NotificationManager;

    $manager->success('Test');

    $array = $manager->toArray();

    expect($array)->toBeArray();
    expect($array[0])->toBeInstanceOf(Notification::class);
    expect($array[0]->title)->toBe('Test');
});

test('manager can push custom notification', function () {
    $manager = new NotificationManager;

    $notification = Notification::make('Custom')
        ->danger()
        ->position('bottom-center');

    $manager->push($notification);

    expect($manager->all()->first())->toBe($notification);
});

test('manager applies default callback to new notifications', function () {
    $manager = new NotificationManager;

    $manager->setDefault(function (Notification $n) {
        $n->position('bottom-right');
    });

    $notification = $manager->make();

    expect($notification->position)->toBe('bottom-right');
});

test('manager can set default position', function () {
    $manager = new NotificationManager;

    $manager->defaultPosition('top-center');

    $notification = $manager->make();

    expect($notification->position)->toBe('top-center');
});

test('manager can set default duration', function () {
    $manager = new NotificationManager;

    $manager->defaultDuration(10000);

    $notification = $manager->make();

    expect($notification->duration)->toBe(10000);
});

test('manager flush returns collection', function () {
    $manager = new NotificationManager;

    $manager->info('Test');

    $result = $manager->flush();

    expect($result)->toBeInstanceOf(\Illuminate\Support\Collection::class);
});

test('manager title method returns notification', function () {
    $manager = new NotificationManager;

    $notification = $manager->title('Custom Title');

    expect($notification)->toBeInstanceOf(Notification::class);
    expect($notification->title)->toBe('Custom Title');
});
</file>

<file path="tests/Unit/NotificationTest.php">
<?php

declare(strict_types=1);

use Accelade\Notification\Notification;

test('notification can be created with title', function () {
    $notification = new Notification('Test Title');

    expect($notification->title)->toBe('Test Title');
    expect($notification->id)->toStartWith('notif-');
});

test('notification can be created without title', function () {
    $notification = Notification::make();

    expect($notification->title)->toBe('');
});

test('notification has default values', function () {
    $notification = Notification::make();

    expect($notification->body)->toBe('');
    expect($notification->status)->toBe('success');
    expect($notification->position)->toBe('top-right');
    expect($notification->duration)->toBe(5000);
    expect($notification->persistent)->toBeFalse();
    expect($notification->icon)->toBe('');
    expect($notification->actions)->toBe([]);
});

test('notification can set title', function () {
    $notification = Notification::make()->title('Hello');

    expect($notification->title)->toBe('Hello');
});

test('notification can set body', function () {
    $notification = Notification::make('Title')->body('Hello World');

    expect($notification->body)->toBe('Hello World');
});

test('notification message is alias for body', function () {
    $notification = Notification::make('Title')->message('Alias Test');

    expect($notification->body)->toBe('Alias Test');
});

test('notification can set status to success', function () {
    $notification = Notification::make('Title')->success();

    expect($notification->status)->toBe('success');
});

test('notification can set status to info', function () {
    $notification = Notification::make('Title')->info();

    expect($notification->status)->toBe('info');
});

test('notification can set status to warning', function () {
    $notification = Notification::make('Title')->warning();

    expect($notification->status)->toBe('warning');
});

test('notification can set status to danger', function () {
    $notification = Notification::make('Title')->danger();

    expect($notification->status)->toBe('danger');
});

test('notification can set custom status', function () {
    $notification = Notification::make('Title')->status('custom');

    expect($notification->status)->toBe('custom');
});

test('notification can set icon', function () {
    $notification = Notification::make('Title')->icon('heroicon-o-check');

    expect($notification->icon)->toBe('heroicon-o-check');
});

test('notification can set icon color', function () {
    $notification = Notification::make('Title')->iconColor('#ff0000');

    expect($notification->iconColor)->toBe('#ff0000');
});

test('notification can set color', function () {
    $notification = Notification::make('Title')->color('success');

    expect($notification->color)->toBe('success');
});

test('notification can set position', function () {
    $notification = Notification::make('Title')->position('bottom-left');

    expect($notification->position)->toBe('bottom-left');
});

test('notification can set duration in milliseconds', function () {
    $notification = Notification::make('Title')->duration(3000);

    expect($notification->duration)->toBe(3000);
});

test('notification can set duration in seconds', function () {
    $notification = Notification::make('Title')->seconds(5);

    expect($notification->duration)->toBe(5000);
});

test('notification autoDismiss is alias for seconds', function () {
    $notification = Notification::make('Title')->autoDismiss(10);

    expect($notification->duration)->toBe(10000);
});

test('notification can be persistent', function () {
    $notification = Notification::make('Title')->persistent();

    expect($notification->persistent)->toBeTrue();
    expect($notification->duration)->toBe(0);
});

test('notification can set actions', function () {
    $notification = Notification::make('Title')->actions([
        ['name' => 'view', 'url' => '/posts/1'],
    ]);

    expect($notification->actions)->toHaveCount(1);
    expect($notification->actions[0]['name'])->toBe('view');
});

test('notification supports fluent chaining', function () {
    $notification = Notification::make()
        ->title('Title')
        ->body('Body')
        ->warning()
        ->icon('heroicon-o-bell')
        ->position('top-center')
        ->seconds(3);

    expect($notification->title)->toBe('Title');
    expect($notification->body)->toBe('Body');
    expect($notification->status)->toBe('warning');
    expect($notification->icon)->toBe('heroicon-o-bell');
    expect($notification->position)->toBe('top-center');
    expect($notification->duration)->toBe(3000);
});

test('notification serializes to json correctly', function () {
    $notification = Notification::make('Test')
        ->body('Body')
        ->info()
        ->position('bottom-right');

    $json = $notification->jsonSerialize();

    expect($json)->toBeArray();
    expect($json['title'])->toBe('Test');
    expect($json['body'])->toBe('Body');
    expect($json['status'])->toBe('info');
    expect($json['position'])->toBe('bottom-right');
    expect($json['id'])->toStartWith('notif-');
});

test('notification can get id', function () {
    $notification = Notification::make('Test');

    expect($notification->getId())->toBe($notification->id);
});

test('notification can be json encoded', function () {
    $notification = Notification::make('Test');

    $encoded = json_encode($notification);

    expect($encoded)->toBeString();
    expect(json_decode($encoded, true)['title'])->toBe('Test');
});
</file>

<file path="tests/Unit/SEOTest.php">
<?php

declare(strict_types=1);

use Accelade\SEO\SEO;

test('seo can set title', function () {
    $seo = new SEO;
    $seo->title('My Page Title');

    expect($seo->getTitle())->toBe('My Page Title');
});

test('seo can set description', function () {
    $seo = new SEO;
    $seo->description('This is a description');

    expect($seo->getDescription())->toBe('This is a description');
});

test('seo can set keywords as string', function () {
    $seo = new SEO;
    $seo->keywords('php, laravel, accelade');

    expect($seo->getKeywords())->toBe(['php', 'laravel', 'accelade']);
});

test('seo can set keywords as array', function () {
    $seo = new SEO;
    $seo->keywords(['php', 'laravel', 'accelade']);

    expect($seo->getKeywords())->toBe(['php', 'laravel', 'accelade']);
});

test('seo can set canonical url', function () {
    $seo = new SEO;
    $seo->canonical('https://example.com/page');

    expect($seo->getCanonical())->toBe('https://example.com/page');
});

test('seo can set robots meta', function () {
    $seo = new SEO;
    $seo->robots('index, follow');

    expect($seo->getRobots())->toBe('index, follow');
});

test('seo can set author meta', function () {
    $seo = new SEO;
    $seo->author('John Doe');

    expect($seo->getAuthor())->toBe('John Doe');
});

test('seo can set opengraph type', function () {
    $seo = new SEO;
    $seo->openGraphType('article');

    $og = $seo->getOpenGraph();
    expect($og['type'])->toBe('article');
});

test('seo can set opengraph site name', function () {
    $seo = new SEO;
    $seo->openGraphSiteName('My Website');

    $og = $seo->getOpenGraph();
    expect($og['site_name'])->toBe('My Website');
});

test('seo can set opengraph title', function () {
    $seo = new SEO;
    $seo->openGraphTitle('OG Title');

    $og = $seo->getOpenGraph();
    expect($og['title'])->toBe('OG Title');
});

test('seo can set opengraph description', function () {
    $seo = new SEO;
    $seo->openGraphDescription('OG Description');

    $og = $seo->getOpenGraph();
    expect($og['description'])->toBe('OG Description');
});

test('seo can set opengraph url', function () {
    $seo = new SEO;
    $seo->openGraphUrl('https://example.com');

    $og = $seo->getOpenGraph();
    expect($og['url'])->toBe('https://example.com');
});

test('seo can set opengraph image', function () {
    $seo = new SEO;
    $seo->openGraphImage('https://example.com/image.jpg', 'Image Alt');

    $og = $seo->getOpenGraph();
    expect($og['image'])->toBe('https://example.com/image.jpg');
    expect($og['image:alt'])->toBe('Image Alt');
});

test('seo can set opengraph locale', function () {
    $seo = new SEO;
    $seo->openGraphLocale('en_US');

    $og = $seo->getOpenGraph();
    expect($og['locale'])->toBe('en_US');
});

test('seo can set twitter card type', function () {
    $seo = new SEO;
    $seo->twitterCard('summary_large_image');

    $twitter = $seo->getTwitter();
    expect($twitter['card'])->toBe('summary_large_image');
});

test('seo can set twitter site', function () {
    $seo = new SEO;
    $seo->twitterSite('@mysite');

    $twitter = $seo->getTwitter();
    expect($twitter['site'])->toBe('@mysite');
});

test('seo can set twitter creator', function () {
    $seo = new SEO;
    $seo->twitterCreator('@johndoe');

    $twitter = $seo->getTwitter();
    expect($twitter['creator'])->toBe('@johndoe');
});

test('seo can set twitter title', function () {
    $seo = new SEO;
    $seo->twitterTitle('Twitter Title');

    $twitter = $seo->getTwitter();
    expect($twitter['title'])->toBe('Twitter Title');
});

test('seo can set twitter description', function () {
    $seo = new SEO;
    $seo->twitterDescription('Twitter Description');

    $twitter = $seo->getTwitter();
    expect($twitter['description'])->toBe('Twitter Description');
});

test('seo can set twitter image', function () {
    $seo = new SEO;
    $seo->twitterImage('https://example.com/twitter.jpg', 'Twitter Image');

    $twitter = $seo->getTwitter();
    expect($twitter['image'])->toBe('https://example.com/twitter.jpg');
    expect($twitter['image:alt'])->toBe('Twitter Image');
});

test('seo can add meta by name', function () {
    $seo = new SEO;
    $seo->metaByName('viewport', 'width=device-width, initial-scale=1');

    $meta = $seo->getMeta();
    expect($meta)->toHaveCount(1);
    expect($meta[0]['type'])->toBe('name');
    expect($meta[0]['key'])->toBe('viewport');
    expect($meta[0]['value'])->toBe('width=device-width, initial-scale=1');
});

test('seo can add meta by property', function () {
    $seo = new SEO;
    $seo->metaByProperty('article:author', 'John Doe');

    $meta = $seo->getMeta();
    expect($meta)->toHaveCount(1);
    expect($meta[0]['type'])->toBe('property');
    expect($meta[0]['key'])->toBe('article:author');
    expect($meta[0]['value'])->toBe('John Doe');
});

test('seo can add custom meta with attributes', function () {
    $seo = new SEO;
    $seo->meta(['http-equiv' => 'refresh', 'content' => '30']);

    $meta = $seo->getMeta();
    expect($meta)->toHaveCount(1);
    expect($meta[0]['type'])->toBe('custom');
    expect($meta[0]['attributes'])->toBe(['http-equiv' => 'refresh', 'content' => '30']);
});

test('seo supports fluent chaining', function () {
    $seo = new SEO;
    $result = $seo
        ->title('Title')
        ->description('Description')
        ->keywords('php, laravel')
        ->canonical('https://example.com')
        ->robots('index, follow')
        ->author('John')
        ->openGraphType('article')
        ->twitterCard('summary');

    expect($result)->toBeInstanceOf(SEO::class);
    expect($seo->getTitle())->toBe('Title');
    expect($seo->getDescription())->toBe('Description');
    expect($seo->getKeywords())->toBe(['php', 'laravel']);
    expect($seo->getCanonical())->toBe('https://example.com');
    expect($seo->getRobots())->toBe('index, follow');
    expect($seo->getAuthor())->toBe('John');
});

test('seo can reset all values', function () {
    $seo = new SEO;
    $seo
        ->title('Title')
        ->description('Description')
        ->keywords(['php'])
        ->canonical('https://example.com')
        ->robots('noindex')
        ->author('John')
        ->openGraphType('article')
        ->twitterCard('summary')
        ->metaByName('custom', 'value');

    $seo->reset();

    expect($seo->getTitle())->toBeNull();
    expect($seo->getDescription())->toBeNull();
    expect($seo->getKeywords())->toBe([]);
    expect($seo->getCanonical())->toBeNull();
    expect($seo->getRobots())->toBeNull();
    expect($seo->getAuthor())->toBeNull();
    expect($seo->getMeta())->toBe([]);
});

test('seo can convert to array', function () {
    $seo = new SEO;
    $seo
        ->title('Title')
        ->description('Description')
        ->robots('index');

    $array = $seo->toArray();

    expect($array)->toBeArray();
    expect($array)->toHaveKeys(['title', 'description', 'keywords', 'canonical', 'robots', 'author', 'openGraph', 'twitter', 'meta']);
});

test('seo generates html with title', function () {
    $seo = new SEO;
    $seo->title('My Title');

    $html = $seo->toHtml();

    expect($html)->toContain('<title>My Title</title>');
});

test('seo generates html with description', function () {
    $seo = new SEO;
    $seo->description('My description');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="description" content="My description">');
});

test('seo generates html with keywords', function () {
    $seo = new SEO;
    $seo->keywords(['php', 'laravel', 'accelade']);

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="keywords" content="php, laravel, accelade">');
});

test('seo generates html with robots', function () {
    $seo = new SEO;
    $seo->robots('index, follow');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="robots" content="index, follow">');
});

test('seo generates html with author', function () {
    $seo = new SEO;
    $seo->author('John Doe');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="author" content="John Doe">');
});

test('seo generates html with canonical link', function () {
    $seo = new SEO;
    $seo->canonical('https://example.com/page');

    $html = $seo->toHtml();

    expect($html)->toContain('<link rel="canonical" href="https://example.com/page">');
});

test('seo generates html with opengraph tags', function () {
    $seo = new SEO;
    $seo
        ->openGraphType('article')
        ->openGraphSiteName('My Site')
        ->openGraphTitle('OG Title')
        ->openGraphDescription('OG Description')
        ->openGraphUrl('https://example.com')
        ->openGraphImage('https://example.com/image.jpg', 'Alt Text')
        ->openGraphLocale('en_US');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta property="og:type" content="article">');
    expect($html)->toContain('<meta property="og:site:name" content="My Site">');
    expect($html)->toContain('<meta property="og:title" content="OG Title">');
    expect($html)->toContain('<meta property="og:description" content="OG Description">');
    expect($html)->toContain('<meta property="og:url" content="https://example.com">');
    expect($html)->toContain('<meta property="og:image" content="https://example.com/image.jpg">');
    expect($html)->toContain('<meta property="og:image:alt" content="Alt Text">');
    expect($html)->toContain('<meta property="og:locale" content="en_US">');
});

test('seo generates html with twitter tags', function () {
    $seo = new SEO;
    $seo
        ->twitterCard('summary_large_image')
        ->twitterSite('@mysite')
        ->twitterCreator('@johndoe')
        ->twitterTitle('Twitter Title')
        ->twitterDescription('Twitter Description')
        ->twitterImage('https://example.com/twitter.jpg', 'Twitter Alt');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="twitter:card" content="summary_large_image">');
    expect($html)->toContain('<meta name="twitter:site" content="@mysite">');
    expect($html)->toContain('<meta name="twitter:creator" content="@johndoe">');
    expect($html)->toContain('<meta name="twitter:title" content="Twitter Title">');
    expect($html)->toContain('<meta name="twitter:description" content="Twitter Description">');
    expect($html)->toContain('<meta name="twitter:image" content="https://example.com/twitter.jpg">');
    expect($html)->toContain('<meta name="twitter:image:alt" content="Twitter Alt">');
});

test('seo generates html with custom meta by name', function () {
    $seo = new SEO;
    $seo->metaByName('viewport', 'width=device-width');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta name="viewport" content="width=device-width">');
});

test('seo generates html with custom meta by property', function () {
    $seo = new SEO;
    $seo->metaByProperty('article:author', 'John Doe');

    $html = $seo->toHtml();

    expect($html)->toContain('<meta property="article:author" content="John Doe">');
});

test('seo generates html with custom meta attributes', function () {
    $seo = new SEO;
    $seo->meta(['http-equiv' => 'refresh', 'content' => '30']);

    $html = $seo->toHtml();

    expect($html)->toContain('<meta http-equiv="refresh" content="30">');
});

test('seo escapes html entities in output', function () {
    $seo = new SEO;
    $seo->title('<script>alert("xss")</script>');

    $html = $seo->toHtml();

    expect($html)->not->toContain('<script>');
    expect($html)->toContain('&lt;script&gt;');
});

test('seo render is alias for toHtml', function () {
    $seo = new SEO;
    $seo->title('Test');

    expect($seo->render())->toBe($seo->toHtml());
});

test('seo can be cast to string', function () {
    $seo = new SEO;
    $seo->title('Test');

    expect((string) $seo)->toBe($seo->toHtml());
});

test('seo implements htmlable interface', function () {
    $seo = new SEO;

    expect($seo)->toBeInstanceOf(\Illuminate\Contracts\Support\Htmlable::class);
});

test('seo implements arrayable interface', function () {
    $seo = new SEO;

    expect($seo)->toBeInstanceOf(\Illuminate\Contracts\Support\Arrayable::class);
});
</file>

<file path="tests/Unit/SharedDataTest.php">
<?php

declare(strict_types=1);

use Accelade\Support\SharedData;

describe('SharedData', function () {
    beforeEach(function () {
        $this->sharedData = new SharedData;
    });

    describe('share', function () {
        it('can share a single value', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->get('key'))->toBe('value');
        });

        it('can share multiple values at once', function () {
            $this->sharedData->share([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);

            expect($this->sharedData->get('key1'))->toBe('value1')
                ->and($this->sharedData->get('key2'))->toBe('value2');
        });

        it('can share a closure for lazy evaluation', function () {
            $called = false;
            $this->sharedData->share('lazy', function () use (&$called) {
                $called = true;

                return 'lazy value';
            });

            expect($called)->toBeFalse();

            $value = $this->sharedData->get('lazy');

            expect($called)->toBeTrue()
                ->and($value)->toBe('lazy value');
        });

        it('evaluates closure only once', function () {
            $count = 0;
            $this->sharedData->share('counter', function () use (&$count) {
                $count++;

                return $count;
            });

            $this->sharedData->get('counter');
            $this->sharedData->get('counter');

            expect($count)->toBe(1);
        });

        it('returns self for fluent interface', function () {
            $result = $this->sharedData->share('key', 'value');

            expect($result)->toBe($this->sharedData);
        });
    });

    describe('get', function () {
        it('returns default value when key does not exist', function () {
            expect($this->sharedData->get('missing', 'default'))->toBe('default');
        });

        it('returns null when key does not exist and no default', function () {
            expect($this->sharedData->get('missing'))->toBeNull();
        });

        it('can get nested values with dot notation', function () {
            $this->sharedData->share('user', [
                'name' => 'John',
                'email' => 'john@example.com',
            ]);

            // Note: get() doesn't support dot notation by default in SharedData
            // but this tests the basic nested array access
            $user = $this->sharedData->get('user');
            expect($user['name'])->toBe('John');
        });
    });

    describe('has', function () {
        it('returns true when key exists', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->has('key'))->toBeTrue();
        });

        it('returns false when key does not exist', function () {
            expect($this->sharedData->has('missing'))->toBeFalse();
        });

        it('returns true for lazy values', function () {
            $this->sharedData->share('lazy', fn () => 'value');

            expect($this->sharedData->has('lazy'))->toBeTrue();
        });
    });

    describe('forget', function () {
        it('can remove a shared value', function () {
            $this->sharedData->share('key', 'value');
            $this->sharedData->forget('key');

            expect($this->sharedData->has('key'))->toBeFalse();
        });

        it('can remove a lazy value', function () {
            $this->sharedData->share('lazy', fn () => 'value');
            $this->sharedData->forget('lazy');

            expect($this->sharedData->has('lazy'))->toBeFalse();
        });

        it('returns self for fluent interface', function () {
            $result = $this->sharedData->forget('key');

            expect($result)->toBe($this->sharedData);
        });
    });

    describe('flush', function () {
        it('removes all shared data', function () {
            $this->sharedData->share([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);
            $this->sharedData->share('lazy', fn () => 'value');

            $this->sharedData->flush();

            expect($this->sharedData->count())->toBe(0)
                ->and($this->sharedData->isEmpty())->toBeTrue();
        });
    });

    describe('all', function () {
        it('returns all shared data as array', function () {
            $this->sharedData->share([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);

            $all = $this->sharedData->all();

            expect($all)->toBe([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);
        });

        it('resolves lazy values when getting all', function () {
            $this->sharedData->share('lazy', fn () => 'lazy value');

            $all = $this->sharedData->all();

            expect($all)->toBe(['lazy' => 'lazy value']);
        });
    });

    describe('merge', function () {
        it('merges additional data', function () {
            $this->sharedData->share('key1', 'value1');
            $this->sharedData->merge(['key2' => 'value2']);

            expect($this->sharedData->all())->toBe([
                'key1' => 'value1',
                'key2' => 'value2',
            ]);
        });

        it('overwrites existing keys', function () {
            $this->sharedData->share('key', 'old');
            $this->sharedData->merge(['key' => 'new']);

            expect($this->sharedData->get('key'))->toBe('new');
        });
    });

    describe('count and empty checks', function () {
        it('counts shared items correctly', function () {
            expect($this->sharedData->count())->toBe(0);

            $this->sharedData->share('key1', 'value1');
            expect($this->sharedData->count())->toBe(1);

            $this->sharedData->share('lazy', fn () => 'value');
            expect($this->sharedData->count())->toBe(2);
        });

        it('isEmpty returns true when empty', function () {
            expect($this->sharedData->isEmpty())->toBeTrue();
        });

        it('isEmpty returns false when not empty', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->isEmpty())->toBeFalse();
        });

        it('isNotEmpty returns true when not empty', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->isNotEmpty())->toBeTrue();
        });
    });

    describe('serialization', function () {
        it('can convert to array', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->toArray())->toBe(['key' => 'value']);
        });

        it('can convert to JSON', function () {
            $this->sharedData->share('key', 'value');

            expect($this->sharedData->toJson())->toBe('{"key":"value"}');
        });

        it('can be JSON serialized', function () {
            $this->sharedData->share('key', 'value');

            expect(json_encode($this->sharedData))->toBe('{"key":"value"}');
        });

        it('resolves lazy values in JSON', function () {
            $this->sharedData->share('lazy', fn () => 'lazy value');

            expect($this->sharedData->toJson())->toBe('{"lazy":"lazy value"}');
        });
    });
});
</file>

<file path="tests/Pest.php">
<?php

declare(strict_types=1);

use Accelade\Tests\TestCase;

pest()->extend(TestCase::class)->in('Unit', 'Feature');
</file>

<file path="CLAUDE.md">
# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Accelade is a Laravel package that adds reactivity to Blade templates without requiring a full SPA framework. It provides a hybrid architecture combining server-rendered Blade with client-side reactivity, supporting multiple frontend frameworks (Vanilla JS, Vue, React, Svelte, Angular) through a unified adapter system.

## Common Commands

### Development & Building
```bash
npm run dev              # Start Vite dev server
npm run build            # Build unified JS bundle (all frameworks)
npm run build:all        # Build all framework-specific bundles
npm run typecheck        # Run TypeScript type checking
```

### Testing
```bash
# PHP tests (Pest)
composer test                                    # Run all tests
vendor/bin/pest tests/Unit/AcceladeTest.php     # Run specific test file
vendor/bin/pest --filter=testName               # Filter by test name

# E2E tests (Playwright)
npm run test                                     # Run all E2E tests
npm run test:e2e:ui                             # Run with interactive UI
npm run test:e2e:headed                         # Run in headed browser
npm run test:install                            # Install Playwright browsers
```

### Code Quality
```bash
composer format              # Format PHP with Pint
composer format:test         # Check formatting without fixing
composer mago                # Run Mago linter on src/
composer analyse             # Run format check + Mago
composer ci                  # Full CI: analyse + test
```

## Architecture

### Hybrid Server-Client Design
- **PHP Backend**: Blade directives (`@accelade`, `@endaccelade`) compile reactive components with state serialized to `data-accelade-*` attributes
- **JS Frontend**: Detects framework at runtime, initializes components, binds reactivity

### Key PHP Components
- `AcceladeServiceProvider` - Registers singletons (`accelade`, `accelade.notify`), Blade directives, and component namespace
- `Accelade` - Main class managing component stack, script/style generation, state serialization
- `AcceladeTagCompiler` - Blade precompiler transforming `<x-accelade:*>` tags
- `NotificationManager` - Session-based toast notifications persisting across redirects

### Key TypeScript Components (resources/js/)
- `index.ts` - Unified entry point, exports all framework adapters
- `adapters/` - Framework-specific implementations (Vanilla, Vue, React, Svelte, Angular)
- `core/router.ts` - SPA navigation intercepting links
- `core/progress.ts` - Progress bar during navigation
- `core/notification/` - Client-side toast rendering

### Build System
Vite builds framework bundles in multiple modes:
- `--mode unified` (default): Single bundle including all frameworks
- `--mode vanilla|vue|react`: Framework-specific bundles

Output goes to `dist/` as IIFE and ESM formats.

### Test Structure
- `tests/Unit/` - Unit tests for core classes
- `tests/Feature/` - Feature tests for service provider, routes, facades
- `tests/e2e/` - Playwright E2E tests (require `ACCELADE_TEST_URL`)

Tests use Orchestra Testbench via `tests/TestCase.php`.

## Framework Adapter Pattern

Each framework adapter implements `IFrameworkAdapter` with:
- `IStateAdapter` - Framework-specific reactive state (Proxy, Vue reactive, React useState)
- `IBindingAdapter` - DOM binding for directives (`a-text`, `a-model`, `@click`, etc.)

Adapters are registered with priority in `FrameworkRegistry`; detection happens at runtime.

## Blade Directive Syntax

```blade
@accelade(['count' => 0])
    <button @click="$set('count', count + 1)">
        Clicked <span a-text="count">0</span> times
    </button>
@endaccelade
```

Framework-specific prefixes: `a-` (Vanilla), `v-` (Vue), `data-state-` (React), `s-` (Svelte), `ng-` (Angular).
Event binding uses `@event` syntax across all frameworks (e.g., `@click`, `@submit`, `@input`).

## Configuration

Key config options in `config/accelade.php`:
- `framework` - Default framework (vanilla, vue, react, svelte, angular)
- `asset_mode` - 'route' (serve via Laravel) or 'published' (public/vendor)
- `progress` - SPA navigation progress bar styling
- `demo.enabled` - Enable demo routes (disabled in production by default)
</file>

<file path="CODE_OF_CONDUCT.md">
# Contributor Covenant Code of Conduct

## Our Pledge

We as members, contributors, and leaders pledge to make participation in our
community a harassment-free experience for everyone, regardless of age, body
size, visible or invisible disability, ethnicity, sex characteristics, gender
identity and expression, level of experience, education, socio-economic status,
nationality, personal appearance, race, religion, or sexual identity
and orientation.

We pledge to act and interact in ways that contribute to an open, welcoming,
diverse, inclusive, and healthy community.

## Our Standards

Examples of behavior that contributes to a positive environment for our
community include:

* Demonstrating empathy and kindness toward other people
* Being respectful of differing opinions, viewpoints, and experiences
* Giving and gracefully accepting constructive feedback
* Accepting responsibility and apologizing to those affected by our mistakes,
  and learning from the experience
* Focusing on what is best not just for us as individuals, but for the
  overall community

Examples of unacceptable behavior include:

* The use of sexualized language or imagery, and sexual attention or
  advances of any kind
* Trolling, insulting or derogatory comments, and personal or political attacks
* Public or private harassment
* Publishing others' private information, such as a physical or email
  address, without their explicit permission
* Other conduct which could reasonably be considered inappropriate in a
  professional setting

## Enforcement Responsibilities

Community leaders are responsible for clarifying and enforcing our standards of
acceptable behavior and will take appropriate and fair corrective action in
response to any behavior that they deem inappropriate, threatening, offensive,
or harmful.

## Scope

This Code of Conduct applies within all community spaces, and also applies when
an individual is officially representing the community in public spaces.

## Enforcement

Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported to the community leaders responsible for enforcement.

All complaints will be reviewed and investigated promptly and fairly.

All community leaders are obligated to respect the privacy and security of the
reporter of any incident.

## Attribution

This Code of Conduct is adapted from the [Contributor Covenant](https://www.contributor-covenant.org),
version 2.0, available at https://www.contributor-covenant.org/version/2/0/code_of_conduct.html.
</file>

<file path="CONTRIBUTING.md">
# Contributing to Accelade

Thank you for considering contributing to Accelade! This document outlines the process for contributing to this project.

## Code of Conduct

By participating in this project, you agree to maintain a respectful and inclusive environment for everyone.

## How Can I Contribute?

### Reporting Bugs

Before creating a bug report, please check existing issues to avoid duplicates.

When creating a bug report, include:

- **Clear title** describing the issue
- **Steps to reproduce** the behavior
- **Expected behavior** vs actual behavior
- **Screenshots** if applicable
- **Environment details**:
  - PHP version
  - Laravel version
  - Accelade version
  - Browser (for frontend issues)

### Suggesting Features

Feature requests are welcome! Please:

1. Check if the feature has already been suggested
2. Provide a clear use case
3. Explain why this would benefit other users

### Pull Requests

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/my-feature`
3. Make your changes
4. Run tests and code quality checks
5. Commit with a descriptive message
6. Push and open a Pull Request

## Development Setup

### Prerequisites

- PHP 8.2+
- Composer
- Node.js 18+
- npm

### Installation

```bash
# Clone your fork
git clone https://github.com/YOUR_USERNAME/accelade.git
cd accelade

# Install dependencies
composer install
npm install

# Build assets
npm run build
```

### Running Tests

```bash
# Run all tests
composer test

# Run with coverage
composer test:coverage

# Run specific test file
./vendor/bin/pest tests/Unit/NotificationTest.php

# Run specific test
./vendor/bin/pest --filter="notification can set title"
```

### Code Quality

```bash
# Format code with Laravel Pint
composer format

# Check formatting (no changes)
composer format:test

# Run Mago static analysis
composer mago

# Fix Mago issues automatically
composer mago:fix

# Run all checks
composer analyse

# Full CI pipeline (analyse + test)
composer ci
```

### E2E Tests

```bash
# Install Playwright browsers
npx playwright install chromium

# Run E2E tests
npm run test:e2e

# Run with headed browser
npm run test:e2e -- --headed

# Debug mode
npx playwright test --debug
```

## Coding Standards

### PHP

- Follow PSR-12 coding standards
- Use `declare(strict_types=1)` in all PHP files
- Add type hints for parameters and return types
- Use Laravel Pint for formatting

### TypeScript/JavaScript

- Use TypeScript for all new code
- Follow existing code style
- Add JSDoc comments for public APIs

### Commits

- Use clear, descriptive commit messages
- Reference issues when applicable: `Fix #123`
- Keep commits focused and atomic

### Pull Request Guidelines

1. **Title**: Clear and descriptive (e.g., "Add support for custom notification icons")
2. **Description**: Explain what and why, not just how
3. **Tests**: Include tests for new features and bug fixes
4. **Documentation**: Update docs if needed
5. **Breaking Changes**: Clearly document any breaking changes

## Project Structure

```
accelade/
├── src/                    # PHP source code
│   ├── Facades/           # Laravel facades
│   ├── Http/              # Controllers
│   ├── Notification/      # Notification system
│   └── View/              # Blade components
├── resources/
│   ├── js/                # TypeScript source
│   │   ├── core/         # Shared utilities
│   │   ├── vanilla/      # Vanilla JS adapter
│   │   ├── vue/          # Vue adapter
│   │   └── react/        # React adapter
│   └── views/            # Blade templates
├── tests/
│   ├── Unit/             # Unit tests
│   ├── Feature/          # Feature tests
│   └── e2e/              # Playwright E2E tests
├── config/               # Package config
├── routes/               # Route definitions
└── docs/                 # Documentation
```

## Testing Guidelines

### Unit Tests

Test individual classes in isolation:

```php
it('can create a notification with title', function () {
    $notification = Notification::make()->title('Test');

    expect($notification->title)->toBe('Test');
});
```

### Feature Tests

Test integration with Laravel:

```php
it('stores notifications in session', function () {
    Notify::success('Test')->body('Body');

    $notifications = Notify::flush();

    expect($notifications)->toHaveCount(1);
});
```

### E2E Tests

Test browser functionality:

```typescript
test('shows success notification', async ({ page }) => {
    await page.goto('/demo/vanilla');
    await page.click('[data-testid="notify-success"]');

    const notification = page.locator('.accelade-notification');
    await expect(notification).toBeVisible();
});
```

## Release Process

1. Update CHANGELOG.md
2. Update version in composer.json
3. Create a GitHub release with tag
4. Package is automatically published to Packagist

## Getting Help

- **Documentation**: [docs/](./docs/)
- **Issues**: [GitHub Issues](https://github.com/accelade/accelade/issues)
- **Discussions**: [GitHub Discussions](https://github.com/accelade/accelade/discussions)

## Recognition

Contributors will be recognized in:

- The README.md contributors section
- Release notes for significant contributions

Thank you for contributing!
</file>

<file path="LICENSE">
MIT License

Copyright (c) 2025 Fady Mondy <info@3x1.io>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</file>

<file path="mago.toml">
# Mago Configuration
# https://mago.carthage.software/

[source]
paths = ["src"]
excludes = ["vendor", "tests", "dist"]

# Disable some overly strict rules for this codebase
[linter.rules.too-many-methods]
enabled = false

[linter.rules.too-many-properties]
enabled = false

[linter.rules.kan-defect]
enabled = false

[linter.rules.cyclomatic-complexity]
enabled = false

[linter.rules.literal-named-argument]
enabled = false

[linter.rules.prefer-arrow-function]
enabled = false

[linter.rules.prefer-first-class-callable]
enabled = false

[linter.rules.prefer-static-closure]
enabled = false

[linter.rules.no-else-clause]
enabled = false

[linter.rules.no-empty]
enabled = false

[linter.rules.no-boolean-flag-parameter]
enabled = false

[linter.rules.prefer-early-continue]
enabled = false

[linter.rules.inline-variable-return]
enabled = false
</file>

<file path="phpunit.xml">
<?xml version="1.0" encoding="UTF-8"?>
<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="vendor/phpunit/phpunit/phpunit.xsd"
         bootstrap="vendor/autoload.php"
         colors="true"
         cacheDirectory=".phpunit.cache"
>
    <testsuites>
        <testsuite name="Unit">
            <directory>tests/Unit</directory>
        </testsuite>
        <testsuite name="Feature">
            <directory>tests/Feature</directory>
        </testsuite>
    </testsuites>
    <source>
        <include>
            <directory>src</directory>
        </include>
    </source>
</phpunit>
</file>

<file path="playwright.config.ts">
import { defineConfig, devices } from '@playwright/test';

/**
 * Accelade E2E Test Configuration
 *
 * Environment Variables:
 * - ACCELADE_TEST_URL: Base URL for tests (default: http://localhost:8000)
 * - CI: Set to true in CI environments for different retry/worker settings
 *
 * Usage:
 * - Local: npm run test:e2e
 * - CI: ACCELADE_TEST_URL=http://localhost:8000 npm run test:e2e
 */
export default defineConfig({
    testDir: './tests/e2e',
    fullyParallel: true,
    forbidOnly: !!process.env.CI,
    retries: process.env.CI ? 2 : 0,
    workers: process.env.CI ? 1 : undefined,
    reporter: process.env.CI ? 'github' : 'html',
    timeout: 30000,
    expect: {
        timeout: 5000,
    },
    use: {
        baseURL: process.env.ACCELADE_TEST_URL || 'http://localhost:8000',
        trace: 'on-first-retry',
        ignoreHTTPSErrors: true,
        screenshot: 'only-on-failure',
        video: 'retain-on-failure',
    },
    projects: [
        {
            name: 'chromium',
            use: { ...devices['Desktop Chrome'] },
        },
        // Uncomment for cross-browser testing
        // {
        //     name: 'firefox',
        //     use: { ...devices['Desktop Firefox'] },
        // },
        // {
        //     name: 'webkit',
        //     use: { ...devices['Desktop Safari'] },
        // },
    ],
    // Web server configuration for CI
    webServer: process.env.CI ? {
        command: 'cd ../.. && php artisan serve --port=8000',
        url: 'http://localhost:8000',
        reuseExistingServer: !process.env.CI,
        timeout: 120000,
    } : undefined,
});
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "strict": true,
    "jsx": "preserve",
    "declaration": true,
    "declarationDir": "./dist/types",
    "emitDeclarationOnly": false,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "baseUrl": ".",
    "paths": {
      "@/*": ["resources/js/*"]
    },
    "types": ["vite/client"]
  },
  "include": [
    "resources/js/**/*.ts",
    "resources/js/**/*.tsx"
  ],
  "exclude": [
    "node_modules",
    "dist"
  ]
}
</file>

<file path="vite.config.ts">
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import react from '@vitejs/plugin-react';
import { resolve } from 'path';

export default defineConfig(({ mode }) => {
    // Mode options:
    // - 'unified' (default): Single bundle with all frameworks
    // - 'vue': Vue-only bundle (legacy)
    // - 'react': React-only bundle (legacy)
    // - 'vanilla': Vanilla-only bundle (legacy)
    const isUnified = mode === 'unified' || mode === 'production';
    const isVue = mode === 'vue';
    const isReact = mode === 'react';
    const isVanilla = mode === 'vanilla';

    // Determine entry file and output name
    let entry: string;
    let fileName: string;

    if (isUnified) {
        // Unified build - includes all frameworks
        entry = resolve(__dirname, 'resources/js/index.ts');
        fileName = 'accelade';
    } else if (isVue) {
        entry = resolve(__dirname, 'resources/js/vue/accelade.ts');
        fileName = 'accelade-vue';
    } else if (isReact) {
        entry = resolve(__dirname, 'resources/js/react/accelade.tsx');
        fileName = 'accelade-react';
    } else {
        entry = resolve(__dirname, 'resources/js/vanilla/accelade.ts');
        fileName = 'accelade-vanilla';
    }

    // Plugins - always include Vue and React for unified build
    const plugins = [];
    if (isUnified || isVue) {
        plugins.push(vue());
    }
    if (isUnified || isReact) {
        plugins.push(react());
    }

    return {
        plugins,

        build: {
            lib: {
                entry,
                name: 'Accelade',
                fileName,
                formats: ['iife', 'es'] as const,
            },
            outDir: 'dist',
            emptyOutDir: isUnified, // Only empty for unified build
            rollupOptions: {
                // Bundle everything - no externals for standalone usage
                external: [],
                output: [
                    {
                        format: 'iife' as const,
                        entryFileNames: `${fileName}.js`,
                        assetFileNames: '[name].[ext]',
                        inlineDynamicImports: true,
                        name: 'AcceladeModule',
                        exports: 'named' as const,
                    },
                    {
                        format: 'es' as const,
                        entryFileNames: `${fileName}.esm.js`,
                        assetFileNames: '[name].[ext]',
                        inlineDynamicImports: true,
                        exports: 'named' as const,
                    },
                ],
            },
            sourcemap: true,
            minify: 'terser' as const,
            terserOptions: {
                compress: {
                    drop_console: false,
                },
            },
        },

        resolve: {
            alias: {
                '@': resolve(__dirname, 'resources/js'),
                // Use Vue's full build with runtime compiler for template support
                'vue': 'vue/dist/vue.esm-bundler.js',
            },
        },

        define: {
            'process.env.NODE_ENV': JSON.stringify('production'),
            'process.env': JSON.stringify({}),
            // Feature flags for Vue
            '__VUE_OPTIONS_API__': JSON.stringify(true),
            '__VUE_PROD_DEVTOOLS__': JSON.stringify(false),
            '__VUE_PROD_HYDRATION_MISMATCH_DETAILS__': JSON.stringify(false),
        },
    };
});
</file>

<file path=".github/workflows/dependabot-auto-merge.yml">
name: Dependabot Auto-Merge

on:
  pull_request:
    types: [opened, synchronize, reopened]

permissions:
  contents: write
  pull-requests: write

jobs:
  dependabot:
    runs-on: ubuntu-latest
    if: github.actor == 'dependabot[bot]'

    steps:
      - name: Dependabot metadata
        id: metadata
        uses: dependabot/fetch-metadata@v2
        with:
          github-token: "${{ secrets.GITHUB_TOKEN }}"

      - name: Auto-merge minor and patch updates
        if: steps.metadata.outputs.update-type == 'version-update:semver-patch' || steps.metadata.outputs.update-type == 'version-update:semver-minor'
        run: gh pr merge --auto --squash "$PR_URL"
        env:
          PR_URL: ${{ github.event.pull_request.html_url }}
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Auto-approve minor and patch updates
        if: steps.metadata.outputs.update-type == 'version-update:semver-patch' || steps.metadata.outputs.update-type == 'version-update:semver-minor'
        run: gh pr review --approve "$PR_URL"
        env:
          PR_URL: ${{ github.event.pull_request.html_url }}
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Comment on major updates
        if: steps.metadata.outputs.update-type == 'version-update:semver-major'
        run: |
          gh pr comment "$PR_URL" --body "This is a **major version update**. Please review carefully before merging."
        env:
          PR_URL: ${{ github.event.pull_request.html_url }}
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
</file>

<file path="docs/frameworks.md">
# Framework Adapters

Accelade supports multiple frontend frameworks. Each framework has its own binding syntax and reactivity system.

## Choosing a Framework

Set your framework in configuration:

```php
// config/accelade.php
'framework' => env('ACCELADE_FRAMEWORK', 'vanilla'),
```

Or via environment variable:

```env
ACCELADE_FRAMEWORK=vue
```

## Available Frameworks

| Framework | Value | Description |
|-----------|-------|-------------|
| Vanilla JS | `vanilla` | No dependencies, Proxy-based reactivity |
| Vue 3 | `vue` | Vue Composition API with reactive() |
| React 18 | `react` | React hooks with useState |
| Svelte 4 | `svelte` | Svelte stores with writable() |
| Angular 17+ | `angular` | Angular signals |

---

## Vanilla JavaScript

The default framework with zero dependencies.

### Binding Syntax

```blade
@accelade(['count' => 0, 'name' => ''])
    <span a-text="count">0</span>
    <input a-model="name">
    <div a-show="count > 0">Positive</div>
    <button @click="$set('count', count + 1)">+1</button>
@endaccelade
```

### Directive Prefix: `a-`

| Directive | Usage |
|-----------|-------|
| `a-text` | Text binding |
| `a-html` | HTML binding |
| `a-show` | Show/hide |
| `a-if` | Conditional |
| `a-model` | Two-way binding |
| `@event` | Event handler |
| `a-class` | Dynamic classes |
| `a-style` | Dynamic styles |
| `a-sync` | Server sync |

### Reactivity

Uses JavaScript Proxy for change detection:

```javascript
// Internal implementation
const state = new Proxy(initialState, {
    set(target, key, value) {
        target[key] = value;
        updateDOM();
        return true;
    }
});
```

---

## Vue 3

For Vue.js applications using Composition API.

### Binding Syntax

```blade
@accelade(['count' => 0, 'name' => ''])
    <span v-text="count">0</span>
    <input v-model="name">
    <div v-show="count > 0">Positive</div>
    <button @click="count++">+1</button>
@endaccelade
```

### Directive Prefix: `v-`

| Directive | Usage |
|-----------|-------|
| `v-text` | Text binding |
| `v-html` | HTML binding |
| `v-show` | Show/hide |
| `v-if` | Conditional |
| `v-model` | Two-way binding |
| `@event` | Event handler |
| `v-bind:class` | Dynamic classes |
| `v-bind:style` | Dynamic styles |

### Reactivity

Uses Vue's `reactive()` and `watch()`:

```javascript
import { reactive, watch } from 'vue';

const state = reactive(initialState);
watch(state, () => updateDOM(), { deep: true });
```

### Vue-Specific Features

```blade
{{-- Short syntax for events --}}
<button @click="count++">+1</button>

{{-- Short syntax for bindings --}}
<div :class="{ active: isActive }">

{{-- Computed-like expressions --}}
<span v-text="firstName + ' ' + lastName"></span>
```

---

## React 18

For React applications using hooks.

### Binding Syntax

```blade
@accelade(['count' => 0, 'name' => ''])
    <span state:text="count">0</span>
    <input state:model="name">
    <div state:show="count > 0">Positive</div>
    <button state:onClick="() => setCount(count + 1)">+1</button>
@endaccelade
```

### Directive Prefix: `state:`

| Directive | Usage |
|-----------|-------|
| `state:text` | Text binding |
| `state:html` | HTML binding |
| `state:show` | Show/hide |
| `state:if` | Conditional |
| `state:model` | Two-way binding |
| `state:onClick` | Click handler |
| `state:className` | Dynamic classes |
| `state:style` | Dynamic styles |

### Reactivity

Uses React's `useState` hooks:

```jsx
const [state, setState] = useState(initialState);

// Update function
const updateState = (key, value) => {
    setState(prev => ({ ...prev, [key]: value }));
};
```

### React-Specific Features

```blade
{{-- JSX-style event handlers --}}
<button state:onClick="handleClick">Click</button>

{{-- Callback pattern --}}
<button state:onClick="() => setCount(c => c + 1)">+1</button>
```

---

## Svelte 4

For Svelte applications using stores.

### Binding Syntax

```blade
@accelade(['count' => 0, 'name' => ''])
    <span bind:text="count">0</span>
    <input bind:value="name">
    <div bind:show="count > 0">Positive</div>
    <button on:click="() => count++">+1</button>
@endaccelade
```

### Directive Prefix: `bind:` / `on:`

| Directive | Usage |
|-----------|-------|
| `bind:text` | Text binding |
| `bind:html` | HTML binding |
| `bind:show` | Show/hide |
| `bind:if` | Conditional |
| `bind:value` | Two-way binding |
| `on:click` | Click handler |
| `class:name` | Dynamic classes |

### Reactivity

Uses Svelte's `writable` stores:

```javascript
import { writable } from 'svelte/store';

const state = writable(initialState);

state.subscribe(value => updateDOM(value));
```

### Svelte-Specific Features

```blade
{{-- Class directive --}}
<div class:active="isActive">

{{-- Store auto-subscription --}}
<span>{$count}</span>
```

---

## Angular 17+

For Angular applications using signals.

### Binding Syntax

```blade
@accelade(['count' => 0, 'name' => ''])
    <span ng-text="count">0</span>
    <input ng-model="name">
    <div ng-show="count > 0">Positive</div>
    <button @click="count = count + 1">+1</button>
@endaccelade
```

### Directive Prefix: `ng-`

| Directive | Usage |
|-----------|-------|
| `ng-text` | Text binding |
| `ng-html` | HTML binding |
| `ng-show` | Show/hide |
| `ng-if` | Conditional |
| `ng-model` | Two-way binding |
| `@click` | Click handler |
| `ng-class` | Dynamic classes |
| `ng-style` | Dynamic styles |

### Reactivity

Uses Angular's signals:

```typescript
import { signal, effect } from '@angular/core';

const count = signal(0);

effect(() => {
    updateDOM(count());
});
```

### Angular-Specific Features

```blade
{{-- Event binding with $event --}}
<input @input="handleInput($event)">

{{-- Two-way binding --}}
<input [(ngModel)]="name">
```

---

## Framework Comparison

| Feature | Vanilla | Vue | React | Svelte | Angular |
|---------|---------|-----|-------|--------|---------|
| Bundle Size | Smallest | Medium | Medium | Small | Large |
| Learning Curve | Easy | Medium | Medium | Easy | Hard |
| Reactivity | Proxy | reactive() | useState | writable | signal |
| Dependencies | None | Vue 3 | React 18 | Svelte 4 | Angular 17 |

## Switching Frameworks

When navigating between pages with different frameworks, a full page reload occurs to load the correct adapter.

```blade
{{-- On Vue page --}}
<x-accelade::link href="/react-page">
    Go to React
</x-accelade::link>
{{-- Full reload happens --}}
```

## Custom Framework Adapter

Create a custom adapter:

```typescript
// resources/js/custom/accelade.ts
import { createAdapter } from '../core/adapter';

export const customAdapter = createAdapter({
    name: 'custom',
    prefix: 'x-',

    createState(initial) {
        // Return reactive state
    },

    bindText(element, expression, state) {
        // Implement text binding
    },

    bindEvent(element, event, handler, state) {
        // Implement event binding
    },

    // ... other bindings
});
```

Register in Vite config:

```typescript
// vite.config.ts
build: {
    rollupOptions: {
        input: {
            'accelade-custom': 'resources/js/custom/accelade.ts'
        }
    }
}
```

## Best Practices

1. **Match Your Stack** - Use the framework you're already using
2. **Vanilla for Simple Sites** - No extra dependencies
3. **Consider Bundle Size** - Vanilla is smallest
4. **SSR Considerations** - All frameworks support SSR

## Next Steps

- [Components](components.md) - Creating components
- [Architecture](architecture.md) - How adapters work
- [API Reference](api-reference.md) - Complete API
</file>

<file path="resources/js/adapters/angular/AngularAdapter.ts">
/**
 * AngularAdapter - Framework adapter for Angular
 */

import { BaseAdapter } from '../BaseAdapter';
import type { IStateAdapter, IBindingAdapter, BindingAttributeMap } from '../types';
import { AngularStateAdapter } from './AngularStateAdapter';
import { AngularBindingAdapter } from './AngularBindingAdapter';

/**
 * Angular binding attribute map
 * Using ng-* prefix to avoid CSS selector issues with brackets/parens
 */
const ANGULAR_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 'ng-text',
    html: 'ng-html',
    show: 'ng-show',
    if: 'ng-if',
    model: 'ng-model',
    class: 'ng-class',
    style: 'ng-style',
    bind: 'ng-bind-',
    on: '@',
    cloak: 'ng-cloak',
};

/**
 * AngularAdapter - Uses Angular-style signals/RxJS for reactivity
 */
export class AngularAdapter extends BaseAdapter {
    readonly type = 'angular' as const;

    /**
     * Create an Angular state adapter
     */
    createStateAdapter(): IStateAdapter {
        return new AngularStateAdapter();
    }

    /**
     * Create an Angular binding adapter
     */
    createBindingAdapter(): IBindingAdapter {
        return new AngularBindingAdapter();
    }

    /**
     * Check if Angular is available
     */
    isAvailable(): boolean {
        if (typeof window !== 'undefined') {
            // Check for Angular global (ng)
            if ((window as unknown as Record<string, unknown>).ng) {
                return true;
            }

            // Check for ng-version attribute (Angular apps set this on root)
            const hasAngularApp = document.querySelector('[ng-version]') !== null;
            if (hasAngularApp) {
                return true;
            }

            // Check for Angular-specific attributes
            const hasAngularBindings = document.querySelector('[_nghost], [_ngcontent]') !== null;
            if (hasAngularBindings) {
                return true;
            }
        }

        return false;
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 'ng-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get alternate event prefix (ng-on- for backward compatibility)
     */
    protected getAltEventPrefix(): string | null {
        return 'ng-on-';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[ng-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attributes
     */
    getBindingAttributes(): BindingAttributeMap {
        return ANGULAR_BINDING_ATTRIBUTES;
    }
}

export default AngularAdapter;
</file>

<file path="resources/js/adapters/angular/AngularStateAdapter.ts">
/**
 * AngularStateAdapter - Angular signal/RxJS-based state management
 *
 * Provides Angular-compatible state management that can work with:
 * - Angular Signals (v16+)
 * - RxJS BehaviorSubject (older versions)
 * - Or standalone mode without Angular
 */

import type { IStateAdapter } from '../types';
import type { StateChangeCallback } from '../../core/types';

/**
 * Signal-like interface (Angular 16+ compatible)
 */
interface SignalLike<T> {
    (): T;
    set(value: T): void;
    update(fn: (value: T) => T): void;
}

/**
 * BehaviorSubject-like interface (RxJS compatible)
 */
interface BehaviorSubjectLike<T> {
    getValue(): T;
    next(value: T): void;
    subscribe(callback: (value: T) => void): { unsubscribe(): void };
}

/**
 * Create a minimal signal (Angular-like)
 */
function createSignal<T>(initialValue: T): SignalLike<T> {
    let value = initialValue;
    const subscribers = new Set<() => void>();

    const signal = (() => value) as SignalLike<T>;

    signal.set = (newValue: T) => {
        value = newValue;
        for (const subscriber of subscribers) {
            subscriber();
        }
    };

    signal.update = (fn: (value: T) => T) => {
        value = fn(value);
        for (const subscriber of subscribers) {
            subscriber();
        }
    };

    return signal;
}

/**
 * Create a minimal BehaviorSubject (RxJS-like)
 */
function createBehaviorSubject<T>(initialValue: T): BehaviorSubjectLike<T> {
    let value = initialValue;
    const subscribers = new Set<(value: T) => void>();

    return {
        getValue: () => value,
        next: (newValue: T) => {
            value = newValue;
            for (const subscriber of subscribers) {
                subscriber(value);
            }
        },
        subscribe: (callback: (value: T) => void) => {
            subscribers.add(callback);
            callback(value); // Emit current value immediately (BehaviorSubject behavior)
            return {
                unsubscribe: () => subscribers.delete(callback),
            };
        },
    };
}

/**
 * AngularStateAdapter - Uses Angular-style signals/observables for reactivity
 */
export class AngularStateAdapter implements IStateAdapter {
    private state: Record<string, unknown> = {};
    private originalState: Record<string, unknown> = {};
    private signals: Map<string, SignalLike<unknown>> = new Map();
    private subject: BehaviorSubjectLike<Record<string, unknown>> | null = null;
    private subscriptions: Array<{ unsubscribe(): void }> = [];
    private generalCallbacks: Set<{ callback: StateChangeCallback }> = new Set();
    private keyCallbacks: Map<string, Set<(newVal: unknown, oldVal: unknown) => void>> = new Map();

    /**
     * Initialize state
     */
    init(initialState: Record<string, unknown>): void {
        this.originalState = { ...initialState };
        this.state = { ...initialState };

        // Create signals for each key (Angular 16+ style)
        for (const [key, value] of Object.entries(initialState)) {
            this.signals.set(key, createSignal(value));
        }

        // Create a BehaviorSubject for the full state (RxJS style)
        this.subject = createBehaviorSubject(this.state);
    }

    /**
     * Notify subscribers of state change
     */
    private notifyChange(newValue: unknown, oldValue: unknown, key: string): void {
        // Notify general subscribers
        for (const sub of this.generalCallbacks) {
            sub.callback(newValue, oldValue, key);
        }

        // Notify key-specific subscribers
        const keySubs = this.keyCallbacks.get(key);
        if (keySubs) {
            for (const callback of keySubs) {
                callback(newValue, oldValue);
            }
        }
    }

    /**
     * Get current state snapshot
     */
    getState(): Record<string, unknown> {
        return { ...this.state };
    }

    /**
     * Get a specific state value (supports nested paths like "props.count")
     */
    get<T = unknown>(key: string): T | undefined {
        if (!key.includes('.')) {
            return this.state[key] as T | undefined;
        }

        // Handle nested path
        const parts = key.split('.');
        let current: unknown = this.state;
        for (const part of parts) {
            if (current === null || current === undefined) {
                return undefined;
            }
            current = (current as Record<string, unknown>)[part];
        }
        return current as T | undefined;
    }

    /**
     * Set a state value (supports nested paths like "props.count")
     */
    set(key: string, value: unknown): void {
        const oldValue = this.get(key);

        if (!key.includes('.')) {
            // Simple key
            this.state[key] = value;

            // Update the signal if it exists
            const signal = this.signals.get(key);
            if (signal) {
                signal.set(value);
            } else {
                this.signals.set(key, createSignal(value));
            }
        } else {
            // Handle nested path
            const parts = key.split('.');
            const lastKey = parts.pop()!;
            let current: Record<string, unknown> = this.state;

            for (const part of parts) {
                if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                    current[part] = {};
                }
                current = current[part] as Record<string, unknown>;
            }

            current[lastKey] = value;

            // Update the root signal
            const rootKey = parts[0];
            if (rootKey) {
                const signal = this.signals.get(rootKey);
                if (signal) {
                    signal.set(this.state[rootKey]);
                }
            }
        }

        // Update the BehaviorSubject
        if (this.subject) {
            this.subject.next({ ...this.state });
        }

        if (oldValue !== value) {
            this.notifyChange(value, oldValue, key);
        }
    }

    /**
     * Set multiple values at once
     */
    setMany(updates: Record<string, unknown>): void {
        for (const [key, value] of Object.entries(updates)) {
            const oldValue = this.state[key];
            this.state[key] = value;

            // Update or create signal
            const signal = this.signals.get(key);
            if (signal) {
                signal.set(value);
            } else {
                this.signals.set(key, createSignal(value));
            }

            if (oldValue !== value) {
                this.notifyChange(value, oldValue, key);
            }
        }

        // Update the BehaviorSubject once
        if (this.subject) {
            this.subject.next({ ...this.state });
        }
    }

    /**
     * Subscribe to all state changes
     */
    subscribe(callback: StateChangeCallback): () => void {
        const subscription = { callback };
        this.generalCallbacks.add(subscription);

        return () => {
            this.generalCallbacks.delete(subscription);
        };
    }

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void {
        let keySubs = this.keyCallbacks.get(key);
        if (!keySubs) {
            keySubs = new Set();
            this.keyCallbacks.set(key, keySubs);
        }
        keySubs.add(callback);

        return () => {
            keySubs?.delete(callback);
            if (keySubs?.size === 0) {
                this.keyCallbacks.delete(key);
            }
        };
    }

    /**
     * Get the reactive state (returns the BehaviorSubject for RxJS usage)
     */
    getReactiveState(): BehaviorSubjectLike<Record<string, unknown>> {
        return this.subject ?? createBehaviorSubject(this.state);
    }

    /**
     * Get a signal for a specific key (Angular 16+ usage)
     */
    getSignal<T = unknown>(key: string): SignalLike<T> | undefined {
        return this.signals.get(key) as SignalLike<T> | undefined;
    }

    /**
     * Get the BehaviorSubject for RxJS usage
     */
    getSubject(): BehaviorSubjectLike<Record<string, unknown>> | null {
        return this.subject;
    }

    /**
     * Get original state for reset operations
     */
    getOriginalState(): Record<string, unknown> {
        return { ...this.originalState };
    }

    /**
     * Check if key exists
     */
    has(key: string): boolean {
        return key in this.state;
    }

    /**
     * Get all keys
     */
    keys(): string[] {
        return Object.keys(this.state);
    }

    /**
     * Select a slice of state (Angular NgRx-like selector)
     */
    select<T>(selector: (state: Record<string, unknown>) => T): T {
        return selector(this.state);
    }

    /**
     * Dispose and cleanup
     */
    dispose(): void {
        // Unsubscribe all
        for (const sub of this.subscriptions) {
            sub.unsubscribe();
        }
        this.subscriptions = [];

        // Clear callbacks
        this.generalCallbacks.clear();
        this.keyCallbacks.clear();

        // Clear signals
        this.signals.clear();

        // Clear state
        this.subject = null;
        this.state = {};
        this.originalState = {};
    }
}

export default AngularStateAdapter;
</file>

<file path="resources/js/adapters/react/hooks.ts">
/**
 * React Hooks for Accelade
 */

import {
    useState,
    useEffect,
    useCallback,
    useMemo,
    useRef,
    type Dispatch,
    type SetStateAction,
} from 'react';
import type { AcceladeActions } from '../../core/types';
import { navigate, type NavigationOptions } from '../../core/router';
import { SyncFactory } from '../../core/factories/SyncFactory';

/**
 * State type
 */
type StateRecord = Record<string, unknown>;

/**
 * Custom methods type
 */
type CustomMethods = Record<string, (...args: unknown[]) => unknown>;

/**
 * Hook result type
 */
export interface UseAcceladeResult<T extends StateRecord> {
    state: T;
    setState: Dispatch<SetStateAction<T>>;
    actions: AcceladeActions;
    customMethods: CustomMethods;
    $set: (key: string, value: unknown) => void;
    $get: (key: string) => unknown;
    $toggle: (key: string) => void;
    $navigate: (url: string, options?: NavigationOptions) => Promise<boolean>;
}

/**
 * Options for useAccelade hook
 */
export interface UseAcceladeOptions {
    componentId?: string;
    syncProperties?: string[];
    scripts?: string[];
    debounceSync?: number;
}

/**
 * useAccelade hook - React-style state management for Accelade
 *
 * @example
 * ```tsx
 * function Counter() {
 *   const { state, actions } = useAccelade({ count: 0 });
 *   return (
 *     <div>
 *       <span>{state.count}</span>
 *       <button onClick={() => actions.increment('count')}>+</button>
 *     </div>
 *   );
 * }
 * ```
 */
export function useAccelade<T extends StateRecord>(
    initialState: T,
    options: UseAcceladeOptions = {}
): UseAcceladeResult<T> {
    const [state, setState] = useState<T>(initialState);
    const { componentId, syncProperties = [], scripts = [], debounceSync = 300 } = options;
    const customMethodsRef = useRef<CustomMethods>({});
    const originalStateRef = useRef<T>(initialState);
    const prevSyncValuesRef = useRef<Record<string, unknown>>({});

    // Sync effect - debounced
    useEffect(() => {
        if (!componentId || syncProperties.length === 0) return;

        // Check which properties changed
        const changedProps = syncProperties.filter((prop) => {
            const prevValue = prevSyncValuesRef.current[prop];
            const currentValue = state[prop];
            return prevValue !== currentValue;
        });

        if (changedProps.length === 0) return;

        // Update prev values
        for (const prop of changedProps) {
            prevSyncValuesRef.current[prop] = state[prop];
        }

        // Batch sync changed properties
        const updates: Record<string, unknown> = {};
        for (const prop of changedProps) {
            updates[prop] = state[prop];
        }

        void SyncFactory.batchSync(componentId, updates, { debounce: debounceSync });
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [componentId, debounceSync, ...syncProperties.map((prop) => state[prop])]);

    // Helper functions
    const $set = useCallback((key: string, value: unknown): void => {
        setState((prev) => ({ ...prev, [key]: value }));
    }, []);

    const $get = useCallback(
        (key: string): unknown => {
            return state[key];
        },
        [state]
    );

    const $toggle = useCallback((key: string): void => {
        setState((prev) => ({ ...prev, [key]: !prev[key] }));
    }, []);

    const $navigate = useCallback((url: string, options?: NavigationOptions): Promise<boolean> => {
        return navigate(url, options);
    }, []);

    // Actions
    const actions = useMemo<AcceladeActions>(
        () => ({
            increment: (key = 'count', amount = 1): void => {
                setState((prev) => ({
                    ...prev,
                    [key]: (parseInt(String(prev[key]), 10) || 0) + amount,
                }));
            },

            decrement: (key = 'count', amount = 1): void => {
                setState((prev) => ({
                    ...prev,
                    [key]: (parseInt(String(prev[key]), 10) || 0) - amount,
                }));
            },

            set: (key: string, value: unknown): void => {
                setState((prev) => ({ ...prev, [key]: value }));
            },

            toggle: (key: string): void => {
                setState((prev) => ({ ...prev, [key]: !prev[key] }));
            },

            reset: (key: string): void => {
                const original = originalStateRef.current;
                setState((prev) => ({
                    ...prev,
                    [key]:
                        typeof original[key] === 'number'
                            ? 0
                            : typeof original[key] === 'boolean'
                              ? false
                              : '',
                }));
            },

            get: (key: string): unknown => {
                return state[key];
            },

            // Aliases with $ prefix for template usage
            $set: (key: string, value: unknown): void => {
                setState((prev) => ({ ...prev, [key]: value }));
            },

            $get: (key: string): unknown => {
                return state[key];
            },

            $toggle: (key: string): void => {
                setState((prev) => ({ ...prev, [key]: !prev[key] }));
            },
        }),
        []
    );

    // Process scripts on mount
    useEffect(() => {
        scripts.forEach((code) => {
            if (!code.trim()) return;

            try {
                const scriptFn = new Function(
                    'state',
                    'setState',
                    'actions',
                    '$set',
                    '$get',
                    '$toggle',
                    '$navigate',
                    'initialState',
                    code
                ) as (
                    state: T,
                    setState: Dispatch<SetStateAction<T>>,
                    actions: AcceladeActions,
                    $set: (key: string, value: unknown) => void,
                    $get: (key: string) => unknown,
                    $toggle: (key: string) => void,
                    $navigate: (url: string, options?: NavigationOptions) => Promise<boolean>,
                    initialState: T
                ) => CustomMethods | void;

                const result = scriptFn(
                    state,
                    setState,
                    actions,
                    $set,
                    $get,
                    $toggle,
                    $navigate,
                    initialState
                );

                if (result && typeof result === 'object') {
                    Object.assign(customMethodsRef.current, result);
                }
            } catch (e) {
                console.error('Accelade React: Error executing script:', e);
            }
        });
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, []);

    return {
        state,
        setState,
        actions,
        customMethods: customMethodsRef.current,
        $set,
        $get,
        $toggle,
        $navigate,
    };
}

/**
 * useAcceladeSync - Simplified hook just for syncing state to server
 */
export function useAcceladeSync<T extends StateRecord>(
    componentId: string,
    state: T,
    syncProperties: string[],
    debounce = 300
): void {
    const prevValuesRef = useRef<Record<string, unknown>>({});

    useEffect(() => {
        const changedProps = syncProperties.filter((prop) => {
            return prevValuesRef.current[prop] !== state[prop];
        });

        if (changedProps.length === 0) return;

        // Update prev values
        for (const prop of changedProps) {
            prevValuesRef.current[prop] = state[prop];
        }

        // Batch sync
        const updates: Record<string, unknown> = {};
        for (const prop of changedProps) {
            updates[prop] = state[prop];
        }

        void SyncFactory.batchSync(componentId, updates, { debounce });
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [componentId, debounce, ...syncProperties.map((prop) => state[prop])]);
}

export default useAccelade;
</file>

<file path="resources/js/adapters/react/ReactAdapter.ts">
/**
 * ReactAdapter - Framework adapter for React
 */

import { BaseAdapter } from '../BaseAdapter';
import type { IStateAdapter, IBindingAdapter, BindingAttributeMap } from '../types';
import { ReactStateAdapter } from './ReactStateAdapter';
import { ReactBindingAdapter } from './ReactBindingAdapter';

/**
 * React binding attribute map
 * Using data-state-* format to avoid CSS selector issues with colons
 */
const REACT_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 'data-state-text',
    html: 'data-state-html',
    show: 'data-state-show',
    if: 'data-state-if',
    model: 'data-state-model',
    class: 'data-state-class',
    style: 'data-state-style',
    bind: 'data-state-',
    on: '@',
    cloak: 'data-accelade-cloak',
};

/**
 * ReactAdapter - Uses React's useState/useReducer for state management
 */
export class ReactAdapter extends BaseAdapter {
    readonly type = 'react' as const;

    /**
     * Create a React state adapter
     */
    createStateAdapter(): IStateAdapter {
        return new ReactStateAdapter();
    }

    /**
     * Create a React binding adapter
     */
    createBindingAdapter(): IBindingAdapter {
        return new ReactBindingAdapter();
    }

    /**
     * Check if React is available
     */
    isAvailable(): boolean {
        if (typeof window !== 'undefined') {
            // Check window.React global
            if ((window as unknown as Record<string, unknown>).React) {
                return true;
            }

            // Check for React root markers in DOM
            const hasReactRoot = document.querySelector('[data-reactroot]') !== null;
            if (hasReactRoot) {
                return true;
            }

            // Check for React 18+ root markers
            const hasReact18Root = document.querySelector('[data-react-root]') !== null;
            if (hasReact18Root) {
                return true;
            }
        }

        return false;
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 'data-state-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get alternate event prefix (data-on- for backward compatibility)
     */
    protected getAltEventPrefix(): string | null {
        return 'data-on-';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[state-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attributes
     */
    getBindingAttributes(): BindingAttributeMap {
        return REACT_BINDING_ATTRIBUTES;
    }
}

export default ReactAdapter;
</file>

<file path="resources/js/adapters/react/ReactStateAdapter.ts">
/**
 * ReactStateAdapter - React useState-based state management
 *
 * Note: This adapter is designed to work with React's hooks system.
 * Unlike Vue/Vanilla adapters, React requires component re-renders for state updates.
 * This adapter provides a bridge between the adapter interface and React's useState.
 */

import type { IStateAdapter } from '../types';
import type { StateChangeCallback } from '../../core/types';

/**
 * State setter function type (like React's setState)
 */
type StateSetter = (updater: Record<string, unknown> | ((prev: Record<string, unknown>) => Record<string, unknown>)) => void;

/**
 * ReactStateAdapter - Bridges IStateAdapter interface with React's useState
 *
 * Usage:
 * In a React component:
 * ```
 * const [state, setState] = useState(initialState);
 * const adapter = new ReactStateAdapter();
 * adapter.connectReactState(state, setState);
 * ```
 */
export class ReactStateAdapter implements IStateAdapter {
    private state: Record<string, unknown> = {};
    private originalState: Record<string, unknown> = {};
    private setState: StateSetter | null = null;
    private subscriptions: Set<{ callback: StateChangeCallback; key?: string }> = new Set();
    private keySubscriptions: Map<string, Set<(newVal: unknown, oldVal: unknown) => void>> = new Map();

    /**
     * Initialize state with given values
     */
    init(initialState: Record<string, unknown>): void {
        this.originalState = { ...initialState };
        this.state = { ...initialState };
    }

    /**
     * Connect to React's useState setter
     * Call this from within a React component to enable reactive updates
     */
    connectReactState(
        currentState: Record<string, unknown>,
        setter: StateSetter
    ): void {
        this.state = currentState;
        this.setState = setter;
    }

    /**
     * Update internal state reference (called from React component when state changes)
     */
    syncFromReact(newState: Record<string, unknown>): void {
        const oldState = { ...this.state };
        this.state = newState;

        // Notify subscribers of changes
        for (const key of Object.keys(newState)) {
            if (oldState[key] !== newState[key]) {
                this.notifyChange(newState[key], oldState[key], key);
            }
        }
    }

    /**
     * Notify subscribers of state change
     */
    private notifyChange(newValue: unknown, oldValue: unknown, key: string): void {
        // Notify general subscribers
        for (const sub of this.subscriptions) {
            if (!sub.key || sub.key === key) {
                sub.callback(newValue, oldValue, key);
            }
        }

        // Notify key-specific subscribers
        const keySubs = this.keySubscriptions.get(key);
        if (keySubs) {
            for (const callback of keySubs) {
                callback(newValue, oldValue);
            }
        }
    }

    /**
     * Get current state snapshot
     */
    getState(): Record<string, unknown> {
        return { ...this.state };
    }

    /**
     * Get a specific state value (supports nested paths like "props.count")
     */
    get<T = unknown>(key: string): T | undefined {
        if (!key.includes('.')) {
            return this.state[key] as T | undefined;
        }

        // Handle nested path
        const parts = key.split('.');
        let current: unknown = this.state;
        for (const part of parts) {
            if (current === null || current === undefined) {
                return undefined;
            }
            current = (current as Record<string, unknown>)[part];
        }
        return current as T | undefined;
    }

    /**
     * Set a state value (supports nested paths, triggers React re-render via setState)
     */
    set(key: string, value: unknown): void {
        const oldValue = this.get(key);

        if (!key.includes('.')) {
            // Simple key
            if (this.setState) {
                this.setState((prev) => ({ ...prev, [key]: value }));
            } else {
                this.state[key] = value;
            }
        } else {
            // Handle nested path
            const parts = key.split('.');
            const lastKey = parts.pop()!;

            if (this.setState) {
                this.setState((prev) => {
                    const newState = { ...prev };
                    let current: Record<string, unknown> = newState;

                    for (const part of parts) {
                        if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                            current[part] = {};
                        }
                        current[part] = { ...(current[part] as Record<string, unknown>) };
                        current = current[part] as Record<string, unknown>;
                    }

                    current[lastKey] = value;
                    return newState;
                });
            } else {
                let current: Record<string, unknown> = this.state;
                for (const part of parts) {
                    if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                        current[part] = {};
                    }
                    current = current[part] as Record<string, unknown>;
                }
                current[lastKey] = value;
            }
        }

        if (oldValue !== value) {
            this.notifyChange(value, oldValue, key);
        }
    }

    /**
     * Set multiple values at once
     */
    setMany(updates: Record<string, unknown>): void {
        if (this.setState) {
            this.setState((prev) => ({ ...prev, ...updates }));
        } else {
            Object.assign(this.state, updates);
        }

        // Notify for each changed key
        for (const [key, value] of Object.entries(updates)) {
            const oldValue = this.state[key];
            if (oldValue !== value) {
                this.notifyChange(value, oldValue, key);
            }
        }
    }

    /**
     * Subscribe to all state changes
     */
    subscribe(callback: StateChangeCallback): () => void {
        const subscription = { callback };
        this.subscriptions.add(subscription);

        return () => {
            this.subscriptions.delete(subscription);
        };
    }

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void {
        let keySubs = this.keySubscriptions.get(key);
        if (!keySubs) {
            keySubs = new Set();
            this.keySubscriptions.set(key, keySubs);
        }
        keySubs.add(callback);

        return () => {
            keySubs?.delete(callback);
            if (keySubs?.size === 0) {
                this.keySubscriptions.delete(key);
            }
        };
    }

    /**
     * Get the reactive state object
     * In React, this returns the current state object
     */
    getReactiveState(): Record<string, unknown> {
        return this.state;
    }

    /**
     * Get original state for reset operations
     */
    getOriginalState(): Record<string, unknown> {
        return { ...this.originalState };
    }

    /**
     * Check if key exists
     */
    has(key: string): boolean {
        return key in this.state;
    }

    /**
     * Get all keys
     */
    keys(): string[] {
        return Object.keys(this.state);
    }

    /**
     * Dispose and cleanup
     */
    dispose(): void {
        this.subscriptions.clear();
        this.keySubscriptions.clear();
        this.setState = null;
        this.state = {};
        this.originalState = {};
    }
}

export default ReactStateAdapter;
</file>

<file path="resources/js/adapters/svelte/SvelteAdapter.ts">
/**
 * SvelteAdapter - Framework adapter for Svelte
 */

import { BaseAdapter } from '../BaseAdapter';
import type { IStateAdapter, IBindingAdapter, BindingAttributeMap } from '../types';
import { SvelteStateAdapter } from './SvelteStateAdapter';
import { SvelteBindingAdapter } from './SvelteBindingAdapter';

/**
 * Svelte binding attribute map
 * Using s-* prefix to avoid CSS selector issues with colons
 */
const SVELTE_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 's-text',
    html: 's-html',
    show: 's-show',
    if: 's-if',
    model: 's-model',
    class: 's-class',
    style: 's-style',
    bind: 's-bind-',
    on: '@',
    cloak: 's-cloak',
};

/**
 * SvelteAdapter - Uses Svelte-style stores for reactivity
 */
export class SvelteAdapter extends BaseAdapter {
    readonly type = 'svelte' as const;

    /**
     * Create a Svelte state adapter
     */
    createStateAdapter(): IStateAdapter {
        return new SvelteStateAdapter();
    }

    /**
     * Create a Svelte binding adapter
     */
    createBindingAdapter(): IBindingAdapter {
        return new SvelteBindingAdapter();
    }

    /**
     * Check if Svelte is available
     */
    isAvailable(): boolean {
        if (typeof window !== 'undefined') {
            // Check for Svelte-specific class naming convention
            const hasSvelteElements = document.querySelector('[class*="svelte-"]') !== null;
            if (hasSvelteElements) {
                return true;
            }

            // Check for Svelte runtime
            if ((window as unknown as Record<string, unknown>).__svelte) {
                return true;
            }
        }

        return false;
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 's-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get alternate event prefix (s-on- for backward compatibility)
     */
    protected getAltEventPrefix(): string | null {
        return 's-on-';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[svelte-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attributes
     */
    getBindingAttributes(): BindingAttributeMap {
        return SVELTE_BINDING_ATTRIBUTES;
    }
}

export default SvelteAdapter;
</file>

<file path="resources/js/adapters/svelte/SvelteStateAdapter.ts">
/**
 * SvelteStateAdapter - Svelte store-based state management
 *
 * Uses Svelte's writable stores for reactivity.
 * Can work with or without the Svelte runtime.
 */

import type { IStateAdapter } from '../types';
import type { StateChangeCallback } from '../../core/types';

/**
 * Minimal writable store interface (Svelte-compatible)
 */
interface WritableStore<T> {
    subscribe(callback: (value: T) => void): () => void;
    set(value: T): void;
    update(updater: (value: T) => T): void;
}

/**
 * Create a minimal writable store (Svelte-like)
 */
function writable<T>(initialValue: T): WritableStore<T> {
    let value = initialValue;
    const subscribers = new Set<(value: T) => void>();

    return {
        subscribe(callback: (value: T) => void): () => void {
            subscribers.add(callback);
            callback(value); // Svelte stores call immediately on subscribe
            return () => subscribers.delete(callback);
        },
        set(newValue: T): void {
            value = newValue;
            for (const subscriber of subscribers) {
                subscriber(value);
            }
        },
        update(updater: (value: T) => T): void {
            value = updater(value);
            for (const subscriber of subscribers) {
                subscriber(value);
            }
        },
    };
}

/**
 * SvelteStateAdapter - Uses Svelte-style stores for reactivity
 */
export class SvelteStateAdapter implements IStateAdapter {
    private store: WritableStore<Record<string, unknown>> | null = null;
    private currentState: Record<string, unknown> = {};
    private originalState: Record<string, unknown> = {};
    private unsubscribers: Array<() => void> = [];
    private keySubscriptions: Map<string, Set<(newVal: unknown, oldVal: unknown) => void>> = new Map();
    private generalSubscriptions: Set<{ callback: StateChangeCallback }> = new Set();

    /**
     * Initialize state with Svelte store
     */
    init(initialState: Record<string, unknown>): void {
        this.originalState = { ...initialState };
        this.currentState = { ...initialState };

        // Create the main store
        this.store = writable(this.currentState);

        // Subscribe to track changes
        const unsub = this.store.subscribe((state) => {
            const oldState = this.currentState;
            this.currentState = state;

            // Detect and notify changes
            for (const key of Object.keys(state)) {
                if (oldState[key] !== state[key]) {
                    this.notifyChange(state[key], oldState[key], key);
                }
            }
        });

        this.unsubscribers.push(unsub);
    }

    /**
     * Notify subscribers of state change
     */
    private notifyChange(newValue: unknown, oldValue: unknown, key: string): void {
        // Notify general subscribers
        for (const sub of this.generalSubscriptions) {
            sub.callback(newValue, oldValue, key);
        }

        // Notify key-specific subscribers
        const keySubs = this.keySubscriptions.get(key);
        if (keySubs) {
            for (const callback of keySubs) {
                callback(newValue, oldValue);
            }
        }
    }

    /**
     * Get current state snapshot
     */
    getState(): Record<string, unknown> {
        return { ...this.currentState };
    }

    /**
     * Get a specific state value (supports nested paths like "props.count")
     */
    get<T = unknown>(key: string): T | undefined {
        if (!key.includes('.')) {
            return this.currentState[key] as T | undefined;
        }

        // Handle nested path
        const parts = key.split('.');
        let current: unknown = this.currentState;
        for (const part of parts) {
            if (current === null || current === undefined) {
                return undefined;
            }
            current = (current as Record<string, unknown>)[part];
        }
        return current as T | undefined;
    }

    /**
     * Set a state value (supports nested paths like "props.count")
     */
    set(key: string, value: unknown): void {
        if (!this.store) return;

        if (!key.includes('.')) {
            this.store.update((state) => ({ ...state, [key]: value }));
            return;
        }

        // Handle nested path
        const parts = key.split('.');
        const lastKey = parts.pop()!;

        this.store.update((state) => {
            const newState = { ...state };
            let current: Record<string, unknown> = newState;

            for (const part of parts) {
                if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                    current[part] = {};
                }
                current[part] = { ...(current[part] as Record<string, unknown>) };
                current = current[part] as Record<string, unknown>;
            }

            current[lastKey] = value;
            return newState;
        });
    }

    /**
     * Set multiple values at once
     */
    setMany(updates: Record<string, unknown>): void {
        if (this.store) {
            this.store.update((state) => ({ ...state, ...updates }));
        }
    }

    /**
     * Subscribe to all state changes
     */
    subscribe(callback: StateChangeCallback): () => void {
        const subscription = { callback };
        this.generalSubscriptions.add(subscription);

        return () => {
            this.generalSubscriptions.delete(subscription);
        };
    }

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void {
        let keySubs = this.keySubscriptions.get(key);
        if (!keySubs) {
            keySubs = new Set();
            this.keySubscriptions.set(key, keySubs);
        }
        keySubs.add(callback);

        return () => {
            keySubs?.delete(callback);
            if (keySubs?.size === 0) {
                this.keySubscriptions.delete(key);
            }
        };
    }

    /**
     * Get the Svelte store for reactive usage
     */
    getReactiveState(): WritableStore<Record<string, unknown>> {
        return this.store ?? writable({});
    }

    /**
     * Get original state for reset operations
     */
    getOriginalState(): Record<string, unknown> {
        return { ...this.originalState };
    }

    /**
     * Check if key exists
     */
    has(key: string): boolean {
        return key in this.currentState;
    }

    /**
     * Get all keys
     */
    keys(): string[] {
        return Object.keys(this.currentState);
    }

    /**
     * Get store for direct Svelte usage
     * In Svelte components: $store
     */
    getStore(): WritableStore<Record<string, unknown>> | null {
        return this.store;
    }

    /**
     * Dispose and cleanup
     */
    dispose(): void {
        // Unsubscribe from store
        for (const unsub of this.unsubscribers) {
            unsub();
        }
        this.unsubscribers = [];

        // Clear subscriptions
        this.generalSubscriptions.clear();
        this.keySubscriptions.clear();

        // Clear state
        this.store = null;
        this.currentState = {};
        this.originalState = {};
    }
}

export default SvelteStateAdapter;
</file>

<file path="resources/js/adapters/vanilla/VanillaAdapter.ts">
/**
 * VanillaAdapter - Framework adapter for vanilla JavaScript
 */

import { BaseAdapter } from '../BaseAdapter';
import type { IStateAdapter, IBindingAdapter, BindingAttributeMap } from '../types';
import { VanillaStateAdapter } from './VanillaStateAdapter';
import { VanillaBindingAdapter } from './VanillaBindingAdapter';

/**
 * Vanilla binding attribute map
 */
const VANILLA_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 'a-text',
    html: 'a-html',
    show: 'a-show',
    if: 'a-if',
    model: 'a-model',
    class: 'a-class',
    style: 'a-style',
    bind: 'a-bind:',
    on: '@',
    cloak: 'a-cloak',
};

/**
 * VanillaAdapter - Pure JavaScript adapter using Proxy
 */
export class VanillaAdapter extends BaseAdapter {
    readonly type = 'vanilla' as const;

    /**
     * Create a vanilla state adapter
     */
    createStateAdapter(): IStateAdapter {
        return new VanillaStateAdapter();
    }

    /**
     * Create a vanilla binding adapter
     */
    createBindingAdapter(): IBindingAdapter {
        return new VanillaBindingAdapter();
    }

    /**
     * Vanilla is always available
     */
    isAvailable(): boolean {
        return true;
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 'a-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get alternate event prefix (a-on: for backward compatibility)
     */
    protected getAltEventPrefix(): string | null {
        return 'a-on:';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[a-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attributes
     */
    getBindingAttributes(): BindingAttributeMap {
        return VANILLA_BINDING_ATTRIBUTES;
    }
}

export default VanillaAdapter;
</file>

<file path="resources/js/adapters/vanilla/VanillaStateAdapter.ts">
/**
 * VanillaStateAdapter - Proxy-based reactive state for vanilla JavaScript
 */

import type { IStateAdapter } from '../types';
import type { StateChangeCallback } from '../../core/types';

/**
 * Subscription entry
 */
interface Subscription {
    callback: StateChangeCallback;
    key?: string;
}

/**
 * VanillaStateAdapter - Uses Proxy for reactivity without framework dependencies
 */
export class VanillaStateAdapter implements IStateAdapter {
    private state: Record<string, unknown> = {};
    private proxy: Record<string, unknown> | null = null;
    private subscriptions: Set<Subscription> = new Set();
    private keySubscriptions: Map<string, Set<(newVal: unknown, oldVal: unknown) => void>> = new Map();

    /**
     * Initialize state with given values
     */
    init(initialState: Record<string, unknown>): void {
        this.state = { ...initialState };
        this.proxy = this.createProxy();
    }

    /**
     * Create reactive proxy
     */
    private createProxy(): Record<string, unknown> {
        const adapter = this;

        return new Proxy(this.state, {
            set(target: Record<string, unknown>, prop: string, value: unknown): boolean {
                const oldValue = target[prop];
                target[prop] = value;

                if (oldValue !== value) {
                    adapter.notifyChange(value, oldValue, prop);
                }

                return true;
            },

            get(target: Record<string, unknown>, prop: string): unknown {
                return target[prop];
            },

            deleteProperty(target: Record<string, unknown>, prop: string): boolean {
                const oldValue = target[prop];
                const existed = prop in target;
                delete target[prop];

                if (existed) {
                    adapter.notifyChange(undefined, oldValue, prop);
                }

                return true;
            },
        });
    }

    /**
     * Notify subscribers of state change
     */
    private notifyChange(newValue: unknown, oldValue: unknown, key: string): void {
        // Notify general subscribers
        for (const sub of this.subscriptions) {
            if (!sub.key || sub.key === key) {
                sub.callback(newValue, oldValue, key);
            }
        }

        // Notify key-specific subscribers
        const keySubs = this.keySubscriptions.get(key);
        if (keySubs) {
            for (const callback of keySubs) {
                callback(newValue, oldValue);
            }
        }
    }

    /**
     * Get current state snapshot
     */
    getState(): Record<string, unknown> {
        return { ...this.state };
    }

    /**
     * Get a specific state value (supports nested paths like "props.count")
     */
    get<T = unknown>(key: string): T | undefined {
        if (!key.includes('.')) {
            return this.state[key] as T | undefined;
        }

        // Handle nested path
        const parts = key.split('.');
        let current: unknown = this.state;
        for (const part of parts) {
            if (current === null || current === undefined) {
                return undefined;
            }
            current = (current as Record<string, unknown>)[part];
        }
        return current as T | undefined;
    }

    /**
     * Set a state value (supports nested paths like "props.count")
     */
    set(key: string, value: unknown): void {
        if (!key.includes('.')) {
            // Simple key
            if (this.proxy) {
                this.proxy[key] = value;
            } else {
                const oldValue = this.state[key];
                this.state[key] = value;
                if (oldValue !== value) {
                    this.notifyChange(value, oldValue, key);
                }
            }
            return;
        }

        // Handle nested path
        const parts = key.split('.');
        const lastKey = parts.pop()!;
        let current: Record<string, unknown> = this.state;

        // Navigate to parent object, creating nested objects if needed
        for (const part of parts) {
            if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                current[part] = {};
            }
            current = current[part] as Record<string, unknown>;
        }

        // Set the value
        const oldValue = current[lastKey];
        current[lastKey] = value;

        if (oldValue !== value) {
            this.notifyChange(value, oldValue, key);
            // Also notify for the root key if it's nested
            const rootKey = parts[0];
            if (rootKey) {
                this.notifyChange(this.state[rootKey], this.state[rootKey], rootKey);
            }
        }
    }

    /**
     * Set multiple values at once
     */
    setMany(updates: Record<string, unknown>): void {
        for (const [key, value] of Object.entries(updates)) {
            this.set(key, value);
        }
    }

    /**
     * Subscribe to all state changes
     */
    subscribe(callback: StateChangeCallback): () => void {
        const subscription: Subscription = { callback };
        this.subscriptions.add(subscription);

        return () => {
            this.subscriptions.delete(subscription);
        };
    }

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void {
        let keySubs = this.keySubscriptions.get(key);
        if (!keySubs) {
            keySubs = new Set();
            this.keySubscriptions.set(key, keySubs);
        }
        keySubs.add(callback);

        return () => {
            keySubs?.delete(callback);
            if (keySubs?.size === 0) {
                this.keySubscriptions.delete(key);
            }
        };
    }

    /**
     * Get the reactive proxy
     */
    getReactiveState(): Record<string, unknown> {
        return this.proxy ?? this.state;
    }

    /**
     * Check if key exists
     */
    has(key: string): boolean {
        return key in this.state;
    }

    /**
     * Get all keys
     */
    keys(): string[] {
        return Object.keys(this.state);
    }

    /**
     * Dispose and cleanup
     */
    dispose(): void {
        this.subscriptions.clear();
        this.keySubscriptions.clear();
        this.proxy = null;
        this.state = {};
    }
}

export default VanillaStateAdapter;
</file>

<file path="resources/js/adapters/vue/VueAdapter.ts">
/**
 * VueAdapter - Framework adapter for Vue.js
 */

import { BaseAdapter } from '../BaseAdapter';
import type { IStateAdapter, IBindingAdapter, BindingAttributeMap } from '../types';
import { VueStateAdapter } from './VueStateAdapter';
import { VueBindingAdapter } from './VueBindingAdapter';

/**
 * Vue binding attribute map
 */
const VUE_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 'v-text',
    html: 'v-html',
    show: 'v-show',
    if: 'v-if',
    model: 'v-model',
    class: 'v-class',
    style: 'v-style',
    bind: 'v-bind:',
    on: '@',
    cloak: 'v-cloak',
};

/**
 * VueAdapter - Uses Vue's reactive() and effect() for reactivity
 */
export class VueAdapter extends BaseAdapter {
    readonly type = 'vue' as const;

    /**
     * Create a Vue state adapter
     */
    createStateAdapter(): IStateAdapter {
        return new VueStateAdapter();
    }

    /**
     * Create a Vue binding adapter
     */
    createBindingAdapter(): IBindingAdapter {
        return new VueBindingAdapter();
    }

    /**
     * Check if Vue is available
     */
    isAvailable(): boolean {
        // Check for Vue global or data attributes
        if (typeof window !== 'undefined') {
            // Check window.Vue global
            if ((window as unknown as Record<string, unknown>).Vue) {
                return true;
            }

            // Check for Vue reactive markers in DOM
            const hasVueElements = document.querySelector('[data-v-]') !== null;
            if (hasVueElements) {
                return true;
            }
        }

        // Always return true since we bundle Vue's reactivity system
        return true;
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 'v-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get alternate event prefix (v-on: for backward compatibility)
     */
    protected getAltEventPrefix(): string | null {
        return 'v-on:';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[v-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attributes
     */
    getBindingAttributes(): BindingAttributeMap {
        return VUE_BINDING_ATTRIBUTES;
    }

    /**
     * Get shorthand bind prefix (:)
     */
    getShorthandBindPrefix(): string {
        return ':';
    }
}

export default VueAdapter;
</file>

<file path="resources/js/adapters/vue/VueStateAdapter.ts">
/**
 * VueStateAdapter - Vue reactive state management
 */

import { reactive, watch, type UnwrapNestedRefs } from 'vue';
import type { IStateAdapter } from '../types';
import type { StateChangeCallback } from '../../core/types';

/**
 * VueStateAdapter - Uses Vue's reactive() for state management
 */
export class VueStateAdapter implements IStateAdapter {
    private state: UnwrapNestedRefs<Record<string, unknown>> | null = null;
    private originalState: Record<string, unknown> = {};
    private watchers: Array<() => void> = [];

    /**
     * Initialize state with Vue's reactive()
     */
    init(initialState: Record<string, unknown>): void {
        this.originalState = { ...initialState };
        this.state = reactive({ ...initialState }) as UnwrapNestedRefs<Record<string, unknown>>;
    }

    /**
     * Get current state snapshot (non-reactive copy)
     */
    getState(): Record<string, unknown> {
        if (!this.state) return {};
        return { ...this.state };
    }

    /**
     * Get a specific state value (supports nested paths like "props.count")
     */
    get<T = unknown>(key: string): T | undefined {
        if (!this.state) return undefined;

        if (!key.includes('.')) {
            return this.state[key] as T | undefined;
        }

        // Handle nested path
        const parts = key.split('.');
        let current: unknown = this.state;
        for (const part of parts) {
            if (current === null || current === undefined) {
                return undefined;
            }
            current = (current as Record<string, unknown>)[part];
        }
        return current as T | undefined;
    }

    /**
     * Set a state value (supports nested paths like "props.count")
     */
    set(key: string, value: unknown): void {
        if (!this.state) return;

        if (!key.includes('.')) {
            this.state[key] = value;
            return;
        }

        // Handle nested path
        const parts = key.split('.');
        const lastKey = parts.pop()!;
        let current: Record<string, unknown> = this.state;

        // Navigate to parent object, creating nested objects if needed
        for (const part of parts) {
            if (!(part in current) || typeof current[part] !== 'object' || current[part] === null) {
                current[part] = {};
            }
            current = current[part] as Record<string, unknown>;
        }

        // Set the value
        current[lastKey] = value;
    }

    /**
     * Set multiple values at once
     */
    setMany(updates: Record<string, unknown>): void {
        if (!this.state) return;
        for (const [key, value] of Object.entries(updates)) {
            this.state[key] = value;
        }
    }

    /**
     * Subscribe to all state changes using Vue's watch
     */
    subscribe(callback: StateChangeCallback): () => void {
        if (!this.state) return () => {};

        // Watch all properties
        const keys = Object.keys(this.state);
        const unwatchers: Array<() => void> = [];

        for (const key of keys) {
            const unwatch = watch(
                () => this.state![key],
                (newValue, oldValue) => {
                    callback(newValue, oldValue, key);
                }
            );
            unwatchers.push(unwatch);
        }

        // Store watchers for cleanup
        this.watchers.push(...unwatchers);

        return () => {
            for (const unwatch of unwatchers) {
                unwatch();
                const idx = this.watchers.indexOf(unwatch);
                if (idx !== -1) this.watchers.splice(idx, 1);
            }
        };
    }

    /**
     * Subscribe to specific key changes
     */
    subscribeKey(
        key: string,
        callback: (newVal: unknown, oldVal: unknown) => void
    ): () => void {
        if (!this.state) return () => {};

        const unwatch = watch(
            () => this.state![key],
            (newValue, oldValue) => {
                callback(newValue, oldValue);
            }
        );

        this.watchers.push(unwatch);

        return () => {
            unwatch();
            const idx = this.watchers.indexOf(unwatch);
            if (idx !== -1) this.watchers.splice(idx, 1);
        };
    }

    /**
     * Get the reactive Vue state object
     */
    getReactiveState(): UnwrapNestedRefs<Record<string, unknown>> {
        return this.state ?? reactive({});
    }

    /**
     * Get original state for reset operations
     */
    getOriginalState(): Record<string, unknown> {
        return { ...this.originalState };
    }

    /**
     * Check if key exists
     */
    has(key: string): boolean {
        return this.state ? key in this.state : false;
    }

    /**
     * Get all keys
     */
    keys(): string[] {
        return this.state ? Object.keys(this.state) : [];
    }

    /**
     * Dispose and cleanup
     */
    dispose(): void {
        // Stop all watchers
        for (const unwatch of this.watchers) {
            unwatch();
        }
        this.watchers = [];
        this.state = null;
        this.originalState = {};
    }
}

export default VueStateAdapter;
</file>

<file path="resources/js/core/factories/index.ts">
/**
 * Core Factories - Export all factory modules
 */

export { ConfigFactory } from './ConfigFactory';
export type { SyncOptions, SyncResult } from './SyncFactory';
export { SyncFactory } from './SyncFactory';
export { ActionsFactory } from './ActionsFactory';
export type { ExtendedActions, StateGetter, StateSetter } from './ActionsFactory';
export { ScriptExecutor } from './ScriptExecutor';
export type { CustomMethods, ScriptHelpers, ScriptContext, FrameworkType } from './ScriptExecutor';
export { DeferFactory } from './DeferFactory';
export type { DeferConfig, DeferState, DeferResult, DeferInstance } from './DeferFactory';
</file>

<file path="resources/js/core/factories/ScriptExecutor.ts">
/**
 * ScriptExecutor - Execute custom scripts in component context
 */

import type { AcceladeActions, AcceladeComponentConfig } from '../types';
import type { NavigationOptions } from '../router';
import { navigate } from '../router';

/**
 * Custom methods returned from script execution
 */
export type CustomMethods = Record<string, (...args: unknown[]) => unknown>;

/**
 * Event callback type
 */
export type EventCallback<T = unknown> = (data: T) => void;

/**
 * Script helper functions
 */
export interface ScriptHelpers {
    $set: (key: string, value: unknown) => void;
    $get: (key: string) => unknown;
    $toggle: (key: string) => void;
    $watch?: (key: string, callback: (newVal: unknown, oldVal: unknown) => void) => void;
    $emit?: <T = unknown>(event: string, data?: T) => void;
    $on?: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
    $once?: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
    $off?: <T = unknown>(event: string, callback: EventCallback<T>) => void;
}

/**
 * Script execution context
 */
export interface ScriptContext {
    state: Record<string, unknown>;
    actions: AcceladeActions;
    helpers: ScriptHelpers;
    setState: (key: string, value: unknown) => void;
    getState: () => Record<string, unknown>;
    originalState: Record<string, unknown>;
}

/**
 * Framework-specific script attribute names
 */
export type FrameworkType = 'vanilla' | 'vue' | 'react' | 'svelte' | 'angular';

const SCRIPT_SELECTORS: Record<FrameworkType, string> = {
    vanilla: 'script[a-script], accelade-script, accelade\\:script',
    vue: 'script[v-script], accelade-script, accelade\\:script',
    react: 'script[state-script], accelade-script, accelade\\:script',
    svelte: 'script[s-script], accelade-script, accelade\\:script',
    angular: 'script[ng-script], accelade-script, accelade\\:script',
};

/**
 * ScriptExecutor - Handles execution of inline scripts in components
 */
export class ScriptExecutor {
    /**
     * Get script selector for a framework
     */
    static getSelector(framework: FrameworkType): string {
        return SCRIPT_SELECTORS[framework] || SCRIPT_SELECTORS.vanilla;
    }

    /**
     * Find and extract script elements from a component
     */
    static findScripts(element: HTMLElement, framework: FrameworkType): HTMLScriptElement[] {
        const selector = this.getSelector(framework);
        return Array.from(element.querySelectorAll<HTMLScriptElement>(selector));
    }

    /**
     * Execute scripts and return custom methods
     */
    static execute(
        element: HTMLElement,
        context: ScriptContext,
        framework: FrameworkType = 'vanilla'
    ): CustomMethods {
        const customMethods: CustomMethods = {};
        const scriptElements = this.findScripts(element, framework);

        for (const scriptEl of scriptElements) {
            const code = scriptEl.textContent ?? '';
            if (!code.trim()) continue;

            try {
                const methods = this.executeScript(code, context);
                if (methods && typeof methods === 'object') {
                    Object.assign(customMethods, methods);
                }

                // Remove the script element from DOM (already executed)
                scriptEl.remove();
            } catch (e) {
                console.error('Accelade: Error executing script:', e);
            }
        }

        return customMethods;
    }

    /**
     * Execute a single script code block
     */
    static executeScript(code: string, context: ScriptContext): CustomMethods | void {
        const { state, actions, helpers, originalState } = context;
        const { $set, $get, $toggle, $watch, $emit, $on, $once, $off } = helpers;

        // Build function parameters based on available helpers
        const paramNames = [
            'state',
            'actions',
            '$set',
            '$get',
            '$toggle',
            '$navigate',
            'originalState',
            '$emit',
            '$on',
            '$once',
            '$off',
        ];

        const paramValues: unknown[] = [
            state,
            actions,
            $set,
            $get,
            $toggle,
            navigate,
            originalState,
            $emit,
            $on,
            $once,
            $off,
        ];

        // Add $watch if available (Vue-specific)
        if ($watch) {
            paramNames.push('$watch');
            paramValues.push($watch);
        }

        // Create the function with all context variables
        const scriptFn = new Function(...paramNames, code) as (
            ...args: unknown[]
        ) => CustomMethods | void;

        // Execute and return the result
        return scriptFn(...paramValues);
    }

    /**
     * Event bus methods interface
     */
    static eventBusMethods?: {
        emit: <T = unknown>(event: string, data?: T) => void;
        on: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
        once: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
        off: <T = unknown>(event: string, callback: EventCallback<T>) => void;
    };

    /**
     * Set event bus methods (called once during initialization)
     */
    static setEventBusMethods(methods: {
        emit: <T = unknown>(event: string, data?: T) => void;
        on: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
        once: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
        off: <T = unknown>(event: string, callback: EventCallback<T>) => void;
    }): void {
        this.eventBusMethods = methods;
    }

    /**
     * Create script helpers from state accessors
     */
    static createHelpers(
        getState: () => Record<string, unknown>,
        setState: (key: string, value: unknown) => void,
        watchFn?: (key: string, callback: (newVal: unknown, oldVal: unknown) => void) => void
    ): ScriptHelpers {
        const helpers: ScriptHelpers = {
            $set: setState,
            $get: (key: string): unknown => getState()[key],
            $toggle: (key: string): void => {
                const state = getState();
                setState(key, !state[key]);
            },
        };

        if (watchFn) {
            helpers.$watch = watchFn;
        }

        // Add event bus methods if available
        if (this.eventBusMethods) {
            helpers.$emit = this.eventBusMethods.emit;
            helpers.$on = this.eventBusMethods.on;
            helpers.$once = this.eventBusMethods.once;
            helpers.$off = this.eventBusMethods.off;
        }

        return helpers;
    }

    /**
     * Execute an action expression string
     */
    static executeAction(
        expr: string,
        state: Record<string, unknown>,
        actions: AcceladeActions,
        customMethods: CustomMethods,
        event?: Event
    ): void {
        // Try custom method first (simple call like "myMethod")
        if (customMethods[expr]) {
            (customMethods[expr] as (event?: Event) => void)(event);
            return;
        }

        // Handle action:key format (e.g., "increment:count", "toggle:showMessage")
        if (expr.includes(':') && !expr.includes('(')) {
            const [action, key] = expr.split(':');

            // Check custom methods first
            if (customMethods[action]) {
                (customMethods[action] as (key: string, event?: Event) => void)(key, event);
                return;
            }

            const actionMethod = actions[action as keyof AcceladeActions];
            if (typeof actionMethod === 'function') {
                (actionMethod as (key: string) => void)(key);
                return;
            }
        }

        // Handle method('arg') format
        const match = expr.match(/^(\w+)\s*\(\s*['"]?([^'"]*?)['"]?\s*\)$/);
        if (match) {
            const [, method, arg] = match;

            // Check custom methods first
            if (customMethods[method]) {
                (customMethods[method] as (...args: unknown[]) => void)(arg, event);
                return;
            }

            const actionMethod = actions[method as keyof AcceladeActions];
            if (typeof actionMethod === 'function') {
                (actionMethod as (key: string) => void)(arg);
                return;
            }
        }

        // Try direct action name (e.g., "increment")
        const directAction = actions[expr as keyof AcceladeActions];
        if (typeof directAction === 'function') {
            (directAction as () => void)();
            return;
        }

        // Try to evaluate as expression (dangerous but flexible)
        try {
            const fn = new Function('state', 'actions', 'methods', 'event', '$navigate', `
                with (state) {
                    with (actions) {
                        with (methods) {
                            ${expr}
                        }
                    }
                }
            `) as (
                state: Record<string, unknown>,
                actions: AcceladeActions,
                methods: CustomMethods,
                event: Event | undefined,
                navigate: typeof import('../router').navigate
            ) => void;

            fn(state, actions, customMethods, event, navigate);
        } catch {
            // Action execution failed silently
        }
    }
}

export default ScriptExecutor;
</file>

<file path="resources/js/core/link/ConfirmDialog.ts">
/**
 * ConfirmDialog - Modal confirmation dialog for link actions
 *
 * Provides a customizable confirmation dialog that appears before
 * navigation or destructive actions.
 */

import type { ConfirmDialogOptions, ConfirmDialogResult } from './types';

/**
 * Default dialog options
 */
const defaults: ConfirmDialogOptions = {
    text: 'Are you sure you want to continue?',
    confirmButton: 'Confirm',
    cancelButton: 'Cancel',
    danger: false,
};

/**
 * CSS for the confirmation dialog (RTL and Dark mode aware)
 */
const dialogStyles = `
:root {
    --accelade-confirm-bg: #ffffff;
    --accelade-confirm-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --accelade-confirm-title-color: #1f2937;
    --accelade-confirm-text-color: #6b7280;
    --accelade-confirm-btn-cancel-bg: #f3f4f6;
    --accelade-confirm-btn-cancel-color: #374151;
    --accelade-confirm-btn-cancel-hover-bg: #e5e7eb;
    --accelade-confirm-focus-ring: #6366f1;
    --accelade-confirm-focus-ring-bg: white;
}
.dark, [data-theme="dark"] {
    --accelade-confirm-bg: #1e293b;
    --accelade-confirm-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    --accelade-confirm-title-color: #f1f5f9;
    --accelade-confirm-text-color: #94a3b8;
    --accelade-confirm-btn-cancel-bg: #334155;
    --accelade-confirm-btn-cancel-color: #e2e8f0;
    --accelade-confirm-btn-cancel-hover-bg: #475569;
    --accelade-confirm-focus-ring: #818cf8;
    --accelade-confirm-focus-ring-bg: #1e293b;
}
.accelade-confirm-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    opacity: 0;
    transition: opacity 0.15s ease-out;
}
.accelade-confirm-overlay.show {
    opacity: 1;
}
.accelade-confirm-dialog {
    background: var(--accelade-confirm-bg);
    border-radius: 0.75rem;
    box-shadow: var(--accelade-confirm-shadow);
    max-width: 28rem;
    width: calc(100% - 2rem);
    padding: 1.5rem;
    transform: scale(0.95);
    transition: transform 0.15s ease-out;
}
.accelade-confirm-overlay.show .accelade-confirm-dialog {
    transform: scale(1);
}
.accelade-confirm-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--accelade-confirm-title-color);
    margin: 0 0 0.5rem 0;
}
.accelade-confirm-text {
    font-size: 0.875rem;
    color: var(--accelade-confirm-text-color);
    margin: 0 0 1.5rem 0;
    line-height: 1.5;
}
.accelade-confirm-buttons {
    display: flex;
    gap: 0.75rem;
    justify-content: flex-end;
}
.accelade-confirm-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s ease;
    border: none;
}
.accelade-confirm-btn:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--accelade-confirm-focus-ring-bg), 0 0 0 4px var(--accelade-confirm-focus-ring);
}
.accelade-confirm-btn-cancel {
    background: var(--accelade-confirm-btn-cancel-bg);
    color: var(--accelade-confirm-btn-cancel-color);
}
.accelade-confirm-btn-cancel:hover {
    background: var(--accelade-confirm-btn-cancel-hover-bg);
}
.accelade-confirm-btn-confirm {
    background: #6366f1;
    color: white;
}
.accelade-confirm-btn-confirm:hover {
    background: #4f46e5;
}
.accelade-confirm-btn-danger {
    background: #ef4444;
    color: white;
}
.accelade-confirm-btn-danger:hover {
    background: #dc2626;
}
`;

/**
 * Inject dialog styles into document
 */
function ensureStyles(): void {
    if (document.getElementById('accelade-confirm-styles')) return;

    const style = document.createElement('style');
    style.id = 'accelade-confirm-styles';
    style.textContent = dialogStyles;
    document.head.appendChild(style);
}

/**
 * Show a confirmation dialog
 */
export function showConfirmDialog(options: Partial<ConfirmDialogOptions> = {}): Promise<ConfirmDialogResult> {
    ensureStyles();

    const opts: ConfirmDialogOptions = { ...defaults, ...options };

    return new Promise((resolve) => {
        // Create overlay
        const overlay = document.createElement('div');
        overlay.className = 'accelade-confirm-overlay';
        overlay.setAttribute('role', 'dialog');
        overlay.setAttribute('aria-modal', 'true');

        // Create dialog
        const dialog = document.createElement('div');
        dialog.className = 'accelade-confirm-dialog';

        // Title (optional)
        if (opts.title) {
            const title = document.createElement('h3');
            title.className = 'accelade-confirm-title';
            title.textContent = opts.title;
            dialog.appendChild(title);
        }

        // Message
        const text = document.createElement('p');
        text.className = 'accelade-confirm-text';
        text.textContent = opts.text;
        dialog.appendChild(text);

        // Buttons container
        const buttons = document.createElement('div');
        buttons.className = 'accelade-confirm-buttons';

        // Cancel button
        const cancelBtn = document.createElement('button');
        cancelBtn.className = 'accelade-confirm-btn accelade-confirm-btn-cancel';
        cancelBtn.textContent = opts.cancelButton;
        cancelBtn.type = 'button';

        // Confirm button
        const confirmBtn = document.createElement('button');
        confirmBtn.className = `accelade-confirm-btn ${opts.danger ? 'accelade-confirm-btn-danger' : 'accelade-confirm-btn-confirm'}`;
        confirmBtn.textContent = opts.confirmButton;
        confirmBtn.type = 'button';

        buttons.appendChild(cancelBtn);
        buttons.appendChild(confirmBtn);
        dialog.appendChild(buttons);
        overlay.appendChild(dialog);

        // Close and resolve
        const close = (confirmed: boolean) => {
            overlay.classList.remove('show');
            setTimeout(() => {
                overlay.remove();
                resolve({ confirmed });
            }, 150);
        };

        // Event handlers
        cancelBtn.addEventListener('click', () => close(false));
        confirmBtn.addEventListener('click', () => close(true));

        // Close on overlay click
        overlay.addEventListener('click', (e) => {
            if (e.target === overlay) {
                close(false);
            }
        });

        // Close on Escape
        const handleKeydown = (e: KeyboardEvent) => {
            if (e.key === 'Escape') {
                close(false);
                document.removeEventListener('keydown', handleKeydown);
            } else if (e.key === 'Enter') {
                close(true);
                document.removeEventListener('keydown', handleKeydown);
            }
        };
        document.addEventListener('keydown', handleKeydown);

        // Add to DOM and animate in
        document.body.appendChild(overlay);
        requestAnimationFrame(() => {
            overlay.classList.add('show');
            confirmBtn.focus();
        });
    });
}

/**
 * Quick confirm with just a message
 */
export function confirm(message: string): Promise<boolean> {
    return showConfirmDialog({ text: message }).then(r => r.confirmed);
}

/**
 * Danger confirm (red button)
 */
export function confirmDanger(message: string, confirmLabel = 'Delete'): Promise<boolean> {
    return showConfirmDialog({
        text: message,
        confirmButton: confirmLabel,
        danger: true,
    }).then(r => r.confirmed);
}

export default {
    show: showConfirmDialog,
    confirm,
    confirmDanger,
};
</file>

<file path="resources/js/core/modal/ModalManager.ts">
/**
 * ModalManager - Singleton manager for modals and slideovers
 *
 * Handles modal creation, opening, closing, stacking, and events.
 */

import type {
    ModalConfig,
    ModalInstance,
    ModalOpenOptions,
    ModalMaxWidth,
    ModalPosition,
    SlideoverPosition,
    ModalType,
    LinkModalOptions,
} from './types';

/**
 * Default modal configuration
 */
const defaultConfig: ModalConfig = {
    type: 'modal',
    maxWidth: '2xl',
    position: 'center',
    slideoverPosition: 'right',
    closeExplicitly: false,
    closeButton: true,
    opened: false,
};

/**
 * Default slideover configuration
 */
const defaultSlideoverConfig: Partial<ModalConfig> = {
    type: 'slideover',
    maxWidth: 'md',
};

/**
 * Default bottom sheet configuration
 */
const defaultBottomSheetConfig: Partial<ModalConfig> = {
    type: 'bottom-sheet',
    maxWidth: '2xl',
};

/**
 * Max-width CSS values
 */
const maxWidthClasses: Record<ModalMaxWidth, string> = {
    sm: '24rem',
    md: '28rem',
    lg: '32rem',
    xl: '36rem',
    '2xl': '42rem',
    '3xl': '48rem',
    '4xl': '56rem',
    '5xl': '64rem',
    '6xl': '72rem',
    '7xl': '80rem',
};

/**
 * CSS for modals and slideovers (RTL and Dark mode aware)
 */
const modalStyles = `
:root {
    --accelade-modal-bg: #ffffff;
    --accelade-modal-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --accelade-modal-shadow-side: -10px 0 40px -5px rgba(0, 0, 0, 0.2);
    --accelade-modal-shadow-bottom: 0 -10px 40px -5px rgba(0, 0, 0, 0.2);
    --accelade-modal-close-color: #6b7280;
    --accelade-modal-close-hover-bg: #f3f4f6;
    --accelade-modal-close-hover-color: #1f2937;
    --accelade-modal-close-focus-ring: #6366f1;
    --accelade-modal-close-focus-ring-bg: white;
    --accelade-modal-handle-bg: #d1d5db;
    --accelade-modal-loading-color: #6b7280;
}
.dark, [data-theme="dark"] {
    --accelade-modal-bg: #1e293b;
    --accelade-modal-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    --accelade-modal-shadow-side: -10px 0 40px -5px rgba(0, 0, 0, 0.4);
    --accelade-modal-shadow-bottom: 0 -10px 40px -5px rgba(0, 0, 0, 0.4);
    --accelade-modal-close-color: #94a3b8;
    --accelade-modal-close-hover-bg: #334155;
    --accelade-modal-close-hover-color: #f1f5f9;
    --accelade-modal-close-focus-ring: #818cf8;
    --accelade-modal-close-focus-ring-bg: #1e293b;
    --accelade-modal-handle-bg: #475569;
    --accelade-modal-loading-color: #94a3b8;
}
.accelade-modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 99990;
    opacity: 0;
    transition: opacity 0.2s ease-out;
    overflow-y: auto;
}
.accelade-modal-overlay.show {
    opacity: 1;
}
.accelade-modal-overlay.modal {
    display: flex;
    padding: 1rem;
}
.accelade-modal-overlay.modal.position-top {
    align-items: flex-start;
    justify-content: center;
}
.accelade-modal-overlay.modal.position-center {
    align-items: center;
    justify-content: center;
}
.accelade-modal-overlay.modal.position-bottom {
    align-items: flex-end;
    justify-content: center;
}
.accelade-modal-overlay.slideover {
    display: flex;
}
.accelade-modal-overlay.slideover.position-left {
    justify-content: flex-start;
}
.accelade-modal-overlay.slideover.position-right {
    justify-content: flex-end;
}
.accelade-modal-panel {
    background: var(--accelade-modal-bg);
    position: relative;
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
}
.accelade-modal-overlay.modal .accelade-modal-panel {
    border-radius: 0.75rem;
    box-shadow: var(--accelade-modal-shadow);
    max-height: calc(100vh - 2rem);
    overflow-y: auto;
    transform: scale(0.95);
    opacity: 0;
}
.accelade-modal-overlay.modal.show .accelade-modal-panel {
    transform: scale(1);
    opacity: 1;
}
.accelade-modal-overlay.slideover .accelade-modal-panel {
    height: 100vh;
    max-height: 100vh;
    overflow-y: auto;
    box-shadow: var(--accelade-modal-shadow-side);
}
.accelade-modal-overlay.slideover.position-left .accelade-modal-panel {
    transform: translateX(-100%);
}
.accelade-modal-overlay.slideover.position-right .accelade-modal-panel {
    transform: translateX(100%);
}
.accelade-modal-overlay.slideover.show .accelade-modal-panel {
    transform: translateX(0);
}
.accelade-modal-overlay.bottom-sheet {
    display: flex;
    align-items: flex-end;
    justify-content: center;
}
.accelade-modal-overlay.bottom-sheet .accelade-modal-panel {
    border-radius: 1rem 1rem 0 0;
    box-shadow: var(--accelade-modal-shadow-bottom);
    max-height: 90vh;
    overflow-y: auto;
    transform: translateY(100%);
    width: 100%;
}
.accelade-modal-overlay.bottom-sheet.show .accelade-modal-panel {
    transform: translateY(0);
}
.accelade-modal-overlay.bottom-sheet .accelade-modal-handle {
    width: 2.5rem;
    height: 0.25rem;
    background: var(--accelade-modal-handle-bg);
    border-radius: 9999px;
    margin: 0.75rem auto 0.5rem;
}
.accelade-modal-close {
    position: absolute;
    top: 0.75rem;
    inset-inline-end: 0.75rem;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    color: var(--accelade-modal-close-color);
    cursor: pointer;
    border-radius: 0.375rem;
    transition: background 0.15s ease, color 0.15s ease;
    z-index: 10;
}
.accelade-modal-close:hover {
    background: var(--accelade-modal-close-hover-bg);
    color: var(--accelade-modal-close-hover-color);
}
.accelade-modal-close:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--accelade-modal-close-focus-ring-bg), 0 0 0 4px var(--accelade-modal-close-focus-ring);
}
.accelade-modal-close svg {
    width: 1.25rem;
    height: 1.25rem;
}
.accelade-modal-content {
    padding: 1.5rem;
}
.accelade-modal-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 8rem;
    color: var(--accelade-modal-loading-color);
}
.accelade-modal-loading svg {
    width: 2rem;
    height: 2rem;
    animation: accelade-spin 1s linear infinite;
}
@keyframes accelade-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
`;

/**
 * Generate unique ID
 */
let modalIdCounter = 0;
function generateId(): string {
    return `accelade-modal-${++modalIdCounter}`;
}

/**
 * ModalManager singleton
 */
class ModalManager {
    private modals: Map<string, ModalInstance> = new Map();
    private namedModals: Map<string, ModalInstance> = new Map();
    private stack: string[] = [];
    private stylesInjected = false;

    /**
     * Ensure styles are injected
     */
    private ensureStyles(): void {
        if (this.stylesInjected) return;
        if (document.getElementById('accelade-modal-styles')) {
            this.stylesInjected = true;
            return;
        }

        const style = document.createElement('style');
        style.id = 'accelade-modal-styles';
        style.textContent = modalStyles;
        document.head.appendChild(style);
        this.stylesInjected = true;
    }

    /**
     * Parse config from element attributes
     */
    parseConfig(element: HTMLElement): ModalConfig {
        let type: ModalType = 'modal';
        if (element.hasAttribute('data-bottom-sheet')) {
            type = 'bottom-sheet';
        } else if (element.hasAttribute('data-slideover')) {
            type = 'slideover';
        }

        let defaults = { ...defaultConfig };
        if (type === 'slideover') {
            defaults = { ...defaultConfig, ...defaultSlideoverConfig };
        } else if (type === 'bottom-sheet') {
            defaults = { ...defaultConfig, ...defaultBottomSheetConfig };
        }

        return {
            id: element.getAttribute('data-modal-id') ?? undefined,
            name: element.getAttribute('data-modal-name') ?? undefined,
            type,
            maxWidth: (element.getAttribute('data-max-width') as ModalMaxWidth) ?? defaults.maxWidth,
            position: (element.getAttribute('data-position') as ModalPosition) ?? defaults.position,
            slideoverPosition: (element.getAttribute('data-slideover-position') as SlideoverPosition) ?? defaults.slideoverPosition,
            closeExplicitly: element.hasAttribute('data-close-explicitly'),
            closeButton: !element.hasAttribute('data-no-close-button'),
            opened: element.hasAttribute('data-opened'),
        };
    }

    /**
     * Parse link modal options from anchor element
     */
    parseLinkOptions(element: HTMLAnchorElement): LinkModalOptions | null {
        const isModal = element.hasAttribute('data-modal');
        const isSlideover = element.hasAttribute('data-slideover');
        const isBottomSheet = element.hasAttribute('data-bottom-sheet');

        if (!isModal && !isSlideover && !isBottomSheet) {
            return null;
        }

        return {
            modal: isModal,
            slideover: isSlideover,
            bottomSheet: isBottomSheet,
            maxWidth: element.getAttribute('data-modal-max-width') as ModalMaxWidth | undefined,
            position: element.getAttribute('data-modal-position') as ModalPosition | undefined,
            slideoverPosition: element.getAttribute('data-slideover-position') as SlideoverPosition | undefined,
        };
    }

    /**
     * Register a pre-loaded modal from the page
     */
    register(element: HTMLElement, config: ModalConfig): ModalInstance {
        this.ensureStyles();

        const id = config.id ?? generateId();
        const instance = this.createInstance(id, element, config);

        this.modals.set(id, instance);

        if (config.name) {
            this.namedModals.set(config.name, instance);
        }

        // Open immediately if configured
        if (config.opened) {
            requestAnimationFrame(() => instance.open());
        }

        return instance;
    }

    /**
     * Create a modal instance
     */
    private createInstance(id: string, element: HTMLElement, config: ModalConfig): ModalInstance {
        let isOpen = false;
        let overlay: HTMLElement | null = null;

        const open = (): void => {
            if (isOpen) return;

            this.ensureStyles();
            isOpen = true;

            // Create overlay
            overlay = this.createOverlay(config, element.innerHTML);

            // Add to DOM
            document.body.appendChild(overlay);
            document.body.style.overflow = 'hidden';

            // Add to stack
            this.stack.push(id);

            // Setup event handlers
            this.setupOverlayEvents(overlay, instance);

            // Animate in
            requestAnimationFrame(() => {
                overlay?.classList.add('show');
            });

            // Dispatch event
            this.dispatchEvent('open', instance);
        };

        const close = (): void => {
            if (!isOpen || !overlay) return;

            isOpen = false;
            overlay.classList.remove('show');

            // Remove from stack
            const stackIndex = this.stack.indexOf(id);
            if (stackIndex > -1) {
                this.stack.splice(stackIndex, 1);
            }

            // Restore body scroll if no more modals
            if (this.stack.length === 0) {
                document.body.style.overflow = '';
            }

            // Remove after animation
            const overlayToRemove = overlay;
            setTimeout(() => {
                overlayToRemove.remove();
            }, 200);

            overlay = null;

            // Dispatch event
            this.dispatchEvent('close', instance);
        };

        const setIsOpen = (open: boolean): void => {
            if (open) {
                instance.open();
            } else {
                instance.close();
            }
        };

        const dispose = (): void => {
            close();
            this.modals.delete(id);
            if (config.name) {
                this.namedModals.delete(config.name);
            }
        };

        const instance: ModalInstance = {
            id,
            name: config.name,
            config,
            element,
            get isOpen() {
                return isOpen;
            },
            open,
            close,
            setIsOpen,
            dispose,
        };

        return instance;
    }

    /**
     * Create overlay element
     */
    private createOverlay(config: ModalConfig, content: string): HTMLElement {
        const overlay = document.createElement('div');
        overlay.className = `accelade-modal-overlay ${config.type}`;
        overlay.setAttribute('role', 'dialog');
        overlay.setAttribute('aria-modal', 'true');

        // Position class
        if (config.type === 'modal') {
            overlay.classList.add(`position-${config.position}`);
        } else if (config.type === 'slideover') {
            overlay.classList.add(`position-${config.slideoverPosition}`);
        }
        // bottom-sheet doesn't need position class (always bottom)

        // Panel
        const panel = document.createElement('div');
        panel.className = 'accelade-modal-panel';
        panel.style.width = '100%';
        panel.style.maxWidth = maxWidthClasses[config.maxWidth];

        // Add handle for bottom sheet
        if (config.type === 'bottom-sheet') {
            const handle = document.createElement('div');
            handle.className = 'accelade-modal-handle';
            panel.appendChild(handle);
        }

        // Close button
        if (config.closeButton) {
            const closeBtn = document.createElement('button');
            closeBtn.className = 'accelade-modal-close';
            closeBtn.type = 'button';
            closeBtn.setAttribute('aria-label', 'Close');
            closeBtn.innerHTML = `<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>`;
            panel.appendChild(closeBtn);
        }

        // Content
        const contentEl = document.createElement('div');
        contentEl.className = 'accelade-modal-content';
        contentEl.innerHTML = content;
        panel.appendChild(contentEl);

        overlay.appendChild(panel);
        return overlay;
    }

    /**
     * Setup event handlers for overlay
     */
    private setupOverlayEvents(overlay: HTMLElement, instance: ModalInstance): void {
        // Close button
        const closeBtn = overlay.querySelector('.accelade-modal-close');
        if (closeBtn) {
            closeBtn.addEventListener('click', () => instance.close());
        }

        // Outside click
        if (!instance.config.closeExplicitly) {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    instance.close();
                }
            });
        }

        // Escape key
        if (!instance.config.closeExplicitly) {
            const handleKeydown = (e: KeyboardEvent): void => {
                if (e.key === 'Escape' && this.stack[this.stack.length - 1] === instance.id) {
                    instance.close();
                    document.removeEventListener('keydown', handleKeydown);
                }
            };
            document.addEventListener('keydown', handleKeydown);
        }

        // Expose modal object to content for close handlers
        const panel = overlay.querySelector('.accelade-modal-panel');
        if (panel) {
            (panel as HTMLElement & { modal: ModalInstance }).modal = instance;

            // Find all elements with @click="modal.close" and bind them
            panel.querySelectorAll('[\\@click*="modal.close"], [data-modal-close]').forEach((el) => {
                el.addEventListener('click', () => instance.close());
            });
        }
    }

    /**
     * Open a modal by URL (async content loading)
     */
    async openUrl(url: string, options: Omit<ModalOpenOptions, 'url' | 'content'> = {}): Promise<ModalInstance> {
        this.ensureStyles();

        const id = generateId();
        const type = options.type ?? (options.slideoverPosition ? 'slideover' : 'modal');
        let defaults = { ...defaultConfig };
        if (type === 'slideover') {
            defaults = { ...defaultConfig, ...defaultSlideoverConfig };
        } else if (type === 'bottom-sheet') {
            defaults = { ...defaultConfig, ...defaultBottomSheetConfig };
        }

        const config: ModalConfig = {
            id,
            type,
            maxWidth: options.maxWidth ?? defaults.maxWidth,
            position: options.position ?? defaults.position,
            slideoverPosition: options.slideoverPosition ?? defaults.slideoverPosition,
            closeExplicitly: options.closeExplicitly ?? defaults.closeExplicitly,
            closeButton: options.closeButton ?? defaults.closeButton,
            opened: true,
        };

        // Create loading overlay
        const loadingContent = `<div class="accelade-modal-loading"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></div>`;

        // Create temp element for registration
        const tempElement = document.createElement('div');
        tempElement.innerHTML = loadingContent;

        const instance = this.createInstance(id, tempElement, config);
        this.modals.set(id, instance);

        // Open with loading state
        instance.open();

        // Store onClose callback
        if (options.onClose) {
            const originalClose = instance.close;
            instance.close = (): void => {
                originalClose();
                options.onClose?.();
            };
        }

        // Fetch content
        try {
            const response = await fetch(url, {
                headers: {
                    'X-Accelade-Modal': 'true',
                    'X-Requested-With': 'XMLHttpRequest',
                    Accept: 'text/html, application/xhtml+xml',
                },
            });

            if (!response.ok) {
                throw new Error(`HTTP ${response.status}`);
            }

            const html = await response.text();

            // Update content
            const overlay = document.querySelector(`.accelade-modal-overlay`) as HTMLElement;
            if (overlay) {
                const contentEl = overlay.querySelector('.accelade-modal-content');
                if (contentEl) {
                    contentEl.innerHTML = html;

                    // Re-setup close handlers
                    this.setupOverlayEvents(overlay, instance);

                    // Initialize any Accelade components in the new content
                    if (window.Accelade?.init) {
                        window.Accelade.init();
                    }
                }
            }
        } catch (error) {
            console.error('[Accelade Modal] Failed to load content:', error);
            instance.close();
        }

        return instance;
    }

    /**
     * Open a modal with HTML content
     */
    open(options: ModalOpenOptions): ModalInstance {
        if (options.url) {
            // Return a promise-based instance for URL loading
            const placeholder = document.createElement('div');
            const instance = this.createInstance(generateId(), placeholder, {
                ...defaultConfig,
                type: options.type ?? 'modal',
                maxWidth: options.maxWidth ?? defaultConfig.maxWidth,
                position: options.position ?? defaultConfig.position,
                slideoverPosition: options.slideoverPosition ?? defaultConfig.slideoverPosition,
                closeExplicitly: options.closeExplicitly ?? defaultConfig.closeExplicitly,
                closeButton: options.closeButton ?? defaultConfig.closeButton,
                opened: true,
            });

            this.openUrl(options.url, options);
            return instance;
        }

        this.ensureStyles();

        const id = generateId();
        const type = options.type ?? 'modal';
        const defaults = type === 'slideover'
            ? { ...defaultConfig, ...defaultSlideoverConfig }
            : { ...defaultConfig };

        const config: ModalConfig = {
            id,
            type,
            maxWidth: options.maxWidth ?? defaults.maxWidth,
            position: options.position ?? defaults.position,
            slideoverPosition: options.slideoverPosition ?? defaults.slideoverPosition,
            closeExplicitly: options.closeExplicitly ?? defaults.closeExplicitly,
            closeButton: options.closeButton ?? defaults.closeButton,
            opened: true,
        };

        const tempElement = document.createElement('div');
        tempElement.innerHTML = options.content ?? '';

        const instance = this.createInstance(id, tempElement, config);
        this.modals.set(id, instance);

        if (options.onClose) {
            const originalClose = instance.close;
            instance.close = (): void => {
                originalClose();
                options.onClose?.();
            };
        }

        instance.open();
        return instance;
    }

    /**
     * Open a named modal (pre-loaded)
     */
    openNamed(name: string): ModalInstance | undefined {
        const instance = this.namedModals.get(name);
        if (instance) {
            instance.open();
        }
        return instance;
    }

    /**
     * Close a modal by ID
     */
    close(id: string): void {
        const instance = this.modals.get(id);
        if (instance) {
            instance.close();
        }
    }

    /**
     * Close the topmost modal
     */
    closeLast(): void {
        const lastId = this.stack[this.stack.length - 1];
        if (lastId) {
            this.close(lastId);
        }
    }

    /**
     * Close all modals
     */
    closeAll(): void {
        [...this.stack].reverse().forEach((id) => this.close(id));
    }

    /**
     * Get a modal by ID
     */
    get(id: string): ModalInstance | undefined {
        return this.modals.get(id);
    }

    /**
     * Get a modal by name
     */
    getByName(name: string): ModalInstance | undefined {
        return this.namedModals.get(name);
    }

    /**
     * Check if any modal is open
     */
    hasOpen(): boolean {
        return this.stack.length > 0;
    }

    /**
     * Dispatch modal event
     */
    private dispatchEvent(type: 'open' | 'close', instance: ModalInstance): void {
        const event = new CustomEvent(`accelade:modal-${type}`, {
            detail: {
                id: instance.id,
                name: instance.name,
                isOpen: instance.isOpen,
            },
            bubbles: true,
        });
        document.dispatchEvent(event);
    }

    /**
     * Handle hash-based modal opening
     */
    handleHashChange(): void {
        const hash = window.location.hash.slice(1);
        if (hash) {
            const instance = this.namedModals.get(hash);
            if (instance) {
                instance.open();
            }
        }
    }

    /**
     * Initialize hash listener
     */
    initHashListener(): void {
        window.addEventListener('hashchange', () => this.handleHashChange());

        // Check initial hash
        if (window.location.hash) {
            this.handleHashChange();
        }
    }
}

// Singleton instance
export const modalManager = new ModalManager();

// Export for window.Accelade.modal
export default modalManager;

// Extend window type
declare global {
    interface Window {
        Accelade?: {
            init?: () => void;
            modal?: ModalManager;
            [key: string]: unknown;
        };
    }
}
</file>

<file path="resources/js/core/notification/NotificationManager.ts">
/**
 * NotificationManager - Filament-style notification display.
 */

import type {
    NotificationData,
    NotificationConfig,
    NotificationStatus,
    NotificationPosition,
    NotificationAction,
} from './types';
import { DEFAULT_CONFIG, STATUS_ICONS } from './types';

export class NotificationManager {
    private config: NotificationConfig;
    private containers: Map<string, HTMLElement> = new Map();
    private notifications: Map<string, HTMLElement> = new Map();
    private timers: Map<string, number> = new Map();

    constructor(config: Partial<NotificationConfig> = {}) {
        this.config = { ...DEFAULT_CONFIG, ...config };
    }

    configure(config: Partial<NotificationConfig>): void {
        this.config = { ...this.config, ...config };
    }

    show(data: Partial<NotificationData> & { id?: string; title: string }): void {
        const normalized = this.normalizeData(data);
        const container = this.ensureContainer(normalized.position);
        const el = this.createElement(normalized);

        container.appendChild(el);
        this.notifications.set(normalized.id, el);

        requestAnimationFrame(() => el.classList.add('accelade-notif-show'));

        if (!normalized.persistent && normalized.duration > 0) {
            this.scheduleRemove(normalized.id, normalized.duration);
        }
    }

    dismiss(id: string): void {
        const el = this.notifications.get(id);
        if (!el) return;

        this.clearTimer(id);
        el.classList.remove('accelade-notif-show');
        el.classList.add('accelade-notif-hide');

        setTimeout(() => {
            el.remove();
            this.notifications.delete(id);
            this.cleanupContainers();
        }, 300);
    }

    success(title: string, body = ''): void {
        this.show({ id: `notif-${Date.now()}`, title, body, status: 'success' });
    }

    info(title: string, body = ''): void {
        this.show({ id: `notif-${Date.now()}`, title, body, status: 'info' });
    }

    warning(title: string, body = ''): void {
        this.show({ id: `notif-${Date.now()}`, title, body, status: 'warning' });
    }

    danger(title: string, body = ''): void {
        this.show({ id: `notif-${Date.now()}`, title, body, status: 'danger' });
    }

    private normalizeData(data: Partial<NotificationData> & { title: string }): NotificationData {
        return {
            id: data.id || `notif-${Date.now()}`,
            title: data.title,
            body: data.body || data.message || '',
            status: data.status || data.type || 'success',
            icon: data.icon,
            iconColor: data.iconColor,
            color: data.color,
            position: data.position || this.config.position,
            duration: data.duration ?? this.config.duration,
            persistent: data.persistent ?? false,
            actions: data.actions || [],
        };
    }

    private ensureContainer(position: NotificationPosition): HTMLElement {
        const id = `accelade-notifications-${position}`;
        let container = this.containers.get(position);

        if (!container) {
            const existingContainer = document.getElementById(id);
            if (existingContainer) {
                container = existingContainer;
            } else {
                container = document.createElement('div');
                container.id = id;
                container.className = `accelade-notifications accelade-notifications-${position}`;
                document.body.appendChild(container);
            }
            this.containers.set(position, container);
        }

        return container;
    }

    private createElement(data: NotificationData): HTMLElement {
        const el = document.createElement('div');
        el.id = data.id;
        el.className = `accelade-notif accelade-notif-${data.status}`;
        if (data.color) el.style.setProperty('--accelade-notif-color', data.color);
        el.innerHTML = this.getTemplate(data);

        el.querySelector('.accelade-notif-close')?.addEventListener('click', () => {
            this.dismiss(data.id);
        });

        data.actions?.forEach((action) => {
            const btn = el.querySelector(`[data-action="${action.name}"]`);
            btn?.addEventListener('click', () => this.handleAction(data.id, action));
        });

        if (this.config.pauseOnHover) {
            el.addEventListener('mouseenter', () => this.clearTimer(data.id));
            el.addEventListener('mouseleave', () => {
                if (!data.persistent && data.duration > 0) {
                    this.scheduleRemove(data.id, data.duration);
                }
            });
        }

        return el;
    }

    private getTemplate(data: NotificationData): string {
        const icon = data.icon || STATUS_ICONS[data.status];
        const iconStyle = data.iconColor ? `color: ${data.iconColor}` : '';

        return `
            <div class="accelade-notif-icon" style="${iconStyle}">${icon}</div>
            <div class="accelade-notif-content">
                <div class="accelade-notif-title">${data.title}</div>
                ${data.body ? `<div class="accelade-notif-body">${data.body}</div>` : ''}
                ${this.renderActions(data.actions || [])}
            </div>
            <button type="button" class="accelade-notif-close" aria-label="Dismiss">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        `;
    }

    private renderActions(actions: NotificationAction[]): string {
        if (!actions.length) return '';

        const buttons = actions.map((a) => {
            const label = a.label || a.name;
            if (a.url) {
                const target = a.openInNewTab ? ' target="_blank" rel="noopener"' : '';
                return `<a href="${a.url}"${target} data-action="${a.name}" class="accelade-notif-action">${label}</a>`;
            }
            return `<button type="button" data-action="${a.name}" class="accelade-notif-action">${label}</button>`;
        });

        return `<div class="accelade-notif-actions">${buttons.join('')}</div>`;
    }

    private handleAction(notifId: string, action: NotificationAction): void {
        if (action.dispatch) {
            window.dispatchEvent(new CustomEvent(action.dispatch, { detail: { notificationId: notifId } }));
        }
        if (action.close !== false && !action.url) {
            this.dismiss(notifId);
        }
    }

    private scheduleRemove(id: string, duration: number): void {
        this.clearTimer(id);
        const timer = window.setTimeout(() => this.dismiss(id), duration);
        this.timers.set(id, timer);
    }

    private clearTimer(id: string): void {
        const timer = this.timers.get(id);
        if (timer) {
            clearTimeout(timer);
            this.timers.delete(id);
        }
    }

    private cleanupContainers(): void {
        this.containers.forEach((container, position) => {
            if (container.children.length === 0) {
                container.remove();
                this.containers.delete(position);
            }
        });
    }
}

export default NotificationManager;
</file>

<file path="resources/js/core/progress.ts">
/**
 * Accelade Progress Bar
 * Customizable loading indicator inspired by Inertia.js/NProgress
 */

export interface ProgressConfig {
    /** Delay in ms before showing progress bar (default: 250) */
    delay?: number;
    /** Progress bar color (default: '#6366f1') */
    color?: string;
    /** Include spinner indicator (default: true) */
    includeSpinner?: boolean;
    /** Show progress bar (default: true) */
    showBar?: boolean;
    /** Progress bar height in pixels (default: 3) */
    height?: number;
    /** Minimum progress percentage on start (default: 8) */
    minimum?: number;
    /** Animation easing function (default: 'ease-out') */
    easing?: string;
    /** Animation speed in ms (default: 200) */
    speed?: number;
    /** Trickle speed - how fast it trickles (default: 200) */
    trickleSpeed?: number;
    /** Z-index for the progress bar (default: 99999) */
    zIndex?: number;
    /** Position: 'top' or 'bottom' (default: 'top') */
    position?: 'top' | 'bottom';
    /** Spinner position (default: 'top-right') */
    spinnerPosition?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';
    /** Custom spinner size in pixels (default: 18) */
    spinnerSize?: number;
    /** Use gradient colors (default: true) */
    useGradient?: boolean;
    /** Secondary gradient color (default: '#8b5cf6') */
    gradientColor?: string;
    /** Third gradient color (default: '#a855f7') */
    gradientColor2?: string;
}

const defaultConfig: Required<ProgressConfig> = {
    delay: 0,
    color: '#6366f1',
    includeSpinner: true,
    showBar: true,
    height: 3,
    minimum: 8,
    easing: 'ease-out',
    speed: 200,
    trickleSpeed: 200,
    zIndex: 99999,
    position: 'top',
    spinnerPosition: 'top-right',
    spinnerSize: 18,
    useGradient: true,
    gradientColor: '#8b5cf6',
    gradientColor2: '#a855f7',
};

class AcceladeProgress {
    private config: Required<ProgressConfig>;
    private element: HTMLElement | null = null;
    private barElement: HTMLElement | null = null;
    private spinnerElement: HTMLElement | null = null;
    private progress: number = 0;
    private isRunning: boolean = false;
    private trickleInterval: ReturnType<typeof setInterval> | null = null;
    private delayTimeout: ReturnType<typeof setTimeout> | null = null;
    private isVisible: boolean = false;
    private static stylesInjected: boolean = false;

    /**
     * Check if document is in RTL mode
     */
    private isRTL(): boolean {
        return document.documentElement.dir === 'rtl' || document.body.dir === 'rtl';
    }

    constructor(config: ProgressConfig = {}) {
        this.config = { ...defaultConfig, ...config };
        this.injectStyles();
    }

    /**
     * Inject CSS keyframes for spinner animation
     */
    private injectStyles(): void {
        if (AcceladeProgress.stylesInjected) return;
        if (typeof document === 'undefined') return;

        const style = document.createElement('style');
        style.id = 'accelade-progress-styles';
        style.textContent = `
            @keyframes accelade-spinner {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
        AcceladeProgress.stylesInjected = true;
    }

    /**
     * Configure the progress bar
     */
    configure(config: ProgressConfig): void {
        this.config = { ...this.config, ...config };
        this.updateStyles();
    }

    /**
     * Create progress bar DOM elements
     */
    private createElements(): void {
        if (this.element) {
            return;
        }

        // Create container
        this.element = document.createElement('div');
        this.element.id = 'accelade-progress';
        this.applyContainerStyles();

        // Create bar
        if (this.config.showBar) {
            this.barElement = document.createElement('div');
            this.barElement.className = 'bar';
            this.applyBarStyles();
            this.element.appendChild(this.barElement);
        }

        // Create spinner
        if (this.config.includeSpinner) {
            this.spinnerElement = document.createElement('div');
            this.spinnerElement.className = 'spinner';
            this.applySpinnerStyles();
            this.element.appendChild(this.spinnerElement);
        }

        document.body.appendChild(this.element);
    }

    /**
     * Apply container styles
     */
    private applyContainerStyles(): void {
        if (!this.element) return;

        const { position, zIndex, height } = this.config;
        Object.assign(this.element.style, {
            position: 'fixed',
            [position]: '0',
            left: '0',
            right: '0',
            height: `${height}px`,
            zIndex: String(zIndex),
            pointerEvents: 'none',
            background: 'transparent',
            overflow: 'hidden',
            opacity: '0',
            transition: 'opacity 0.2s ease',
        });
    }

    /**
     * Apply bar styles
     */
    private applyBarStyles(): void {
        if (!this.barElement) return;

        const { color, height, easing, speed, useGradient, gradientColor, gradientColor2 } = this.config;
        const background = useGradient
            ? `linear-gradient(90deg, ${color}, ${gradientColor}, ${gradientColor2})`
            : color;

        Object.assign(this.barElement.style, {
            position: 'absolute',
            top: '0',
            left: '0',
            height: '100%',
            width: '0%',
            background,
            boxShadow: `0 0 10px ${this.hexToRgba(color, 0.7)}, 0 0 5px ${this.hexToRgba(gradientColor, 0.5)}`,
            transition: `width ${speed}ms ${easing}`,
            borderRadius: '0 2px 2px 0',
        });
    }

    /**
     * Apply spinner styles
     */
    private applySpinnerStyles(): void {
        if (!this.spinnerElement) return;

        const { color, gradientColor, spinnerSize, spinnerPosition } = this.config;
        const isRTL = this.isRTL();

        // Position mapping - RTL-aware (swaps left/right in RTL mode)
        const positions: Record<string, { top?: string; bottom?: string; left?: string; right?: string }> = {
            'top-left': { top: '15px', [isRTL ? 'right' : 'left']: '15px' },
            'top-right': { top: '15px', [isRTL ? 'left' : 'right']: '15px' },
            'bottom-left': { bottom: '15px', [isRTL ? 'right' : 'left']: '15px' },
            'bottom-right': { bottom: '15px', [isRTL ? 'left' : 'right']: '15px' },
        };

        const pos = positions[spinnerPosition] || positions['top-right'];

        // Clear existing position styles
        this.spinnerElement.style.left = '';
        this.spinnerElement.style.right = '';

        Object.assign(this.spinnerElement.style, {
            position: 'fixed',
            ...pos,
            width: `${spinnerSize}px`,
            height: `${spinnerSize}px`,
            border: '2px solid transparent',
            borderTopColor: color,
            [isRTL ? 'borderRightColor' : 'borderLeftColor']: gradientColor,
            borderRadius: '50%',
            animation: 'accelade-spinner 0.6s linear infinite',
            opacity: '0',
            transition: 'opacity 0.2s ease',
        });
    }

    /**
     * Update styles dynamically
     */
    private updateStyles(): void {
        this.applyContainerStyles();
        this.applyBarStyles();
        this.applySpinnerStyles();
    }

    /**
     * Convert hex to rgba
     */
    private hexToRgba(hex: string, alpha: number): string {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    /**
     * Start the progress bar
     */
    start(): void {
        if (this.isRunning) return;

        this.createElements();
        this.isRunning = true;
        this.progress = 0;

        // Add navigating class to document
        document.documentElement.classList.add('accelade-navigating');

        // Delay showing the progress bar
        this.delayTimeout = setTimeout(() => {
            this.show();
            this.set(this.config.minimum);
            this.startTrickle();
        }, this.config.delay);
    }

    /**
     * Show the progress bar
     */
    private show(): void {
        if (this.isVisible) return;
        this.isVisible = true;

        if (this.element) {
            this.element.style.opacity = '1';
        }
        if (this.spinnerElement) {
            this.spinnerElement.classList.add('visible');
            this.spinnerElement.style.opacity = '1';
        }
    }

    /**
     * Hide the progress bar
     */
    private hide(): void {
        this.isVisible = false;

        if (this.element) {
            this.element.style.opacity = '0';
        }
        if (this.spinnerElement) {
            this.spinnerElement.classList.remove('visible');
            this.spinnerElement.style.opacity = '0';
        }
    }

    /**
     * Set progress to a specific value (0-100)
     */
    set(value: number): void {
        this.progress = Math.max(0, Math.min(100, value));

        if (this.barElement) {
            this.barElement.style.width = `${this.progress}%`;
        }
    }

    /**
     * Increment progress by a random amount
     */
    inc(amount?: number): void {
        if (this.progress >= 100) return;

        if (amount === undefined) {
            // Smart increment - slower as we get closer to 100%
            if (this.progress < 25) {
                amount = Math.random() * 10 + 3;
            } else if (this.progress < 50) {
                amount = Math.random() * 5 + 2;
            } else if (this.progress < 80) {
                amount = Math.random() * 3 + 1;
            } else if (this.progress < 95) {
                amount = Math.random() * 2 + 0.5;
            } else {
                amount = 0.1;
            }
        }

        this.set(this.progress + amount);
    }

    /**
     * Start trickling (automatic progress)
     */
    private startTrickle(): void {
        this.stopTrickle();
        this.trickleInterval = setInterval(() => {
            this.inc();
        }, this.config.trickleSpeed);
    }

    /**
     * Stop trickling
     */
    private stopTrickle(): void {
        if (this.trickleInterval) {
            clearInterval(this.trickleInterval);
            this.trickleInterval = null;
        }
    }

    /**
     * Complete the progress bar
     */
    done(force: boolean = false): void {
        if (!this.isRunning && !force) return;

        // Clear delay timeout if progress hasn't shown yet
        if (this.delayTimeout) {
            clearTimeout(this.delayTimeout);
            this.delayTimeout = null;
        }

        this.stopTrickle();

        // If not visible yet, just clean up
        if (!this.isVisible) {
            this.isRunning = false;
            document.documentElement.classList.remove('accelade-navigating');
            return;
        }

        // Complete to 100%
        this.set(100);

        // Hide after animation completes
        setTimeout(() => {
            this.hide();

            // Reset after fade out
            setTimeout(() => {
                this.set(0);
                this.isRunning = false;
                document.documentElement.classList.remove('accelade-navigating');
            }, 200);
        }, this.config.speed);
    }

    /**
     * Check if progress bar is running
     */
    isActive(): boolean {
        return this.isRunning;
    }

    /**
     * Remove the progress bar from DOM
     */
    remove(): void {
        this.done(true);
        if (this.element) {
            this.element.remove();
            this.element = null;
            this.barElement = null;
            this.spinnerElement = null;
        }
    }
}

// Singleton instance
let progressInstance: AcceladeProgress | null = null;

/**
 * Get or create the progress instance
 */
export function getProgress(config?: ProgressConfig): AcceladeProgress {
    if (!progressInstance) {
        progressInstance = new AcceladeProgress(config);
    } else if (config) {
        progressInstance.configure(config);
    }
    return progressInstance;
}

/**
 * Configure the progress bar
 */
export function configureProgress(config: ProgressConfig): void {
    getProgress().configure(config);
}

/**
 * Start the progress bar
 */
export function startProgress(): void {
    getProgress().start();
}

/**
 * Set progress value
 */
export function setProgress(value: number): void {
    getProgress().set(value);
}

/**
 * Increment progress
 */
export function incProgress(amount?: number): void {
    getProgress().inc(amount);
}

/**
 * Complete the progress bar
 */
export function doneProgress(force?: boolean): void {
    getProgress().done(force);
}

// Export the class for type usage
export { AcceladeProgress };

export default {
    AcceladeProgress,
    getProgress,
    configureProgress,
    startProgress,
    setProgress,
    incProgress,
    doneProgress,
};
</file>

<file path="resources/views/components/layouts/docs.blade.php">
@props([
    'section' => 'getting-started',
    'framework' => 'vanilla',
    'documentation' => null,
    'hasDemo' => true,
    'navigation' => null,
])

@php
    // Framework configuration
    $frameworks = [
        'vanilla' => ['label' => 'Vanilla JS', 'color' => '#f7df1e'],
        'vue' => ['label' => 'Vue.js', 'color' => '#42b883'],
        'react' => ['label' => 'React', 'color' => '#61dafb'],
        'svelte' => ['label' => 'Svelte', 'color' => '#ff3e00'],
        'angular' => ['label' => 'Angular', 'color' => '#dd0031'],
    ];
    $currentFramework = $frameworks[$framework] ?? $frameworks['vanilla'];

    // Framework prefixes
    $frameworkPrefixes = [
        'vanilla' => 'a',
        'vue' => 'v',
        'react' => 'data-state',
        'svelte' => 's',
        'angular' => 'ng',
    ];
    $prefix = $frameworkPrefixes[$framework] ?? 'a';

    // Icon mapping for section slugs
    $sectionIcons = [
        'getting-started' => '👋',
        'installation' => '📦',
        'configuration' => '⚙️',
        'frameworks' => '🏗️',
        'architecture' => '🏛️',
        'testing' => '🧪',
        'counter' => '🔢',
        'data' => '💾',
        'state' => '🔀',
        'scripts' => '📜',
        'modal' => '🪟',
        'toggle' => '🔘',
        'transition' => '✨',
        'notifications' => '🔔',
        'code-block' => '💻',
        'lazy' => '💤',
        'defer' => '⏱️',
        'content' => '📄',
        'rehydrate' => '🔄',
        'teleport' => '🚀',
        'navigation' => '🧭',
        'link' => '🔗',
        'progress' => '📊',
        'persistent' => '📌',
        'event-bus' => '📡',
        'event' => '📻',
        'bridge' => '🌉',
        'shared-data' => '📤',
        'flash' => '⚡',
        'errors' => '⚠️',
        'api-reference' => '📚',
        'contributing' => '🤝',
        'sponsor' => '💖',
        'thanks' => '🙏',
    ];

    // Use navigation from registry if provided, otherwise get from app
    $navData = $navigation ?? app('accelade.docs')->getNavigation();

    // Build section groups from navigation data
    $sectionGroups = [];
    $allSections = [];
    foreach ($navData as $group) {
        $groupSections = [];
        foreach ($group['items'] as $item) {
            $sectionData = [
                'id' => $item['slug'],
                'label' => $item['label'],
                'icon' => $sectionIcons[$item['slug']] ?? '📄',
                'demo' => $item['hasDemo'],
                'keywords' => '',
            ];
            $groupSections[] = $sectionData;
            $allSections[$item['slug']] = $sectionData;
        }
        $sectionGroups[$group['label']] = $groupSections;
    }

    // Current section info
    $currentSection = $allSections[$section] ?? ['label' => ucfirst($section)];

    // Get doc file from registry for GitHub edit URL
    $registry = app('accelade.docs');
    $docSection = $registry->getSection($section);
    $docFile = $docSection?->markdownFile ?? 'getting-started.md';
    $githubRepo = config('accelade.docs.github_repo', 'accelade/accelade');
    $githubEditUrl = "https://github.com/{$githubRepo}/edit/master/docs/{$docFile}";

    // Extract headings from documentation for TOC
    $tocItems = [];
    if ($documentation) {
        preg_match_all('/<h([2-3])[^>]*id="([^"]*)"[^>]*>([^<]*)<\/h[2-3]>/i', $documentation, $matches, PREG_SET_ORDER);
        foreach ($matches as $match) {
            $tocItems[] = [
                'level' => (int) $match[1],
                'id' => $match[2],
                'text' => strip_tags($match[3]),
            ];
        }
        // If no IDs found, try matching without IDs and we'll generate them
        if (empty($tocItems)) {
            preg_match_all('/<h([2-3])[^>]*>([^<]*)<\/h[2-3]>/i', $documentation, $matches, PREG_SET_ORDER);
            foreach ($matches as $i => $match) {
                $id = \Illuminate\Support\Str::slug($match[2]);
                $tocItems[] = [
                    'level' => (int) $match[1],
                    'id' => $id,
                    'text' => strip_tags($match[2]),
                ];
            }
        }
    }
@endphp
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}" dir="{{ in_array(app()->getLocale(), ['ar', 'he', 'fa', 'ur']) ? 'rtl' : 'ltr' }}" class="scroll-smooth">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <meta name="accelade-framework" content="{{ $framework }}">
    <meta name="color-scheme" content="light dark">

    <title>{{ $currentSection['label'] }} - Accelade Documentation</title>
    <meta name="description" content="Learn about {{ $currentSection['label'] }} in Accelade - a reactive Blade template library for Laravel. Build dynamic UIs without complex JavaScript frameworks.">
    <meta name="keywords" content="accelade, laravel, blade, reactive, {{ strtolower($currentSection['label']) }}, php, frontend">
    <meta name="author" content="Accelade">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="{{ url()->current() }}">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="Accelade Documentation">
    <meta property="og:title" content="{{ $currentSection['label'] }} - Accelade Docs">
    <meta property="og:description" content="Learn about {{ $currentSection['label'] }} in Accelade - a reactive Blade template library for Laravel.">
    <meta property="og:url" content="{{ url()->current() }}">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ $currentSection['label'] }} - Accelade Docs">
    <meta name="twitter:description" content="Learn about {{ $currentSection['label'] }} in Accelade - a reactive Blade template library for Laravel.">

    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=inter:400,500,600,700|jetbrains-mono:400,500" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    @if(file_exists(public_path('build/manifest.json')))
        @vite(['resources/css/app.css'])
    @else
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                darkMode: 'class',
                safelist: [
                    // Light mode
                    'bg-white',
                    'bg-slate-50',
                    'bg-slate-100',
                    'border-slate-100',
                    'border-slate-200',
                    'text-slate-800',
                    'text-slate-700',
                    'text-slate-600',
                    'text-slate-500',
                    'text-slate-400',
                    'text-green-600',
                    'text-red-600',
                    // Dark mode
                    'dark:bg-slate-800',
                    'dark:bg-slate-700',
                    'dark:bg-slate-900',
                    'dark:border-slate-700',
                    'dark:border-slate-600',
                    'dark:text-slate-100',
                    'dark:text-slate-200',
                    'dark:text-slate-300',
                    'dark:text-slate-400',
                    'dark:text-slate-500',
                    'dark:text-green-400',
                    'dark:text-red-400',
                    'dark:hidden',
                    'dark:block',
                ]
            }
        </script>
    @endif

    @acceladeStyles
    @php app('accelade')->setFramework($framework); @endphp

    <style>
        :root {
            --docs-bg: #ffffff;
            --docs-bg-alt: #f8fafc;
            --docs-text: #0f172a;
            --docs-text-muted: #64748b;
            --docs-border: #e2e8f0;
            --docs-accent: #ea7023;
            --docs-primary: #18395c;
        }
        .dark {
            --docs-bg: #0f172a;
            --docs-bg-alt: #1e293b;
            --docs-text: #f1f5f9;
            --docs-text-muted: #94a3b8;
            --docs-border: #334155;
            --docs-accent: #fb923c;
            --docs-primary: #60a5fa;
        }
        body { background: var(--docs-bg); color: var(--docs-text); font-family: 'Inter', sans-serif; }

        /* Global scrollbar styling */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--docs-bg); }
        ::-webkit-scrollbar-thumb { background: var(--docs-border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--docs-text-muted); }
        * { scrollbar-width: thin; scrollbar-color: var(--docs-border) var(--docs-bg); }

        /* Sidebar */
        .sidebar { background: var(--docs-bg-alt); border-color: var(--docs-border); }

        /* Sidebar scrollbar styling */
        .sidebar::-webkit-scrollbar { width: 6px; }
        .sidebar::-webkit-scrollbar-track { background: transparent; }
        .sidebar::-webkit-scrollbar-thumb { background: var(--docs-border); border-radius: 3px; }
        .sidebar::-webkit-scrollbar-thumb:hover { background: var(--docs-text-muted); }
        .sidebar { scrollbar-width: thin; scrollbar-color: var(--docs-border) transparent; }

        .sidebar-group { margin-bottom: 1.25rem; }
        .sidebar-group-title {
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--docs-text-muted);
            padding-inline: 0.75rem;
            margin-bottom: 0.375rem;
        }
        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.8125rem;
            color: var(--docs-text-muted);
            border-radius: 0.375rem;
            transition: all 0.15s;
        }
        .sidebar-link:hover { color: var(--docs-text); background: var(--docs-border); }
        .sidebar-link.active { color: var(--docs-accent); font-weight: 500; }
        .sidebar-link .icon { font-size: 0.875rem; width: 1.25rem; text-align: center; }

        /* Mobile sidebar - RTL aware */
        @media (max-width: 1023px) {
            .sidebar {
                position: fixed;
                z-index: 50;
                height: 100vh;
                width: 280px;
                transition: transform 0.2s;
                inset-inline-start: 0;
            }
            [dir="ltr"] .sidebar { transform: translateX(-100%); }
            [dir="rtl"] .sidebar { transform: translateX(100%); }
            .sidebar.mobile-open { transform: translateX(0) !important; }
        }

        /* Right Sidebar (TOC) - RTL aware */
        .toc { position: sticky; top: 5rem; }
        .toc-link {
            display: block;
            padding: 0.25rem 0;
            font-size: 0.8125rem;
            color: var(--docs-text-muted);
            transition: color 0.15s;
            border-inline-start: 2px solid transparent;
            padding-inline-start: 0.75rem;
            margin-inline-start: -2px;
        }
        .toc-link:hover { color: var(--docs-text); }
        .toc-link.active { color: var(--docs-accent); border-color: var(--docs-accent); }
        .toc-link.level-3 { padding-inline-start: 1.5rem; font-size: 0.75rem; }

        /* Header */
        .docs-header { background: var(--docs-bg); border-color: var(--docs-border); }

        /* Tabs */
        .tab-btn { padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 500; border-bottom: 2px solid transparent; color: var(--docs-text-muted); transition: all 0.15s; }
        .tab-btn:hover { color: var(--docs-text); }
        .tab-btn.active { color: var(--docs-accent); border-color: var(--docs-accent); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Cloak pattern - hide until JS is ready */
        [data-cloak] { display: none !important; }

        /* Documentation prose - GitHub-style markdown */
        .docs-prose {
            font-size: 1rem;
            line-height: 1.75;
            color: var(--docs-text);
            word-wrap: break-word;
        }

        /* Headings */
        .docs-prose h1,
        .docs-prose h2,
        .docs-prose h3,
        .docs-prose h4,
        .docs-prose h5,
        .docs-prose h6 {
            margin-top: 1.5em;
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.25;
            color: var(--docs-text);
        }
        .docs-prose h1 { font-size: 2em; padding-bottom: 0.3em; border-bottom: 1px solid var(--docs-border); margin-top: 0; }
        .docs-prose h2 { font-size: 1.5em; padding-bottom: 0.3em; border-bottom: 1px solid var(--docs-border); scroll-margin-top: 5rem; }
        .docs-prose h3 { font-size: 1.25em; scroll-margin-top: 5rem; }
        .docs-prose h4 { font-size: 1em; }
        .docs-prose h5 { font-size: 0.875em; }
        .docs-prose h6 { font-size: 0.85em; color: var(--docs-text-muted); }

        /* Paragraphs */
        .docs-prose p {
            margin-top: 0;
            margin-bottom: 1em;
        }

        /* Links */
        .docs-prose a {
            color: var(--docs-accent);
            text-decoration: none;
        }
        .docs-prose a:hover {
            text-decoration: underline;
        }

        /* Bold and emphasis */
        .docs-prose strong { font-weight: 600; color: var(--docs-text); }
        .docs-prose em { font-style: italic; }

        /* Inline code */
        .docs-prose code {
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
            background-color: var(--docs-bg-alt);
            border-radius: 6px;
            border: 1px solid var(--docs-border);
        }
        .docs-prose pre code {
            padding: 0;
            margin: 0;
            font-size: 100%;
            background-color: transparent;
            border: none;
            border-radius: 0;
        }

        /* Code blocks */
        .docs-prose pre {
            padding: 1rem;
            overflow: auto;
            font-size: 0.875rem;
            line-height: 1.45;
            background-color: var(--docs-bg-alt);
            border-radius: 6px;
            margin-top: 0;
            margin-bottom: 1rem;
        }

        /* Lists */
        .docs-prose ul,
        .docs-prose ol {
            margin-top: 0;
            margin-bottom: 1rem;
            padding-inline-start: 2em;
        }
        .docs-prose ul { list-style-type: disc; }
        .docs-prose ol { list-style-type: decimal; }
        .docs-prose ul ul,
        .docs-prose ol ol,
        .docs-prose ul ol,
        .docs-prose ol ul {
            margin-top: 0.25em;
            margin-bottom: 0;
        }
        .docs-prose li {
            margin-bottom: 0.25em;
        }
        .docs-prose li + li {
            margin-top: 0.25em;
        }
        .docs-prose li > p {
            margin-top: 1em;
        }
        .docs-prose li > ul,
        .docs-prose li > ol {
            margin-top: 0.25em;
        }

        /* Task lists (checkboxes) */
        .docs-prose input[type="checkbox"] {
            margin-inline-end: 0.5em;
            vertical-align: middle;
        }

        /* Blockquotes */
        .docs-prose blockquote {
            margin: 0 0 1rem 0;
            padding: 0 1em;
            color: var(--docs-text-muted);
            border-inline-start: 0.25em solid var(--docs-border);
        }
        .docs-prose blockquote > :first-child { margin-top: 0; }
        .docs-prose blockquote > :last-child { margin-bottom: 0; }

        /* Horizontal rules */
        .docs-prose hr {
            height: 2px;
            padding: 0;
            margin: 2rem 0;
            background: linear-gradient(to right, transparent, var(--docs-border), transparent);
            border: 0;
        }
        .dark .docs-prose hr {
            background: linear-gradient(to right, transparent, var(--docs-text-muted), transparent);
        }

        /* Tables */
        .docs-prose table {
            display: block;
            width: 100%;
            max-width: 100%;
            overflow: auto;
            border-spacing: 0;
            border-collapse: collapse;
            margin-top: 0;
            margin-bottom: 1rem;
        }
        .docs-prose table th,
        .docs-prose table td {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--docs-border);
        }
        .docs-prose table th {
            font-weight: 600;
            background-color: var(--docs-bg-alt);
            text-align: start;
        }
        .docs-prose table tr {
            background-color: var(--docs-bg);
            border-top: 1px solid var(--docs-border);
        }
        .docs-prose table tr:nth-child(2n) {
            background-color: var(--docs-bg-alt);
        }

        /* Images */
        .docs-prose img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            margin: 1rem 0;
        }

        /* Definition lists */
        .docs-prose dl {
            padding: 0;
            margin-bottom: 1rem;
        }
        .docs-prose dl dt {
            padding: 0;
            margin-top: 1rem;
            font-weight: 600;
        }
        .docs-prose dl dd {
            padding: 0 1rem;
            margin-bottom: 1rem;
            margin-inline-start: 0;
        }

        /* Keyboard keys */
        .docs-prose kbd {
            display: inline-block;
            padding: 0.2em 0.4em;
            font-size: 0.875em;
            font-family: 'JetBrains Mono', monospace;
            line-height: 1;
            color: var(--docs-text);
            vertical-align: middle;
            background-color: var(--docs-bg-alt);
            border: 1px solid var(--docs-border);
            border-radius: 6px;
            box-shadow: inset 0 -1px 0 var(--docs-border);
        }

        /* Abbreviations */
        .docs-prose abbr[title] {
            text-decoration: underline dotted;
            cursor: help;
            border-bottom: none;
        }

        /* First child and last child cleanup */
        .docs-prose > :first-child { margin-top: 0 !important; }
        .docs-prose > :last-child { margin-bottom: 0 !important; }

        /* Note/Warning/Info boxes - for custom callouts */
        .docs-prose .note,
        .docs-prose .warning,
        .docs-prose .info,
        .docs-prose .tip {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 6px;
            border-inline-start: 4px solid;
        }
        .docs-prose .note {
            background-color: rgba(59, 130, 246, 0.1);
            border-color: #3b82f6;
        }
        .docs-prose .warning {
            background-color: rgba(245, 158, 11, 0.1);
            border-color: #f59e0b;
        }
        .docs-prose .info {
            background-color: rgba(99, 102, 241, 0.1);
            border-color: #6366f1;
        }
        .docs-prose .tip {
            background-color: rgba(16, 185, 129, 0.1);
            border-color: #10b981;
        }

        /* Framework selector */
        .framework-btn { display: flex; align-items: center; gap: 0.5rem; padding: 0.375rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 500; border: 1px solid var(--docs-border); transition: all 0.15s; }
        .framework-btn:hover { border-color: var(--docs-accent); }
        .framework-dropdown { background: var(--docs-bg); border: 1px solid var(--docs-border); border-radius: 0.5rem; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.2); }

        /* Code block styling - handled by code-block component */
        .docs-prose .code-block-wrapper { margin: 1.5rem 0; }
        .docs-prose pre code {
            font-size: 0.875rem;
            line-height: 1.7;
        }
    </style>
</head>
<body class="min-h-screen antialiased" data-section="{{ $section }}">
    <!-- Mobile overlay -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden" onclick="toggleMobileSidebar()"></div>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar w-60 border-e flex flex-col shrink-0 lg:sticky lg:top-0 lg:h-screen">
            <!-- Logo -->
            <div class="p-4 border-b border-[var(--docs-border)]">
                <x-accelade::link href="{{ route('docs.section', ['section' => 'getting-started']) }}" class="flex items-center gap-3" activeClass="">
                    <img src="{{ asset('vendor/accelade/logo-dark.png') }}" alt="Accelade" class="h-7 w-auto dark:hidden">
                    <img src="{{ asset('vendor/accelade/logo-light.png') }}" alt="Accelade" class="h-7 w-auto hidden dark:block">
                    <span class="font-bold text-lg">Accelade</span>
                </x-accelade::link>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-3 overflow-y-auto" id="docs-sidebar-nav">
                @foreach($sectionGroups as $groupName => $sections)
                    <div class="sidebar-group">
                        <div class="sidebar-group-title">{{ $groupName }}</div>
                        @foreach($sections as $s)
                            <x-accelade::link
                                href="{{ route('docs.section', ['section' => $s['id'], 'framework' => $framework]) }}"
                                :preserveScroll="true"
                                class="sidebar-link {{ $section === $s['id'] ? 'active' : '' }}"
                                activeClass="">
                                <span class="icon">{{ $s['icon'] }}</span>
                                <span>{{ $s['label'] }}</span>
                            </x-accelade::link>
                        @endforeach
                    </div>
                @endforeach
            </nav>

            <!-- Version -->
            <div class="p-3 border-t border-[var(--docs-border)] text-xs text-[var(--docs-text-muted)]">
                v1.0.0
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col min-w-0">
            <!-- Header -->
            <header class="docs-header sticky top-0 z-30 border-b px-4 lg:px-6">
                <div class="h-14 flex items-center justify-between gap-4">
                    <!-- Mobile menu -->
                    <button onclick="toggleMobileSidebar()" class="p-2 -ms-2 rounded-lg hover:bg-[var(--docs-bg-alt)] lg:hidden">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
                    </button>

                    <!-- Framework Selector -->
                    <div class="relative">
                        <button onclick="toggleFrameworkDropdown()" class="framework-btn">
                            @include('accelade::components.layouts.partials.framework-icon', ['fw' => $framework, 'size' => 'w-5 h-5'])
                            <span class="hidden sm:inline">{{ $currentFramework['label'] }}</span>
                            <svg class="w-4 h-4 text-[var(--docs-text-muted)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                        </button>
                        <div id="framework-dropdown" class="framework-dropdown hidden absolute start-0 mt-2 w-48 py-1 z-50">
                            @foreach($frameworks as $fw => $config)
                                <a href="{{ route('docs.section', ['section' => $section, 'framework' => $fw]) }}"
                                   class="flex items-center gap-3 px-4 py-2 text-sm hover:bg-[var(--docs-bg-alt)] {{ $framework === $fw ? 'text-[var(--docs-accent)] font-medium' : '' }}">
                                    @include('accelade::components.layouts.partials.framework-icon', ['fw' => $fw, 'size' => 'w-5 h-5'])
                                    {{ $config['label'] }}
                                </a>
                            @endforeach
                        </div>
                    </div>

                    <!-- Search -->
                    <button onclick="openSearch()" class="flex-1 max-w-md flex items-center gap-2 px-3 py-1.5 rounded-lg bg-[var(--docs-bg-alt)] border border-[var(--docs-border)] text-[var(--docs-text-muted)] text-sm hover:border-[var(--docs-accent)]">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                        <span class="hidden sm:inline">Search...</span>
                        <kbd class="ms-auto px-1.5 py-0.5 text-xs rounded bg-[var(--docs-bg)] border border-[var(--docs-border)] hidden sm:inline">⌘K</kbd>
                    </button>

                    <!-- Actions -->
                    <div class="flex items-center gap-1">
                        <a href="https://github.com/{{ $githubRepo }}" target="_blank" class="p-2 rounded-lg hover:bg-[var(--docs-bg-alt)] text-[var(--docs-text-muted)]" title="GitHub">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                        </a>
                        <a href="https://acceladephp.com" target="_blank" class="p-2 rounded-lg hover:bg-[var(--docs-bg-alt)] text-[var(--docs-text-muted)] hidden sm:block" title="Website">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>
                        </a>
                        <button onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-[var(--docs-bg-alt)] text-[var(--docs-text-muted)]" title="Toggle theme">
                            <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
                            <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="flex-1 flex justify-center" data-accelade-page>
                <!-- Main Content -->
                <main class="flex-1 px-4 lg:px-8 py-6 min-w-0 max-w-4xl">
                    @if($hasDemo && $documentation)
                        <!-- Tabs container - hidden by data-cloak until JS sets correct state -->
                        <div id="tabs-container" data-cloak>
                            <!-- Tabs -->
                            <div class="border-b border-[var(--docs-border)] mb-6">
                                <div class="flex gap-4">
                                    <button class="tab-btn active" data-tab="docs">Documentation</button>
                                    <button class="tab-btn" data-tab="demo">
                                        Live Demo
                                        <span class="ms-1 px-1.5 py-0.5 text-xs rounded" style="background: {{ $currentFramework['color'] }}20; color: {{ $currentFramework['color'] }}">
                                            {{ $currentFramework['label'] }}
                                        </span>
                                    </button>
                                </div>
                            </div>

                            <!-- Docs Tab -->
                            <div id="tab-docs" class="tab-content active">
                                <div class="docs-prose" id="docs-content">
                                    {!! $documentation !!}
                                </div>
                            </div>

                            <!-- Demo Tab -->
                            <div id="tab-demo" class="tab-content">
                                {{ $slot }}
                            </div>
                        </div>
                        <script>
                            (function() {
                                var container = document.getElementById('tabs-container');
                                if (localStorage.getItem('docs-tab-{{ $section }}') === 'demo') {
                                    document.getElementById('tab-docs').classList.remove('active');
                                    document.getElementById('tab-demo').classList.add('active');
                                    container.querySelectorAll('.tab-btn')[0].classList.remove('active');
                                    container.querySelectorAll('.tab-btn')[1].classList.add('active');
                                }
                                container.removeAttribute('data-cloak');
                            })();
                        </script>
                    @elseif($documentation)
                        <div class="docs-prose" id="docs-content">
                            {!! $documentation !!}
                        </div>
                    @else
                        {{ $slot }}
                    @endif
                </main>

                <!-- TOC Sidebar -->
                @if(!empty($tocItems))
                <aside class="hidden xl:block w-56 shrink-0 pe-4">
                    <div class="toc py-6">
                        <div class="text-xs font-semibold uppercase tracking-wider text-[var(--docs-text-muted)] mb-3 px-3">
                            On this page
                        </div>
                        <nav class="border-s border-[var(--docs-border)]">
                            @foreach($tocItems as $item)
                                <a href="#{{ $item['id'] }}" class="toc-link {{ $item['level'] === 3 ? 'level-3' : '' }}" data-toc-link>
                                    {{ $item['text'] }}
                                </a>
                            @endforeach
                        </nav>

                        <!-- Edit on GitHub -->
                        <div class="mt-6 pt-4 border-t border-[var(--docs-border)]">
                            <a href="{{ $githubEditUrl }}" target="_blank" class="flex items-center gap-2 text-xs text-[var(--docs-text-muted)] hover:text-[var(--docs-accent)]">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
                                Edit this page on GitHub
                            </a>
                        </div>
                    </div>
                </aside>
                @endif
            </div>

            <!-- Footer -->
            <footer class="border-t border-[var(--docs-border)] py-6 px-4 lg:px-8">
                <div class="max-w-3xl flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-[var(--docs-text-muted)]">
                    <div class="flex items-center gap-4">
                        <a href="https://acceladephp.com" target="_blank" class="hover:text-[var(--docs-accent)]">Website</a>
                        <a href="https://github.com/{{ $githubRepo }}" target="_blank" class="hover:text-[var(--docs-accent)]">GitHub</a>
                        <a href="https://github.com/{{ $githubRepo }}/issues" target="_blank" class="hover:text-[var(--docs-accent)]">Issues</a>
                    </div>
                    <div>Built with Accelade & Laravel</div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="search-modal" class="fixed inset-0 z-50 hidden">
        <div class="fixed inset-0 bg-black/50" onclick="closeSearch()"></div>
        <div class="fixed inset-x-4 top-[15%] sm:inset-x-auto sm:left-1/2 sm:-translate-x-1/2 sm:w-full sm:max-w-lg">
            <div class="rounded-xl border border-[var(--docs-border)] bg-[var(--docs-bg)] shadow-2xl overflow-hidden">
                <div class="flex items-center gap-3 px-4 py-3 border-b border-[var(--docs-border)]">
                    <svg class="w-5 h-5 text-[var(--docs-text-muted)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    <input type="text" id="search-input" class="flex-1 bg-transparent outline-none" placeholder="Search documentation..." oninput="handleSearch(this.value)">
                    <kbd class="px-1.5 py-0.5 text-xs rounded bg-[var(--docs-bg-alt)] border border-[var(--docs-border)] text-[var(--docs-text-muted)]">ESC</kbd>
                </div>
                <div id="search-results" class="max-h-80 overflow-y-auto p-2">
                    @foreach($sectionGroups as $groupName => $sections)
                        <div class="search-group" data-group="{{ \Illuminate\Support\Str::slug($groupName) }}">
                            <div class="search-group-title px-2 py-1.5 text-xs font-medium text-[var(--docs-text-muted)] uppercase">{{ $groupName }}</div>
                            @foreach($sections as $s)
                                <x-accelade::link
                                    href="{{ route('docs.section', ['section' => $s['id'], 'framework' => $framework]) }}"
                                    class="search-item flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-[var(--docs-bg-alt)]"
                                    activeClass=""
                                    data-search="{{ strtolower($s['label'] . ' ' . $groupName . ' ' . ($s['keywords'] ?? '')) }}"
                                    data-group="{{ \Illuminate\Support\Str::slug($groupName) }}">
                                    <span>{{ $s['icon'] }}</span>
                                    <span class="font-medium">{{ $s['label'] }}</span>
                                </x-accelade::link>
                            @endforeach
                        </div>
                    @endforeach
                </div>
            </div>
        </div>
    </div>

    @acceladeScripts
    @acceladeNotifications

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup-templating.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script>
        // Theme initialization
        (function() {
            var stored = localStorage.getItem('docs-theme');
            var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.classList.toggle('dark', stored === 'dark' || (!stored && prefersDark));
        })();

        function toggleTheme() {
            var isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('docs-theme', isDark ? 'dark' : 'light');
        }

        function toggleMobileSidebar() {
            document.getElementById('sidebar').classList.toggle('mobile-open');
            document.getElementById('sidebar-overlay').classList.toggle('hidden');
        }

        function toggleFrameworkDropdown() {
            document.getElementById('framework-dropdown').classList.toggle('hidden');
        }

        function openSearch() {
            document.getElementById('search-modal').classList.remove('hidden');
            document.getElementById('search-input').focus();
            document.body.style.overflow = 'hidden';
        }

        function closeSearch() {
            document.getElementById('search-modal').classList.add('hidden');
            document.getElementById('search-input').value = '';
            document.body.style.overflow = '';
            document.querySelectorAll('.search-item, .search-group').forEach(function(el) {
                el.style.display = '';
            });
        }

        function handleSearch(query) {
            var q = query.toLowerCase().trim();
            var groupVisibility = {};

            document.querySelectorAll('.search-item').forEach(function(el) {
                var matches = !q || el.dataset.search.includes(q);
                el.style.display = matches ? '' : 'none';
                groupVisibility[el.dataset.group] = groupVisibility[el.dataset.group] || matches;
            });

            document.querySelectorAll('.search-group').forEach(function(group) {
                group.style.display = groupVisibility[group.dataset.group] ? '' : 'none';
            });
        }

        function updateTocActive() {
            var docsTab = document.getElementById('tab-docs');
            if (!docsTab || !docsTab.classList.contains('active')) {
                return;
            }

            var currentId = '';
            document.querySelectorAll('.docs-prose h2[id], .docs-prose h3[id]').forEach(function(h) {
                if (h.getBoundingClientRect().top <= 120) {
                    currentId = h.id;
                }
            });

            document.querySelectorAll('[data-toc-link]').forEach(function(link) {
                link.classList.toggle('active', link.getAttribute('href') === '#' + currentId);
            });
        }

        window.switchTab = function(tab) {
            document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
            document.querySelectorAll('.tab-content').forEach(function(c) { c.classList.remove('active'); });

            var tabBtn = document.querySelector('.tab-btn[data-tab="' + tab + '"]');
            var tabContent = document.getElementById('tab-' + tab);
            if (tabBtn) { tabBtn.classList.add('active'); }
            if (tabContent) { tabContent.classList.add('active'); }

            var section = document.body.dataset.section || 'default';
            localStorage.setItem('docs-tab-' + section, tab);
        };

        // Markdown filename to section slug mapping
        var docToSection = {
            'getting-started.md': 'getting-started', 'installation.md': 'installation',
            'configuration.md': 'configuration', 'components.md': 'counter',
            'data.md': 'data', 'state.md': 'state', 'modal.md': 'modal',
            'toggle.md': 'toggle', 'animations.md': 'transition',
            'notifications.md': 'notifications', 'code-block.md': 'code-block',
            'lazy-loading.md': 'lazy', 'content.md': 'content', 'rehydrate.md': 'rehydrate',
            'teleport.md': 'teleport', 'spa-navigation.md': 'navigation', 'link.md': 'link',
            'persistent-layout.md': 'persistent', 'event-bus.md': 'event-bus',
            'event.md': 'event', 'bridge.md': 'bridge', 'shared-data.md': 'shared-data',
            'flash.md': 'flash', 'exception-handling.md': 'errors', 'scripts.md': 'scripts',
            'api-reference.md': 'api-reference', 'frameworks.md': 'frameworks',
            'architecture.md': 'architecture', 'testing.md': 'testing',
            'contributing.md': 'contributing', 'sponsor.md': 'sponsor', 'thanks.md': 'thanks'
        };

        function fixDocLinks() {
            var docsContent = document.getElementById('docs-content');
            if (!docsContent) {
                return;
            }

            docsContent.querySelectorAll('a[href]').forEach(function(link) {
                var href = link.getAttribute('href');
                if (!href || href.startsWith('http') || href.startsWith('#')) {
                    return;
                }

                var filename = href.split('/').pop();
                if (filename.endsWith('.md')) {
                    var sectionId = docToSection[filename];
                    if (sectionId) {
                        link.setAttribute('href', '/docs/' + sectionId + '?framework={{ $framework }}');
                        link.setAttribute('a-navigate', '');
                    }
                }
            });
        }

        function initDocsPage() {
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }

            fixDocLinks();
            updateTocActive();

            document.querySelectorAll('.docs-prose h2, .docs-prose h3').forEach(function(h) {
                if (!h.id) {
                    h.id = h.textContent.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
                }
            });

            var tabsContainer = document.getElementById('tabs-container');
            if (tabsContainer) {
                var section = document.body.dataset.section || 'default';
                if (localStorage.getItem('docs-tab-' + section) === 'demo') {
                    window.switchTab('demo');
                }
                tabsContainer.removeAttribute('data-cloak');
            }
        }

        // Sidebar scroll preservation
        var sidebarScrollPosition = 0;

        function saveSidebarScroll() {
            var nav = document.getElementById('docs-sidebar-nav');
            if (nav) {
                sidebarScrollPosition = nav.scrollTop;
            }
        }

        function restoreSidebarScroll() {
            var nav = document.getElementById('docs-sidebar-nav');
            if (nav && sidebarScrollPosition > 0) {
                nav.scrollTop = sidebarScrollPosition;
            }
        }

        // Global click handler using event delegation
        document.addEventListener('click', function(e) {
            // Close framework dropdown when clicking outside
            var dropdown = document.getElementById('framework-dropdown');
            if (dropdown && !e.target.closest('.framework-btn') && !dropdown.contains(e.target)) {
                dropdown.classList.add('hidden');
            }

            // Tab switching
            var tabBtn = e.target.closest('.tab-btn');
            if (tabBtn && tabBtn.dataset.tab) {
                window.switchTab(tabBtn.dataset.tab);
            }

            // TOC link click - switch to docs tab and scroll
            var tocLink = e.target.closest('[data-toc-link]');
            if (tocLink) {
                e.preventDefault();
                var targetId = tocLink.getAttribute('href').substring(1);
                var target = document.getElementById(targetId);
                if (target) {
                    window.switchTab('docs');
                    setTimeout(function() {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 50);
                }
            }

            // Code copy button
            var copyBtn = e.target.closest('.code-copy-btn');
            if (copyBtn) {
                handleCodeCopy(copyBtn);
            }

            // Code download button
            var downloadBtn = e.target.closest('.code-download-btn');
            if (downloadBtn) {
                handleCodeDownload(downloadBtn);
            }

            // SPA link click - save sidebar scroll
            if (e.target.closest('a[a-link]')) {
                saveSidebarScroll();
            }
        }, true);

        function handleCodeCopy(btn) {
            var targetId = btn.dataset.codeTarget;
            var pre = document.getElementById(targetId);
            if (!pre) {
                return;
            }

            var code = pre.querySelector('code') || pre;
            navigator.clipboard.writeText(code.textContent).then(function() {
                var copyIcon = btn.querySelector('.copy-icon');
                var checkIcon = btn.querySelector('.check-icon');
                var copyText = btn.querySelector('.copy-text');

                if (copyIcon) { copyIcon.classList.add('hidden'); }
                if (checkIcon) { checkIcon.classList.remove('hidden'); }
                if (copyText) { copyText.textContent = 'Copied!'; }

                setTimeout(function() {
                    if (copyIcon) { copyIcon.classList.remove('hidden'); }
                    if (checkIcon) { checkIcon.classList.add('hidden'); }
                    if (copyText) { copyText.textContent = 'Copy'; }
                }, 2000);
            });
        }

        function handleCodeDownload(btn) {
            var targetId = btn.dataset.codeTarget;
            var wrapper = document.querySelector('[data-code-block="' + targetId + '"]');
            if (!wrapper) {
                return;
            }

            var originalText = btn.querySelector('span:last-child');
            var originalContent = originalText ? originalText.textContent : 'Image';
            if (originalText) {
                originalText.textContent = 'Loading...';
            }

            try {
                var pre = document.getElementById(targetId);
                var codeEl = pre && pre.querySelector('code') || pre;
                var langLabel = wrapper.querySelector('.text-xs.font-medium.uppercase');
                langLabel = langLabel ? langLabel.textContent.trim() : 'CODE';

                var coloredLines = extractColoredLines(codeEl);
                var canvas = renderCodeToCanvas(coloredLines, langLabel);

                var link = document.createElement('a');
                link.download = 'code-snippet.png';
                link.href = canvas.toDataURL('image/png');
                link.click();

                if (originalText) {
                    originalText.textContent = 'Done!';
                }
                setTimeout(function() {
                    if (originalText) {
                        originalText.textContent = originalContent;
                    }
                }, 1500);
            } catch (error) {
                console.error('Failed to generate image:', error);
                if (originalText) {
                    originalText.textContent = originalContent;
                }
                alert('Failed to generate image: ' + error.message);
            }
        }

        function extractColoredLines(element) {
            var tokens = [];

            function walk(node) {
                if (node.nodeType === Node.TEXT_NODE) {
                    var text = node.textContent;
                    if (text) {
                        var color = '#e2e8f0';
                        var parent = node.parentElement;
                        if (parent && parent.classList.contains('token')) {
                            color = window.getComputedStyle(parent).color;
                        }
                        tokens.push({ text: text, color: color });
                    }
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    for (var i = 0; i < node.childNodes.length; i++) {
                        walk(node.childNodes[i]);
                    }
                }
            }
            walk(element);

            var lines = [];
            var currentLine = [];
            tokens.forEach(function(token) {
                var parts = token.text.split('\n');
                parts.forEach(function(part, i) {
                    if (i > 0) {
                        lines.push(currentLine);
                        currentLine = [];
                    }
                    if (part) {
                        currentLine.push({ text: part, color: token.color });
                    }
                });
            });
            if (currentLine.length > 0) {
                lines.push(currentLine);
            }

            return lines;
        }

        function renderCodeToCanvas(coloredLines, langLabel) {
            var config = {
                padding: 40, headerHeight: 48, fontSize: 14, lineHeight: 1.6,
                font: 'JetBrains Mono, SF Mono, Monaco, Consolas, monospace',
                bgColor: '#1e293b', outerBgColor: '#0f172a', borderColor: '#334155',
                textColor: '#e2e8f0', labelColor: '#94a3b8',
                dotColors: ['#ef4444', '#eab308', '#22c55e'], borderRadius: 12
            };

            var canvas = document.createElement('canvas');
            var ctx = canvas.getContext('2d');
            var scale = 2;

            ctx.font = config.fontSize + 'px ' + config.font;
            var maxWidth = 400;
            coloredLines.forEach(function(line) {
                var lineText = line.map(function(t) { return t.text; }).join('');
                var width = ctx.measureText(lineText).width;
                if (width > maxWidth) {
                    maxWidth = width;
                }
            });

            var contentWidth = Math.min(maxWidth + config.padding, 900);
            var codeHeight = coloredLines.length * config.fontSize * config.lineHeight;
            var contentHeight = codeHeight + config.padding;
            var totalWidth = contentWidth + config.padding * 2;
            var totalHeight = contentHeight + config.headerHeight + config.padding * 2;

            canvas.width = totalWidth * scale;
            canvas.height = totalHeight * scale;
            ctx.scale(scale, scale);

            // Outer background gradient
            var gradient = ctx.createLinearGradient(0, 0, totalWidth, totalHeight);
            gradient.addColorStop(0, config.outerBgColor);
            gradient.addColorStop(1, '#1a1a2e');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, totalWidth, totalHeight);

            var blockX = config.padding;
            var blockY = config.padding;
            var blockW = contentWidth;
            var blockH = contentHeight + config.headerHeight;

            // Shadow and container
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetY = 10;
            ctx.fillStyle = config.bgColor;
            ctx.beginPath();
            ctx.roundRect(blockX, blockY, blockW, blockH, config.borderRadius);
            ctx.fill();

            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetY = 0;

            // Border
            ctx.strokeStyle = config.borderColor;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.roundRect(blockX, blockY, blockW, blockH, config.borderRadius);
            ctx.stroke();

            // Header with bottom border
            ctx.fillStyle = config.bgColor;
            ctx.beginPath();
            ctx.roundRect(blockX, blockY, blockW, config.headerHeight, [config.borderRadius, config.borderRadius, 0, 0]);
            ctx.fill();

            ctx.strokeStyle = config.borderColor;
            ctx.beginPath();
            ctx.moveTo(blockX, blockY + config.headerHeight);
            ctx.lineTo(blockX + blockW, blockY + config.headerHeight);
            ctx.stroke();

            // Traffic light dots
            var dotY = blockY + config.headerHeight / 2;
            var dotStartX = blockX + 16;
            config.dotColors.forEach(function(color, i) {
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(dotStartX + (i * 20), dotY, 6, 0, Math.PI * 2);
                ctx.fill();
            });

            // Language label
            ctx.fillStyle = config.labelColor;
            ctx.font = '500 11px ' + config.font;
            ctx.textAlign = 'left';
            ctx.fillText(langLabel.toUpperCase(), dotStartX + 70, dotY + 4);

            // Syntax-highlighted code
            ctx.font = config.fontSize + 'px ' + config.font;
            ctx.textBaseline = 'top';

            var codeStartX = blockX + config.padding / 2;
            var codeStartY = blockY + config.headerHeight + config.padding / 2;

            coloredLines.forEach(function(line, lineIndex) {
                var x = codeStartX;
                var y = codeStartY + (lineIndex * config.fontSize * config.lineHeight);

                line.forEach(function(segment) {
                    ctx.fillStyle = segment.color;
                    ctx.fillText(segment.text, x, y);
                    x += ctx.measureText(segment.text).width;
                });
            });

            return canvas;
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                openSearch();
            }
            if (e.key === 'Escape') {
                closeSearch();
            }
        });

        window.addEventListener('scroll', updateTocActive);

        // SPA navigation handling
        var lastUrl = location.href;
        var observer = new MutationObserver(function() {
            if (location.href !== lastUrl) {
                lastUrl = location.href;
                requestAnimationFrame(function() {
                    restoreSidebarScroll();
                    initDocsPage();
                });
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            initDocsPage();
            observer.observe(document.body, { childList: true, subtree: true });
        });

        window.addEventListener('popstate', function() {
            requestAnimationFrame(function() {
                restoreSidebarScroll();
                initDocsPage();
            });
        });
    </script>
</body>
</html>
</file>

<file path="resources/views/components/code-block.blade.php">
@props([
    'language' => 'markup',
    'filename' => null,
])

@php
    $id = 'code-' . Str::random(8);

    // Map common language names to Prism language classes
    // Blade files use PHP since they contain PHP, HTML, and JS mixed
    $prismLanguage = match($language) {
        'blade' => 'php',
        'html', 'xml' => 'markup',
        'js' => 'javascript',
        default => $language,
    };
@endphp

<div class="code-block-wrapper rounded-xl overflow-hidden shadow-lg my-4" dir="ltr" style="background:#1e293b;border:1px solid #334155;" data-code-block="{{ $id }}">
    {{-- macOS-style title bar --}}
    <div class="flex items-center justify-between px-4 py-3" style="background:#1e293b;border-bottom:1px solid #334155;">
        <div class="flex items-center gap-4">
            {{-- Traffic lights --}}
            <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full" style="background:#ef4444;"></span>
                <span class="w-3 h-3 rounded-full" style="background:#eab308;"></span>
                <span class="w-3 h-3 rounded-full" style="background:#22c55e;"></span>
            </div>
            {{-- Filename or language label --}}
            <span class="text-xs font-medium uppercase tracking-wider" style="color:#94a3b8;">
                {{ $filename ?? $language }}
            </span>
        </div>
        {{-- Action buttons --}}
        <div class="flex items-center gap-2">
            {{-- Copy button --}}
            <button
                type="button"
                class="code-copy-btn flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-md transition-all"
                style="color:#94a3b8;background:rgba(51,65,85,0.5);"
                data-code-target="{{ $id }}"
                title="Copy code"
            >
                <svg class="copy-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                </svg>
                <svg class="check-icon w-4 h-4 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="copy-text">Copy</span>
            </button>
            {{-- Download as image button --}}
            <button
                type="button"
                class="code-download-btn flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-md transition-all"
                style="color:#94a3b8;background:rgba(51,65,85,0.5);"
                data-code-target="{{ $id }}"
                title="Download as image"
            >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                <span>Image</span>
            </button>
        </div>
    </div>
    {{-- Code content --}}
    <div class="code-content overflow-x-auto" style="background:#1e293b;">
        <pre id="{{ $id }}" class="language-{{ $prismLanguage }}" style="margin:0;border-radius:0;background:#1e293b !important;"><code class="language-{{ $prismLanguage }}" style="background:transparent !important;">{!! $slot !!}</code></pre>
    </div>
</div>
</file>

<file path="resources/views/components/notifications.blade.php">
@php
    $notifications = app('accelade.notify')->flush();
@endphp

@if($notifications->isNotEmpty())
<script data-accelade-notifications>
    (function() {
        // Generate unique ID to prevent duplicate execution
        const scriptId = '{{ md5(json_encode($notifications)) }}';

        // Check if this exact set of notifications was already shown
        if (window.__acceladeNotificationsShown && window.__acceladeNotificationsShown[scriptId]) {
            return;
        }

        // Mark as shown
        window.__acceladeNotificationsShown = window.__acceladeNotificationsShown || {};
        window.__acceladeNotificationsShown[scriptId] = true;

        const notifications = @json($notifications);

        function showNotifications() {
            notifications.forEach(function(n) {
                window.Accelade?.notify?.show(n);
            });
        }

        // Show immediately if Accelade is ready, otherwise wait for DOMContentLoaded
        if (window.Accelade?.notify) {
            showNotifications();
        } else if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', showNotifications, { once: true });
        } else {
            // DOM is ready but Accelade might not be, retry shortly
            setTimeout(function checkAccelade() {
                if (window.Accelade?.notify) {
                    showNotifications();
                } else {
                    setTimeout(checkAccelade, 50);
                }
            }, 10);
        }
    })();
</script>
@endif
</file>

<file path="resources/views/components/toggle.blade.php">
@props([
    'data' => false,
    'animation' => null,
])

@php
    $framework = config('accelade.framework', 'vanilla');
    $id = $attributes->get('id', 'toggle-' . uniqid());

    // Get animation preset if specified
    $animationConfig = null;
    if ($animation) {
        $preset = app('accelade.animation')->get($animation);
        if ($preset) {
            $animationConfig = $preset->toArray();
        }
    }

    // Parse data attribute to determine keys and default value
    $keys = [];
    $defaultValue = false;

    if (is_bool($data)) {
        // Single toggle with boolean default: :data="true" or :data="false"
        $keys = ['toggled'];
        $defaultValue = $data;
    } elseif (is_string($data)) {
        if ($data === 'true') {
            // String "true" - single toggle default true
            $keys = ['toggled'];
            $defaultValue = true;
        } elseif ($data === 'false' || $data === '') {
            // String "false" or empty - single toggle default false
            $keys = ['toggled'];
            $defaultValue = false;
        } else {
            // Comma-separated keys: data="isCompany, hasVatNumber"
            $keys = array_map('trim', explode(',', $data));
            $keys = array_filter($keys, fn($k) => !empty($k));
            $defaultValue = false;
        }
    } elseif (is_array($data)) {
        // Array of keys with values: :data="['isCompany' => true, 'hasVat' => false]"
        $keys = array_keys($data);
        // Use the array as initial state
    }

    // Build initial state
    $initialState = [];
    if (is_array($data) && !empty($data)) {
        // Check if it's an associative array with values (not just keys)
        $firstKey = array_key_first($data);
        if (is_string($firstKey)) {
            // Associative array with values: ['isCompany' => true, 'hasVat' => false]
            foreach ($data as $key => $value) {
                $initialState[$key] = (bool) $value;
            }
        } else {
            // Numeric keys - treat as key names with default value
            foreach ($data as $key) {
                $initialState[$key] = $defaultValue;
            }
        }
    } else {
        // Keys with default value
        foreach ($keys as $key) {
            $initialState[$key] = $defaultValue;
        }
    }

    // For toggle data attribute (passed to JS)
    $toggleData = is_bool($data) ? ($data ? 'true' : 'false') : (is_array($data) ? implode(', ', $keys) : $data);
@endphp

<div
    data-accelade
    data-accelade-toggle
    data-toggle-id="{{ $id }}"
    @if($toggleData) data-toggle-data="{{ $toggleData }}" @endif
    data-toggle-default="{{ $defaultValue ? 'true' : 'false' }}"
    @if($animationConfig) data-toggle-animation="{{ json_encode($animationConfig) }}" @endif
    data-accelade-state="{{ json_encode($initialState) }}"
    {{ $attributes->except(['id', 'data', 'animation']) }}
>{{ $slot }}</div>
</file>

<file path="resources/views/components/transition.blade.php">
@props([
    'show' => null,
    'animation' => null,
    'enter' => null,
    'enterFrom' => null,
    'enterTo' => null,
    'leave' => null,
    'leaveFrom' => null,
    'leaveTo' => null,
])

@php
    $id = $attributes->get('id', 'transition-' . uniqid());

    // Get animation preset if specified
    $preset = null;
    if ($animation) {
        $preset = app('accelade.animation')->get($animation);
    }

    // Build transition classes - prefer explicit props over preset
    $transitionClasses = [
        'enter' => $enter ?? ($preset?->enter->transition ?? 'transition ease-out duration-200'),
        'enterFrom' => $enterFrom ?? ($preset?->enter->from ?? 'opacity-0'),
        'enterTo' => $enterTo ?? ($preset?->enter->to ?? 'opacity-100'),
        'leave' => $leave ?? ($preset?->leave->transition ?? 'transition ease-in duration-150'),
        'leaveFrom' => $leaveFrom ?? ($preset?->leave->from ?? 'opacity-100'),
        'leaveTo' => $leaveTo ?? ($preset?->leave->to ?? 'opacity-0'),
    ];

    // The show expression - can be a state property or expression
    $showExpression = $show ?? 'true';
@endphp

<div
    data-accelade-transition
    data-transition-id="{{ $id }}"
    data-transition-show="{{ $showExpression }}"
    data-transition-enter="{{ $transitionClasses['enter'] }}"
    data-transition-enter-from="{{ $transitionClasses['enterFrom'] }}"
    data-transition-enter-to="{{ $transitionClasses['enterTo'] }}"
    data-transition-leave="{{ $transitionClasses['leave'] }}"
    data-transition-leave-from="{{ $transitionClasses['leaveFrom'] }}"
    data-transition-leave-to="{{ $transitionClasses['leaveTo'] }}"
    {{ $attributes->except(['id', 'show', 'animation', 'enter', 'enterFrom', 'enterTo', 'leave', 'leaveFrom', 'leaveTo']) }}
>{{ $slot }}</div>
</file>

<file path="resources/views/demo/partials/_errors-component.blade.php">
{{-- Errors Component Section - Framework Agnostic --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $ifAttr = match($prefix) {
        'v' => 'v-if',
        'data-state' => 'data-state-if',
        's' => 's-if',
        'ng' => 'ng-if',
        default => 'a-if',
    };

    $modelAttr = match($prefix) {
        'v' => 'v-model',
        'data-state' => 'data-state-model',
        's' => 's-model',
        'ng' => 'ng-model',
        default => 'a-model',
    };

    $classAttr = match($prefix) {
        'v' => ':class',
        'data-state' => 'data-state-class',
        's' => 's-class',
        'ng' => 'ng-class',
        default => 'a-class',
    };
@endphp

<!-- Demo: Errors Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-red-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Errors Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Display Laravel validation errors with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::errors&gt;</code>.
        Exposes <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">errors.has()</code>, <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">errors.first()</code>, and <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">errors.all</code>.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Simulated Errors Display -->
        <div class="rounded-xl p-4 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-red-500/20 text-red-500 rounded">Demo</span>
                Error Display Methods
            </h4>

            {{-- Simulate errors for demo purposes --}}
            <x-accelade::data :default="[
                'demoErrors' => [
                    'name' => ['The name field is required.'],
                    'email' => ['The email field is required.', 'The email must be a valid email address.'],
                    'password' => ['The password must be at least 8 characters.', 'The password must contain a number.'],
                ]
            ]">
                <div class="space-y-4">
                    {{-- Check if field has errors --}}
                    <div class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="text-sm font-medium mb-2" style="color: var(--docs-text);">errors.has('name'):</p>
                        <span {{ $showAttr }}="demoErrors.name && demoErrors.name.length > 0" class="text-red-500 text-sm">true - Field has errors</span>
                        <span {{ $showAttr }}="!demoErrors.name || demoErrors.name.length === 0" class="text-green-500 text-sm">false - No errors</span>
                    </div>

                    {{-- Get first error --}}
                    <div class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="text-sm font-medium mb-2" style="color: var(--docs-text);">errors.first('email'):</p>
                        <p class="text-red-500 text-sm" {{ $textAttr }}="demoErrors.email[0]"></p>
                    </div>

                    {{-- Get all errors for a field --}}
                    <div class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="text-sm font-medium mb-2" style="color: var(--docs-text);">All password errors:</p>
                        <ul class="list-disc list-inside text-red-500 text-sm">
                            <template a-for="error in demoErrors.password">
                                <li {{ $textAttr }}="error"></li>
                            </template>
                        </ul>
                    </div>
                </div>
            </x-accelade::data>
        </div>

        <!-- Interactive Form Demo -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Interactive</span>
                Form with Client Validation
            </h4>

            @accelade([
                'formData' => ['name' => '', 'email' => ''],
                'formErrors' => ['name' => null, 'email' => null],
                'submitted' => false,
            ])
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Name</label>
                        <input
                            type="text"
                            {{ $modelAttr }}="formData.name"
                            class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg); color: var(--docs-text);"
                            placeholder="Enter your name"
                        >
                        <p {{ $showAttr }}="formErrors.name" class="text-red-500 text-sm mt-1" {{ $textAttr }}="formErrors.name"></p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Email</label>
                        <input
                            type="text"
                            {{ $modelAttr }}="formData.email"
                            class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg); color: var(--docs-text);"
                            placeholder="Enter your email"
                        >
                        <p {{ $showAttr }}="formErrors.email" class="text-red-500 text-sm mt-1" {{ $textAttr }}="formErrors.email"></p>
                    </div>

                    <div class="flex gap-2">
                        <button
                            type="button"
                            @click="validateForm()"
                            class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                        >
                            Submit (Validate)
                        </button>
                        <button
                            type="button"
                            @click="clearErrors()"
                            class="px-4 py-2 rounded-lg transition-colors text-sm border border-[var(--docs-border)]"
                            style="background: var(--docs-bg); color: var(--docs-text);"
                        >
                            Clear Errors
                        </button>
                    </div>

                    <p {{ $showAttr }}="submitted && !formErrors.name && !formErrors.email" class="text-green-500 text-sm">
                        Form submitted successfully!
                    </p>
                </div>

                <accelade:script>
                    return {
                        validateForm() {
                            const data = $get('formData');
                            let nameError = null;
                            let emailError = null;

                            if (!data.name || data.name.trim() === '') {
                                nameError = 'The name field is required.';
                            }

                            if (!data.email || data.email.trim() === '') {
                                emailError = 'The email field is required.';
                            } else if (!data.email.includes('@')) {
                                emailError = 'The email must be a valid email address.';
                            }

                            $set('formErrors.name', nameError);
                            $set('formErrors.email', emailError);
                            $set('submitted', true);
                        },
                        clearErrors() {
                            $set('formErrors.name', null);
                            $set('formErrors.email', null);
                            $set('submitted', false);
                        }
                    };
                </accelade:script>
            @endaccelade
        </div>

        <!-- Error Summary Box -->
        <div class="rounded-xl p-4 border border-orange-500/30" style="background: rgba(249, 115, 22, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Error Summary Box Pattern</h4>

            <x-accelade::data :default="[
                'summaryErrors' => [
                    'username' => ['The username has already been taken.'],
                    'terms' => ['You must accept the terms and conditions.'],
                    'age' => ['You must be at least 18 years old.'],
                ]
            ]">
                <div {{ $showAttr }}="Object.keys(summaryErrors).length > 0" class="bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-4">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                        </svg>
                        <div>
                            <h4 class="font-medium text-red-500">There were errors with your submission</h4>
                            <ul class="mt-2 text-sm text-red-400 list-disc list-inside">
                                <template a-for="(errors, field) in summaryErrors">
                                    <template a-for="error in errors">
                                        <li {{ $textAttr }}="error"></li>
                                    </template>
                                </template>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button
                        @click="$set('summaryErrors', {})"
                        class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm"
                    >
                        Clear All Errors
                    </button>
                    <button
                        @click="$set('summaryErrors', { username: ['Username taken'], email: ['Invalid email'] })"
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                    >
                        Add Errors
                    </button>
                </div>
            </x-accelade::data>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="errors.blade.php">
&lt;!-- Basic errors display --&gt;
&lt;x-accelade::errors&gt;
    &lt;p {{ $ifAttr }}="errors.has('name')" {{ $textAttr }}="errors.first('name')"&gt;&lt;/p&gt;
&lt;/x-accelade::errors&gt;

&lt;!-- Loop through all errors --&gt;
&lt;x-accelade::errors&gt;
    &lt;div {{ $showAttr }}="errors.any"&gt;
        &lt;template a-for="(messages, field) in errors.all"&gt;
            &lt;p {{ $textAttr }}="messages[0]"&gt;&lt;/p&gt;
        &lt;/template&gt;
    &lt;/div&gt;
&lt;/x-accelade::errors&gt;

&lt;!-- Custom error bag --&gt;
&lt;x-accelade::errors bag="login"&gt;
    &lt;p {{ $textAttr }}="errors.first('credentials')"&gt;&lt;/p&gt;
&lt;/x-accelade::errors&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_event-bus.blade.php">
{{-- Event Bus Section --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };
@endphp

<!-- Demo: Event Bus -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-violet-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Event Bus</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Decoupled component communication through a global event bus.
        Components can emit and listen to events without direct references.
    </p>

    <div class="space-y-4 mb-4">
        <!-- API Overview -->
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-violet-500/20 text-violet-500 rounded">API</span>
                Global Methods
            </h4>
            <div class="space-y-2 text-sm font-mono" style="color: var(--docs-text-muted);">
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>Accelade.emit('event', data)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>Accelade.on('event', callback)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>Accelade.once('event', callback)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>Accelade.off('event', callback)</code>
                </div>
            </div>
        </div>

        <!-- Component Context -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Context</span>
                In Components
            </h4>
            <div class="space-y-2 text-sm font-mono" style="color: var(--docs-text-muted);">
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>$emit('event', data)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>$on('event', callback)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>$once('event', callback)</code>
                </div>
                <div class="p-2 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code>$off('event', callback)</code>
                </div>
            </div>
        </div>

        <!-- Live Example: Sender and Receiver -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Live Example: Component Communication</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Two independent components communicating through the event bus.
                The sender emits events, and the receiver listens for them.
            </p>

            <div class="grid md:grid-cols-2 gap-4">
                <!-- Sender Component -->
                <div class="rounded-lg p-4 border border-violet-500/50" style="background: var(--docs-bg);">
                    <h4 class="text-sm font-medium text-violet-500 mb-3">Sender Component</h4>
                    <x-accelade::data :default="['message' => 'Hello from sender!']">
                        <div class="space-y-3">
                            <input
                                type="text"
                                {{ $prefix }}-model="message"
                                class="w-full px-3 py-2 rounded-lg text-sm border border-[var(--docs-border)]"
                                style="background: var(--docs-bg-alt); color: var(--docs-text);"
                                placeholder="Enter message..."
                            >
                            <div class="flex gap-2">
                                <button
                                    @click="$emit('message-sent', { text: message, time: new Date().toLocaleTimeString() })"
                                    class="px-4 py-2 text-sm bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-colors"
                                >
                                    Send Message
                                </button>
                                <button
                                    @click="$emit('counter-increment', { amount: 1 })"
                                    class="px-4 py-2 text-sm bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors"
                                >
                                    +1 Counter
                                </button>
                            </div>
                        </div>
                    </x-accelade::data>
                </div>

                <!-- Receiver Component -->
                <div class="rounded-lg p-4 border border-purple-500/50" style="background: var(--docs-bg);">
                    <h4 class="text-sm font-medium text-purple-500 mb-3">Receiver Component</h4>
                    <x-accelade::data :default="['lastMessage' => 'No messages yet', 'lastTime' => '', 'counter' => 0]">
                        <div class="space-y-3">
                            <div class="bg-purple-500/10 p-3 rounded-lg">
                                <div class="text-xs text-purple-500 mb-1">Last Message:</div>
                                <div class="text-sm" style="color: var(--docs-text);" {{ $textAttr }}="lastMessage">No messages yet</div>
                                <div {{ $showAttr }}="lastTime" class="text-xs text-purple-400 mt-1">
                                    at <span {{ $textAttr }}="lastTime"></span>
                                </div>
                            </div>
                            <div class="bg-violet-500/10 p-3 rounded-lg flex items-center justify-between">
                                <span class="text-sm text-violet-500">Counter:</span>
                                <span class="text-2xl font-bold text-violet-500" {{ $textAttr }}="counter">0</span>
                            </div>
                        </div>
                        <accelade:script>
                            // Listen for message events
                            $on('message-sent', (data) => {
                                $set('lastMessage', data.text);
                                $set('lastTime', data.time);
                            });

                            // Listen for counter events
                            $on('counter-increment', (data) => {
                                $set('counter', $get('counter') + data.amount);
                            });
                        </accelade:script>
                    </x-accelade::data>
                </div>
            </div>
        </div>

        <!-- One-time Events Example -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">One-time Events</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Use <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">$once()</code> to listen for an event only once.
                After the first trigger, the listener is automatically removed.
            </p>

            <x-accelade::data :default="['triggered' => false, 'count' => 0]">
                <div class="flex flex-wrap items-center gap-4">
                    <button
                        @click="$emit('one-time-event')"
                        class="px-4 py-2 text-sm rounded-lg transition-colors border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                        Emit One-Time Event
                    </button>
                    <div class="text-sm">
                        <span style="color: var(--docs-text-muted);">Status:</span>
                        <span {{ $showAttr }}="!triggered" class="text-amber-500">Waiting for first event...</span>
                        <span {{ $showAttr }}="triggered" class="text-green-500">
                            Triggered! (only fires once, click again to verify)
                        </span>
                    </div>
                    <div class="text-sm" style="color: var(--docs-text-muted);">
                        Trigger count: <span {{ $textAttr }}="count">0</span>
                    </div>
                </div>
                <accelade:script>
                    // This will only fire once
                    $once('one-time-event', () => {
                        $set('triggered', true);
                        $set('count', $get('count') + 1);
                    });
                </accelade:script>
            </x-accelade::data>
        </div>

        <!-- JavaScript API Example -->
        <div class="rounded-xl p-4 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-500 rounded">JS</span>
                JavaScript API
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Access the event bus from anywhere in your JavaScript code.
            </p>

            <div class="flex gap-4">
                <button
                    onclick="window.Accelade.emit('js-event', { source: 'button', timestamp: Date.now() })"
                    class="px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                >
                    Emit from JS
                </button>
                <div id="js-event-receiver" class="text-sm flex items-center" style="color: var(--docs-text-muted);">
                    Click the button to emit an event from vanilla JS
                </div>
            </div>

            <script>
                // Listen from vanilla JS - wait for Accelade to be ready
                document.addEventListener('DOMContentLoaded', () => {
                    window.Accelade?.on('js-event', (data) => {
                        const el = document.getElementById('js-event-receiver');
                        if (el) {
                            el.innerHTML = `<span class="text-green-500">Received from ${data.source}!</span>`;
                            setTimeout(() => {
                                el.innerHTML = 'Click the button to emit an event from vanilla JS';
                            }, 2000);
                        }
                    });
                });
            </script>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="event-bus-examples.blade.php">
&lt;!-- Emitting events --&gt;
&lt;button @click="$emit('user-selected', { id: 123, name: 'John' })"&gt;
    Select User
&lt;/button&gt;

&lt;!-- Listening for events in a component --&gt;
&lt;x-accelade::data :default="['selectedUser' =&gt; null]"&gt;
    &lt;div a-show="selectedUser"&gt;
        Selected: &lt;span a-text="selectedUser?.name"&gt;&lt;/span&gt;
    &lt;/div&gt;
    &lt;accelade:script&gt;
        $on('user-selected', (user) =&gt; {
            $set('selectedUser', user);
        });
    &lt;/accelade:script&gt;
&lt;/x-accelade::data&gt;

&lt;!-- Using from JavaScript --&gt;
&lt;script&gt;
    // Emit an event
    window.Accelade.emit('custom-event', { foo: 'bar' });

    // Listen for events
    const unsubscribe = window.Accelade.on('custom-event', (data) =&gt; {
        console.log('Received:', data);
    });

    // Stop listening
    unsubscribe();

    // Or use off() directly
    window.Accelade.off('custom-event', callback);

    // Listen once
    window.Accelade.once('init-complete', () =&gt; {
        console.log('Initialization complete!');
    });
&lt;/script&gt;
    </x-accelade::code-block>

    <div class="mt-4 p-4 bg-violet-500/10 rounded-lg border border-violet-500/30">
        <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-violet-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <div>
                <h4 class="font-medium text-violet-500 mb-1">Best Practices</h4>
                <ul class="text-sm text-violet-400 space-y-1">
                    <li>Use descriptive event names like <code class="bg-violet-500/20 px-1 py-0.5 rounded text-xs">user-selected</code> or <code class="bg-violet-500/20 px-1 py-0.5 rounded text-xs">cart-updated</code></li>
                    <li>Always unsubscribe when a component is destroyed to prevent memory leaks</li>
                    <li>Use <code class="bg-violet-500/20 px-1 py-0.5 rounded text-xs">$once()</code> for initialization events that should only trigger once</li>
                    <li>Keep event payloads simple and serializable</li>
                </ul>
            </div>
        </div>
    </div>
</section>
</file>

<file path="resources/views/demo/partials/_event-component.blade.php">
{{-- Event Component Section - Laravel Echo Integration --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $ifAttr = match($prefix) {
        'v' => 'v-if',
        'data-state' => 'data-state-if',
        's' => 's-if',
        'ng' => 'ng-if',
        default => 'a-if',
    };
@endphp

<!-- Demo: Event Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-violet-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Event Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Listen to Laravel Echo broadcast events in real-time using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::event&gt;</code>.
        Supports automatic redirect, page refresh, and toast notifications.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Basic Usage -->
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-violet-500/20 text-violet-500 rounded">Basic</span>
                Event Listener
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Subscribe to a channel and listen for events. The component exposes <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">subscribed</code> (boolean) and <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">events</code> (array) state.
            </p>

            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                <div class="flex items-center gap-2 text-sm">
                    <span class="w-2 h-2 rounded-full bg-amber-400"></span>
                    <span style="color: var(--docs-text-muted);">Echo not connected (requires Laravel Echo setup)</span>
                </div>
            </div>
        </div>

        <!-- Private Channel -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Private</span>
                Private Channel
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Use the <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">private</code> attribute for authenticated channels.
            </p>

            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                <pre class="text-xs overflow-x-auto" style="color: var(--docs-text-muted);"><code>&lt;x-accelade::event
    channel="user.123"
    :private="true"
    listen="MessageReceived"
/&gt;</code></pre>
            </div>
        </div>

        <!-- Actions Section -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Automatic Actions</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Backend events can trigger client-side actions automatically using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">Accelade::redirectOnEvent()</code>,
                <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">Accelade::refreshOnEvent()</code>, and <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">Accelade::toastOnEvent()</code>.
            </p>

            <div class="grid md:grid-cols-3 gap-4">
                <!-- Redirect -->
                <div class="rounded-lg p-4 border border-violet-500/50" style="background: var(--docs-bg);">
                    <div class="flex items-center gap-2 mb-2">
                        <svg class="w-4 h-4 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                        </svg>
                        <span class="font-medium text-sm" style="color: var(--docs-text);">Redirect</span>
                    </div>
                    <p class="text-xs" style="color: var(--docs-text-muted);">Navigate to a new page when event fires</p>
                </div>

                <!-- Refresh -->
                <div class="rounded-lg p-4 border border-violet-500/50" style="background: var(--docs-bg);">
                    <div class="flex items-center gap-2 mb-2">
                        <svg class="w-4 h-4 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        <span class="font-medium text-sm" style="color: var(--docs-text);">Refresh</span>
                    </div>
                    <p class="text-xs" style="color: var(--docs-text-muted);">Reload the page with optional scroll preservation</p>
                </div>

                <!-- Toast -->
                <div class="rounded-lg p-4 border border-violet-500/50" style="background: var(--docs-bg);">
                    <div class="flex items-center gap-2 mb-2">
                        <svg class="w-4 h-4 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                        <span class="font-medium text-sm" style="color: var(--docs-text);">Toast</span>
                    </div>
                    <p class="text-xs" style="color: var(--docs-text-muted);">Show notification when event is received</p>
                </div>
            </div>
        </div>

        <!-- Exposed State -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Exposed Reactive State</h4>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <code class="text-sm font-mono text-violet-500">subscribed</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Boolean indicating if connected to the channel</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <code class="text-sm font-mono text-violet-500">events</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Array of received events with name, data, and timestamp</p>
                </div>
            </div>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="event-examples.blade.php">
&lt;!-- Basic event listener --&gt;
&lt;x-accelade::event channel="orders" listen="OrderCreated,OrderUpdated"&gt;
    &lt;p {{ $ifAttr }}="subscribed"&gt;Listening for order events...&lt;/p&gt;
    &lt;p {{ $ifAttr }}="!subscribed"&gt;Not connected to channel.&lt;/p&gt;
&lt;/x-accelade::event&gt;

&lt;!-- Private channel with user ID --&gt;
&lt;x-accelade::event
    channel="user.@{{ auth()-&gt;id() }}"
    :private="true"
    listen="NotificationReceived"
&gt;
    &lt;div {{ $showAttr }}="events.length &gt; 0"&gt;
        You have &lt;span {{ $textAttr }}="events.length"&gt;&lt;/span&gt; new notifications
    &lt;/div&gt;
&lt;/x-accelade::event&gt;

&lt;!-- Refresh page on event (preserve scroll) --&gt;
&lt;x-accelade::event
    channel="dashboard"
    listen="DataUpdated"
    :preserve-scroll="true"
/&gt;
    </x-accelade::code-block>

    <div class="mt-4">
        <x-accelade::code-block language="php" filename="OrderCreated.php">
&lt;?php
// Broadcasting event with Accelade action
use Accelade\Accelade;

class OrderCreated implements ShouldBroadcast
{
    public function __construct(public Order $order) {}

    public function broadcastOn(): Channel
    {
        return new PrivateChannel('orders.'.$this->order->user_id);
    }

    public function broadcastWith(): array
    {
        // Redirect client to order page
        return Accelade::redirectOnEvent(
            route('orders.show', $this->order)
        )->with(['order_id' => $this->order->id])->toArray();

        // Or show a toast notification
        return Accelade::toastOnEvent(
            'New order #'.$this->order->id.' created!',
            'success'
        )->toArray();

        // Or refresh the page
        return Accelade::refreshOnEvent()->toArray();
    }
}
        </x-accelade::code-block>
    </div>
</section>
</file>

<file path="resources/views/demo/partials/_flash-component.blade.php">
{{-- Flash Component Section - Laravel Flash Data --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $ifAttr = match($prefix) {
        'v' => 'v-if',
        'data-state' => 'data-state-if',
        's' => 's-if',
        'ng' => 'ng-if',
        default => 'a-if',
    };
@endphp

<!-- Demo: Flash Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-amber-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Flash Data Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Access Laravel's session flash data in your templates using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::flash&gt;</code>.
        Works seamlessly with SPA navigation.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Live Demo -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Live</span>
                Flash Messages
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                These flash messages were set on the server. They're accessible through the <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">flash</code> object.
            </p>

            <x-accelade::flash class="space-y-3">
                <div {{ $ifAttr }}="flash.has('message')" class="p-3 rounded-lg border border-[var(--docs-border)] text-sm" style="background: var(--docs-bg); color: var(--docs-text);">
                    <span class="font-medium">Message:</span>
                    <span {{ $textAttr }}="flash.message"></span>
                </div>

                <div {{ $ifAttr }}="flash.has('success')" class="p-3 bg-green-500/10 rounded-lg border border-green-500/30 text-sm text-green-500">
                    <span class="font-medium">Success:</span>
                    <span {{ $textAttr }}="flash.success"></span>
                </div>

                <div {{ $ifAttr }}="flash.has('error')" class="p-3 bg-red-500/10 rounded-lg border border-red-500/30 text-sm text-red-500">
                    <span class="font-medium">Error:</span>
                    <span {{ $textAttr }}="flash.error"></span>
                </div>

                <div {{ $ifAttr }}="flash.has('info')" class="p-3 bg-blue-500/10 rounded-lg border border-blue-500/30 text-sm text-blue-500">
                    <span class="font-medium">Info:</span>
                    <span {{ $textAttr }}="flash.info"></span>
                </div>
            </x-accelade::flash>
        </div>

        <!-- How It Works -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 border border-[var(--docs-border)] rounded" style="background: var(--docs-bg-alt); color: var(--docs-text-muted);">Info</span>
                How It Works
            </h4>
            <ul class="space-y-3 text-sm" style="color: var(--docs-text-muted);">
                <li class="flex gap-2">
                    <span class="text-amber-500">1.</span>
                    <span>Backend flashes data using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">session()->flash()</code></span>
                </li>
                <li class="flex gap-2">
                    <span class="text-amber-500">2.</span>
                    <span>Flash data is automatically shared via middleware</span>
                </li>
                <li class="flex gap-2">
                    <span class="text-amber-500">3.</span>
                    <span>The <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">flash</code> object provides <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">.has()</code> and direct access</span>
                </li>
                <li class="flex gap-2">
                    <span class="text-amber-500">4.</span>
                    <span>Works with SPA navigation without full page reloads</span>
                </li>
            </ul>
        </div>

        <!-- Flash Methods -->
        <div class="rounded-xl p-4 border border-orange-500/30" style="background: rgba(249, 115, 22, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Flash Object Methods</h4>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-amber-500">flash.has(key)</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Check if a flash key exists and has a value</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-amber-500">flash.key</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Access flash value directly by key</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-amber-500">flash.get(key, default)</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Get value with optional default</p>
                </div>
            </div>
        </div>

        <!-- Configuration -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Configuration Options</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Control automatic flash data sharing in <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">config/accelade.php</code>:
            </p>

            <div class="grid md:grid-cols-2 gap-4">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <code class="text-sm font-mono" style="color: var(--docs-text-muted);">flash.enabled</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Enable/disable automatic flash data sharing (default: true)</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <code class="text-sm font-mono" style="color: var(--docs-text-muted);">flash.keys</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Array of specific keys to share, or null for all</p>
                </div>
            </div>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="flash-examples.blade.php">
&lt;!-- Basic flash message display --&gt;
&lt;x-accelade::flash&gt;
    &lt;div {{ $ifAttr }}="flash.has('success')" class="alert alert-success"&gt;
        &lt;span {{ $textAttr }}="flash.success"&gt;&lt;/span&gt;
    &lt;/div&gt;

    &lt;div {{ $ifAttr }}="flash.has('error')" class="alert alert-danger"&gt;
        &lt;span {{ $textAttr }}="flash.error"&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/x-accelade::flash&gt;

&lt;!-- Notification-style flash messages --&gt;
&lt;x-accelade::flash class="fixed top-4 right-4 space-y-2"&gt;
    &lt;div {{ $showAttr }}="flash.has('message')"
         class="p-4 bg-white shadow-lg rounded-lg"&gt;
        &lt;p {{ $textAttr }}="flash.message"&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/x-accelade::flash&gt;
    </x-accelade::code-block>

    <div class="mt-4">
        <x-accelade::code-block language="php" filename="Controller.php">
&lt;?php

namespace App\Http\Controllers;

class OrderController extends Controller
{
    public function store(Request $request)
    {
        // Create the order...
        $order = Order::create($request->validated());

        // Flash success message
        session()->flash('success', 'Order created successfully!');

        return redirect()->route('orders.index');
    }

    public function destroy(Order $order)
    {
        $order->delete();

        // Flash with different types
        session()->flash('message', 'Order has been deleted.');
        session()->flash('info', 'You can restore it within 30 days.');

        return redirect()->route('orders.index');
    }
}
        </x-accelade::code-block>
    </div>

    <div class="mt-4">
        <x-accelade::code-block language="php" filename="config/accelade.php">
// Flash data configuration
'flash' => [
    // Enable automatic flash data sharing
    'enabled' => env('ACCELADE_FLASH_ENABLED', true),

    // Specific keys to share (null = all keys)
    // 'keys' => ['message', 'success', 'error', 'warning', 'info'],
    'keys' => null,
],
        </x-accelade::code-block>
    </div>
</section>
</file>

<file path="resources/views/demo/partials/_link-component.blade.php">
{{-- Link Component Section - Enhanced Navigation --}}
@props(['prefix' => 'a'])

<!-- Demo: Link Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-blue-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Link Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Enhanced link component with HTTP methods, confirmation dialogs, and navigation options using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::link&gt;</code>.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Basic Navigation -->
        <div class="rounded-xl p-4 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-500 rounded">Basic</span>
                SPA Navigation
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Click links to navigate without full page reload. The link component handles SPA navigation automatically.
            </p>

            <div class="flex flex-wrap gap-2">
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'counter']) }}"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                    Go to Counter
                </x-accelade::link>

                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'notifications']) }}"
                    class="inline-flex items-center gap-2 px-4 py-2 rounded-lg transition border border-[var(--docs-border)]"
                    style="background: var(--docs-bg); color: var(--docs-text);"
                >
                    Go to Notifications
                </x-accelade::link>
            </div>
        </div>

        <!-- Confirmation Dialog -->
        <div class="rounded-xl p-4 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-red-500/20 text-red-500 rounded">Confirm</span>
                Confirmation Dialog
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Show a confirmation dialog before navigation. Great for destructive actions.
            </p>

            <div class="flex flex-wrap gap-2">
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'counter']) }}"
                    :confirm="true"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition"
                >
                    Simple Confirm
                </x-accelade::link>

                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'counter']) }}"
                    confirm-text="Are you sure you want to proceed? This action cannot be undone."
                    confirm-title="Confirm Navigation"
                    confirm-button="Yes, proceed"
                    cancel-button="No, stay here"
                    :confirm-danger="true"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition"
                >
                    Danger Confirm
                </x-accelade::link>
            </div>
        </div>

        <!-- HTTP Methods -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Methods</span>
                HTTP Methods
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Support for POST, PUT, PATCH, DELETE methods - like form submissions but as links.
            </p>

            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                <pre class="text-xs overflow-x-auto" style="color: var(--docs-text-muted);"><code>&lt;x-accelade::link
    href="/api/resource"
    method="POST"
    :data="['name' => 'New Item']"
&gt;
    Create Resource
&lt;/x-accelade::link&gt;

&lt;x-accelade::link
    href="/api/resource/1"
    method="DELETE"
    :confirm-danger="true"
    confirm-text="Delete this item?"
&gt;
    Delete
&lt;/x-accelade::link&gt;</code></pre>
            </div>
        </div>

        <!-- External Links -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 border border-[var(--docs-border)] rounded" style="background: var(--docs-bg-alt); color: var(--docs-text-muted);">External</span>
                External Links (Away)
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Use the <code class="px-1 py-0.5 rounded text-xs border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">away</code> attribute for external links with optional confirmation.
            </p>

            <div class="flex flex-wrap gap-2">
                <x-accelade::link
                    href="https://laravel.com"
                    :away="true"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-800 transition"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                    Visit Laravel
                </x-accelade::link>

                <x-accelade::link
                    href="https://github.com"
                    :away="true"
                    confirm-text="You are leaving this site. Continue?"
                    class="inline-flex items-center gap-2 px-4 py-2 rounded-lg transition border border-[var(--docs-border)]"
                    style="background: var(--docs-bg-alt); color: var(--docs-text);"
                >
                    GitHub (with confirm)
                </x-accelade::link>
            </div>
        </div>

        <!-- Navigation Options -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Navigation Options</h4>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-emerald-500">preserve-scroll</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Keep scroll position after navigation</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-emerald-500">preserve-state</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Preserve component state across navigation</p>
                </div>
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <code class="text-sm font-mono text-emerald-500">prefetch</code>
                    <p class="text-xs mt-1" style="color: var(--docs-text-muted);">Prefetch page on hover for faster navigation</p>
                </div>
            </div>
        </div>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">href</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">-</td>
                        <td class="py-2 px-3">Target URL (required)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">method</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">GET</td>
                        <td class="py-2 px-3">HTTP method (GET, POST, PUT, PATCH, DELETE)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">data</code></td>
                        <td class="py-2 px-3">array</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Request payload data</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">headers</code></td>
                        <td class="py-2 px-3">array</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Custom HTTP headers</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">away</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Treat as external link</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">confirm</code></td>
                        <td class="py-2 px-3">bool/string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Show confirmation dialog</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">confirm-text</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Custom confirmation message</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">confirm-title</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Confirmation dialog title</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">confirm-button</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Confirm</td>
                        <td class="py-2 px-3">Confirm button label</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">cancel-button</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Cancel</td>
                        <td class="py-2 px-3">Cancel button label</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">confirm-danger</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Red confirm button style</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">preserve-scroll</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Keep scroll position</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-blue-500">preserve-state</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Keep component state</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-blue-500">prefetch</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Prefetch on hover</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="link-examples.blade.php">
{{-- Basic SPA navigation --}}
&lt;x-accelade::link href="/dashboard"&gt;Dashboard&lt;/x-accelade::link&gt;

{{-- With confirmation --}}
&lt;x-accelade::link
    href="/account/delete"
    :confirm="true"
    confirm-text="Delete your account? This cannot be undone."
    :confirm-danger="true"
&gt;
    Delete Account
&lt;/x-accelade::link&gt;

{{-- POST request (form-like) --}}
&lt;x-accelade::link
    href="/api/items"
    method="POST"
    :data="['name' => 'New Item', 'status' => 'active']"
&gt;
    Create Item
&lt;/x-accelade::link&gt;

{{-- DELETE with confirmation --}}
&lt;x-accelade::link
    href="/api/items/123"
    method="DELETE"
    confirm-text="Delete this item?"
    confirm-button="Delete"
    :confirm-danger="true"
&gt;
    Delete Item
&lt;/x-accelade::link&gt;

{{-- External link --}}
&lt;x-accelade::link
    href="https://example.com"
    :away="true"
    confirm-text="You are leaving this site."
&gt;
    Visit External Site
&lt;/x-accelade::link&gt;

{{-- Preserve scroll position --}}
&lt;x-accelade::link
    href="/page"
    :preserve-scroll="true"
&gt;
    Update (keep scroll)
&lt;/x-accelade::link&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_modal-component.blade.php">
{{-- Modal Component Section - Modals and Slideovers --}}
@props(['prefix' => 'a'])

<!-- Demo: Modal Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-purple-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Modal Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Modal and slideover dialogs with async content loading using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::modal&gt;</code> and <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::link :modal="true"&gt;</code>.
    </p>

    <!-- Basic Modal & Async Modal -->
    <div class="space-y-4 mb-4">
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Basic</span>
                Pre-loaded Modal
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Click to open a modal with pre-loaded content using a hash link.
            </p>
            <x-accelade::link
                href="#basic-modal"
                class="inline-flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition"
            >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                </svg>
                Open Modal
            </x-accelade::link>

            <!-- Pre-loaded Modal (hidden until triggered) -->
            <x-accelade::modal name="basic-modal">
                <h2 class="text-xl font-semibold mb-4" style="color: var(--docs-text);">Welcome!</h2>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    This is a pre-loaded modal. The content was already on the page and is displayed without any network request.
                </p>
                <p class="mb-6" style="color: var(--docs-text-muted);">
                    You can close this modal by clicking the X button, clicking outside, or pressing Escape.
                </p>
                <button
                    data-modal-close
                    class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition"
                >
                    Got it!
                </button>
            </x-accelade::modal>
        </div>

        <div class="rounded-xl p-4 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-500 rounded">Async</span>
                Async Content Loading
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Load modal content from a URL asynchronously. Great for forms and dynamic content.
            </p>
            <x-accelade::link
                href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'counter']) }}"
                :modal="true"
                class="inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition"
            >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                </svg>
                Load Counter Demo
            </x-accelade::link>
        </div>
    </div>

    <!-- Slideover & Sizes -->
    <div class="space-y-4 mb-4">
        <div class="rounded-xl p-4 border border-green-500/30" style="background: rgba(34, 197, 94, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-green-500/20 text-green-500 rounded">Slideover</span>
                Side Panel
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Slideovers appear from the side. Great for detail panels, settings, and navigation.
            </p>
            <div class="flex flex-wrap gap-2">
                <x-accelade::link
                    href="#slideover-demo"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                    Right
                </x-accelade::link>
                <x-accelade::link
                    href="#slideover-left"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Left
                </x-accelade::link>
            </div>

            <!-- Right Slideover -->
            <x-accelade::modal name="slideover-demo" :slideover="true">
                <h2 class="text-xl font-semibold mb-4" style="color: var(--docs-text);">Slideover Panel</h2>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    This is a slideover panel. It slides in from the right side of the screen.
                </p>
                <p class="mb-4" style="color: var(--docs-text-muted);">Slideovers are great for:</p>
                <ul class="list-disc list-inside mb-6 space-y-2" style="color: var(--docs-text-muted);">
                    <li>Detail views</li>
                    <li>Settings panels</li>
                    <li>Filters and search options</li>
                    <li>Navigation menus</li>
                </ul>
                <button data-modal-close class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">
                    Close Panel
                </button>
            </x-accelade::modal>

            <!-- Left Slideover -->
            <x-accelade::modal name="slideover-left" :slideover="true" slideover-position="left">
                <h2 class="text-xl font-semibold mb-4" style="color: var(--docs-text);">Left Slideover</h2>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    This slideover appears from the left side of the screen.
                </p>
                <nav class="space-y-2 mb-6">
                    <a href="#" class="block px-4 py-2 rounded-lg transition border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">Dashboard</a>
                    <a href="#" class="block px-4 py-2 rounded-lg transition border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">Users</a>
                    <a href="#" class="block px-4 py-2 rounded-lg transition border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">Settings</a>
                    <a href="#" class="block px-4 py-2 rounded-lg transition border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">Help</a>
                </nav>
                <button data-modal-close class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition w-full">
                    Close
                </button>
            </x-accelade::modal>
        </div>

        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-gray-500/20 rounded" style="color: var(--docs-text-muted);">Sizes</span>
                Max Width Options
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Control modal width with the <code class="px-1 py-0.5 rounded text-xs border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">max-width</code> prop.
            </p>
            <div class="flex flex-wrap gap-2">
                <x-accelade::link href="#modal-sm" class="px-3 py-1.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">sm</x-accelade::link>
                <x-accelade::link href="#modal-md" class="px-3 py-1.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">md</x-accelade::link>
                <x-accelade::link href="#modal-lg" class="px-3 py-1.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">lg</x-accelade::link>
                <x-accelade::link href="#modal-xl" class="px-3 py-1.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">xl</x-accelade::link>
                <x-accelade::link href="#modal-2xl" class="px-3 py-1.5 bg-indigo-500 text-white rounded text-sm">2xl (default)</x-accelade::link>
                <x-accelade::link href="#modal-4xl" class="px-3 py-1.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">4xl</x-accelade::link>
            </div>

            <x-accelade::modal name="modal-sm" max-width="sm">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Small Modal (sm)</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 24rem</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-md" max-width="md">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Medium Modal (md)</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 28rem</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-lg" max-width="lg">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Large Modal (lg)</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 32rem</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-xl" max-width="xl">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Extra Large Modal (xl)</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 36rem</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-2xl" max-width="2xl">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">2XL Modal (2xl) - Default</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 42rem. This is the default size for modals.</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-4xl" max-width="4xl">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">4XL Modal (4xl)</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">Max width: 56rem. Great for tables and wide content.</p>
                <button data-modal-close class="px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition">Close</button>
            </x-accelade::modal>
        </div>
    </div>

    <!-- Bottom Sheet & Positions & Close Options -->
    <div class="space-y-4 mb-4">
        <div class="rounded-xl p-4 border border-cyan-500/30" style="background: rgba(6, 182, 212, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-cyan-500/20 text-cyan-500 rounded">Bottom Sheet</span>
                Mobile-Friendly Panel
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Bottom sheets slide up from the bottom. Perfect for mobile interfaces and action sheets.
            </p>
            <div class="flex flex-wrap gap-2">
                <x-accelade::link
                    href="#bottom-sheet-demo"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
                    </svg>
                    Open Bottom Sheet
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework ?? 'vanilla', 'section' => 'counter']) }}"
                    :bottom-sheet="true"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition"
                >
                    Async Bottom Sheet
                </x-accelade::link>
            </div>

            <!-- Pre-loaded Bottom Sheet -->
            <x-accelade::modal name="bottom-sheet-demo" :bottom-sheet="true">
                <h2 class="text-xl font-semibold mb-4" style="color: var(--docs-text);">Action Sheet</h2>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    Bottom sheets are great for mobile-friendly interfaces.
                </p>
                <div class="space-y-2 mb-6">
                    <button class="w-full px-4 py-3 text-left rounded-lg transition flex items-center gap-3 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">
                        <svg class="w-5 h-5" style="color: var(--docs-text-muted);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        Choose from Gallery
                    </button>
                    <button class="w-full px-4 py-3 text-left rounded-lg transition flex items-center gap-3 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">
                        <svg class="w-5 h-5" style="color: var(--docs-text-muted);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        Take a Photo
                    </button>
                    <button class="w-full px-4 py-3 text-left rounded-lg transition flex items-center gap-3 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt); color: var(--docs-text);">
                        <svg class="w-5 h-5" style="color: var(--docs-text-muted);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Browse Files
                    </button>
                </div>
                <button data-modal-close class="w-full px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition">
                    Cancel
                </button>
            </x-accelade::modal>
        </div>

        <div class="rounded-xl p-4 border border-orange-500/30" style="background: rgba(249, 115, 22, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-orange-500/20 text-orange-500 rounded">Position</span>
                Vertical Alignment
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Position modals at the top, center, or bottom of the screen.
            </p>
            <div class="flex flex-wrap gap-2">
                <x-accelade::link href="#modal-top" class="px-3 py-1.5 bg-orange-500/20 text-orange-500 rounded hover:bg-orange-500/30 transition text-sm">Top</x-accelade::link>
                <x-accelade::link href="#modal-center" class="px-3 py-1.5 bg-orange-500 text-white rounded hover:bg-orange-600 transition text-sm">Center (default)</x-accelade::link>
                <x-accelade::link href="#modal-bottom" class="px-3 py-1.5 bg-orange-500/20 text-orange-500 rounded hover:bg-orange-500/30 transition text-sm">Bottom</x-accelade::link>
            </div>

            <x-accelade::modal name="modal-top" position="top">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Top Positioned Modal</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">This modal appears at the top of the viewport.</p>
                <button data-modal-close class="px-3 py-1.5 bg-orange-500 text-white rounded hover:bg-orange-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-center" position="center">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Center Positioned Modal</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">This modal appears in the center of the viewport (default).</p>
                <button data-modal-close class="px-3 py-1.5 bg-orange-500 text-white rounded hover:bg-orange-600 transition">Close</button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-bottom" position="bottom">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Bottom Positioned Modal</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">This modal appears at the bottom of the viewport.</p>
                <button data-modal-close class="px-3 py-1.5 bg-orange-500 text-white rounded hover:bg-orange-600 transition">Close</button>
            </x-accelade::modal>
        </div>

        <div class="rounded-xl p-4 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-red-500/20 text-red-500 rounded">Options</span>
                Close Behavior
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Control how the modal can be closed with <code class="px-1 py-0.5 rounded text-xs border border-[var(--docs-border)]" style="background: var(--docs-bg);">close-explicitly</code>.
            </p>
            <div class="flex flex-wrap gap-2">
                <x-accelade::link href="#modal-explicit" class="inline-flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">
                    Explicit Close Only
                </x-accelade::link>
                <x-accelade::link href="#modal-no-button" class="inline-flex items-center gap-2 px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition">
                    No Close Button
                </x-accelade::link>
            </div>

            <x-accelade::modal name="modal-explicit" :close-explicitly="true">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">Explicit Close Required</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    This modal can only be closed by clicking the button below. ESC key and clicking outside won't work.
                </p>
                <button data-modal-close class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">
                    Close Modal
                </button>
            </x-accelade::modal>
            <x-accelade::modal name="modal-no-button" :close-button="false">
                <h3 class="text-lg font-semibold mb-2" style="color: var(--docs-text);">No Close Button</h3>
                <p class="mb-4" style="color: var(--docs-text-muted);">
                    This modal has no X button, but you can still close it by clicking outside or pressing ESC.
                </p>
                <button data-modal-close class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition">
                    Close
                </button>
            </x-accelade::modal>
        </div>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">name</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Modal name for hash-based opening</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">slideover</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Render as slideover instead of modal</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">bottom-sheet</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Render as bottom sheet (mobile-friendly)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">max-width</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">2xl</td>
                        <td class="py-2 px-3">Max width (sm, md, lg, xl, 2xl, 4xl, etc.)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">position</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">center</td>
                        <td class="py-2 px-3">Vertical position (top, center, bottom)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-purple-500">close-explicitly</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Disable ESC and outside click closing</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-purple-500">close-button</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">true</td>
                        <td class="py-2 px-3">Show the X close button</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="modal-examples.blade.php">
{{-- Pre-loaded modal with hash link --}}
&lt;x-accelade::link href="#my-modal"&gt;Open Modal&lt;/x-accelade::link&gt;

&lt;x-accelade::modal name="my-modal"&gt;
    &lt;h2&gt;Modal Title&lt;/h2&gt;
    &lt;p&gt;Modal content here...&lt;/p&gt;
    &lt;button data-modal-close&gt;Close&lt;/button&gt;
&lt;/x-accelade::modal&gt;

{{-- Async modal (loads from URL) --}}
&lt;x-accelade::link href="/users/create" :modal="true"&gt;
    Create User
&lt;/x-accelade::link&gt;

{{-- Slideover --}}
&lt;x-accelade::modal name="settings" :slideover="true"&gt;
    &lt;nav&gt;...&lt;/nav&gt;
&lt;/x-accelade::modal&gt;

{{-- Bottom sheet --}}
&lt;x-accelade::modal name="actions" :bottom-sheet="true"&gt;
    &lt;button&gt;Option 1&lt;/button&gt;
    &lt;button data-modal-close&gt;Cancel&lt;/button&gt;
&lt;/x-accelade::modal&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_persistent-layout.blade.php">
{{-- Persistent Layout Section --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };
@endphp

<!-- Demo: Persistent Layout -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-rose-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Persistent Layout</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Keep elements like media players active during SPA navigation using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::persistent&gt;</code>.
    </p>

    <div class="space-y-4 mb-4">
        <!-- How It Works -->
        <div class="rounded-xl p-4 border border-rose-500/30" style="background: rgba(244, 63, 94, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-rose-500/20 text-rose-500 rounded">Concept</span>
                How It Works
            </h4>
            <div class="space-y-3 text-sm" style="color: var(--docs-text-muted);">
                <p>When navigating via SPA links, persistent elements are:</p>
                <ol class="list-decimal list-inside space-y-1 ml-2">
                    <li>Saved before the page updates</li>
                    <li>Restored to matching placeholders in new content</li>
                    <li>Media playback state is preserved</li>
                </ol>
            </div>
        </div>

        <!-- Use Cases -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Use Cases</span>
                When to Use
            </h4>
            <ul class="space-y-2 text-sm" style="color: var(--docs-text-muted);">
                <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 text-rose-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <span>Video/audio players that continue during navigation</span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 text-rose-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <span>Chat widgets that maintain connection</span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 text-rose-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
                    </svg>
                    <span>Music players with continuous playback</span>
                </li>
                <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 text-rose-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                    </svg>
                    <span>Notification panels</span>
                </li>
            </ul>
        </div>

        <!-- Live Example -->
        <div class="rounded-xl p-4 border border-pink-500/30" style="background: rgba(236, 72, 153, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Live Example</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                The persistent element below will be preserved when you navigate to other demo pages using the sidebar links.
                Notice how its state (like playback position if it were a video) would be maintained.
            </p>

            <div class="grid md:grid-cols-2 gap-4">
                <!-- Regular element -->
                <div class="rounded-lg p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <h4 class="text-sm font-medium mb-2" style="color: var(--docs-text);">Regular Element</h4>
                    <p class="text-xs mb-3" style="color: var(--docs-text-muted);">Re-renders on navigation</p>
                    <x-accelade::data :default="['count' => 0]">
                        <div class="flex items-center gap-3">
                            <button
                                @click="$set('count', count + 1)"
                                class="px-3 py-1 text-sm rounded transition-colors border border-[var(--docs-border)]"
                                style="background: var(--docs-bg-alt); color: var(--docs-text);"
                            >
                                Click: <span {{ $textAttr }}="count">0</span>
                            </button>
                            <span class="text-xs" style="color: var(--docs-text-muted);">Resets on navigation</span>
                        </div>
                    </x-accelade::data>
                </div>

                <!-- Persistent element -->
                <div class="rounded-lg p-4 border border-rose-500/50" style="background: var(--docs-bg);">
                    <h4 class="text-sm font-medium text-rose-500 mb-2">Persistent Element</h4>
                    <p class="text-xs text-rose-400 mb-3">Preserved across navigation</p>
                    <x-accelade::persistent id="demo-counter">
                        <x-accelade::data :default="['count' => 0]">
                            <div class="flex items-center gap-3">
                                <button
                                    @click="$set('count', count + 1)"
                                    class="px-3 py-1 text-sm bg-rose-500 text-white rounded hover:bg-rose-600 transition-colors"
                                >
                                    Click: <span {{ $textAttr }}="count">0</span>
                                </button>
                                <span class="text-xs text-rose-400">Survives navigation!</span>
                            </div>
                        </x-accelade::data>
                    </x-accelade::persistent>
                </div>
            </div>

            <p class="text-xs mt-4" style="color: var(--docs-text-muted);">
                <strong style="color: var(--docs-text);">Try it:</strong> Increment both counters, then navigate to another section using the sidebar and come back.
                The persistent counter keeps its value!
            </p>
        </div>

        <!-- Creating Custom Persistent Layouts -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Creating Custom Persistent Layouts</h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                For complex use cases, create a custom layout component by extending <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">PersistentComponent</code>:
            </p>

            <div class="grid md:grid-cols-2 gap-4">
                <div class="rounded-lg p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <h4 class="text-sm font-medium mb-2" style="color: var(--docs-text-muted);">1. Create PHP Component</h4>
                    <pre class="text-xs overflow-x-auto" style="color: var(--docs-text-muted);"><code>php artisan make:component VideoLayout

// app/View/Components/VideoLayout.php
use Accelade\Components\PersistentComponent;

class VideoLayout extends PersistentComponent
{
    public function render()
    {
        return view('components.video-layout');
    }
}</code></pre>
                </div>

                <div class="rounded-lg p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <h4 class="text-sm font-medium mb-2" style="color: var(--docs-text-muted);">2. Create Blade View</h4>
                    <pre class="text-xs overflow-x-auto" style="color: var(--docs-text-muted);"><code>&lt;!-- video-layout.blade.php --&gt;
&lt;div&gt;
    &lt;main data-accelade-page&gt;
        @{{ $slot }}
    &lt;/main&gt;

    &lt;x-accelade::persistent id="video-player"&gt;
        &lt;div class="fixed bottom-0 ..."&gt;
            &lt;video src="..."&gt;&lt;/video&gt;
        &lt;/div&gt;
    &lt;/x-accelade::persistent&gt;
&lt;/div&gt;</code></pre>
                </div>
            </div>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="persistent-examples.blade.php">
&lt;!-- Simple persistent wrapper --&gt;
&lt;x-accelade::persistent id="music-player"&gt;
    &lt;audio src="/music.mp3" controls&gt;&lt;/audio&gt;
&lt;/x-accelade::persistent&gt;

&lt;!-- Persistent chat widget --&gt;
&lt;x-accelade::persistent id="chat-widget"&gt;
    &lt;div class="fixed bottom-4 right-4"&gt;
        &lt;!-- Chat component content --&gt;
    &lt;/div&gt;
&lt;/x-accelade::persistent&gt;

&lt;!-- Multiple persistent elements --&gt;
&lt;x-accelade::persistent id="notifications"&gt;
    &lt;!-- Notification panel --&gt;
&lt;/x-accelade::persistent&gt;

&lt;x-accelade::persistent id="mini-player"&gt;
    &lt;!-- Video mini-player --&gt;
&lt;/x-accelade::persistent&gt;
    </x-accelade::code-block>

    <div class="mt-4 p-4 bg-amber-500/10 rounded-lg border border-amber-500/30">
        <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-amber-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
            <div>
                <h4 class="font-medium text-amber-500 mb-1">Important</h4>
                <p class="text-sm text-amber-400">
                    Persistent elements require the same <code class="bg-amber-500/20 px-1 py-0.5 rounded text-xs">id</code> attribute
                    on both the source and destination pages. Navigation must use SPA links
                    (<code class="bg-amber-500/20 px-1 py-0.5 rounded text-xs">&lt;x-accelade::link&gt;</code>) for persistence to work.
                </p>
            </div>
        </div>
    </div>
</section>
</file>

<file path="resources/views/demo/partials/_rehydrate-component.blade.php">
{{-- Rehydrate Component Section - Selective Content Reloading --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };
@endphp

<!-- Demo: Rehydrate Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-teal-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Rehydrate Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Selective section reloading with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::rehydrate&gt;</code>.
        Trigger updates via events or automatic polling without full page refresh.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Event-Triggered Rehydrate -->
        <div class="rounded-xl p-4 border border-teal-500/30" style="background: rgba(20, 184, 166, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-teal-500/20 text-teal-500 rounded">Event</span>
                Event-Triggered Reload
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Click the button to emit an event that triggers the content to reload from the server.
            </p>

            <x-accelade::rehydrate on="counter-updated" id="event-demo">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
                    <p style="color: var(--docs-text);">
                        Current server time: <strong>{{ now()->format('H:i:s') }}</strong>
                    </p>
                    <p class="text-sm mt-1" style="color: var(--docs-text-muted);">
                        Random number: <strong>{{ rand(1000, 9999) }}</strong>
                    </p>
                </div>
            </x-accelade::rehydrate>

            <button
                onclick="window.Accelade.emit('counter-updated')"
                class="px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors text-sm"
            >
                Emit Event & Reload
            </button>
        </div>

        <!-- Polling Rehydrate -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Polling</span>
                Auto-Refresh (5 seconds)
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                This section automatically refreshes every 5 seconds.
            </p>

            <x-accelade::rehydrate :poll="5000" id="poll-demo">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                    <p style="color: var(--docs-text);">
                        Last updated: <strong>{{ now()->format('H:i:s') }}</strong>
                    </p>
                    <p class="text-sm mt-1" style="color: var(--docs-text-muted);">
                        Random color:
                        @php $color = ['red', 'blue', 'green', 'purple', 'orange'][rand(0, 4)]; @endphp
                        <span class="inline-block px-2 py-0.5 rounded text-white text-xs bg-{{ $color }}-500">
                            {{ $color }}
                        </span>
                    </p>
                </div>
            </x-accelade::rehydrate>
        </div>

        <!-- Multiple Events -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Multiple</span>
                Multiple Event Listeners
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Listen to multiple events with a single component.
            </p>

            <x-accelade::rehydrate :on="['item-added', 'item-removed']" id="multi-event-demo">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
                    <p class="font-medium" style="color: var(--docs-text);">Inventory Status</p>
                    <p class="text-sm mt-1" style="color: var(--docs-text-muted);">
                        Items: <strong>{{ rand(1, 100) }}</strong> |
                        Updated: <strong>{{ now()->format('H:i:s') }}</strong>
                    </p>
                </div>
            </x-accelade::rehydrate>

            <div class="flex gap-2">
                <button
                    onclick="window.Accelade.emit('item-added')"
                    class="px-3 py-1.5 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm"
                >
                    Add Item
                </button>
                <button
                    onclick="window.Accelade.emit('item-removed')"
                    class="px-3 py-1.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                >
                    Remove Item
                </button>
            </div>
        </div>

        <!-- Manual Reload -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 border border-[var(--docs-border)] rounded" style="background: var(--docs-bg-alt); color: var(--docs-text-muted);">API</span>
                JavaScript API
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Trigger rehydration programmatically using the JavaScript API.
            </p>

            <x-accelade::rehydrate id="api-demo">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg-alt);">
                    <p style="color: var(--docs-text);">
                        Server timestamp: <strong>{{ now()->timestamp }}</strong>
                    </p>
                    <p class="text-sm mt-1" style="color: var(--docs-text-muted);">
                        Human: {{ now()->diffForHumans() }}
                    </p>
                </div>
            </x-accelade::rehydrate>

            <button
                onclick="window.Accelade.rehydrate.reload('api-demo')"
                class="px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors text-sm"
            >
                Reload via API
            </button>
        </div>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-teal-500">on</code></td>
                        <td class="py-2 px-3">string|array</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Event name(s) that trigger rehydration</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-teal-500">poll</code></td>
                        <td class="py-2 px-3">int</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Polling interval in milliseconds</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-teal-500">url</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">current page</td>
                        <td class="py-2 px-3">URL to fetch content from</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-teal-500">preserve-scroll</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">true</td>
                        <td class="py-2 px-3">Preserve scroll position after reload</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="rehydrate-examples.blade.php">
{{-- Event-triggered rehydrate --}}
&lt;x-accelade::rehydrate on="item-created"&gt;
    @{{ foreach($items as $item) }}
        &lt;li&gt;@{{ $item->name }}&lt;/li&gt;
    @{{ endforeach }}
&lt;/x-accelade::rehydrate&gt;

{{-- Emit event from form success --}}
&lt;form @success="Accelade.emit('item-created')"&gt;...&lt;/form&gt;

{{-- Multiple events --}}
&lt;x-accelade::rehydrate :on="['created', 'updated', 'deleted']"&gt;
    ...
&lt;/x-accelade::rehydrate&gt;

{{-- Auto-polling every 5 seconds --}}
&lt;x-accelade::rehydrate :poll="5000"&gt;
    Score: @{{ $score }}
&lt;/x-accelade::rehydrate&gt;

{{-- JavaScript API --}}
&lt;script&gt;
// Emit event
Accelade.emit('data-updated');

// Reload specific component
Accelade.rehydrate.reload('component-id');

// Reload all rehydrate components
Accelade.rehydrate.reloadAll();
&lt;/script&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_state-component.blade.php">
{{-- State Component Section - Unified Access to Errors, Flash & Shared Data --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    // Simulate validation errors for demo
    $demoErrors = [
        'email' => ['The email field is required.', 'The email must be a valid email address.'],
        'password' => ['The password must be at least 8 characters.'],
    ];

    // Simulate flash data for demo
    $demoFlash = [
        'success' => 'Your changes have been saved successfully!',
        'info' => 'Welcome back to the dashboard.',
    ];

    // Simulate shared data for demo
    $demoShared = [
        'user' => [
            'name' => 'John Doe',
            'email' => 'john@example.com',
            'role' => 'admin',
        ],
        'app' => [
            'name' => 'Accelade Demo',
            'version' => '1.0.0',
        ],
    ];
@endphp

<!-- Demo: State Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">State Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Unified access to errors, flash messages, and shared data with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::state&gt;</code>.
    </p>

    <div class="grid md:grid-cols-2 gap-4 mb-4">
        <!-- Validation Errors -->
        <div class="rounded-xl p-4 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-red-500/20 text-red-500 rounded">Errors</span>
                Validation Errors
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Access validation errors from Laravel's error bag with reactive helpers.
            </p>

            <x-accelade::state :errors="$demoErrors" id="errors-demo">
                <div class="space-y-3">
                    <!-- Check if any errors exist -->
                    <div {{ $showAttr }}="state.hasErrors" class="p-3 rounded-lg border border-red-500/30" style="background: var(--docs-bg);">
                        <p class="text-red-500 font-medium text-sm">Validation failed!</p>
                    </div>

                    <!-- Email error -->
                    <div {{ $showAttr }}="hasError('email')" class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Email</label>
                        <div class="text-sm text-red-500" {{ $textAttr }}="getError('email')"></div>
                    </div>

                    <!-- Password error -->
                    <div {{ $showAttr }}="hasError('password')" class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Password</label>
                        <div class="text-sm text-red-500" {{ $textAttr }}="getError('password')"></div>
                    </div>

                    <!-- Access error via state object -->
                    <div class="p-3 rounded-lg border border-[var(--docs-border)] mt-4" style="background: var(--docs-bg);">
                        <p class="text-xs mb-1" style="color: var(--docs-text-muted);">Via state.errors:</p>
                        <span class="text-sm" style="color: var(--docs-text);" {{ $textAttr }}="state.errors.email || 'No email error'"></span>
                    </div>
                </div>
            </x-accelade::state>
        </div>

        <!-- Flash Messages -->
        <div class="rounded-xl p-4 border border-green-500/30" style="background: rgba(34, 197, 94, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-green-500/20 text-green-500 rounded">Flash</span>
                Flash Messages
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Access session flash data for notifications and status messages.
            </p>

            <x-accelade::state :flash="$demoFlash" id="flash-demo">
                <div class="space-y-3">
                    <!-- Success flash -->
                    <div {{ $showAttr }}="hasFlash('success')" class="p-3 rounded-lg border border-green-500/30" style="background: var(--docs-bg);">
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                            </svg>
                            <span class="text-sm text-green-500" {{ $textAttr }}="getFlash('success')"></span>
                        </div>
                    </div>

                    <!-- Info flash -->
                    <div {{ $showAttr }}="hasFlash('info')" class="p-3 rounded-lg border border-blue-500/30" style="background: var(--docs-bg);">
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                            </svg>
                            <span class="text-sm text-blue-500" {{ $textAttr }}="getFlash('info')"></span>
                        </div>
                    </div>

                    <!-- Access via state object -->
                    <div class="p-3 rounded-lg border border-[var(--docs-border)] mt-4" style="background: var(--docs-bg);">
                        <p class="text-xs mb-1" style="color: var(--docs-text-muted);">Via state.flash:</p>
                        <span class="text-sm" style="color: var(--docs-text);" {{ $textAttr }}="state.flash.success || 'No success message'"></span>
                    </div>
                </div>
            </x-accelade::state>
        </div>
    </div>

    <div class="grid md:grid-cols-2 gap-4 mb-4">
        <!-- Shared Data -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Shared</span>
                Shared Data
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Access globally shared data like user info, app settings, etc.
            </p>

            <x-accelade::state :shared="$demoShared" id="shared-demo">
                <div class="space-y-3">
                    <!-- User info -->
                    <div {{ $showAttr }}="hasShared('user')" class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="text-xs mb-2" style="color: var(--docs-text-muted);">User Info:</p>
                        <div class="space-y-1">
                            <p class="text-sm">
                                <span style="color: var(--docs-text-muted);">Name:</span>
                                <span class="font-medium" style="color: var(--docs-text);" {{ $textAttr }}="getShared('user.name')"></span>
                            </p>
                            <p class="text-sm">
                                <span style="color: var(--docs-text-muted);">Email:</span>
                                <span style="color: var(--docs-text);" {{ $textAttr }}="getShared('user.email')"></span>
                            </p>
                            <p class="text-sm">
                                <span style="color: var(--docs-text-muted);">Role:</span>
                                <span class="text-purple-500 font-medium" {{ $textAttr }}="getShared('user.role')"></span>
                            </p>
                        </div>
                    </div>

                    <!-- App info via state object -->
                    <div class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="text-xs mb-1" style="color: var(--docs-text-muted);">Via state.shared (dot notation):</p>
                        <span class="text-sm" style="color: var(--docs-text);" {{ $textAttr }}="state.shared.app?.name + ' v' + state.shared.app?.version"></span>
                    </div>
                </div>
            </x-accelade::state>
        </div>

        <!-- Combined State -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-gray-500/20 rounded" style="color: var(--docs-text-muted);">Combined</span>
                All Data Together
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Use all state features within a single component.
            </p>

            <x-accelade::state
                :errors="['name' => ['Name is required']]"
                :flash="['notice' => 'Form reloaded']"
                :shared="['env' => 'demo']"
                id="combined-demo"
            >
                <div class="space-y-3">
                    <!-- Show error -->
                    <div {{ $showAttr }}="hasError('name')" class="p-2 rounded text-sm text-red-500 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
                        <span {{ $textAttr }}="getError('name')"></span>
                    </div>

                    <!-- Show flash -->
                    <div {{ $showAttr }}="hasFlash('notice')" class="p-2 rounded text-sm text-blue-500 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
                        <span {{ $textAttr }}="getFlash('notice')"></span>
                    </div>

                    <!-- Show shared -->
                    <div class="p-2 rounded text-sm text-purple-500 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
                        Environment: <span {{ $textAttr }}="getShared('env')"></span>
                    </div>

                    <!-- State summary -->
                    <div class="p-3 rounded-lg border border-[var(--docs-border)] text-sm" style="background: var(--docs-bg-alt);">
                        <p style="color: var(--docs-text);">
                            Has errors: <span class="font-mono" {{ $textAttr }}="state.hasErrors ? 'Yes' : 'No'"></span>
                        </p>
                    </div>
                </div>
            </x-accelade::state>
        </div>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props & State Object</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm mb-6">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">errors</code></td>
                        <td class="py-2 px-3">array</td>
                        <td class="py-2 px-3">error bag</td>
                        <td class="py-2 px-3">Validation errors (from Laravel error bag by default)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">flash</code></td>
                        <td class="py-2 px-3">array</td>
                        <td class="py-2 px-3">session flash</td>
                        <td class="py-2 px-3">Flash data (from session by default)</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-indigo-500">shared</code></td>
                        <td class="py-2 px-3">array</td>
                        <td class="py-2 px-3">Accelade shared</td>
                        <td class="py-2 px-3">Shared data (from Accelade by default)</td>
                    </tr>
                </tbody>
            </table>

            <h5 class="font-medium mb-3" style="color: var(--docs-text);">Available State & Methods</h5>
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Property/Method</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code style="color: var(--docs-text);">state.errors</code></td>
                        <td class="py-2 px-3">object</td>
                        <td class="py-2 px-3">First error message per field</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code style="color: var(--docs-text);">state.rawErrors</code></td>
                        <td class="py-2 px-3">object</td>
                        <td class="py-2 px-3">All error messages per field (arrays)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code style="color: var(--docs-text);">state.hasErrors</code></td>
                        <td class="py-2 px-3">boolean</td>
                        <td class="py-2 px-3">Whether any errors exist</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code style="color: var(--docs-text);">state.flash</code></td>
                        <td class="py-2 px-3">object</td>
                        <td class="py-2 px-3">All flash data</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code style="color: var(--docs-text);">state.shared</code></td>
                        <td class="py-2 px-3">object</td>
                        <td class="py-2 px-3">All shared data</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">hasError(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Check if field has error</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">getError(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Get first error for field</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">getErrors(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Get all errors for field</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">hasFlash(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Check if flash key exists</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">getFlash(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Get flash value</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">hasShared(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Check if shared key exists (dot notation)</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-indigo-500">getShared(key)</code></td>
                        <td class="py-2 px-3">function</td>
                        <td class="py-2 px-3">Get shared value (dot notation)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="state-examples.blade.php">
{{-- Basic validation errors --}}
&lt;x-accelade::state&gt;
    &lt;div a-show="state.hasErrors" class="alert alert-danger"&gt;
        Please fix the errors below.
    &lt;/div&gt;

    &lt;div a-show="hasError('email')"&gt;
        &lt;span a-text="getError('email')"&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/x-accelade::state&gt;

{{-- Flash message display --}}
&lt;x-accelade::state&gt;
    &lt;div a-show="hasFlash('success')" class="alert alert-success"&gt;
        &lt;span a-text="getFlash('success')"&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/x-accelade::state&gt;

{{-- Access shared user data --}}
&lt;x-accelade::state&gt;
    &lt;div a-show="hasShared('user')"&gt;
        Welcome, &lt;span a-text="getShared('user.name')"&gt;&lt;/span&gt;!
    &lt;/div&gt;
&lt;/x-accelade::state&gt;

{{-- Custom data override --}}
&lt;x-accelade::state
    :errors="['custom' => 'Custom error']"
    :flash="['message' => 'Custom flash']"
    :shared="['key' => 'value']"
&gt;
    ...
&lt;/x-accelade::state&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_teleport-component.blade.php">
{{-- Teleport Component Section - Relocate Content to Different DOM Locations --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $modelAttr = match($prefix) {
        'v' => 'v-model',
        'data-state' => 'data-state-model',
        's' => 's-model',
        'ng' => 'ng-model',
        default => 'a-model',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };
@endphp

<!-- Demo: Teleport Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-cyan-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Teleport Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Relocate template sections to different DOM nodes with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::teleport&gt;</code>.
        Content is "teleported" while preserving reactivity.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Basic Teleport -->
        <div class="rounded-xl p-4 border border-cyan-500/30" style="background: rgba(6, 182, 212, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-cyan-500/20 text-cyan-500 rounded">Basic</span>
                Teleport to Footer
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Content from here appears in the target section below.
            </p>

            <x-accelade::data :default="['searchQuery' => '']">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
                    <label class="block text-sm font-medium mb-2" style="color: var(--docs-text);">Search Input</label>
                    <input
                        type="text"
                        {{ $modelAttr }}="searchQuery"
                        placeholder="Type something..."
                        class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-cyan-500 border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                </div>

                <!-- This content teleports to #search-preview -->
                <x-accelade::teleport to="#search-preview">
                    <div class="p-3 bg-cyan-500 text-white rounded-lg">
                        <p class="text-sm">
                            <strong>Search Preview:</strong>
                            <span {{ $textAttr }}="searchQuery || 'Nothing yet...'">Nothing yet...</span>
                        </p>
                    </div>
                </x-accelade::teleport>

                <!-- Target for teleported content -->
                <div class="mt-4 p-3 rounded-lg border-2 border-dashed border-cyan-500/50" style="background: var(--docs-bg);">
                    <p class="text-xs mb-2" style="color: var(--docs-text-muted);">Teleport Target (#search-preview):</p>
                    <div id="search-preview"></div>
                </div>
            </x-accelade::data>
        </div>

        <!-- Reactive Data Teleport -->
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-violet-500/20 text-violet-500 rounded">Reactive</span>
                Maintains Reactivity
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Teleported content stays reactive with parent component data.
            </p>

            <x-accelade::data :default="['count' => 0, 'message' => 'Hello']">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4 space-y-3" style="background: var(--docs-bg);">
                    <div class="flex items-center gap-3">
                        <button
                            @click="$set('count', count - 1)"
                            class="px-3 py-1 bg-violet-500/20 text-violet-500 rounded hover:bg-violet-500/30"
                        >-</button>
                        <span class="font-mono text-lg" style="color: var(--docs-text);" {{ $textAttr }}="count">0</span>
                        <button
                            @click="$set('count', count + 1)"
                            class="px-3 py-1 bg-violet-500/20 text-violet-500 rounded hover:bg-violet-500/30"
                        >+</button>
                    </div>
                    <input
                        type="text"
                        {{ $modelAttr }}="message"
                        class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-violet-500 border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                </div>

                <!-- Teleported content with reactive bindings -->
                <x-accelade::teleport to="#reactive-target">
                    <div class="p-3 bg-violet-500 text-white rounded-lg space-y-1">
                        <p class="text-sm">
                            <strong>Count:</strong> <span {{ $textAttr }}="count">0</span>
                        </p>
                        <p class="text-sm">
                            <strong>Message:</strong> <span {{ $textAttr }}="message">Hello</span>
                        </p>
                        <p class="text-sm">
                            <strong>Computed:</strong> <span {{ $textAttr }}="message + ' (x' + count + ')'">Hello (x0)</span>
                        </p>
                    </div>
                </x-accelade::teleport>

                <!-- Target -->
                <div class="mt-4 p-3 rounded-lg border-2 border-dashed border-violet-500/50" style="background: var(--docs-bg);">
                    <p class="text-xs mb-2" style="color: var(--docs-text-muted);">Teleport Target (#reactive-target):</p>
                    <div id="reactive-target"></div>
                </div>
            </x-accelade::data>
        </div>

        <!-- Multiple Teleports -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Multiple</span>
                Multiple Teleports
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Multiple components can teleport to the same target.
            </p>

            <x-accelade::data :default="['name' => 'Alice']">
                <input
                    type="text"
                    {{ $modelAttr }}="name"
                    placeholder="Enter name"
                    class="w-full px-3 py-2 rounded-lg mb-3 border border-[var(--docs-border)]"
                    style="background: var(--docs-bg); color: var(--docs-text);"
                >

                <x-accelade::teleport to="#multi-target" id="teleport-1">
                    <div class="p-2 bg-amber-500 text-white rounded text-sm mb-1">
                        Teleport 1: <span {{ $textAttr }}="name">Alice</span>
                    </div>
                </x-accelade::teleport>
            </x-accelade::data>

            <x-accelade::data :default="['color' => 'blue']">
                <input
                    type="text"
                    {{ $modelAttr }}="color"
                    placeholder="Enter color"
                    class="w-full px-3 py-2 rounded-lg mb-3 border border-[var(--docs-border)]"
                    style="background: var(--docs-bg); color: var(--docs-text);"
                >

                <x-accelade::teleport to="#multi-target" id="teleport-2">
                    <div class="p-2 bg-yellow-500 text-white rounded text-sm">
                        Teleport 2: <span {{ $textAttr }}="color">blue</span>
                    </div>
                </x-accelade::teleport>
            </x-accelade::data>

            <!-- Target for multiple teleports -->
            <div class="mt-4 p-3 rounded-lg border-2 border-dashed border-amber-500/50" style="background: var(--docs-bg);">
                <p class="text-xs mb-2" style="color: var(--docs-text-muted);">Shared Target (#multi-target):</p>
                <div id="multi-target" class="space-y-1"></div>
            </div>
        </div>

        <!-- Disabled Teleport -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 border border-[var(--docs-border)] rounded" style="background: var(--docs-bg-alt); color: var(--docs-text-muted);">Disabled</span>
                Conditional Teleport
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Disabled teleport keeps content in its original location.
            </p>

            <div class="space-y-4">
                <!-- Disabled teleport -->
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <p class="text-sm mb-2" style="color: var(--docs-text-muted);">This teleport is disabled:</p>
                    <x-accelade::teleport to="#disabled-target" :disabled="true">
                        <div class="p-2 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg); color: var(--docs-text);">
                            Content stays here (disabled)
                        </div>
                    </x-accelade::teleport>
                </div>

                <!-- Target (will be empty) -->
                <div class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <p class="text-xs mb-2" style="color: var(--docs-text-muted);">Target (#disabled-target) - Empty:</p>
                    <div id="disabled-target" class="min-h-[20px]"></div>
                </div>
            </div>
        </div>

        <!-- Global Targets Demo -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">Global</span>
                Teleport to Global Targets
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Teleport content to fixed positions like header, footer, or modal containers anywhere in the page.
            </p>

            <x-accelade::data :default="['notification' => 'Important announcement!']">
                <div class="p-4 rounded-lg border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
                    <label class="block text-sm font-medium mb-2" style="color: var(--docs-text);">Notification Message</label>
                    <input
                        type="text"
                        {{ $modelAttr }}="notification"
                        class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-emerald-500 border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                </div>

                <!-- Teleport to global notification area -->
                <x-accelade::teleport to="#global-notification">
                    <div class="p-3 bg-emerald-500 text-white rounded-lg shadow-lg">
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <span {{ $textAttr }}="notification">Important announcement!</span>
                        </div>
                    </div>
                </x-accelade::teleport>
            </x-accelade::data>
        </div>
    </div>

    <!-- Global Notification Target (simulating a fixed position) -->
    <div class="bg-slate-800 rounded-xl p-4 mb-4">
        <p class="text-xs text-slate-400 mb-2">Global Notification Area (#global-notification):</p>
        <div id="global-notification"></div>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-cyan-500">to</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">CSS selector for target element (required)</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-cyan-500">disabled</code></td>
                        <td class="py-2 px-3">bool</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Keep content in original location</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="teleport-examples.blade.php">
{{-- Basic teleport to target element --}}
&lt;x-accelade::teleport to="#footer"&gt;
    &lt;p&gt;This content appears in the footer&lt;/p&gt;
&lt;/x-accelade::teleport&gt;

&lt;div id="footer"&gt;&lt;/div&gt;

{{-- Teleport with reactive data --}}
&lt;div data-accelade data-accelade-state='{"search": ""}'&gt;
    &lt;input a-model="search" placeholder="Search..."&gt;

    &lt;x-accelade::teleport to="#search-results"&gt;
        &lt;p&gt;Searching for: &lt;span a-text="search"&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;/x-accelade::teleport&gt;
&lt;/div&gt;

{{-- Disabled teleport (content stays in place) --}}
&lt;x-accelade::teleport to="#target" :disabled="true"&gt;
    &lt;p&gt;This stays here&lt;/p&gt;
&lt;/x-accelade::teleport&gt;

{{-- JavaScript API --}}
&lt;script&gt;
// Get teleport instance
const instance = Accelade.teleport.get('my-teleport');

// Update target dynamically
Accelade.teleport.updateTarget('my-teleport', '#new-target');

// Return content to original position
Accelade.teleport.return('my-teleport');

// Re-teleport
Accelade.teleport.teleport('my-teleport');
&lt;/script&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_transition-component.blade.php">
{{-- Transition Component Section - CSS Class-Based Animations --}}
@props(['prefix' => 'a'])

<!-- Demo: Transition Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-violet-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Transition & Animation</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        CSS class-based enter/leave animations. Use animation presets directly on toggle components, or use the standalone <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::transition&gt;</code> component.
    </p>

    <!-- Simplest Usage - Toggle with Animation -->
    <div class="rounded-xl p-4 border-2 border-green-500/50 mb-4" style="background: rgba(34, 197, 94, 0.1);">
        <h4 class="font-semibold mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-green-500 text-white rounded">Recommended</span>
            Simplest Usage: Toggle + Animation
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Just add <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="preset"</code> to the toggle component.
            All <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">{{ $prefix }}-show</code> elements inside will automatically animate.
        </p>

        <div class="grid md:grid-cols-3 gap-4 mb-4">
            <!-- Fade -->
            <x-accelade::toggle animation="fade">
                <div class="space-y-3">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                    >
                        Fade
                    </button>
                    <div {{ $prefix }}-show="toggled" class="p-3 rounded-lg border border-[var(--docs-border)] text-center" style="background: var(--docs-bg);">
                        <span style="color: var(--docs-text);">Fades in/out</span>
                    </div>
                </div>
            </x-accelade::toggle>

            <!-- Scale -->
            <x-accelade::toggle animation="scale">
                <div class="space-y-3">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors"
                    >
                        Scale
                    </button>
                    <div {{ $prefix }}-show="toggled" class="p-3 rounded-lg border border-[var(--docs-border)] text-center" style="background: var(--docs-bg);">
                        <span style="color: var(--docs-text);">Scales in/out</span>
                    </div>
                </div>
            </x-accelade::toggle>

            <!-- Slide Up -->
            <x-accelade::toggle animation="slide-up">
                <div class="space-y-3">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors"
                    >
                        Slide Up
                    </button>
                    <div class="overflow-hidden">
                        <div {{ $prefix }}-show="toggled" class="p-3 rounded-lg border border-[var(--docs-border)] text-center" style="background: var(--docs-bg);">
                            <span style="color: var(--docs-text);">Slides up</span>
                        </div>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <x-accelade::code-block language="blade" filename="simple-toggle-animation.blade.php">
{{-- Just add animation prop to toggle! --}}
&lt;x-accelade::toggle animation="fade"&gt;
    &lt;button @click.prevent="toggle()"&gt;Toggle&lt;/button&gt;
    &lt;div {{ $prefix }}-show="toggled"&gt;Animated content!&lt;/div&gt;
&lt;/x-accelade::toggle&gt;

{{-- Available presets: fade, scale, slide-up, slide-down, slide-left, slide-right --}}
        </x-accelade::code-block>
    </div>

    <!-- All Presets Demo -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">All Animation Presets</h4>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <x-accelade::toggle animation="default">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-slate-600 text-white text-sm rounded hover:bg-slate-700">default</button>
                    <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Default</div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="fade">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-violet-500 text-white text-sm rounded hover:bg-violet-600">fade</button>
                    <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Fade</div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="scale">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-pink-500 text-white text-sm rounded hover:bg-pink-600">scale</button>
                    <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Scale</div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-left">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-blue-500 text-white text-sm rounded hover:bg-blue-600">slide-left</button>
                    <div class="overflow-hidden">
                        <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Left</div>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-right">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-cyan-500 text-white text-sm rounded hover:bg-cyan-600">slide-right</button>
                    <div class="overflow-hidden">
                        <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Right</div>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-up">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-emerald-500 text-white text-sm rounded hover:bg-emerald-600">slide-up</button>
                    <div class="overflow-hidden">
                        <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Up</div>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-down">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-amber-500 text-white text-sm rounded hover:bg-amber-600">slide-down</button>
                    <div class="overflow-hidden">
                        <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Down</div>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="opacity">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-orange-500 text-white text-sm rounded hover:bg-orange-600">opacity</button>
                    <div {{ $prefix }}-show="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg-alt); color: var(--docs-text);">Opacity</div>
                </div>
            </x-accelade::toggle>
        </div>
    </div>

    <!-- Accordion Example with Animation -->
    <div class="rounded-xl p-4 border border-indigo-500/30 mb-4" style="background: rgba(99, 102, 241, 0.1);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-indigo-500/20 text-indigo-500 rounded">Example</span>
            Accordion with Animation
        </h4>

        <div class="space-y-2">
            <x-accelade::toggle animation="collapse">
                <div class="rounded-lg border border-indigo-500/30 overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left font-medium hover:bg-indigo-500/10 flex justify-between items-center"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span>What is Accelade?</span>
                        <svg class="w-5 h-5 transition-transform" {{ $prefix }}-class="{'rotate-180': toggled}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div {{ $prefix }}-show="toggled" class="px-4 py-3 border-t border-indigo-500/30 bg-indigo-500/10" style="color: var(--docs-text-muted);">
                        Accelade is a reactive UI library for Laravel Blade that brings modern reactivity without a JavaScript framework.
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="collapse">
                <div class="rounded-lg border border-indigo-500/30 overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left font-medium hover:bg-indigo-500/10 flex justify-between items-center"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span>How do animations work?</span>
                        <svg class="w-5 h-5 transition-transform" {{ $prefix }}-class="{'rotate-180': toggled}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div {{ $prefix }}-show="toggled" class="px-4 py-3 border-t border-indigo-500/30 bg-indigo-500/10" style="color: var(--docs-text-muted);">
                        Simply add the <code class="px-1 rounded" style="background: var(--docs-bg);">animation</code> prop to your toggle component. CSS classes are applied during enter/leave transitions.
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="collapse">
                <div class="rounded-lg border border-indigo-500/30 overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left font-medium hover:bg-indigo-500/10 flex justify-between items-center"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span>Can I create custom animations?</span>
                        <svg class="w-5 h-5 transition-transform" {{ $prefix }}-class="{'rotate-180': toggled}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div {{ $prefix }}-show="toggled" class="px-4 py-3 border-t border-indigo-500/30 bg-indigo-500/10" style="color: var(--docs-text-muted);">
                        Yes! Use the <code class="px-1 rounded" style="background: var(--docs-bg);">Animation</code> facade to register custom presets with your own Tailwind classes.
                    </div>
                </div>
            </x-accelade::toggle>
        </div>
    </div>

    <hr class="my-6 border-[var(--docs-border)]">

    <h4 class="text-lg font-semibold mb-3" style="color: var(--docs-text);">Standalone Transition Component</h4>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        For more control, use the <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::transition&gt;</code> component directly.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Fade Animation -->
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-violet-500/20 text-violet-500 rounded">Preset</span>
                Fade Animation
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Simple fade in/out using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="fade"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-colors"
                    >
                        Toggle Fade
                    </button>

                    <x-accelade::transition show="toggled" animation="fade">
                        <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                            <p style="color: var(--docs-text);">This content fades in and out smoothly!</p>
                        </div>
                    </x-accelade::transition>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Scale Animation -->
        <div class="rounded-xl p-4 border border-pink-500/30" style="background: rgba(236, 72, 153, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-pink-500/20 text-pink-500 rounded">Preset</span>
                Scale Animation
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Scale from center using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="scale"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors"
                    >
                        Toggle Scale
                    </button>

                    <x-accelade::transition show="toggled" animation="scale">
                        <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                            <p style="color: var(--docs-text);">This content scales in from the center!</p>
                        </div>
                    </x-accelade::transition>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Slide Left -->
        <div class="rounded-xl p-4 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-500 rounded">Preset</span>
                Slide Left
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Slide from left using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="slide-left"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                    >
                        Toggle Slide Left
                    </button>

                    <div class="overflow-hidden">
                        <x-accelade::transition show="toggled" animation="slide-left">
                            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                                <p style="color: var(--docs-text);">Slides in from the left!</p>
                            </div>
                        </x-accelade::transition>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Slide Right -->
        <div class="rounded-xl p-4 border border-cyan-500/30" style="background: rgba(6, 182, 212, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-cyan-500/20 text-cyan-500 rounded">Preset</span>
                Slide Right
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Slide from right using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="slide-right"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors"
                    >
                        Toggle Slide Right
                    </button>

                    <div class="overflow-hidden">
                        <x-accelade::transition show="toggled" animation="slide-right">
                            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                                <p style="color: var(--docs-text);">Slides in from the right!</p>
                            </div>
                        </x-accelade::transition>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Slide Up -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">Preset</span>
                Slide Up
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Slide from bottom using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="slide-up"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors"
                    >
                        Toggle Slide Up
                    </button>

                    <div class="overflow-hidden">
                        <x-accelade::transition show="toggled" animation="slide-up">
                            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                                <p style="color: var(--docs-text);">Slides up from the bottom!</p>
                            </div>
                        </x-accelade::transition>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Slide Down -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Preset</span>
                Slide Down
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Slide from top using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="slide-down"</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors"
                    >
                        Toggle Slide Down
                    </button>

                    <div class="overflow-hidden">
                        <x-accelade::transition show="toggled" animation="slide-down">
                            <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                                <p style="color: var(--docs-text);">Slides down from the top!</p>
                            </div>
                        </x-accelade::transition>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>
    </div>

    <!-- Custom Classes -->
    <div class="rounded-xl p-4 border border-orange-500/30 mb-4" style="background: rgba(249, 115, 22, 0.1);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-orange-500/20 text-orange-500 rounded">Custom</span>
            Custom Tailwind Classes
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Define your own transition using individual class props.
        </p>

        <x-accelade::toggle>
            <div class="space-y-4">
                <button
                    @click.prevent="toggle()"
                    class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors"
                >
                    Toggle Custom Animation
                </button>

                <x-accelade::transition
                    show="toggled"
                    enter="transition-all duration-500 ease-out"
                    enter-from="opacity-0 translate-y-8 rotate-6"
                    enter-to="opacity-100 translate-y-0 rotate-0"
                    leave="transition-all duration-300 ease-in"
                    leave-from="opacity-100 translate-y-0 rotate-0"
                    leave-to="opacity-0 translate-y-8 -rotate-6"
                >
                    <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p style="color: var(--docs-text);">Custom animation with rotation and translate!</p>
                    </div>
                </x-accelade::transition>
            </div>
        </x-accelade::toggle>
    </div>

    <!-- Dropdown Example -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 border border-[var(--docs-border)] rounded" style="background: var(--docs-bg-alt); color: var(--docs-text-muted);">Example</span>
            Dropdown Menu
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Real-world dropdown example using transition with default animation.
        </p>

        <x-accelade::toggle>
            <div class="relative inline-block">
                <button
                    @click.prevent="toggle()"
                    class="px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-800 transition-colors flex items-center gap-2"
                >
                    <span>Menu</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </button>

                <x-accelade::transition show="toggled" animation="default">
                    <div class="absolute left-0 mt-2 w-48 rounded-lg shadow-lg border border-[var(--docs-border)] py-1 z-10" style="background: var(--docs-bg);">
                        <a href="#" class="block px-4 py-2 hover:bg-[var(--docs-bg-alt)]" style="color: var(--docs-text);">Profile</a>
                        <a href="#" class="block px-4 py-2 hover:bg-[var(--docs-bg-alt)]" style="color: var(--docs-text);">Settings</a>
                        <a href="#" class="block px-4 py-2 hover:bg-[var(--docs-bg-alt)]" style="color: var(--docs-text);">Notifications</a>
                        <hr class="my-1 border-[var(--docs-border)]">
                        <a href="#" class="block px-4 py-2 text-red-500 hover:bg-red-500/10">Sign Out</a>
                    </div>
                </x-accelade::transition>
            </div>
        </x-accelade::toggle>
    </div>

    <!-- Modal/Dialog Example -->
    <div class="rounded-xl p-4 border border-indigo-500/30 mb-4" style="background: rgba(99, 102, 241, 0.1);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-indigo-500/20 text-indigo-500 rounded">Example</span>
            Notification Toast
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Toast notification with slide-up animation.
        </p>

        <x-accelade::toggle>
            <div class="space-y-4">
                <button
                    @click.prevent="setToggle(true)"
                    class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors"
                >
                    Show Toast
                </button>

                <x-accelade::transition show="toggled" animation="slide-up">
                    <div class="p-4 bg-green-500 text-white rounded-lg shadow-lg flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <span>Successfully saved!</span>
                        </div>
                        <button @click.prevent="setToggle(false)" class="text-green-200 hover:text-white">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </x-accelade::transition>
            </div>
        </x-accelade::toggle>
    </div>

    <!-- All Presets Reference -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Built-in Animation Presets</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Preset</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">default</code></td>
                        <td class="py-2 px-3">Subtle fade with scale (95% to 100%)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">fade</code> / <code class="text-violet-500">opacity</code></td>
                        <td class="py-2 px-3">Simple opacity fade</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">scale</code></td>
                        <td class="py-2 px-3">Scale from center (0% to 100%)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">slide-left</code></td>
                        <td class="py-2 px-3">Slide in from left</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">slide-right</code></td>
                        <td class="py-2 px-3">Slide in from right</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">slide-up</code></td>
                        <td class="py-2 px-3">Slide up from bottom</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">slide-down</code></td>
                        <td class="py-2 px-3">Slide down from top</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-violet-500">collapse</code></td>
                        <td class="py-2 px-3">Fade only (ideal for accordions)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Props Reference -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props</h4>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">show</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">State expression to watch (e.g., "toggled")</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">animation</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Preset name (default, fade, scale, slide-*)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">enter</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes during enter transition</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">enter-from</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes at start of enter</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">enter-to</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes at end of enter</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">leave</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes during leave transition</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-violet-500">leave-from</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes at start of leave</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-violet-500">leave-to</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">Classes at end of leave</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="transition-examples.blade.php">
{{-- Basic with preset --}}
&lt;x-accelade::toggle&gt;
    &lt;button @click.prevent="toggle()"&gt;Toggle&lt;/button&gt;
    &lt;x-accelade::transition show="toggled" animation="fade"&gt;
        &lt;div&gt;Fades in and out!&lt;/div&gt;
    &lt;/x-accelade::transition&gt;
&lt;/x-accelade::toggle&gt;

{{-- Custom classes --}}
&lt;x-accelade::transition
    show="toggled"
    enter="transition-opacity duration-300"
    enter-from="opacity-0"
    enter-to="opacity-100"
    leave="transition-opacity duration-200"
    leave-from="opacity-100"
    leave-to="opacity-0"
&gt;
    &lt;div&gt;Custom transition!&lt;/div&gt;
&lt;/x-accelade::transition&gt;

{{-- Register custom preset in AppServiceProvider --}}
Animation::new(
    name: 'bounce',
    enter: 'transition ease-bounce duration-300',
    enterFrom: 'opacity-0 scale-50',
    enterTo: 'opacity-100 scale-100',
    leave: 'transition ease-in duration-200',
    leaveFrom: 'opacity-100 scale-100',
    leaveTo: 'opacity-0 scale-50',
);
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/sections/navigation.blade.php">
@props(['framework' => 'vanilla', 'prefix' => 'a'])

@php
    app('accelade')->setFramework($framework);
@endphp

<x-accelade::layouts.demo-sidebar :framework="$framework" section="navigation">
    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework, 'section' => 'counter']) }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Go to Counter (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework, 'section' => 'navigation']) }}?time={{ time() }}"
                    class="px-6 py-3 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the page update without a full reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework, 'section' => 'navigation']) }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('docs.section', ['framework' => $framework, 'section' => 'navigation']) }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
            </div>
        </div>

        <!-- Framework Switch -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                @foreach(['vanilla', 'vue', 'react', 'svelte', 'angular'] as $fw)
                    @if($fw !== $framework)
                        <x-accelade::link
                            href="{{ route('docs.section', ['framework' => $fw, 'section' => 'navigation']) }}"
                            class="px-6 py-3 bg-slate-600 text-white rounded-xl font-medium hover:bg-slate-700 transition"
                        >
                            {{ ucfirst($fw) }} Demo
                        </x-accelade::link>
                    @endif
                @endforeach
            </div>
        </div>
    </section>

    <x-accelade::code-block language="blade" filename="navigation.blade.php">
&lt;x-accelade::link href="/page" :preserveScroll="true"&gt;
    Navigate with SPA
&lt;/x-accelade::link&gt;
    </x-accelade::code-block>
</x-accelade::layouts.demo-sidebar>
</file>

<file path="routes/docs.php">
<?php

declare(strict_types=1);

use Accelade\Docs\DocsRegistry;
use Accelade\Facades\Accelade;
use Accelade\Http\Controllers\DocsController;
use Accelade\Http\Controllers\NotifyDemoController;
use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Documentation Routes
|--------------------------------------------------------------------------
|
| These routes serve the Accelade documentation portal with live demos.
| Other packages can register their documentation sections via the
| DocsRegistry in their service providers.
|
*/

// Share demo data for all docs routes (needed for live demos)
$shareData = function () {
    Accelade::share('appName', config('app.name', 'Accelade Demo'));
    Accelade::share('currentTime', now()->toIso8601String());
    Accelade::share('user', [
        'id' => 1,
        'name' => 'John Doe',
        'email' => 'john@example.com',
    ]);
    Accelade::share('settings', [
        'theme' => 'dark',
        'language' => 'en',
        'notifications' => true,
    ]);
};

// Docs section routes - validates against registered sections
Route::get('/{section}', function (string $section) use ($shareData) {
    /** @var DocsRegistry $registry */
    $registry = app('accelade.docs');

    if (! $registry->hasSection($section)) {
        abort(404);
    }

    $shareData();

    return app(DocsController::class)->show(request(), $section);
})->name('docs.section');

// Search API
Route::get('/api/search', function () {
    return app(DocsController::class)->search(request());
})->name('docs.search');

// Navigation API - returns sidebar structure
Route::get('/api/navigation', function () {
    return app(DocsController::class)->navigation();
})->name('docs.navigation');

// Backend notification demo routes
Route::get('/notify/{type}', [NotifyDemoController::class, 'show'])
    ->name('docs.notify');

// Default docs page
Route::get('/', fn () => redirect()->route('docs.section', ['section' => 'getting-started']))
    ->name('docs.index');
</file>

<file path="src/Animation/AnimationManager.php">
<?php

declare(strict_types=1);

namespace Accelade\Animation;

/**
 * Manages animation presets for transitions.
 */
class AnimationManager
{
    /**
     * Registered animation presets.
     *
     * @var array<string, AnimationPreset>
     */
    protected array $presets = [];

    /**
     * Whether built-in presets have been registered.
     */
    protected bool $builtInsRegistered = false;

    /**
     * Register built-in animation presets.
     */
    protected function registerBuiltIns(): void
    {
        if ($this->builtInsRegistered) {
            return;
        }

        // Default - subtle fade and scale
        $this->register(
            name: 'default',
            enter: new AnimationPhase('transition ease-out duration-200', 'opacity-0 scale-95', 'opacity-100 scale-100'),
            leave: new AnimationPhase('transition ease-in duration-150', 'opacity-100 scale-100', 'opacity-0 scale-95'),
        );

        // Opacity - simple fade
        $this->register(
            name: 'opacity',
            enter: new AnimationPhase('transition-opacity ease-out duration-200', 'opacity-0', 'opacity-100'),
            leave: new AnimationPhase('transition-opacity ease-in duration-150', 'opacity-100', 'opacity-0'),
        );

        // Fade - same as opacity (alias)
        $this->register(
            name: 'fade',
            enter: new AnimationPhase('transition-opacity ease-out duration-200', 'opacity-0', 'opacity-100'),
            leave: new AnimationPhase('transition-opacity ease-in duration-150', 'opacity-100', 'opacity-0'),
        );

        // Slide left
        $this->register(
            name: 'slide-left',
            enter: new AnimationPhase('transition ease-out duration-300', 'opacity-0 -translate-x-full', 'opacity-100 translate-x-0'),
            leave: new AnimationPhase('transition ease-in duration-300', 'opacity-100 translate-x-0', 'opacity-0 -translate-x-full'),
        );

        // Slide right
        $this->register(
            name: 'slide-right',
            enter: new AnimationPhase('transition ease-out duration-300', 'opacity-0 translate-x-full', 'opacity-100 translate-x-0'),
            leave: new AnimationPhase('transition ease-in duration-300', 'opacity-100 translate-x-0', 'opacity-0 translate-x-full'),
        );

        // Slide up
        $this->register(
            name: 'slide-up',
            enter: new AnimationPhase('transition ease-out duration-300', 'opacity-0 translate-y-full', 'opacity-100 translate-y-0'),
            leave: new AnimationPhase('transition ease-in duration-300', 'opacity-100 translate-y-0', 'opacity-0 translate-y-full'),
        );

        // Slide down
        $this->register(
            name: 'slide-down',
            enter: new AnimationPhase('transition ease-out duration-300', 'opacity-0 -translate-y-full', 'opacity-100 translate-y-0'),
            leave: new AnimationPhase('transition ease-in duration-300', 'opacity-100 translate-y-0', 'opacity-0 -translate-y-full'),
        );

        // Scale
        $this->register(
            name: 'scale',
            enter: new AnimationPhase('transition ease-out duration-200', 'opacity-0 scale-0', 'opacity-100 scale-100'),
            leave: new AnimationPhase('transition ease-in duration-150', 'opacity-100 scale-100', 'opacity-0 scale-0'),
        );

        // Collapse - for accordions (no translate, just fade)
        $this->register(
            name: 'collapse',
            enter: new AnimationPhase('transition-opacity ease-out duration-200', 'opacity-0', 'opacity-100'),
            leave: new AnimationPhase('transition-opacity ease-in duration-150', 'opacity-100', 'opacity-0'),
        );

        $this->builtInsRegistered = true;
    }

    /**
     * Register a new animation preset with phase objects.
     */
    public function register(string $name, AnimationPhase $enter, AnimationPhase $leave): self
    {
        $this->presets[$name] = new AnimationPreset(
            name: $name,
            enter: $enter,
            leave: $leave,
        );

        return $this;
    }

    /**
     * Get an animation preset by name.
     */
    public function get(string $name): ?AnimationPreset
    {
        $this->registerBuiltIns();

        return $this->presets[$name] ?? null;
    }

    /**
     * Check if a preset exists.
     */
    public function has(string $name): bool
    {
        $this->registerBuiltIns();

        return isset($this->presets[$name]);
    }

    /**
     * Get all registered presets.
     *
     * @return array<string, AnimationPreset>
     */
    public function all(): array
    {
        $this->registerBuiltIns();

        return $this->presets;
    }

    /**
     * Get all presets as array for JSON.
     *
     * @return array<string, array<string, string>>
     */
    public function toArray(): array
    {
        $this->registerBuiltIns();

        $result = [];
        foreach ($this->presets as $name => $preset) {
            $result[$name] = $preset->toArray();
        }

        return $result;
    }
}
</file>

<file path="src/Animation/AnimationPreset.php">
<?php

declare(strict_types=1);

namespace Accelade\Animation;

/**
 * Value object representing an animation preset.
 */
readonly class AnimationPreset
{
    public function __construct(
        public string $name,
        public AnimationPhase $enter,
        public AnimationPhase $leave,
    ) {}

    /**
     * Convert to array for JSON serialization.
     *
     * @return array<string, string>
     */
    public function toArray(): array
    {
        return [
            'name' => $this->name,
            'enter' => $this->enter->transition,
            'enterFrom' => $this->enter->from,
            'enterTo' => $this->enter->to,
            'leave' => $this->leave->transition,
            'leaveFrom' => $this->leave->from,
            'leaveTo' => $this->leave->to,
        ];
    }
}
</file>

<file path="src/Exceptions/ExceptionHandler.php">
<?php

declare(strict_types=1);

namespace Accelade\Exceptions;

use Closure;
use Illuminate\Foundation\Exceptions\Handler;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\App;
use Illuminate\Validation\ValidationException;
use Symfony\Component\HttpKernel\Exception\HttpExceptionInterface;
use Throwable;

/**
 * ExceptionHandler - Custom exception handling for Accelade requests.
 *
 * Provides graceful error handling for AJAX requests from Bridge components,
 * Defer loading, and other Accelade features.
 */
class ExceptionHandler
{
    /**
     * Create an exception handler for Accelade requests.
     *
     * Usage in app/Exceptions/Handler.php:
     *
     * ```php
     * use Accelade\Exceptions\ExceptionHandler;
     *
     * public function register(): void
     * {
     *     $this->renderable(ExceptionHandler::handle($this));
     * }
     * ```
     *
     * With custom handler:
     *
     * ```php
     * $this->renderable(ExceptionHandler::handle($this, function ($e, $request) {
     *     if ($e instanceof CustomException) {
     *         return response()->json(['error' => 'Custom error'], 500);
     *     }
     * }));
     * ```
     */
    public static function handle(Handler $handler, ?Closure $customHandler = null): Closure
    {
        return function (Throwable $e, Request $request) use ($customHandler) {
            // Only handle Accelade AJAX requests
            if (! static::isAcceladeRequest($request)) {
                return null;
            }

            // Let custom handler process first
            if ($customHandler !== null) {
                $result = $customHandler($e, $request);
                if ($result !== null) {
                    return $result;
                }
            }

            // Handle validation exceptions specially
            if ($e instanceof ValidationException) {
                return static::handleValidationException($e, $request);
            }

            // Handle HTTP exceptions (404, 403, 419, etc.)
            if ($e instanceof HttpExceptionInterface) {
                return static::handleHttpException($e, $request);
            }

            // Handle generic exceptions
            return static::handleGenericException($e, $request);
        };
    }

    /**
     * Check if this is an Accelade AJAX request.
     */
    public static function isAcceladeRequest(Request $request): bool
    {
        // Check for XHR request
        if (! $request->ajax() && ! $request->wantsJson()) {
            return false;
        }

        // Check for Accelade-specific routes or headers
        $path = $request->path();

        // Accelade route patterns
        $acceladePatterns = [
            'accelade/',
            '_accelade/',
        ];

        foreach ($acceladePatterns as $pattern) {
            if (str_starts_with($path, $pattern)) {
                return true;
            }
        }

        // Check for X-Accelade header
        if ($request->hasHeader('X-Accelade')) {
            return true;
        }

        // Check for Accept header with accelade
        $accept = $request->header('Accept', '');
        if (str_contains($accept, 'accelade')) {
            return true;
        }

        return false;
    }

    /**
     * Handle validation exceptions.
     */
    protected static function handleValidationException(ValidationException $e, Request $request): JsonResponse
    {
        return response()->json([
            'success' => false,
            'message' => $e->getMessage(),
            'errors' => $e->errors(),
            '_accelade' => [
                'type' => 'validation',
                'toast' => [
                    'type' => 'danger',
                    'title' => __('Validation Error'),
                    'body' => $e->getMessage(),
                ],
            ],
        ], 422);
    }

    /**
     * Handle HTTP exceptions (404, 403, 419, etc.).
     */
    protected static function handleHttpException(HttpExceptionInterface $e, Request $request): JsonResponse
    {
        $statusCode = $e->getStatusCode();
        $message = static::getHttpExceptionMessage($statusCode, $e);

        $response = [
            'success' => false,
            'message' => $message,
            '_accelade' => [
                'type' => 'http',
                'status' => $statusCode,
            ],
        ];

        // Handle specific status codes
        switch ($statusCode) {
            case 419: // CSRF token mismatch
                $response['_accelade']['action'] = 'refresh';
                $response['_accelade']['toast'] = [
                    'type' => 'warning',
                    'title' => __('Session Expired'),
                    'body' => __('Your session has expired. Please refresh the page.'),
                ];
                break;

            case 401: // Unauthorized
                $response['_accelade']['action'] = 'redirect';
                $response['_accelade']['url'] = route('login');
                $response['_accelade']['toast'] = [
                    'type' => 'info',
                    'title' => __('Authentication Required'),
                    'body' => __('Please log in to continue.'),
                ];
                break;

            case 403: // Forbidden
                $response['_accelade']['toast'] = [
                    'type' => 'danger',
                    'title' => __('Access Denied'),
                    'body' => $message,
                ];
                break;

            case 404: // Not Found
                $response['_accelade']['toast'] = [
                    'type' => 'warning',
                    'title' => __('Not Found'),
                    'body' => $message,
                ];
                break;

            case 429: // Too Many Requests
                $response['_accelade']['toast'] = [
                    'type' => 'warning',
                    'title' => __('Too Many Requests'),
                    'body' => __('Please slow down and try again later.'),
                ];
                break;

            case 500: // Server Error
            case 503: // Service Unavailable
            default:
                $response['_accelade']['toast'] = [
                    'type' => 'danger',
                    'title' => __('Server Error'),
                    'body' => App::environment('production')
                        ? __('An unexpected error occurred. Please try again.')
                        : $message,
                ];
                break;
        }

        return response()->json($response, $statusCode);
    }

    /**
     * Handle generic exceptions.
     */
    protected static function handleGenericException(Throwable $e, Request $request): JsonResponse
    {
        $isDebug = config('app.debug', false);

        $response = [
            'success' => false,
            'message' => $isDebug ? $e->getMessage() : __('An unexpected error occurred.'),
            '_accelade' => [
                'type' => 'exception',
                'toast' => [
                    'type' => 'danger',
                    'title' => __('Error'),
                    'body' => $isDebug ? $e->getMessage() : __('An unexpected error occurred. Please try again.'),
                ],
            ],
        ];

        // Include debug info in non-production
        if ($isDebug) {
            $response['_accelade']['debug'] = [
                'exception' => get_class($e),
                'message' => $e->getMessage(),
                'file' => $e->getFile(),
                'line' => $e->getLine(),
                'trace' => collect($e->getTrace())->take(10)->map(function ($frame) {
                    return [
                        'file' => $frame['file'] ?? null,
                        'line' => $frame['line'] ?? null,
                        'function' => $frame['function'] ?? null,
                        'class' => $frame['class'] ?? null,
                    ];
                })->all(),
            ];
        }

        return response()->json($response, 500);
    }

    /**
     * Get a human-readable message for HTTP status codes.
     */
    protected static function getHttpExceptionMessage(int $statusCode, HttpExceptionInterface $e): string
    {
        // Use the exception message if available
        if ($e->getMessage()) {
            return $e->getMessage();
        }

        // Default messages for common status codes
        return match ($statusCode) {
            400 => __('Bad Request'),
            401 => __('Unauthorized'),
            403 => __('Forbidden'),
            404 => __('Not Found'),
            405 => __('Method Not Allowed'),
            408 => __('Request Timeout'),
            419 => __('Page Expired'),
            422 => __('Unprocessable Entity'),
            429 => __('Too Many Requests'),
            500 => __('Internal Server Error'),
            502 => __('Bad Gateway'),
            503 => __('Service Unavailable'),
            504 => __('Gateway Timeout'),
            default => __('HTTP Error :code', ['code' => $statusCode]),
        };
    }
}
</file>

<file path="src/Facades/Accelade.php">
<?php

declare(strict_types=1);

namespace Accelade\Facades;

use Accelade\Support\SharedData;
use Illuminate\Support\Facades\Facade;

/**
 * @method static string scripts()
 * @method static string styles()
 * @method static void startComponent(array $state = [])
 * @method static string endComponent()
 * @method static string framework()
 * @method static \Accelade\Accelade share(array|string $key, mixed $value = null)
 * @method static mixed getShared(string $key, mixed $default = null)
 * @method static array allShared()
 * @method static SharedData shared()
 *
 * @see \Accelade\Accelade
 */
class Accelade extends Facade
{
    protected static function getFacadeAccessor(): string
    {
        return 'accelade';
    }
}
</file>

<file path="src/Http/Middleware/ShareAcceladeData.php">
<?php

declare(strict_types=1);

namespace Accelade\Http\Middleware;

use Accelade\Facades\Accelade;
use Closure;
use Illuminate\Http\Request;
use Symfony\Component\HttpFoundation\Response;

class ShareAcceladeData
{
    /**
     * Handle an incoming request.
     *
     * This middleware allows applications to define a callback that shares
     * data across all requests. Register this middleware in your application
     * and define the callback in a service provider.
     *
     * Example in AppServiceProvider:
     *
     *     Accelade::share('user', fn() => auth()->user()?->only('id', 'name', 'email'));
     *     Accelade::share('appName', config('app.name'));
     *
     * @param  Closure(Request): Response  $next
     */
    public function handle(Request $request, Closure $next): Response
    {
        // Share common data that's useful across all requests
        if (! Accelade::shared()->has('csrf_token')) {
            Accelade::share('csrf_token', fn () => csrf_token());
        }

        // Share flash data if enabled
        if (config('accelade.flash.enabled', true)) {
            Accelade::share('flash', fn () => $this->getFlashData());
        }

        return $next($request);
    }

    /**
     * Get flash data from session.
     *
     * @return array<string, mixed>
     */
    protected function getFlashData(): array
    {
        $flashData = [];
        $session = session();

        // Get allowed keys from config (null means all keys)
        $allowedKeys = config('accelade.flash.keys');

        // Collect flash data from session's old flash keys
        $oldFlashKeys = $session->get('_flash.old', []);
        foreach ($oldFlashKeys as $key) {
            if ($session->has($key)) {
                // If allowedKeys is set, filter by it
                if ($allowedKeys === null || in_array($key, $allowedKeys, true)) {
                    $flashData[$key] = $session->get($key);
                }
            }
        }

        // Also check common flash keys that might be in new flash
        $commonFlashKeys = ['message', 'success', 'error', 'warning', 'info', 'status', 'notification', 'alert'];

        // If allowedKeys is set, use only those
        $keysToCheck = $allowedKeys ?? $commonFlashKeys;

        foreach ($keysToCheck as $key) {
            if ($session->has($key) && ! isset($flashData[$key])) {
                $flashData[$key] = $session->get($key);
            }
        }

        return $flashData;
    }
}
</file>

<file path="src/SEO/SEO.php">
<?php

declare(strict_types=1);

namespace Accelade\SEO;

use Illuminate\Contracts\Support\Arrayable;
use Illuminate\Contracts\Support\Htmlable;
use Illuminate\Support\Arr;
use Illuminate\Support\Traits\Macroable;

/**
 * SEO Manager for managing page metadata.
 *
 * Provides a fluent interface for setting title, description, keywords,
 * canonical URLs, OpenGraph tags, Twitter Cards, and custom meta tags.
 */
class SEO implements Arrayable, Htmlable
{
    use Macroable;

    protected ?string $title = null;

    protected ?string $description = null;

    /** @var array<int, string> */
    protected array $keywords = [];

    protected ?string $canonical = null;

    /** @var array<string, string|null> */
    protected array $openGraph = [
        'type' => null,
        'site_name' => null,
        'title' => null,
        'description' => null,
        'url' => null,
        'image' => null,
        'image:alt' => null,
        'locale' => null,
    ];

    /** @var array<string, string|null> */
    protected array $twitter = [
        'card' => null,
        'site' => null,
        'creator' => null,
        'title' => null,
        'description' => null,
        'image' => null,
        'image:alt' => null,
    ];

    /** @var array<int, array{type: string, key: string, value: string}> */
    protected array $meta = [];

    protected ?string $robots = null;

    protected ?string $author = null;

    /**
     * Set the page title.
     */
    public function title(?string $title): self
    {
        $this->title = $title;

        return $this;
    }

    /**
     * Get the page title.
     */
    public function getTitle(): ?string
    {
        return $this->title;
    }

    /**
     * Set the page description.
     */
    public function description(?string $description): self
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get the page description.
     */
    public function getDescription(): ?string
    {
        return $this->description;
    }

    /**
     * Set page keywords.
     *
     * @param  string|array<int, string>  $keywords
     */
    public function keywords(string|array $keywords): self
    {
        if (is_string($keywords)) {
            $keywords = array_map('trim', explode(',', $keywords));
        }

        $this->keywords = $keywords;

        return $this;
    }

    /**
     * Get page keywords.
     *
     * @return array<int, string>
     */
    public function getKeywords(): array
    {
        return $this->keywords;
    }

    /**
     * Set the canonical URL.
     */
    public function canonical(?string $url): self
    {
        $this->canonical = $url;

        return $this;
    }

    /**
     * Get the canonical URL.
     */
    public function getCanonical(): ?string
    {
        return $this->canonical;
    }

    /**
     * Set robots meta tag.
     */
    public function robots(?string $robots): self
    {
        $this->robots = $robots;

        return $this;
    }

    /**
     * Get robots meta tag.
     */
    public function getRobots(): ?string
    {
        return $this->robots;
    }

    /**
     * Set author meta tag.
     */
    public function author(?string $author): self
    {
        $this->author = $author;

        return $this;
    }

    /**
     * Get author meta tag.
     */
    public function getAuthor(): ?string
    {
        return $this->author;
    }

    /**
     * Set OpenGraph type.
     */
    public function openGraphType(?string $type): self
    {
        $this->openGraph['type'] = $type;

        return $this;
    }

    /**
     * Set OpenGraph site name.
     */
    public function openGraphSiteName(?string $siteName): self
    {
        $this->openGraph['site_name'] = $siteName;

        return $this;
    }

    /**
     * Set OpenGraph title.
     */
    public function openGraphTitle(?string $title): self
    {
        $this->openGraph['title'] = $title;

        return $this;
    }

    /**
     * Set OpenGraph description.
     */
    public function openGraphDescription(?string $description): self
    {
        $this->openGraph['description'] = $description;

        return $this;
    }

    /**
     * Set OpenGraph URL.
     */
    public function openGraphUrl(?string $url): self
    {
        $this->openGraph['url'] = $url;

        return $this;
    }

    /**
     * Set OpenGraph image.
     */
    public function openGraphImage(?string $image, ?string $alt = null): self
    {
        $this->openGraph['image'] = $image;

        if ($alt !== null) {
            $this->openGraph['image:alt'] = $alt;
        }

        return $this;
    }

    /**
     * Set OpenGraph locale.
     */
    public function openGraphLocale(?string $locale): self
    {
        $this->openGraph['locale'] = $locale;

        return $this;
    }

    /**
     * Get all OpenGraph values.
     *
     * @return array<string, string|null>
     */
    public function getOpenGraph(): array
    {
        return $this->openGraph;
    }

    /**
     * Set Twitter card type.
     */
    public function twitterCard(?string $card): self
    {
        $this->twitter['card'] = $card;

        return $this;
    }

    /**
     * Set Twitter site handle.
     */
    public function twitterSite(?string $site): self
    {
        $this->twitter['site'] = $site;

        return $this;
    }

    /**
     * Set Twitter creator handle.
     */
    public function twitterCreator(?string $creator): self
    {
        $this->twitter['creator'] = $creator;

        return $this;
    }

    /**
     * Set Twitter title.
     */
    public function twitterTitle(?string $title): self
    {
        $this->twitter['title'] = $title;

        return $this;
    }

    /**
     * Set Twitter description.
     */
    public function twitterDescription(?string $description): self
    {
        $this->twitter['description'] = $description;

        return $this;
    }

    /**
     * Set Twitter image.
     */
    public function twitterImage(?string $image, ?string $alt = null): self
    {
        $this->twitter['image'] = $image;

        if ($alt !== null) {
            $this->twitter['image:alt'] = $alt;
        }

        return $this;
    }

    /**
     * Get all Twitter card values.
     *
     * @return array<string, string|null>
     */
    public function getTwitter(): array
    {
        return $this->twitter;
    }

    /**
     * Add a meta tag by name attribute.
     */
    public function metaByName(string $name, string $content): self
    {
        $this->meta[] = [
            'type' => 'name',
            'key' => $name,
            'value' => $content,
        ];

        return $this;
    }

    /**
     * Add a meta tag by property attribute.
     */
    public function metaByProperty(string $property, string $content): self
    {
        $this->meta[] = [
            'type' => 'property',
            'key' => $property,
            'value' => $content,
        ];

        return $this;
    }

    /**
     * Add a custom meta tag with arbitrary attributes.
     *
     * @param  array<string, string>  $attributes
     */
    public function meta(array $attributes): self
    {
        $this->meta[] = [
            'type' => 'custom',
            'key' => '',
            'value' => '',
            'attributes' => $attributes,
        ];

        return $this;
    }

    /**
     * Get all custom meta tags.
     *
     * @return array<int, array{type: string, key: string, value: string}>
     */
    public function getMeta(): array
    {
        return $this->meta;
    }

    /**
     * Reset all SEO values to defaults.
     */
    public function reset(): self
    {
        $this->title = null;
        $this->description = null;
        $this->keywords = [];
        $this->canonical = null;
        $this->robots = null;
        $this->author = null;

        $this->openGraph = [
            'type' => null,
            'site_name' => null,
            'title' => null,
            'description' => null,
            'url' => null,
            'image' => null,
            'image:alt' => null,
            'locale' => null,
        ];

        $this->twitter = [
            'card' => null,
            'site' => null,
            'creator' => null,
            'title' => null,
            'description' => null,
            'image' => null,
            'image:alt' => null,
        ];

        $this->meta = [];

        return $this;
    }

    /**
     * Build the full title with separator and suffix.
     */
    public function buildTitle(): ?string
    {
        $config = config('accelade.seo', []);
        $title = $this->title ?? Arr::get($config, 'defaults.title');

        if ($title === null) {
            return null;
        }

        $separator = Arr::get($config, 'title_separator', ' | ');
        $prefix = Arr::get($config, 'title_prefix');
        $suffix = Arr::get($config, 'title_suffix');

        $parts = array_filter([$prefix, $title, $suffix]);

        return implode($separator, $parts);
    }

    /**
     * Get effective description (with fallback to default).
     */
    public function buildDescription(): ?string
    {
        return $this->description ?? Arr::get(config('accelade.seo', []), 'defaults.description');
    }

    /**
     * Get effective keywords (with fallback to default).
     *
     * @return array<int, string>
     */
    public function buildKeywords(): array
    {
        if (count($this->keywords) > 0) {
            return $this->keywords;
        }

        return Arr::get(config('accelade.seo', []), 'defaults.keywords', []);
    }

    /**
     * Get effective canonical URL (with auto-generation if enabled).
     */
    public function buildCanonical(): ?string
    {
        if ($this->canonical !== null) {
            return $this->canonical;
        }

        $autoCanonical = Arr::get(config('accelade.seo', []), 'auto_canonical_link', true);

        if ($autoCanonical && function_exists('request')) {
            return request()->url();
        }

        return null;
    }

    /**
     * Convert SEO data to array.
     *
     * @return array<string, mixed>
     */
    public function toArray(): array
    {
        return [
            'title' => $this->buildTitle(),
            'description' => $this->buildDescription(),
            'keywords' => $this->buildKeywords(),
            'canonical' => $this->buildCanonical(),
            'robots' => $this->robots,
            'author' => $this->author,
            'openGraph' => $this->buildOpenGraph(),
            'twitter' => $this->buildTwitter(),
            'meta' => $this->meta,
        ];
    }

    /**
     * Build OpenGraph tags with auto-fill.
     *
     * @return array<string, string|null>
     */
    protected function buildOpenGraph(): array
    {
        $config = Arr::get(config('accelade.seo', []), 'open_graph', []);
        $autoFill = Arr::get($config, 'auto_fill', true);

        $og = $this->openGraph;

        // Apply defaults
        foreach (Arr::get($config, 'defaults', []) as $key => $value) {
            if ($og[$key] === null) {
                $og[$key] = $value;
            }
        }

        // Auto-fill from main SEO values
        if ($autoFill) {
            if ($og['title'] === null) {
                $og['title'] = $this->buildTitle();
            }
            if ($og['description'] === null) {
                $og['description'] = $this->buildDescription();
            }
            if ($og['url'] === null) {
                $og['url'] = $this->buildCanonical();
            }
        }

        return $og;
    }

    /**
     * Build Twitter card tags with auto-fill.
     *
     * @return array<string, string|null>
     */
    protected function buildTwitter(): array
    {
        $config = Arr::get(config('accelade.seo', []), 'twitter', []);
        $autoFill = Arr::get($config, 'auto_fill', true);

        $twitter = $this->twitter;

        // Apply defaults
        foreach (Arr::get($config, 'defaults', []) as $key => $value) {
            if ($twitter[$key] === null) {
                $twitter[$key] = $value;
            }
        }

        // Auto-fill from main SEO values
        if ($autoFill) {
            if ($twitter['title'] === null) {
                $twitter['title'] = $this->buildTitle();
            }
            if ($twitter['description'] === null) {
                $twitter['description'] = $this->buildDescription();
            }
        }

        return $twitter;
    }

    /**
     * Generate HTML meta tags.
     */
    public function toHtml(): string
    {
        $html = array_merge(
            $this->renderBasicMeta(),
            $this->renderOpenGraphMeta(),
            $this->renderTwitterMeta(),
            $this->renderCustomMeta(),
        );

        return implode("\n    ", $html);
    }

    /**
     * Render basic meta tags (title, description, keywords, robots, author, canonical).
     *
     * @return array<int, string>
     */
    protected function renderBasicMeta(): array
    {
        $html = [];

        $title = $this->buildTitle();
        if ($title !== null) {
            $html[] = '<title>'.e($title).'</title>';
        }

        $description = $this->buildDescription();
        if ($description !== null) {
            $html[] = '<meta name="description" content="'.e($description).'">';
        }

        $keywords = $this->buildKeywords();
        if (count($keywords) > 0) {
            $html[] = '<meta name="keywords" content="'.e(implode(', ', $keywords)).'">';
        }

        if ($this->robots !== null) {
            $html[] = '<meta name="robots" content="'.e($this->robots).'">';
        }

        if ($this->author !== null) {
            $html[] = '<meta name="author" content="'.e($this->author).'">';
        }

        $canonical = $this->buildCanonical();
        if ($canonical !== null) {
            $html[] = '<link rel="canonical" href="'.e($canonical).'">';
        }

        return $html;
    }

    /**
     * Render OpenGraph meta tags.
     *
     * @return array<int, string>
     */
    protected function renderOpenGraphMeta(): array
    {
        $html = [];
        $og = $this->buildOpenGraph();

        foreach ($og as $key => $value) {
            if ($value !== null) {
                $property = $key === 'type' ? 'og:type' : 'og:'.str_replace('_', ':', $key);
                $html[] = '<meta property="'.e($property).'" content="'.e($value).'">';
            }
        }

        return $html;
    }

    /**
     * Render Twitter Card meta tags.
     *
     * @return array<int, string>
     */
    protected function renderTwitterMeta(): array
    {
        $html = [];
        $twitter = $this->buildTwitter();

        foreach ($twitter as $key => $value) {
            if ($value !== null) {
                $name = 'twitter:'.str_replace('_', ':', $key);
                $html[] = '<meta name="'.e($name).'" content="'.e($value).'">';
            }
        }

        return $html;
    }

    /**
     * Render custom meta tags.
     *
     * @return array<int, string>
     */
    protected function renderCustomMeta(): array
    {
        $html = [];

        foreach ($this->meta as $meta) {
            if ($meta['type'] === 'name') {
                $html[] = '<meta name="'.e($meta['key']).'" content="'.e($meta['value']).'">';
            } elseif ($meta['type'] === 'property') {
                $html[] = '<meta property="'.e($meta['key']).'" content="'.e($meta['value']).'">';
            } elseif ($meta['type'] === 'custom' && isset($meta['attributes'])) {
                $attrs = [];
                foreach ($meta['attributes'] as $attrKey => $attrValue) {
                    $attrs[] = e($attrKey).'="'.e($attrValue).'"';
                }
                $html[] = '<meta '.implode(' ', $attrs).'>';
            }
        }

        return $html;
    }

    /**
     * Render SEO tags as HTML string.
     */
    public function render(): string
    {
        return $this->toHtml();
    }

    /**
     * Convert to string (renders HTML).
     */
    public function __toString(): string
    {
        return $this->toHtml();
    }
}
</file>

<file path="tests/Feature/AnimationFacadeTest.php">
<?php

declare(strict_types=1);

use Accelade\Animation\AnimationPhase;
use Accelade\Animation\AnimationPreset;
use Accelade\Facades\Animation;

beforeEach(function () {
    // Reset animation manager between tests
    app()->forgetInstance('accelade.animation');
});

it('animation facade is registered', function () {
    expect(app('accelade.animation'))
        ->toBeInstanceOf(\Accelade\Animation\AnimationManager::class);
});

it('animation singleton returns same instance', function () {
    $instance1 = app('accelade.animation');
    $instance2 = app('accelade.animation');

    expect($instance1)->toBe($instance2);
});

it('animation facade has built-in presets', function () {
    expect(Animation::has('default'))->toBeTrue();
    expect(Animation::has('opacity'))->toBeTrue();
    expect(Animation::has('fade'))->toBeTrue();
    expect(Animation::has('slide-left'))->toBeTrue();
    expect(Animation::has('slide-right'))->toBeTrue();
    expect(Animation::has('slide-up'))->toBeTrue();
    expect(Animation::has('slide-down'))->toBeTrue();
    expect(Animation::has('scale'))->toBeTrue();
});

it('animation facade can get preset', function () {
    $preset = Animation::get('fade');

    expect($preset)
        ->toBeInstanceOf(AnimationPreset::class)
        ->and($preset->name)->toBe('fade')
        ->and($preset->enter->transition)->toBe('transition-opacity ease-out duration-200')
        ->and($preset->enter->from)->toBe('opacity-0')
        ->and($preset->enter->to)->toBe('opacity-100')
        ->and($preset->leave->transition)->toBe('transition-opacity ease-in duration-150')
        ->and($preset->leave->from)->toBe('opacity-100')
        ->and($preset->leave->to)->toBe('opacity-0');
});

it('animation facade returns null for unknown preset', function () {
    expect(Animation::get('nonexistent'))->toBeNull();
});

it('animation facade can register custom preset', function () {
    Animation::register(
        name: 'custom',
        enter: new AnimationPhase('custom-enter', 'custom-from', 'custom-to'),
        leave: new AnimationPhase('custom-leave', 'custom-leave-from', 'custom-leave-to'),
    );

    expect(Animation::has('custom'))->toBeTrue();

    $preset = Animation::get('custom');
    expect($preset->name)->toBe('custom');
    expect($preset->enter->transition)->toBe('custom-enter');
});

it('animation facade can get all presets', function () {
    $all = Animation::all();

    expect($all)
        ->toBeArray()
        ->toHaveKey('default')
        ->toHaveKey('fade')
        ->toHaveKey('slide-left');
});

it('animation facade can convert to array', function () {
    $array = Animation::toArray();

    expect($array)
        ->toBeArray()
        ->toHaveKey('default')
        ->and($array['default'])->toHaveKey('name')
        ->and($array['default'])->toHaveKey('enter')
        ->and($array['default'])->toHaveKey('enterFrom')
        ->and($array['default'])->toHaveKey('enterTo')
        ->and($array['default'])->toHaveKey('leave')
        ->and($array['default'])->toHaveKey('leaveFrom')
        ->and($array['default'])->toHaveKey('leaveTo');
});

it('preset can convert to array', function () {
    $preset = Animation::get('default');
    $array = $preset->toArray();

    expect($array)
        ->toBeArray()
        ->toHaveKey('name')
        ->toHaveKey('enter')
        ->toHaveKey('enterFrom')
        ->toHaveKey('enterTo')
        ->toHaveKey('leave')
        ->toHaveKey('leaveFrom')
        ->toHaveKey('leaveTo');
});

it('animation facade supports fluent interface', function () {
    $result = Animation::register(
        name: 'fluent-test',
        enter: new AnimationPhase('enter', 'from', 'to'),
        leave: new AnimationPhase('leave', 'leave-from', 'leave-to'),
    );

    expect($result)->toBeInstanceOf(\Accelade\Animation\AnimationManager::class);
});
</file>

<file path="tests/Feature/LinkComponentTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\View;
use Illuminate\Support\HtmlString;
use Illuminate\View\ComponentAttributeBag;

function makeLinkView(array $props = []): string
{
    $defaults = [
        'href' => '/test',
        'method' => 'GET',
        'data' => null,
        'headers' => null,
        'spa' => true,
        'away' => false,
        'activeClass' => 'active',
        'prefetch' => false,
        'preserveScroll' => false,
        'preserveState' => false,
        'replace' => false,
        'confirm' => null,
        'confirmText' => null,
        'confirmTitle' => null,
        'confirmButton' => null,
        'cancelButton' => null,
        'confirmDanger' => false,
        'modal' => false,
        'slideover' => false,
        'bottomSheet' => false,
        'modalMaxWidth' => null,
        'modalPosition' => null,
        'slideoverPosition' => null,
        'slot' => new HtmlString('Test Link'),
        'attributes' => new ComponentAttributeBag([]),
    ];

    return View::file(
        __DIR__.'/../../resources/views/components/link.blade.php',
        array_merge($defaults, $props)
    )->render();
}

it('renders basic link', function () {
    $html = makeLinkView();

    expect($html)
        ->toContain('href="/test"')
        ->toContain('Test Link')
        ->toContain('a-link');
});

it('renders with SPA attributes for vanilla framework', function () {
    config(['accelade.framework' => 'vanilla']);

    $html = makeLinkView();

    expect($html)->toContain('a-link');
});

it('renders with SPA attributes for vue framework', function () {
    config(['accelade.framework' => 'vue']);

    $html = makeLinkView();

    expect($html)->toContain('data-accelade-link');
});

it('renders with SPA attributes for react framework', function () {
    config(['accelade.framework' => 'react']);

    $html = makeLinkView();

    expect($html)->toContain('data-spa-link');
});

it('includes HTTP method attribute for non-GET methods', function () {
    $html = makeLinkView(['method' => 'POST']);

    expect($html)->toContain('data-method="POST"');
});

it('includes data attribute when data is provided', function () {
    $html = makeLinkView(['data' => ['name' => 'test', 'id' => 123]]);

    expect($html)
        ->toContain('data-data=')
        ->toContain('name')
        ->toContain('test');
});

it('includes headers attribute when headers are provided', function () {
    $html = makeLinkView(['headers' => ['X-Custom' => 'value']]);

    expect($html)
        ->toContain('data-headers=')
        ->toContain('X-Custom');
});

it('includes prefetch attribute when enabled', function () {
    $html = makeLinkView(['prefetch' => true]);

    expect($html)->toContain('data-prefetch');
});

it('includes preserve-scroll attribute when enabled', function () {
    $html = makeLinkView(['preserveScroll' => true]);

    expect($html)->toContain('data-preserve-scroll');
});

it('includes preserve-state attribute when enabled', function () {
    $html = makeLinkView(['preserveState' => true]);

    expect($html)->toContain('data-preserve-state');
});

it('includes replace attribute when enabled', function () {
    $html = makeLinkView(['replace' => true]);

    expect($html)->toContain('data-replace');
});

it('includes confirm attribute when confirm is true', function () {
    $html = makeLinkView(['confirm' => true]);

    expect($html)->toContain('data-confirm=');
});

it('includes confirm attribute with custom text', function () {
    $html = makeLinkView(['confirmText' => 'Are you sure?']);

    expect($html)->toContain('data-confirm="Are you sure?"');
});

it('includes confirm-title attribute when provided', function () {
    $html = makeLinkView([
        'confirm' => true,
        'confirmTitle' => 'Confirm Action',
    ]);

    expect($html)->toContain('data-confirm-title="Confirm Action"');
});

it('includes confirm-button attribute when provided', function () {
    $html = makeLinkView([
        'confirm' => true,
        'confirmButton' => 'Yes, do it',
    ]);

    expect($html)->toContain('data-confirm-button="Yes, do it"');
});

it('includes cancel-button attribute when provided', function () {
    $html = makeLinkView([
        'confirm' => true,
        'cancelButton' => 'No, cancel',
    ]);

    expect($html)->toContain('data-cancel-button="No, cancel"');
});

it('includes confirm-danger attribute when enabled', function () {
    $html = makeLinkView([
        'confirm' => true,
        'confirmDanger' => true,
    ]);

    expect($html)->toContain('data-confirm-danger');
});

it('includes away attribute for external links', function () {
    $html = makeLinkView(['away' => true]);

    expect($html)->toContain('data-away');
});

it('adds active class when on current URL', function () {
    // Mock the request to be on /test
    request()->merge(['_url' => '/test']);

    $html = makeLinkView(['href' => request()->url()]);

    expect($html)->toContain('active');
});

it('renders without SPA attributes when spa is false', function () {
    $html = makeLinkView(['spa' => false]);

    expect($html)
        ->not->toContain('a-link')
        ->not->toContain('data-accelade-link')
        ->not->toContain('data-spa-link');
});

it('merges additional attributes', function () {
    $html = makeLinkView([
        'attributes' => new ComponentAttributeBag([
            'class' => 'custom-class',
            'id' => 'my-link',
        ]),
    ]);

    expect($html)
        ->toContain('class="custom-class')
        ->toContain('id="my-link"');
});

it('renders slot content', function () {
    $html = makeLinkView([
        'slot' => new HtmlString('Click Here'),
    ]);

    expect($html)->toContain('Click Here');
});

it('renders DELETE method link', function () {
    $html = makeLinkView([
        'method' => 'DELETE',
        'confirmDanger' => true,
        'confirmText' => 'Delete this item?',
    ]);

    expect($html)
        ->toContain('data-method="DELETE"')
        ->toContain('data-confirm="Delete this item?"')
        ->toContain('data-confirm-danger');
});

it('renders PUT method link', function () {
    $html = makeLinkView(['method' => 'PUT']);

    expect($html)->toContain('data-method="PUT"');
});

it('renders PATCH method link', function () {
    $html = makeLinkView(['method' => 'PATCH']);

    expect($html)->toContain('data-method="PATCH"');
});

it('renders modal link with data-modal attribute', function () {
    $html = makeLinkView(['modal' => true]);

    expect($html)->toContain('data-modal');
});

it('renders slideover link with data-slideover attribute', function () {
    $html = makeLinkView(['slideover' => true]);

    expect($html)->toContain('data-slideover');
});

it('renders modal link with custom max-width', function () {
    $html = makeLinkView(['modal' => true, 'modalMaxWidth' => '4xl']);

    expect($html)
        ->toContain('data-modal')
        ->toContain('data-modal-max-width="4xl"');
});

it('renders modal link with custom position', function () {
    $html = makeLinkView(['modal' => true, 'modalPosition' => 'top']);

    expect($html)
        ->toContain('data-modal')
        ->toContain('data-modal-position="top"');
});

it('renders slideover link with custom position', function () {
    $html = makeLinkView(['slideover' => true, 'slideoverPosition' => 'left']);

    expect($html)
        ->toContain('data-slideover')
        ->toContain('data-slideover-position="left"');
});

it('modal link does not have SPA attributes', function () {
    $html = makeLinkView(['modal' => true]);

    expect($html)
        ->toContain('data-modal')
        ->not->toContain('a-link')
        ->not->toContain('data-accelade-link')
        ->not->toContain('data-spa-link');
});

it('slideover link does not have SPA attributes', function () {
    $html = makeLinkView(['slideover' => true]);

    expect($html)
        ->toContain('data-slideover')
        ->not->toContain('a-link')
        ->not->toContain('data-accelade-link')
        ->not->toContain('data-spa-link');
});

it('renders bottom sheet link with data-bottom-sheet attribute', function () {
    $html = makeLinkView(['bottomSheet' => true]);

    expect($html)->toContain('data-bottom-sheet');
});

it('bottom sheet link does not have SPA attributes', function () {
    $html = makeLinkView(['bottomSheet' => true]);

    expect($html)
        ->toContain('data-bottom-sheet')
        ->not->toContain('a-link')
        ->not->toContain('data-accelade-link')
        ->not->toContain('data-spa-link');
});

it('renders bottom sheet link with custom max-width', function () {
    $html = makeLinkView(['bottomSheet' => true, 'modalMaxWidth' => 'lg']);

    expect($html)
        ->toContain('data-bottom-sheet')
        ->toContain('data-modal-max-width="lg"');
});

it('bottom sheet link does not have modal or slideover attributes', function () {
    $html = makeLinkView(['bottomSheet' => true]);

    expect($html)
        ->toContain('data-bottom-sheet')
        ->not->toContain('data-modal')
        ->not->toContain('data-slideover');
});
</file>

<file path="tests/Feature/RouteRegistrationTest.php">
<?php

declare(strict_types=1);

use Illuminate\Support\Facades\Route;

describe('Core Routes', function () {
    it('registers the script route', function () {
        expect(Route::has('accelade.script'))->toBeTrue();
    });

    it('registers the update route', function () {
        expect(Route::has('accelade.update'))->toBeTrue();
    });

    it('registers the batch-update route', function () {
        expect(Route::has('accelade.batch-update'))->toBeTrue();
    });
});

describe('Docs Routes with Config', function () {
    it('docs routes registration depends on config', function () {
        // The docs routes are registered based on config at boot time
        $docsEnabled = config('accelade.docs.enabled', false);

        if ($docsEnabled) {
            expect(Route::has('docs.section'))->toBeTrue();
            expect(Route::has('docs.index'))->toBeTrue();
            expect(Route::has('docs.search'))->toBeTrue();
            expect(Route::has('docs.notify'))->toBeTrue();
        } else {
            // When docs is disabled, routes should not exist
            expect(Route::has('docs.section'))->toBeFalse();
        }
    });

    it('docs is enabled in non-production environments', function () {
        // Docs is enabled by default in non-production environments
        // env('APP_ENV') !== 'production' evaluates to true in testing
        $isProduction = app()->environment('production');
        $docsEnabled = config('accelade.docs.enabled');

        if ($isProduction) {
            expect($docsEnabled)->toBeFalse();
        } else {
            expect($docsEnabled)->toBeTrue();
        }
    });

    it('docs prefix defaults to docs', function () {
        expect(config('accelade.docs.prefix', 'docs'))->toBe('docs');
    });

    it('docs middleware defaults to web', function () {
        expect(config('accelade.docs.middleware', ['web']))->toBe(['web']);
    });

    it('docs github repo is configured', function () {
        expect(config('accelade.docs.github_repo'))->toBe('accelade/accelade');
    });
});
</file>

<file path="tests/TestCase.php">
<?php

declare(strict_types=1);

namespace Accelade\Tests;

use Accelade\AcceladeServiceProvider;
use Orchestra\Testbench\TestCase as Orchestra;

abstract class TestCase extends Orchestra
{
    protected function getPackageProviders($app): array
    {
        return [
            AcceladeServiceProvider::class,
        ];
    }

    protected function getPackageAliases($app): array
    {
        return [
            'Accelade' => \Accelade\Facades\Accelade::class,
            'Notify' => \Accelade\Facades\Notify::class,
            'SEO' => \Accelade\Facades\SEO::class,
        ];
    }

    protected function defineEnvironment($app): void
    {
        $app['config']->set('accelade.framework', 'vanilla');
    }
}
</file>

<file path=".gitignore">
# Dependencies
node_modules/
.idea
.phpunit.cache
.phpunit.result.cache
.DS_Store
Thumbs.db
/vendor/
/.vscode/
*.log
.env
.env.backup
.env.production

# Build output
dist/

# Playwright
/test-results/
/playwright-report/
/blob-report/
/playwright/.cache/

# IDE
.idea/
.vscode/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Logs
*.log
npm-debug.log*

# Mago binary (installed locally)
/mago
</file>

<file path="docs/getting-started.md">
<p align="center">
  <img src="/vendor/accelade/logo-dark.png" alt="Accelade" style="height: 36px; width: auto;" class="dark:hidden">
  <img src="/vendor/accelade/logo-light.png" alt="Accelade" style="height: 36px; width: auto;" class="hidden dark:block">
</p>

<p align="center">
  <strong>Reactive Blade Components for Laravel</strong><br>
  Build dynamic, interactive UIs without leaving your Blade templates.
</p>

<p align="center">
  <a href="https://github.com/accelade/accelade">GitHub</a> &bull;
  <a href="/docs/installation">Installation</a> &bull;
  <a href="/docs/api-reference">API Reference</a> &bull;
  <a href="/docs/sponsor">Sponsor</a>
</p>

---

# Getting Started

Welcome to Accelade — the reactive Blade template library that brings modern frontend interactivity to Laravel without the complexity of JavaScript frameworks.

## What is Accelade?

Accelade is a lightweight, powerful library that transforms your Blade templates into reactive components. It bridges the gap between traditional server-rendered Laravel applications and modern interactive UIs, letting you build dynamic interfaces using familiar Blade syntax.

**Think of it as:** Alpine.js simplicity + Livewire's server integration + Inertia's SPA navigation — all unified in a single, cohesive package.

---

## Key Features

### Reactive Components
Create interactive UI components directly in Blade without writing JavaScript:

```blade
@accelade(['count' => 0])
    <button @click="$set('count', count + 1)">
        Clicked <span a-text="count">0</span> times
    </button>
@endaccelade
```

### Multi-Framework Support
Works with your preferred JavaScript framework or standalone:

- **Vanilla JS** — Zero dependencies, works everywhere
- **Vue.js** — Native Vue reactivity and directives
- **React** — JSX-compatible state bindings
- **Svelte** — Svelte-style reactive declarations
- **Angular** — Angular template syntax support

### SPA Navigation
Full single-page application navigation with a progress bar, prefetching, and state preservation:

```blade
<x-accelade::link href="/dashboard" :prefetch="true">
    Dashboard
</x-accelade::link>
```

### Server Integration
Seamlessly sync state between frontend and backend:

- **Bridge** — Call PHP methods directly from JavaScript
- **Server Sync** — Persist component state to the server
- **Flash Messages** — Display session flash data reactively
- **Real-time Events** — Laravel Echo integration for WebSockets

### Toast Notifications
Beautiful, customizable notifications from PHP or JavaScript:

```php
Notify::success('Saved!')->body('Your changes have been saved.')->send();
```

### Modals & Dialogs
Pre-built modal and slideover components with async loading:

```blade
<x-accelade::link href="/users/create" :modal="true">
    Create User
</x-accelade::link>
```

---

## Why Accelade?

| Traditional Approach | With Accelade |
|---------------------|---------------|
| Write separate JavaScript files | Keep logic in Blade templates |
| Manage complex build pipelines | Works with or without build tools |
| Learn new templating languages | Use familiar Blade syntax |
| Handle state synchronization manually | Automatic server sync |
| Build navigation from scratch | Built-in SPA routing |

### Perfect For

- **Laravel developers** who want interactivity without learning React/Vue
- **Teams** maintaining existing Blade applications
- **Projects** needing progressive enhancement
- **Rapid prototyping** with instant reactivity
- **Full-stack developers** who prefer server-side rendering

---

## Quick Start

### 1. Install via Composer

```bash
composer require accelade/accelade
```

### 2. Add Directives to Layout

```blade
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">

    @acceladeStyles
</head>
<body>
    {{ $slot }}

    @acceladeScripts
    @acceladeNotifications
</body>
</html>
```

> **Important:** The CSRF meta tag is required for server sync functionality.

### 3. Create Your First Component

```blade
@accelade(['count' => 0])
    <div class="counter">
        <p>Count: <span a-text="count">0</span></p>
        <button @click="$set('count', count + 1)">Increment</button>
        <button @click="$set('count', count - 1)">Decrement</button>
        <button @click="$set('count', 0)">Reset</button>
    </div>
@endaccelade
```

That's it! The counter is now fully reactive without writing any JavaScript.

---

## Core Concepts

### The @accelade Directive

The `@accelade` directive creates a reactive component scope. Pass an array of initial state:

```blade
@accelade(['name' => '', 'email' => '', 'agreed' => false])
    {{-- Your reactive content --}}
@endaccelade
```

### Binding Directives

| Directive | Purpose | Example |
|-----------|---------|---------|
| `a-text` | Display text | `<span a-text="name">default</span>` |
| `a-html` | Display HTML | `<div a-html="content"></div>` |
| `a-show` | Toggle visibility | `<div a-show="isVisible">...</div>` |
| `a-if` | Conditional render | `<div a-if="hasItems">...</div>` |
| `a-model` | Two-way binding | `<input a-model="email">` |
| `a-for` | Loop rendering | `<template a-for="item in items">` |
| `a-class` | Dynamic classes | `<div a-class="{ active: isActive }">` |
| `a-sync` | Server sync | `<div a-sync="preferences">` |
| `@event` | Event handler | `<button @click="save()">` |

### State Actions

Built-in functions available in event handlers:

```blade
{{-- Set a value --}}
<button @click="$set('count', count + 1)">+1</button>

{{-- Toggle a boolean --}}
<button @click="$toggle('isOpen')">Toggle</button>

{{-- Reset to initial state --}}
<button @click="$reset()">Reset All</button>
<button @click="$reset('count')">Reset Count</button>

{{-- Navigate programmatically --}}
<button @click="$navigate('/dashboard')">Go to Dashboard</button>
```

---

## Common Patterns

### Form with Validation

```blade
@accelade(['email' => '', 'submitted' => false])
    <form @submit.prevent="$set('submitted', true)">
        <input a-model="email" type="email" placeholder="Enter email">

        <p a-show="submitted && !email" class="text-red-500">
            Email is required
        </p>

        <button type="submit">Subscribe</button>
    </form>
@endaccelade
```

### Toggle Panel

```blade
@accelade(['isOpen' => false])
    <button @click="$toggle('isOpen')">
        <span a-show="!isOpen">Show Details</span>
        <span a-show="isOpen">Hide Details</span>
    </button>

    <div a-show="isOpen" class="panel">
        <p>Panel content goes here...</p>
    </div>
@endaccelade
```

### Tabs

```blade
@accelade(['activeTab' => 'home'])
    <div class="tabs">
        <button @click="$set('activeTab', 'home')" a-class="{ active: activeTab === 'home' }">
            Home
        </button>
        <button @click="$set('activeTab', 'profile')" a-class="{ active: activeTab === 'profile' }">
            Profile
        </button>
    </div>

    <div a-show="activeTab === 'home'">Home content</div>
    <div a-show="activeTab === 'profile'">Profile content</div>
@endaccelade
```

---

## Configuration

Publish the config file to customize Accelade:

```bash
php artisan vendor:publish --tag=accelade-config
```

Key options:

```php
// config/accelade.php
return [
    'framework' => 'vanilla',     // vanilla, vue, react, svelte, angular
    'sync_debounce' => 300,       // ms before syncing to server
    'progress' => [
        'color' => '#6366f1',     // progress bar color
        'showBar' => true,
        'includeSpinner' => true,
    ],
];
```

---

## Documentation

Enable the built-in documentation to explore all features with interactive demos:

```env
ACCELADE_DOCS_ENABLED=true
```

Then visit `/docs/getting-started` to browse the documentation.

---

## Next Steps

- [Installation](installation.md) — Detailed installation guide
- [Components](components.md) — Advanced component patterns
- [Custom Scripts](scripts.md) — Add custom JavaScript methods
- [Notifications](notifications.md) — Full notification API
- [SPA Navigation](spa-navigation.md) — Router configuration
- [Bridge](bridge.md) — Call PHP from JavaScript
- [Frameworks](frameworks.md) — Using with Vue, React, etc.
- [API Reference](api-reference.md) — Complete API documentation
</file>

<file path="docs/installation.md">
# Installation

## Requirements

- **PHP**: 8.2 or higher
- **Laravel**: 11.x or 12.x
- **Node.js**: 18+ (for development only)

## Install via Composer

```bash
composer require accelade/accelade
```

The package auto-registers its service provider and facades.

## Add to Layout

Include Accelade in your main layout file:

```blade
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>{{ $title ?? 'My App' }}</title>

    @acceladeStyles
</head>
<body>
    {{ $slot }}

    @acceladeScripts
    @acceladeNotifications
</body>
</html>
```

**Note:** The CSRF token meta tag is required for server sync functionality.

## Verify Installation

Create a quick test:

```blade
@accelade(['count' => 0])
    <button @click="$set('count', count + 1)">
        Clicked: <span a-text="count">0</span>
    </button>
@endaccelade
```

If the counter increments on click, you're ready to go!

## Optional: Publish Config

```bash
php artisan vendor:publish --tag=accelade-config
```

Creates `config/accelade.php` for customization.

## Optional: Publish Assets

For production, serve assets from your public directory:

```bash
php artisan vendor:publish --tag=accelade-assets
```

Then update config:

```php
'asset_mode' => 'published',
```

## Optional: Publish Views

Customize notification templates:

```bash
php artisan vendor:publish --tag=accelade-views
```

## Enable Demo

For development, enable the built-in demo pages:

```env
ACCELADE_DEMO_ENABLED=true
```

Visit `/demo/vanilla` to explore all features.

## Troubleshooting

### Scripts Not Loading

Ensure the CSRF token meta tag is present:

```html
<meta name="csrf-token" content="{{ csrf_token() }}">
```

### Reactivity Not Working

1. Check browser console for JavaScript errors
2. Ensure `@acceladeScripts` is before `</body>`
3. Verify no JavaScript conflicts

### Assets 404

If using published mode, run:

```bash
php artisan vendor:publish --tag=accelade-assets
```

## Next Steps

- [Getting Started](getting-started.md) — First steps and examples
- [Configuration](configuration.md) — All configuration options
- [Components](components.md) — Building reactive components
</file>

<file path="resources/js/core/factories/ActionsFactory.ts">
/**
 * ActionsFactory - Create standard state actions
 */

import type { AcceladeActions } from '../types';
import { emit as eventBusEmit, on as eventBusOn, once as eventBusOnce, off as eventBusOff, type EventCallback } from '../events';

/**
 * State getter function type
 */
export type StateGetter = () => Record<string, unknown>;

/**
 * State setter function type
 */
export type StateSetter = (key: string, value: unknown) => void;

/**
 * ActionsFactory - Creates standard actions for state manipulation
 */
export class ActionsFactory {
    /**
     * Create standard actions for a component
     */
    static create(
        getState: StateGetter,
        setState: StateSetter,
        originalState: Record<string, unknown>
    ): AcceladeActions {
        // Helper functions with $ prefix (common usage in templates)
        const $set = (key: string, value: unknown): void => {
            setState(key, value);
        };

        const $get = (key: string): unknown => {
            return getState()[key];
        };

        const $toggle = (key: string): void => {
            const state = getState();
            setState(key, !state[key]);
        };

        return {
            /**
             * Increment a numeric value
             */
            increment: (key = 'count', amount = 1): void => {
                const state = getState();
                const currentValue = state[key];
                const numValue = parseInt(String(currentValue), 10) || 0;
                setState(key, numValue + amount);
            },

            /**
             * Decrement a numeric value
             */
            decrement: (key = 'count', amount = 1): void => {
                const state = getState();
                const currentValue = state[key];
                const numValue = parseInt(String(currentValue), 10) || 0;
                setState(key, numValue - amount);
            },

            /**
             * Set a value directly
             */
            set: $set,

            /**
             * Toggle a boolean value
             */
            toggle: $toggle,

            /**
             * Get a value (for completeness)
             */
            get: $get,

            /**
             * Reset a value to its default (based on original type)
             */
            reset: (key: string): void => {
                const originalValue = originalState[key];

                if (typeof originalValue === 'number') {
                    setState(key, 0);
                } else if (typeof originalValue === 'boolean') {
                    setState(key, false);
                } else if (Array.isArray(originalValue)) {
                    setState(key, []);
                } else if (originalValue !== null && typeof originalValue === 'object') {
                    setState(key, {});
                } else {
                    setState(key, '');
                }
            },

            // Aliases with $ prefix for template usage
            $set,
            $get,
            $toggle,

            // Event bus methods
            $emit: eventBusEmit,
            $on: eventBusOn,
            $once: eventBusOnce,
            $off: eventBusOff,
        };
    }

    /**
     * Create extended actions with additional methods
     */
    static createExtended(
        getState: StateGetter,
        setState: StateSetter,
        originalState: Record<string, unknown>
    ): AcceladeActions & ExtendedActions {
        const baseActions = this.create(getState, setState, originalState);

        return {
            ...baseActions,

            /**
             * Push an item to an array
             */
            push: (key: string, value: unknown): void => {
                const state = getState();
                const arr = Array.isArray(state[key]) ? [...(state[key] as unknown[])] : [];
                arr.push(value);
                setState(key, arr);
            },

            /**
             * Remove an item from an array by index
             */
            remove: (key: string, index: number): void => {
                const state = getState();
                if (Array.isArray(state[key])) {
                    const arr = [...(state[key] as unknown[])];
                    arr.splice(index, 1);
                    setState(key, arr);
                }
            },

            /**
             * Clear an array or object
             */
            clear: (key: string): void => {
                const state = getState();
                if (Array.isArray(state[key])) {
                    setState(key, []);
                } else if (state[key] !== null && typeof state[key] === 'object') {
                    setState(key, {});
                } else {
                    setState(key, '');
                }
            },

            /**
             * Reset to original value
             */
            resetToOriginal: (key: string): void => {
                const originalValue = originalState[key];
                setState(key, originalValue !== undefined ? JSON.parse(JSON.stringify(originalValue)) : undefined);
            },

            /**
             * Reset all state to original
             */
            resetAll: (): void => {
                for (const key of Object.keys(originalState)) {
                    const originalValue = originalState[key];
                    setState(key, JSON.parse(JSON.stringify(originalValue)));
                }
            },

            /**
             * Multiply a numeric value
             */
            multiply: (key: string, factor: number): void => {
                const state = getState();
                const currentValue = state[key];
                const numValue = parseFloat(String(currentValue)) || 0;
                setState(key, numValue * factor);
            },

            /**
             * Append to a string
             */
            append: (key: string, value: string): void => {
                const state = getState();
                const currentValue = String(state[key] ?? '');
                setState(key, currentValue + value);
            },
        };
    }
}

/**
 * Extended actions interface
 */
export interface ExtendedActions {
    push: (key: string, value: unknown) => void;
    remove: (key: string, index: number) => void;
    clear: (key: string) => void;
    resetToOriginal: (key: string) => void;
    resetAll: () => void;
    multiply: (key: string, factor: number) => void;
    append: (key: string, value: string) => void;
}

export default ActionsFactory;
</file>

<file path="resources/js/core/factories/ConfigFactory.ts">
/**
 * ConfigFactory - Parse and manage component configuration
 */

import type { AcceladeComponentConfig, AcceladeConfig, SharedData } from '../types';

/**
 * Full config type with required properties (for internal use)
 */
interface FullAcceladeConfig {
    framework: AcceladeConfig['framework'];
    syncDebounce: number;
    csrfToken: string;
    updateUrl: string;
    batchUpdateUrl: string;
    debug: boolean;
    progress?: AcceladeConfig['progress'];
    shared?: SharedData;
}

/**
 * Default Accelade configuration
 */
const defaultConfig: FullAcceladeConfig = {
    framework: 'vanilla',
    syncDebounce: 150,
    csrfToken: '',
    updateUrl: '/accelade/update',
    batchUpdateUrl: '/accelade/batch-update',
    debug: false,
};

/**
 * ConfigFactory - Handles configuration parsing and merging
 */
export class ConfigFactory {
    private static globalConfig: FullAcceladeConfig | null = null;

    /**
     * Parse component configuration from an HTML element
     */
    static parseElement(element: HTMLElement): AcceladeComponentConfig {
        const id = element.dataset.acceladeId ?? `accelade-${Math.random().toString(36).slice(2, 10)}`;
        const stateStr = element.dataset.acceladeState ?? '{}';
        const stateJsStr = element.dataset.acceladeStateJs;

        let state: Record<string, unknown> = {};

        // First try to parse JSON state
        if (stateStr && stateStr !== '{}') {
            try {
                state = JSON.parse(stateStr) as Record<string, unknown>;
            } catch {
                console.error('Accelade: Invalid state JSON', stateStr);
            }
        }

        // If we have a JS object string (for JavaScript object notation like { count: 0 })
        if (stateJsStr) {
            try {
                // Use Function to evaluate JS object notation
                const evalFn = new Function(`return (${stateJsStr})`) as () => Record<string, unknown>;
                state = evalFn();
            } catch {
                console.error('Accelade: Invalid state JS object', stateJsStr);
            }
        }

        let props: Record<string, unknown> = {};
        try {
            props = JSON.parse(element.dataset.acceladeProps ?? '{}') as Record<string, unknown>;
        } catch {
            console.error('Accelade: Invalid props JSON', element.dataset.acceladeProps);
        }

        const syncStr = element.dataset.acceladeSync ?? '';
        const sync = syncStr ? syncStr.split(',').map(s => s.trim()).filter(Boolean) : [];

        // Parse storage attributes
        const rememberKey = element.dataset.acceladeRemember;
        const localStorageKey = element.dataset.acceladeLocalStorage;
        const storeName = element.dataset.acceladeStore;

        return { id, state, sync, props, rememberKey, localStorageKey, storeName };
    }

    /**
     * Get global configuration (from window.AcceladeConfig or defaults)
     */
    static getGlobalConfig(): FullAcceladeConfig {
        if (this.globalConfig) {
            return this.globalConfig;
        }

        const windowConfig = typeof window !== 'undefined' ? window.AcceladeConfig : undefined;
        this.globalConfig = { ...defaultConfig, ...windowConfig };

        return this.globalConfig;
    }

    /**
     * Set global configuration
     */
    static setGlobalConfig(config: Partial<AcceladeConfig>): void {
        this.globalConfig = { ...this.getGlobalConfig(), ...config };
    }

    /**
     * Merge configurations
     */
    static merge<T extends Record<string, unknown>>(base: T, override: Partial<T>): T {
        const result = { ...base };

        for (const key of Object.keys(override) as Array<keyof T>) {
            const value = override[key];
            if (value !== undefined) {
                if (this.isObject(value) && this.isObject(base[key])) {
                    result[key] = this.merge(
                        base[key] as Record<string, unknown>,
                        value as Record<string, unknown>
                    ) as T[keyof T];
                } else {
                    result[key] = value as T[keyof T];
                }
            }
        }

        return result;
    }

    /**
     * Check if value is a plain object
     */
    private static isObject(val: unknown): val is Record<string, unknown> {
        return val !== null && typeof val === 'object' && !Array.isArray(val);
    }

    /**
     * Get CSRF token
     */
    static getCsrfToken(): string {
        const config = this.getGlobalConfig();
        if (config.csrfToken) {
            return config.csrfToken;
        }

        // Try to get from meta tag
        if (typeof document !== 'undefined') {
            const meta = document.querySelector<HTMLMetaElement>('meta[name="csrf-token"]');
            if (meta) {
                return meta.content;
            }
        }

        return '';
    }

    /**
     * Get update URL
     */
    static getUpdateUrl(): string {
        return this.getGlobalConfig().updateUrl;
    }

    /**
     * Get batch update URL
     */
    static getBatchUpdateUrl(): string {
        return this.getGlobalConfig().batchUpdateUrl;
    }

    /**
     * Get sync debounce time
     */
    static getSyncDebounce(): number {
        return this.getGlobalConfig().syncDebounce;
    }

    /**
     * Reset configuration (useful for testing)
     */
    static reset(): void {
        this.globalConfig = null;
    }
}

export default ConfigFactory;
</file>

<file path="resources/js/react/accelade.tsx">
/**
 * Accelade React Integration
 * React-style state management with hooks
 */

import React, {
    useState,
    useEffect,
    useCallback,
    createContext,
    useContext,
    useMemo,
    useRef,
    type ReactNode,
    type Dispatch,
    type SetStateAction,
} from 'react';
import { createRoot, type Root } from 'react-dom/client';
import type { AcceladeComponentConfig, AcceladeActions } from '../core/types';
import { initRouter, navigate, getRouter, type NavigationOptions } from '../core/router';
import { getProgress, configureProgress, startProgress, doneProgress, type ProgressConfig } from '../core/progress';

// State type
type StateRecord = Record<string, unknown>;

// Custom methods type
type CustomMethods = Record<string, (...args: unknown[]) => unknown>;

// Hook result type
interface UseAcceladeResult<T extends StateRecord> {
    state: T;
    setState: Dispatch<SetStateAction<T>>;
    actions: AcceladeActions;
    customMethods: CustomMethods;
}

// Context type
const AcceladeContext = createContext<UseAcceladeResult<StateRecord> | null>(null);

/**
 * Parse Accelade element data attributes
 */
function parseAcceladeElement(el: HTMLElement): AcceladeComponentConfig {
    const id = el.dataset.acceladeId ?? `accelade-${Math.random().toString(36).slice(2, 10)}`;
    const stateStr = el.dataset.acceladeState ?? '{}';
    const syncStr = el.dataset.acceladeSync ?? '';

    let state: StateRecord = {};
    try {
        state = JSON.parse(stateStr) as StateRecord;
    } catch {
        console.error('Accelade React: Invalid state JSON', stateStr);
    }

    const sync = syncStr ? syncStr.split(',').filter(Boolean) : [];

    return { id, state, sync };
}

/**
 * Sync state to server
 */
function syncToServer(componentId: string, property: string, value: unknown): void {
    const config = window.AcceladeConfig;
    const url = config?.updateUrl ?? '/accelade/update';
    const csrfToken = config?.csrfToken ?? '';

    // Show progress bar during sync
    startProgress();

    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-TOKEN': csrfToken,
            'Accept': 'application/json'
        },
        body: JSON.stringify({
            component: componentId,
            property: property,
            value: value
        })
    })
    .then(() => {
        doneProgress();
    })
    .catch((err: unknown) => {
        console.error('Accelade React: Sync failed', err);
        doneProgress();
    });
}

/**
 * Options for useAccelade hook
 */
interface UseAcceladeOptions {
    componentId?: string;
    syncProperties?: string[];
    scripts?: string[];
}

/**
 * useAccelade hook - React-style state management
 */
export function useAccelade<T extends StateRecord>(
    initialState: T,
    options: UseAcceladeOptions = {}
): UseAcceladeResult<T> {
    const [state, setState] = useState<T>(initialState);
    const { componentId, syncProperties = [], scripts = [] } = options;
    const customMethodsRef = useRef<CustomMethods>({});

    // Sync effect
    useEffect(() => {
        if (componentId && syncProperties.length > 0) {
            syncProperties.forEach(prop => {
                syncToServer(componentId, prop, state[prop]);
            });
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, syncProperties.map(prop => state[prop]));

    // Actions
    const actions = useMemo<AcceladeActions>(() => ({
        increment: (key = 'count', amount = 1): void => {
            setState(prev => ({
                ...prev,
                [key]: (parseInt(String(prev[key]), 10) || 0) + amount
            }));
        },

        decrement: (key = 'count', amount = 1): void => {
            setState(prev => ({
                ...prev,
                [key]: (parseInt(String(prev[key]), 10) || 0) - amount
            }));
        },

        set: (key: string, value: unknown): void => {
            setState(prev => ({ ...prev, [key]: value }));
        },

        toggle: (key: string): void => {
            setState(prev => ({ ...prev, [key]: !prev[key] }));
        },

        reset: (key: string): void => {
            setState(prev => ({
                ...prev,
                [key]: typeof initialState[key] === 'number' ? 0 :
                       typeof initialState[key] === 'boolean' ? false : ''
            }));
        },

        get: (key: string): unknown => {
            return state[key];
        },

        // Aliases with $ prefix for template usage
        $set: (key: string, value: unknown): void => {
            setState(prev => ({ ...prev, [key]: value }));
        },

        $get: (key: string): unknown => {
            return state[key];
        },

        $toggle: (key: string): void => {
            setState(prev => ({ ...prev, [key]: !prev[key] }));
        }
    }), [initialState, state]);

    // Process scripts on mount
    useEffect(() => {
        scripts.forEach(code => {
            if (!code.trim()) return;

            try {
                const scriptFn = new Function(
                    'state',
                    'setState',
                    'actions',
                    '$set',
                    '$get',
                    '$toggle',
                    '$navigate',
                    'initialState',
                    code
                ) as (
                    state: T,
                    setState: Dispatch<SetStateAction<T>>,
                    actions: AcceladeActions,
                    $set: (key: string, value: unknown) => void,
                    $get: (key: string) => unknown,
                    $toggle: (key: string) => void,
                    $navigate: (url: string, options?: NavigationOptions) => Promise<boolean>,
                    initialState: T
                ) => CustomMethods | void;

                const $set = (key: string, value: unknown): void => {
                    setState(prev => ({ ...prev, [key]: value }));
                };
                const $get = (key: string): unknown => state[key];
                const $toggle = (key: string): void => {
                    setState(prev => ({ ...prev, [key]: !prev[key] }));
                };

                const result = scriptFn(
                    state,
                    setState,
                    actions,
                    $set,
                    $get,
                    $toggle,
                    navigate,
                    initialState
                );

                if (result && typeof result === 'object') {
                    Object.assign(customMethodsRef.current, result);
                }
            } catch (e) {
                console.error('Accelade React: Error executing script:', e);
            }
        });
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, []);

    return { state, setState, actions, customMethods: customMethodsRef.current };
}

/**
 * AcceladeProvider props
 */
interface AcceladeProviderProps<T extends StateRecord> {
    initialState: T;
    componentId?: string;
    syncProperties?: string[];
    children: ReactNode | ((accelade: UseAcceladeResult<T>) => ReactNode);
}

/**
 * AcceladeProvider - Context provider for Accelade state
 */
export function AcceladeProvider<T extends StateRecord>({
    initialState,
    componentId,
    syncProperties,
    children
}: AcceladeProviderProps<T>): React.ReactElement {
    const accelade = useAccelade(initialState, { componentId, syncProperties });

    return (
        <AcceladeContext.Provider value={accelade as UseAcceladeResult<StateRecord>}>
            {typeof children === 'function' ? children(accelade) : children}
        </AcceladeContext.Provider>
    );
}

/**
 * useAcceladeContext - Use Accelade from context
 */
export function useAcceladeContext<T extends StateRecord = StateRecord>(): UseAcceladeResult<T> {
    const context = useContext(AcceladeContext);
    if (!context) {
        throw new Error('useAcceladeContext must be used within AcceladeProvider');
    }
    return context as UseAcceladeResult<T>;
}

/**
 * Link component props
 */
interface AcceladeLinkProps {
    href: string;
    children: ReactNode;
    className?: string;
    activeClassName?: string;
    [key: string]: unknown;
}

/**
 * AcceladeLink - SPA navigation link component
 */
export function AcceladeLink({
    href,
    children,
    className = '',
    activeClassName = 'active',
    ...props
}: AcceladeLinkProps): React.ReactElement {
    const isActive = window.location.pathname === new URL(href, window.location.origin).pathname;

    const handleClick = (e: React.MouseEvent<HTMLAnchorElement>) => {
        e.preventDefault();
        void navigate(href);
    };

    return (
        <a
            href={href}
            className={`${className} ${isActive ? activeClassName : ''}`.trim()}
            onClick={handleClick}
            {...props}
        >
            {children}
        </a>
    );
}

/**
 * AcceladeComponent props
 */
interface AcceladeComponentProps {
    template: string;
    config: AcceladeComponentConfig;
    scripts: string[];
}

/**
 * Generic Accelade Component - Renders children with state
 */
function AcceladeComponent({ template, config, scripts }: AcceladeComponentProps): React.ReactElement {
    const { state, actions, customMethods } = useAccelade(config.state, {
        componentId: config.id,
        syncProperties: config.sync,
        scripts
    });
    const containerRef = useRef<HTMLDivElement>(null);

    // Update the data-accelade-state attribute so MutationObservers can detect changes
    // This is important for lazy loading conditional triggers
    useEffect(() => {
        const parentEl = containerRef.current?.closest('[data-accelade]');
        if (parentEl) {
            (parentEl as HTMLElement).dataset.acceladeState = JSON.stringify(state);
        }
    }, [state]);

    // Parse and render template with state bindings
    const renderTemplate = useCallback((): ReactNode[] => {
        const container = document.createElement('div');
        container.innerHTML = template;

        // Process the template and convert to React elements
        const processNode = (node: Node, key: number = 0): ReactNode => {
            if (node.nodeType === Node.TEXT_NODE) {
                // Replace {{ property }} with state values
                let text = node.textContent ?? '';
                Object.keys(state).forEach(stateKey => {
                    text = text.replace(
                        new RegExp(`\\{\\{\\s*${stateKey}\\s*\\}\\}`, 'g'),
                        String(state[stateKey])
                    );
                });
                return text;
            }

            if (node.nodeType !== Node.ELEMENT_NODE) return null;

            const element = node as HTMLElement;
            const props: Record<string, unknown> = { key };
            const tagName = element.tagName.toLowerCase();

            // Process attributes
            Array.from(element.attributes).forEach(attr => {
                let name = attr.name;
                const value = attr.value;

                // Handle state: bindings (React-style)
                if (name.startsWith('state:')) {
                    const bindType = name.slice(6);
                    if (bindType === 'text') {
                        // Will handle in children
                        return;
                    }
                    // state:disabled="isDisabled" -> disabled={state.isDisabled}
                    const stateValue = state[value];
                    if (stateValue !== undefined) {
                        if (bindType === 'class' || bindType === 'className') {
                            props.className = stateValue;
                        } else {
                            props[bindType] = stateValue;
                        }
                    }
                    return;
                }

                // Handle onClick actions
                if (name === 'onclick' || name === 'data-onclick') {
                    const actionStr = value;
                    props.onClick = (e: React.MouseEvent) => {
                        e.preventDefault();

                        // Check custom methods first
                        if (customMethods[actionStr]) {
                            (customMethods[actionStr] as (event: React.MouseEvent) => void)(e);
                            return;
                        }

                        if (actionStr.includes(':')) {
                            const [action, actionKey] = actionStr.split(':');

                            // Check custom methods
                            if (customMethods[action]) {
                                (customMethods[action] as (key: string, event: React.MouseEvent) => void)(actionKey, e);
                                return;
                            }

                            const actionMethod = actions[action as keyof AcceladeActions];
                            if (typeof actionMethod === 'function') {
                                (actionMethod as (key: string) => void)(actionKey);
                            }
                        } else {
                            const actionMethod = actions[actionStr as keyof AcceladeActions];
                            if (typeof actionMethod === 'function') {
                                (actionMethod as () => void)();
                            }
                        }
                    };
                    return;
                }

                // Convert to React-style props
                if (name === 'class') name = 'className';
                if (name === 'for') name = 'htmlFor';
                if (name === 'tabindex') name = 'tabIndex';
                if (name === 'readonly') name = 'readOnly';

                props[name] = value;
            });

            // Process children
            const children = Array.from(element.childNodes)
                .map((child, i) => processNode(child, i))
                .filter((child): child is ReactNode => child !== null);

            // Check for state:text binding
            const stateText = element.getAttribute('state:text');
            if (stateText && state[stateText] !== undefined) {
                return React.createElement(tagName, props, String(state[stateText]));
            }

            return React.createElement(tagName, props, ...children);
        };

        return Array.from(container.childNodes)
            .map((node, i) => processNode(node, i))
            .filter((node): node is ReactNode => node !== null);
    }, [template, state, actions, customMethods]);

    return <div ref={containerRef}>{renderTemplate()}</div>;
}

/**
 * Extended HTMLElement with initialization flag
 */
interface AcceladeHTMLElement extends HTMLElement {
    __accelade_react_initialized?: boolean;
    __accelade_react_root?: Root;
}

// Module-level initialization guard
let acceladeInitialized = false;

/**
 * Initialize Accelade React components
 */
export function init(): void {
    const elements = document.querySelectorAll<AcceladeHTMLElement>('[data-accelade]');

    elements.forEach((el) => {
        if (el.__accelade_react_initialized) return;

        const config = parseAcceladeElement(el);
        const template = el.innerHTML;

        // Extract scripts - look for state-script attribute, accelade-script tag, or accelade:script tag
        // Note: CSS selector needs escaped colon for accelade:script
        const scripts: string[] = [];
        const scriptElements = el.querySelectorAll<HTMLScriptElement>('script[state-script], accelade-script, accelade\\:script');
        scriptElements.forEach((scriptEl) => {
            const code = scriptEl.textContent ?? '';
            if (code.trim()) {
                scripts.push(code);
            }
            scriptEl.remove();
        });

        try {
            // Clear and create mount point
            el.innerHTML = '';
            const root = createRoot(el);

            // Render the component
            root.render(
                <AcceladeComponent template={template} config={config} scripts={scripts} />
            );

            // Remove cloak and add ready class for smooth reveal
            el.removeAttribute('data-accelade-cloak');
            el.classList.add('accelade-ready');

            el.__accelade_react_initialized = true;
            el.__accelade_react_root = root;
        } catch (e) {
            console.error('Accelade React: Failed to init component', config.id, e);
        }
    });

    // Initialize the router only once
    if (!acceladeInitialized) {
        initRouter();
        acceladeInitialized = true;
    }
}

// Export types
export type {
    UseAcceladeResult,
    UseAcceladeOptions,
    AcceladeProviderProps,
    AcceladeLinkProps,
    AcceladeComponentProps,
};

// Progress API object
const progress = {
    configure: configureProgress,
    start: startProgress,
    done: doneProgress,
    instance: getProgress,
};

// Export for window
if (typeof window !== 'undefined') {
    // Configure progress from AcceladeConfig if available
    const progressConfig = window.AcceladeConfig?.progress;
    if (progressConfig && Object.keys(progressConfig).length > 0) {
        configureProgress(progressConfig as ProgressConfig);
    }

    // Auto-init on DOMContentLoaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => init());
    } else {
        init();
    }
}

// Export everything including progress
export { navigate, getRouter, initRouter, configureProgress, startProgress, doneProgress, progress };
export default { init, navigate, getRouter, initRouter, useAccelade, AcceladeProvider, AcceladeLink, AcceladeComponent, configureProgress, startProgress, doneProgress, progress };
</file>

<file path="resources/views/components/counter.blade.php">
@props([
    'initialCount' => 0,
    'sync' => '',
    'step' => 1,
    'framework' => null,
])

@php
    // Use prop if provided, otherwise try service, fallback to config
    $framework = $framework ?? app('accelade')->getFramework();
@endphp

@accelade(['count' => (int) $initialCount, 'step' => (int) $step], $sync ? $sync : null)
    @if($framework === 'vue')
        {{-- Vue.js: Uses native Vue directives --}}
        <div class="accelade-counter p-6 rounded-xl shadow-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <div class="flex items-center justify-center gap-6">
                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-red-500 text-white text-xl font-bold rounded-full hover:bg-red-600 transition shadow-md hover:shadow-lg"
                    @click="decrement('count')"
                >
                    -
                </button>

                <span
                    class="text-4xl font-bold min-w-[80px] text-center"
                    style="color: var(--docs-text);"
                    v-text="count"
                >
                    {{ $initialCount }}
                </span>

                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-green-500 text-white text-xl font-bold rounded-full hover:bg-green-600 transition shadow-md hover:shadow-lg"
                    @click="increment('count')"
                >
                    +
                </button>
            </div>

            <div class="mt-4 text-center text-sm" style="color: var(--docs-text-muted);">
                <span v-show="count > 0" class="text-green-500 font-medium">Positive value</span>
                <span v-show="count < 0" class="text-red-500 font-medium">Negative value</span>
                <span v-show="count === 0" style="color: var(--docs-text-muted);">Zero</span>
            </div>
        </div>

    @elseif($framework === 'react')
        {{-- React: Uses data-state-* bindings (CSS selector safe) --}}
        <div class="accelade-counter p-6 rounded-xl shadow-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <div class="flex items-center justify-center gap-6">
                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-red-500 text-white text-xl font-bold rounded-full hover:bg-red-600 transition shadow-md hover:shadow-lg"
                    @click="decrement('count')"
                >
                    -
                </button>

                <span
                    class="text-4xl font-bold min-w-[80px] text-center"
                    style="color: var(--docs-text);"
                    data-state-text="count"
                >
                    {{ $initialCount }}
                </span>

                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-green-500 text-white text-xl font-bold rounded-full hover:bg-green-600 transition shadow-md hover:shadow-lg"
                    @click="increment('count')"
                >
                    +
                </button>
            </div>

            <div class="mt-4 text-center text-sm" style="color: var(--docs-text-muted);">
                Count value: <span data-state-text="count">{{ $initialCount }}</span>
            </div>
        </div>

    @elseif($framework === 'svelte')
        {{-- Svelte: Uses s-* bindings --}}
        <div class="accelade-counter p-6 rounded-xl shadow-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <div class="flex items-center justify-center gap-6">
                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-red-500 text-white text-xl font-bold rounded-full hover:bg-red-600 transition shadow-md hover:shadow-lg"
                    @click="decrement('count')"
                >
                    -
                </button>

                <span
                    class="text-4xl font-bold min-w-[80px] text-center"
                    style="color: var(--docs-text);"
                    s-text="count"
                >
                    {{ $initialCount }}
                </span>

                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-green-500 text-white text-xl font-bold rounded-full hover:bg-green-600 transition shadow-md hover:shadow-lg"
                    @click="increment('count')"
                >
                    +
                </button>
            </div>

            <div class="mt-4 text-center text-sm" style="color: var(--docs-text-muted);">
                <span s-show="count > 0" class="text-green-500 font-medium">Positive value</span>
                <span s-show="count < 0" class="text-red-500 font-medium">Negative value</span>
                <span s-show="count === 0" style="color: var(--docs-text-muted);">Zero</span>
            </div>
        </div>

    @elseif($framework === 'angular')
        {{-- Angular: Uses ng-* bindings --}}
        <div class="accelade-counter p-6 rounded-xl shadow-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <div class="flex items-center justify-center gap-6">
                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-red-500 text-white text-xl font-bold rounded-full hover:bg-red-600 transition shadow-md hover:shadow-lg"
                    @click="decrement('count')"
                >
                    -
                </button>

                <span
                    class="text-4xl font-bold min-w-[80px] text-center"
                    style="color: var(--docs-text);"
                    ng-text="count"
                >
                    {{ $initialCount }}
                </span>

                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-green-500 text-white text-xl font-bold rounded-full hover:bg-green-600 transition shadow-md hover:shadow-lg"
                    @click="increment('count')"
                >
                    +
                </button>
            </div>

            <div class="mt-4 text-center text-sm" style="color: var(--docs-text-muted);">
                <span ng-show="count > 0" class="text-green-500 font-medium">Positive value</span>
                <span ng-show="count < 0" class="text-red-500 font-medium">Negative value</span>
                <span ng-show="count === 0" style="color: var(--docs-text-muted);">Zero</span>
            </div>
        </div>

    @else
        {{-- Vanilla JS: Uses a- prefix directives --}}
        <div class="accelade-counter p-6 rounded-xl shadow-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <div class="flex items-center justify-center gap-6">
                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-red-500 text-white text-xl font-bold rounded-full hover:bg-red-600 transition shadow-md hover:shadow-lg"
                    @click="decrement('count')"
                >
                    -
                </button>

                <span
                    class="text-4xl font-bold min-w-[80px] text-center"
                    style="color: var(--docs-text);"
                    a-text="count"
                >
                    {{ $initialCount }}
                </span>

                <button
                    type="button"
                    class="w-12 h-12 flex items-center justify-center bg-green-500 text-white text-xl font-bold rounded-full hover:bg-green-600 transition shadow-md hover:shadow-lg"
                    @click="increment('count')"
                >
                    +
                </button>
            </div>

            <div class="mt-4 text-center text-sm" style="color: var(--docs-text-muted);">
                <span a-show="count > 0" class="font-medium text-green-500">Positive value</span>
                <span a-show="count < 0" class="font-medium text-red-500">Negative value</span>
                <span a-show="count === 0" style="color: var(--docs-text-muted);">Zero</span>
            </div>
        </div>
    @endif
@endaccelade
</file>

<file path="resources/views/components/link.blade.php">
@props([
    'href',
    'method' => 'GET',
    'data' => null,
    'headers' => null,
    'spa' => true,
    'away' => false,
    'activeClass' => 'active',
    'prefetch' => false,
    'preserveScroll' => false,
    'preserveState' => false,
    'replace' => false,
    'confirm' => null,
    'confirmText' => null,
    'confirmTitle' => null,
    'confirmButton' => null,
    'cancelButton' => null,
    'confirmDanger' => false,
    'modal' => false,
    'slideover' => false,
    'bottomSheet' => false,
    'modalMaxWidth' => null,
    'modalPosition' => null,
    'slideoverPosition' => null,
])

@php
    $framework = config('accelade.framework', 'vanilla');
    $isActive = request()->is(ltrim($href, '/')) || request()->url() === url($href);
    $classes = $attributes->get('class', '');
    if ($isActive) {
        $classes .= ' ' . $activeClass;
    }

    // Determine if confirmation is needed
    $hasConfirm = $confirm !== null || $confirmText !== null;

    // Prepare data and headers as JSON if provided
    $dataJson = $data ? json_encode($data) : null;
    $headersJson = $headers ? json_encode($headers) : null;

    // Determine confirmation text
    $finalConfirmText = $confirmText ?? ($confirm === true ? 'Are you sure you want to continue?' : $confirm);
@endphp

@if($modal || $slideover || $bottomSheet)
    <a
        href="{{ $href }}"
        {{ $attributes->merge(['class' => trim($classes)]) }}
        @if($modal) data-modal @endif
        @if($slideover) data-slideover @endif
        @if($bottomSheet) data-bottom-sheet @endif
        @if($modalMaxWidth) data-modal-max-width="{{ $modalMaxWidth }}" @endif
        @if($modalPosition) data-modal-position="{{ $modalPosition }}" @endif
        @if($slideoverPosition) data-slideover-position="{{ $slideoverPosition }}" @endif
    >{{ $slot }}</a>
@elseif($spa && !$away)
    <a
        href="{{ $href }}"
        @if($framework === 'vanilla') a-link @elseif($framework === 'vue') data-accelade-link @else data-spa-link @endif
        {{ $attributes->merge(['class' => trim($classes)]) }}
        @if($method !== 'GET') data-method="{{ strtoupper($method) }}" @endif
        @if($dataJson) data-data="{{ $dataJson }}" @endif
        @if($headersJson) data-headers="{{ $headersJson }}" @endif
        @if($prefetch) data-prefetch @endif
        @if($preserveScroll) data-preserve-scroll @endif
        @if($preserveState) data-preserve-state @endif
        @if($replace) data-replace @endif
        @if($hasConfirm) data-confirm="{{ $finalConfirmText }}" @endif
        @if($confirmTitle) data-confirm-title="{{ $confirmTitle }}" @endif
        @if($confirmButton) data-confirm-button="{{ $confirmButton }}" @endif
        @if($cancelButton) data-cancel-button="{{ $cancelButton }}" @endif
        @if($confirmDanger) data-confirm-danger @endif
    >{{ $slot }}</a>
@elseif($away)
    <a
        href="{{ $href }}"
        @if($framework === 'vanilla') a-link @elseif($framework === 'vue') data-accelade-link @else data-spa-link @endif
        {{ $attributes->merge(['class' => trim($classes)]) }}
        data-away
        @if($hasConfirm) data-confirm="{{ $finalConfirmText }}" @endif
        @if($confirmTitle) data-confirm-title="{{ $confirmTitle }}" @endif
        @if($confirmButton) data-confirm-button="{{ $confirmButton }}" @endif
        @if($cancelButton) data-cancel-button="{{ $cancelButton }}" @endif
        @if($confirmDanger) data-confirm-danger @endif
    >{{ $slot }}</a>
@else
    <a
        href="{{ $href }}"
        {{ $attributes->merge(['class' => trim($classes)]) }}
    >{{ $slot }}</a>
@endif
</file>

<file path="resources/views/demo/partials/_content.blade.php">
{{-- Content Component Section - Framework Agnostic --}}

<!-- Demo: Content Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-emerald-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Content Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Render pre-rendered HTML (like Markdown) using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::content&gt;</code>.
    </p>

    @php
        // Simulated pre-rendered Markdown content
        $markdownHtml = '<h3 style="color: var(--docs-text); margin-bottom: 0.5rem;">Welcome to Accelade</h3>
<p style="color: var(--docs-text-muted); margin-bottom: 0.5rem;">This is <strong style="color: var(--docs-text);">pre-rendered HTML</strong> content, perfect for:</p>
<ul style="color: var(--docs-text-muted); padding-left: 1.5rem; list-style: disc;">
<li>Markdown converted to HTML</li>
<li>Rich text from a CMS</li>
<li>Syntax-highlighted code</li>
</ul>
<blockquote style="border-left: 3px solid var(--docs-border); padding-left: 1rem; margin-top: 1rem;">
<p style="color: var(--docs-text-muted); font-style: italic;">The content is rendered without any interpolation, making it safe for static content.</p>
</blockquote>';

        $codeHtml = '<pre class="bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto"><code class="language-php">// Example PHP code
&lt;?php

namespace App\\Http\\Controllers;

class PostController extends Controller
{
    public function show(Post $post)
    {
        return view(\'posts.show\', [
            \'content\' => Str::markdown($post->body),
        ]);
    }
}</code></pre>';

        $quoteHtml = '<p class="text-lg italic" style="color: var(--docs-text);">"The best way to predict the future is to invent it."</p><footer class="text-sm mt-2" style="color: var(--docs-text-muted);">— Alan Kay</footer>';
    @endphp

    <div class="space-y-4 mb-4">
        <!-- Markdown Content -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">Markdown</span>
                Article Content
            </h4>
            <div class="rounded-lg p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                <x-accelade::content
                    as="article"
                    class="max-w-none"
                    :html="$markdownHtml"
                    data-testid="content-markdown"
                />
            </div>
        </div>

        <!-- Code Block -->
        <div class="rounded-xl p-4 border border-blue-500/30" style="background: rgba(59, 130, 246, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-500 rounded">Code</span>
                Syntax Highlighted
            </h4>
            <x-accelade::content
                as="div"
                class="text-sm"
                :html="$codeHtml"
                data-testid="content-code"
            />
        </div>

        <!-- Quote Block -->
        <div class="rounded-xl p-4 border border-teal-500/30" style="background: rgba(20, 184, 166, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Blockquote with Custom Wrapper</h4>
            <x-accelade::content
                as="blockquote"
                class="border-l-4 border-emerald-500 pl-4"
                :html="$quoteHtml"
                data-testid="content-quote"
            />
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="content.blade.php">
&lt;!-- Basic usage --&gt;
&lt;x-accelade::content :html="$renderedMarkdown" /&gt;

&lt;!-- With custom wrapper and styling --&gt;
&lt;x-accelade::content
    as="article"
    class="prose dark:prose-invert"
    :html="$html"
/&gt;

&lt;!-- Blockquote wrapper --&gt;
&lt;x-accelade::content
    as="blockquote"
    class="border-l-4 pl-4"
    :html="$quote"
/&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_data-component.blade.php">
{{-- Data Component Section - Framework Agnostic --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $modelAttr = match($prefix) {
        'v' => 'v-model',
        'data-state' => 'data-state-model',
        's' => 's-model',
        'ng' => 'ng-model',
        default => 'a-model',
    };
@endphp

<!-- Demo: Data Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-cyan-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Data Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Reactive data containers with storage persistence using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::data&gt;</code>.
    </p>

    <div class="grid md:grid-cols-2 gap-4 mb-4">
        <!-- Basic Counter -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-cyan-500/20 text-cyan-500 rounded">Basic</span>
                Counter with Data
            </h4>
            <x-accelade::data :default="['count' => 0]">
                <div class="flex items-center gap-4">
                    <button
                        @click="$set('count', count - 1)"
                        class="w-10 h-10 flex items-center justify-center bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors"
                    >
                        -
                    </button>
                    <span class="text-2xl font-bold min-w-[3rem] text-center" style="color: var(--docs-text);" {{ $textAttr }}="count">0</span>
                    <button
                        @click="$set('count', count + 1)"
                        class="w-10 h-10 flex items-center justify-center bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors"
                    >
                        +
                    </button>
                </div>
            </x-accelade::data>
        </div>

        <!-- Session Storage (Remember) -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Session</span>
                Remember State
            </h4>
            <x-accelade::data :default="['visits' => 0]" remember="demo-visits">
                <div class="text-center">
                    <p class="mb-2" style="color: var(--docs-text-muted);">Page visits this session:</p>
                    <span class="text-3xl font-bold text-amber-500" {{ $textAttr }}="visits">0</span>
                    <button
                        @click="$set('visits', visits + 1)"
                        class="block mx-auto mt-4 px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors"
                    >
                        Increment Visit
                    </button>
                    <p class="text-xs mt-2" style="color: var(--docs-text-muted);">Refresh the page - count persists!</p>
                </div>
            </x-accelade::data>
        </div>
    </div>

    <div class="grid md:grid-cols-2 gap-4 mb-4">
        <!-- Local Storage -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">localStorage</span>
                Persistent Preferences
            </h4>
            <x-accelade::data :default="['theme' => 'light', 'fontSize' => 16]" local-storage="demo-preferences">
                <div class="space-y-4">
                    <div>
                        <label class="text-sm block mb-1" style="color: var(--docs-text-muted);">Theme</label>
                        <select
                            {{ $modelAttr }}="theme"
                            class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                        >
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="system">System</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-sm block mb-1" style="color: var(--docs-text-muted);">Font Size: <span {{ $textAttr }}="fontSize">16</span>px</label>
                        <input
                            type="range"
                            {{ $modelAttr }}="fontSize"
                            min="12"
                            max="24"
                            class="w-full"
                        >
                    </div>
                    <p class="text-xs" style="color: var(--docs-text-muted);">Close browser & reopen - settings persist!</p>
                </div>
            </x-accelade::data>
        </div>

        <!-- Global Store -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Store</span>
                Global Shared State
            </h4>
            <div class="space-y-3">
                <!-- First component using the store -->
                <x-accelade::data :default="['cartCount' => 0]" store="demoCart">
                    <div class="p-3 rounded-lg border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
                        <p class="text-sm text-purple-500">Component A - Cart: <span class="font-bold" {{ $textAttr }}="cartCount">0</span> items</p>
                        <button
                            @click="$set('cartCount', cartCount + 1)"
                            class="mt-2 px-3 py-1 text-sm bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors"
                        >
                            Add Item (A)
                        </button>
                    </div>
                </x-accelade::data>

                <!-- Second component using the same store -->
                <x-accelade::data :default="['cartCount' => 0]" store="demoCart">
                    <div class="p-3 rounded-lg border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
                        <p class="text-sm text-purple-500">Component B - Cart: <span class="font-bold" {{ $textAttr }}="cartCount">0</span> items</p>
                        <button
                            @click="$set('cartCount', cartCount + 1)"
                            class="mt-2 px-3 py-1 text-sm bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors"
                        >
                            Add Item (B)
                        </button>
                    </div>
                </x-accelade::data>
                <p class="text-xs" style="color: var(--docs-text-muted);">Both components share the same state!</p>
            </div>
        </div>
    </div>

    <!-- Form with Remember -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-3" style="color: var(--docs-text);">Multi-Step Form with Session Persistence</h4>
        <x-accelade::data :default="['step' => 1, 'name' => '', 'email' => '']" remember="demo-form">
            <div {{ $showAttr }}="step === 1" class="space-y-4">
                <div>
                    <label class="text-sm block mb-1" style="color: var(--docs-text-muted);">Step 1: Your Name</label>
                    <input
                        type="text"
                        {{ $modelAttr }}="name"
                        placeholder="Enter your name"
                        class="w-full px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                </div>
                <button
                    @click="$set('step', 2)"
                    class="px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors"
                >
                    Next Step
                </button>
            </div>
            <div {{ $showAttr }}="step === 2" class="space-y-4">
                <div>
                    <label class="text-sm block mb-1" style="color: var(--docs-text-muted);">Step 2: Your Email</label>
                    <input
                        type="email"
                        {{ $modelAttr }}="email"
                        placeholder="Enter your email"
                        class="w-full px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-[var(--docs-border)]"
                        style="background: var(--docs-bg-alt); color: var(--docs-text);"
                    >
                </div>
                <div class="flex gap-2">
                    <button
                        @click="$set('step', 1)"
                        class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
                    >
                        Back
                    </button>
                    <button
                        @click="$set('step', 3)"
                        class="px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors"
                    >
                        Review
                    </button>
                </div>
            </div>
            <div {{ $showAttr }}="step === 3" class="space-y-4">
                <div class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
                    <h5 class="font-medium mb-2" style="color: var(--docs-text);">Review Your Info</h5>
                    <p style="color: var(--docs-text-muted);">Name: <span class="font-medium" style="color: var(--docs-text);" {{ $textAttr }}="name"></span></p>
                    <p style="color: var(--docs-text-muted);">Email: <span class="font-medium" style="color: var(--docs-text);" {{ $textAttr }}="email"></span></p>
                </div>
                <div class="flex gap-2">
                    <button
                        @click="$set('step', 2)"
                        class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
                    >
                        Back
                    </button>
                    <button
                        @click="$set('step', 1); $set('name', ''); $set('email', '')"
                        class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors"
                    >
                        Submit & Reset
                    </button>
                </div>
            </div>
            <p class="text-xs mt-4" style="color: var(--docs-text-muted);">Navigate away and return - your progress is saved!</p>
        </x-accelade::data>
    </div>

    <x-accelade::code-block language="blade" filename="data.blade.php">
&lt;!-- Basic data container --&gt;
&lt;x-accelade::data :default="['count' => 0]"&gt;
    &lt;button @click="$set('count', count + 1)"&gt;
        Count: &lt;span {{ $textAttr }}="count"&gt;0&lt;/span&gt;
    &lt;/button&gt;
&lt;/x-accelade::data&gt;

&lt;!-- With session storage persistence --&gt;
&lt;x-accelade::data :default="['step' => 1]" remember="wizard-form"&gt;
    &lt;!-- Form content --&gt;
&lt;/x-accelade::data&gt;

&lt;!-- With localStorage persistence --&gt;
&lt;x-accelade::data :default="['theme' => 'light']" local-storage="user-prefs"&gt;
    &lt;!-- Settings content --&gt;
&lt;/x-accelade::data&gt;

&lt;!-- With global store (shared state) --&gt;
&lt;x-accelade::data :default="['count' => 0]" store="cart"&gt;
    &lt;!-- Cart content --&gt;
&lt;/x-accelade::data&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_defer-component.blade.php">
{{-- Defer Component Section - Framework Agnostic --}}
@props(['prefix' => 'a'])

@php
    // Determine framework-specific attributes
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };
@endphp

<!-- Demo: Defer Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Defer Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Asynchronous data loading with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::defer&gt;</code>.
        Exposes <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">processing</code>, <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">response</code>, and <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">reload()</code>.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Basic Defer -->
        <div class="rounded-xl p-4 border border-indigo-500/30" style="background: rgba(99, 102, 241, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-indigo-500/20 text-indigo-500 rounded">Basic</span>
                Auto-fetch on Load
            </h4>
            <x-accelade::defer url="https://dummyjson.com/quotes/random">
                <div class="space-y-3">
                    <div {{ $showAttr }}="processing" class="flex items-center gap-2 text-indigo-500">
                        <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Loading quote...</span>
                    </div>
                    <div {{ $showAttr }}="response">
                        <blockquote class="italic border-l-4 border-indigo-500/50 pl-4" style="color: var(--docs-text-muted);">
                            "<span {{ $textAttr }}="response.quote"></span>"
                        </blockquote>
                        <p class="text-sm mt-2" style="color: var(--docs-text-muted);">— <span {{ $textAttr }}="response.author"></span></p>
                    </div>
                    <button
                        @click="reload()"
                        class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-sm"
                    >
                        Get New Quote
                    </button>
                </div>
            </x-accelade::defer>
        </div>

        <!-- Manual Mode -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Manual</span>
                Load on Demand
            </h4>
            <x-accelade::defer url="https://dummyjson.com/users/1" :manual="true">
                <div class="space-y-3">
                    <div {{ $showAttr }}="!response && !processing">
                        <p class="text-sm mb-3" style="color: var(--docs-text-muted);">Data not loaded yet. Click to fetch.</p>
                    </div>
                    <div {{ $showAttr }}="processing" class="flex items-center gap-2 text-amber-500">
                        <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Fetching user...</span>
                    </div>
                    <div {{ $showAttr }}="response" class="p-3 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="font-medium" style="color: var(--docs-text);"><span {{ $textAttr }}="response.firstName"></span> <span {{ $textAttr }}="response.lastName"></span></p>
                        <p class="text-sm" style="color: var(--docs-text-muted);"><span {{ $textAttr }}="response.email"></span></p>
                        <p class="text-sm" style="color: var(--docs-text-muted);"><span {{ $textAttr }}="response.phone"></span></p>
                    </div>
                    <button
                        @click="reload()"
                        class="px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors text-sm"
                    >
                        Load / Refresh
                    </button>
                </div>
            </x-accelade::defer>
        </div>

        <!-- Polling -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">Polling</span>
                Auto-refresh Every 5s
            </h4>
            <x-accelade::defer url="https://worldtimeapi.org/api/timezone/UTC" poll="5000">
                <div class="space-y-3">
                    <div {{ $showAttr }}="processing && !response" class="flex items-center gap-2 text-emerald-500">
                        <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Loading time...</span>
                    </div>
                    <div {{ $showAttr }}="response" class="text-center">
                        <p class="text-xs uppercase tracking-wide" style="color: var(--docs-text-muted);">UTC Time</p>
                        <p class="text-2xl font-mono font-bold text-emerald-500" {{ $textAttr }}="response.datetime"></p>
                        <p class="text-xs mt-2" style="color: var(--docs-text-muted);">
                            <span {{ $showAttr }}="processing" class="inline-flex items-center gap-1">
                                <svg class="animate-spin h-3 w-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                Refreshing...
                            </span>
                            <span {{ $showAttr }}="!processing">Auto-updates every 5 seconds</span>
                        </p>
                    </div>
                </div>
            </x-accelade::defer>
        </div>

        <!-- Error Handling -->
        <div class="rounded-xl p-4 border border-red-500/30" style="background: rgba(239, 68, 68, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-red-500/20 text-red-500 rounded">Error</span>
                Error Handling
            </h4>
            <x-accelade::defer url="https://httpstat.us/500" :manual="true">
                <div class="space-y-3">
                    <div {{ $showAttr }}="!error && !response && !processing">
                        <p class="text-sm" style="color: var(--docs-text-muted);">Click to simulate an API error (500).</p>
                    </div>
                    <div {{ $showAttr }}="processing" class="flex items-center gap-2" style="color: var(--docs-text-muted);">
                        <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Loading...</span>
                    </div>
                    <div {{ $showAttr }}="error" class="p-3 bg-red-500/20 rounded-lg border border-red-500/30">
                        <p class="text-red-500 font-medium">Error occurred!</p>
                        <p class="text-sm text-red-400" {{ $textAttr }}="error"></p>
                    </div>
                    <button
                        @click="reload()"
                        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                    >
                        Trigger Error
                    </button>
                </div>
            </x-accelade::defer>
        </div>
    </div>

    <!-- Product List Example -->
    <div class="rounded-xl p-4 border border-purple-500/30 mb-4" style="background: rgba(168, 85, 247, 0.1);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Product List from API</h4>
        <x-accelade::defer url="https://dummyjson.com/products?limit=4">
            <div {{ $showAttr }}="processing && !response" class="flex justify-center py-8">
                <svg class="animate-spin h-8 w-8 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            <div {{ $showAttr }}="response">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <template a-for="product in response.products">
                        <div class="rounded-lg p-3 border border-[var(--docs-border)] shadow-sm" style="background: var(--docs-bg);">
                            <p class="font-medium text-sm truncate" style="color: var(--docs-text);" {{ $textAttr }}="product.title"></p>
                            <p class="text-purple-500 font-bold">$<span {{ $textAttr }}="product.price"></span></p>
                            <p class="text-xs" style="color: var(--docs-text-muted);" {{ $textAttr }}="product.category"></p>
                        </div>
                    </template>
                </div>
                <div class="flex items-center justify-between">
                    <p class="text-sm" style="color: var(--docs-text-muted);">Showing <span {{ $textAttr }}="response.products.length"></span> of <span {{ $textAttr }}="response.total"></span> products</p>
                    <button
                        @click="reload()"
                        class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm"
                    >
                        Refresh
                    </button>
                </div>
            </div>
        </x-accelade::defer>
    </div>

    <x-accelade::code-block language="blade" filename="defer.blade.php">
&lt;!-- Basic defer - auto-fetches on load --&gt;
&lt;x-accelade::defer url="/api/quote"&gt;
    &lt;p {{ $showAttr }}="processing"&gt;Loading...&lt;/p&gt;
    &lt;p {{ $textAttr }}="response.quote"&gt;&lt;/p&gt;
    &lt;button @click="reload()"&gt;Refresh&lt;/button&gt;
&lt;/x-accelade::defer&gt;

&lt;!-- Manual mode - load on demand --&gt;
&lt;x-accelade::defer url="/api/data" :manual="true"&gt;
    &lt;button @click="reload()"&gt;Load Data&lt;/button&gt;
&lt;/x-accelade::defer&gt;

&lt;!-- Polling - auto-refresh every 5 seconds --&gt;
&lt;x-accelade::defer url="/api/stats" poll="5000"&gt;
    &lt;span {{ $textAttr }}="response.count"&gt;&lt;/span&gt;
&lt;/x-accelade::defer&gt;

&lt;!-- POST with request data --&gt;
&lt;x-accelade::defer url="/api/search" method="POST" :request="['q' =&gt; '']"&gt;
    &lt;div {{ $textAttr }}="response.results"&gt;&lt;/div&gt;
&lt;/x-accelade::defer&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_lazy-loading.blade.php">
{{-- Lazy Loading Section - Framework Specific --}}
@php
    $prefix = $prefix ?? 'a';
    $textAttr = $prefix . '-text';
    $showAttr = $prefix . '-show';

    // Determine click attribute based on framework
    $clickAttr = match($prefix) {
        'v' => 'v-on:click',
        'data-state' => 'data-on-click',
        's' => 's-on-click',
        'ng' => 'ng-on-click',
        default => '@click',
    };
@endphp

<!-- Demo: Lazy Loading -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-cyan-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Lazy Loading</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Defer content rendering with beautiful shimmer placeholders using <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::lazy&gt;</code>.
    </p>

    <!-- Shimmer Variants -->
    <div class="grid md:grid-cols-3 gap-4 mb-4">
        <!-- Basic Shimmer -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 text-sm" style="color: var(--docs-text);">3 Lines (Default)</h4>
            <x-accelade::lazy :shimmer="true" :delay="1500">
                <div class="space-y-2" data-testid="lazy-shimmer-default">
                    <p class="text-sm" style="color: var(--docs-text);">First line loaded</p>
                    <p class="text-sm" style="color: var(--docs-text);">Second line loaded</p>
                    <p class="text-xs" style="color: var(--docs-text-muted);">Third line</p>
                </div>
            </x-accelade::lazy>
        </div>

        <!-- Circle Shimmer -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)] text-center" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 text-sm" style="color: var(--docs-text);">Circle (Avatar)</h4>
            <div class="flex justify-center">
                <x-accelade::lazy :shimmer="true" :shimmer-circle="true" :delay="1800">
                    <img src="https://ui-avatars.com/api/?name=Demo+User&background=6366f1&color=fff" alt="Avatar" class="w-12 h-12 rounded-full" data-testid="lazy-avatar" />
                </x-accelade::lazy>
            </div>
        </div>

        <!-- Rounded Shimmer -->
        <div class="rounded-xl p-4 border border-[var(--docs-border)]" style="background: var(--docs-bg);">
            <h4 class="font-medium mb-3 text-sm" style="color: var(--docs-text);">Rounded Card</h4>
            <x-accelade::lazy :shimmer="true" :shimmer-rounded="true" shimmer-height="80px" :delay="2000">
                <div class="bg-gradient-to-r from-cyan-500 to-blue-500 text-white p-4 rounded-lg text-sm text-center" data-testid="lazy-rounded">
                    Content loaded!
                </div>
            </x-accelade::lazy>
        </div>
    </div>

    <!-- Conditional Loading -->
    <div class="rounded-xl p-4 border border-cyan-500/30 mb-4" style="background: rgba(6, 182, 212, 0.1);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Conditional Loading</h4>
        @accelade(['showContent' => false])
            <div class="flex items-center justify-between mb-4">
                <span class="text-sm" style="color: var(--docs-text-muted);">Click to load content on demand</span>
                <button {{ $clickAttr }}="$toggle('showContent')" class="px-4 py-2 bg-cyan-600 text-white rounded-lg text-sm font-medium hover:bg-cyan-700 transition" data-testid="toggle-lazy">
                    <span {{ $showAttr }}="!showContent">Show Content</span>
                    <span {{ $showAttr }}="showContent">Hide Content</span>
                </button>
            </div>

            <x-accelade::lazy show="showContent" :shimmer="true" :shimmer-lines="4">
                <div class="space-y-2" data-testid="lazy-conditional">
                    <div class="p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-500 text-sm">Your order has been shipped!</div>
                    <div class="p-3 bg-blue-500/20 border border-blue-500/30 rounded-lg text-blue-500 text-sm">New feature: Dark mode available</div>
                    <div class="p-3 bg-amber-500/20 border border-amber-500/30 rounded-lg text-amber-500 text-sm">Password expires in 7 days</div>
                </div>
            </x-accelade::lazy>
        @endaccelade
    </div>

    <!-- Custom Placeholder -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Custom Placeholder</h4>
        <x-accelade::lazy :delay="2500">
            <x-slot:placeholder>
                <div class="flex items-center gap-4 animate-pulse">
                    <div class="w-12 h-12 rounded-full" style="background: var(--docs-border);"></div>
                    <div class="flex-1 space-y-2">
                        <div class="h-4 rounded w-1/3" style="background: var(--docs-border);"></div>
                        <div class="h-3 rounded w-1/4" style="background: var(--docs-border);"></div>
                    </div>
                </div>
            </x-slot:placeholder>

            <div class="flex items-center gap-4" data-testid="lazy-custom">
                <img src="https://ui-avatars.com/api/?name=Jane+Smith&background=8b5cf6&color=fff" alt="Jane Smith" class="w-12 h-12 rounded-full" />
                <div>
                    <h4 class="font-semibold" style="color: var(--docs-text);">Jane Smith</h4>
                    <p class="text-sm" style="color: var(--docs-text-muted);">Product Designer</p>
                </div>
            </div>
        </x-accelade::lazy>
    </div>

    <x-accelade::code-block language="blade" filename="lazy.blade.php">
&lt;!-- Basic shimmer --&gt;
&lt;x-accelade::lazy :shimmer="true"&gt;
    Content here
&lt;/x-accelade::lazy&gt;

&lt;!-- Circle shimmer --&gt;
&lt;x-accelade::lazy :shimmer="true" :shimmer-circle="true"&gt;
    &lt;img src="..." class="rounded-full" /&gt;
&lt;/x-accelade::lazy&gt;

&lt;!-- Conditional loading --&gt;
&lt;x-accelade::lazy show="showContent" :shimmer="true"&gt;
    Content loads when showContent is true
&lt;/x-accelade::lazy&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="resources/views/demo/partials/_shared-data.blade.php">
{{-- Shared Data Section - Framework Specific --}}
@php
    $prefix = $prefix ?? 'a';
    $textAttr = $prefix . '-text';
    $showAttr = $prefix . '-show';

    // Determine click attribute based on framework
    $clickAttr = match($prefix) {
        'v' => 'v-on:click',
        'data-state' => 'data-on-click',
        's' => 's-on-click',
        'ng' => 'ng-on-click',
        default => '@click',
    };
@endphp

<!-- Demo: Shared Data -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-violet-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Shared Data</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Share data from PHP backend to JavaScript frontend. Access via <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">window.Accelade.shared</code>.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Current Shared Data -->
        <div class="rounded-xl p-4 border border-violet-500/30" style="background: rgba(139, 92, 246, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-violet-500/20 text-violet-500 rounded">Data</span>
                Current Shared Data
            </h4>
            <pre id="shared-data-display" class="text-sm font-mono p-4 rounded-lg border border-[var(--docs-border)] overflow-auto max-h-48" style="background: var(--docs-bg); color: var(--docs-text-muted);"></pre>
        </div>

        <!-- JavaScript API -->
        <div class="rounded-xl p-4 border border-purple-500/30" style="background: rgba(168, 85, 247, 0.1);">
            <h4 class="font-medium mb-4 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">API</span>
                JavaScript API
            </h4>
            <div class="space-y-3">
                <div class="flex flex-wrap gap-2">
                    <button onclick="showSharedValue('appName')" class="px-4 py-2 bg-indigo-500 text-white rounded-lg font-medium hover:bg-indigo-600 transition text-sm" data-testid="get-app-name">Get App Name</button>
                    <button onclick="showSharedValue('user.name')" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-medium hover:bg-purple-600 transition text-sm" data-testid="get-user-name">Get User Name</button>
                    <button onclick="toggleTheme()" class="px-4 py-2 bg-teal-500 text-white rounded-lg font-medium hover:bg-teal-600 transition text-sm" data-testid="toggle-theme">Toggle Theme</button>
                </div>
                <div id="shared-value-result" class="text-sm p-3 rounded-lg border border-[var(--docs-border)] min-h-[40px]" style="background: var(--docs-bg); color: var(--docs-text-muted);"></div>
            </div>
        </div>

        <!-- Text Interpolation Demo -->
        <div class="rounded-xl p-4 border border-indigo-500/30" style="background: rgba(99, 102, 241, 0.1);">
            <h4 class="font-medium mb-4" style="color: var(--docs-text);">Reactive State with {{ $prefix }}-* Directives</h4>
            @accelade(['greeting' => 'Hello', 'count' => 0])
                <div class="text-center">
                    <p class="text-xl mb-2" style="color: var(--docs-text);">
                        <span {{ $textAttr }}="greeting">Hello</span>, <span class="font-bold text-violet-500" {{ $textAttr }}="shared.user.name">John Doe</span>!
                    </p>
                    <p class="mb-2" style="color: var(--docs-text-muted);">
                        App: <span class="font-semibold" {{ $textAttr }}="shared.appName">Accelade Demo</span> |
                        Theme: <span class="font-mono px-2 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);" {{ $textAttr }}="shared.settings.theme">dark</span>
                    </p>
                    <p class="mb-4" style="color: var(--docs-text-muted);">
                        Clicked: <span class="font-bold text-purple-500" {{ $textAttr }}="count">0</span> times
                    </p>
                    <div class="flex gap-2 justify-center">
                        <button class="px-4 py-2 bg-violet-500 text-white rounded-lg text-sm font-medium hover:bg-violet-600 transition" {{ $clickAttr }}="$set('count', count + 1)" data-testid="shared-increment">Increment</button>
                        <button class="px-4 py-2 bg-purple-500 text-white rounded-lg text-sm font-medium hover:bg-purple-600 transition" {{ $clickAttr }}="$set('greeting', greeting === 'Hello' ? 'Welcome' : 'Hello')">Toggle Greeting</button>
                    </div>
                </div>
            @endaccelade
        </div>
    </div>

    <x-accelade::code-block language="php" filename="shared-data.php">
// PHP
Accelade::share('user', ['name' => 'John']);
Accelade::share('settings', ['theme' => 'dark']);

// JavaScript
window.Accelade.shared.get('user.name');
window.Accelade.shared.set('settings.theme', 'light');

// Blade Template ({{ $prefix }}-* syntax)
&lt;span {{ $textAttr }}="shared.user.name"&gt;&lt;/span&gt;
    </x-accelade::code-block>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        updateSharedDisplay();
    });
    if (document.readyState !== 'loading') {
        setTimeout(updateSharedDisplay, 100);
    }

    function updateSharedDisplay() {
        const display = document.getElementById('shared-data-display');
        if (display) {
            display.textContent = JSON.stringify(window.Accelade?.shared?.all() || {}, null, 2);
        }
    }

    function showSharedValue(key) {
        const value = window.Accelade?.shared?.get(key);
        document.getElementById('shared-value-result').innerHTML = `<strong>${key}:</strong> ${JSON.stringify(value)}`;
    }

    function toggleTheme() {
        const current = window.Accelade?.shared?.get('settings.theme') || 'light';
        const newTheme = current === 'dark' ? 'light' : 'dark';
        window.Accelade?.shared?.set('settings.theme', newTheme);
        updateSharedDisplay();
        document.getElementById('shared-value-result').innerHTML = `<strong>Theme changed to:</strong> ${newTheme}`;
    }
</script>
</file>

<file path="resources/views/demo/partials/_toggle-component.blade.php">
{{-- Toggle Component Section - Simplified Boolean State Management --}}
@props(['prefix' => 'a'])

@php
    $textAttr = match($prefix) {
        'v' => 'v-text',
        'data-state' => 'data-state-text',
        's' => 's-text',
        'ng' => 'ng-text',
        default => 'a-text',
    };

    $showAttr = match($prefix) {
        'v' => 'v-show',
        'data-state' => 'data-state-show',
        's' => 's-show',
        'ng' => 'ng-show',
        default => 'a-show',
    };

    $ifAttr = match($prefix) {
        'v' => 'v-if',
        'data-state' => 'data-state-if',
        's' => 's-if',
        'ng' => 'ng-if',
        default => 'a-if',
    };
@endphp

<!-- Demo: Toggle Component -->
<section class="rounded-xl p-6 mb-6 border border-[var(--docs-border)]" style="background: var(--docs-bg-alt);">
    <div class="flex items-center gap-3 mb-2">
        <span class="w-2.5 h-2.5 bg-indigo-500 rounded-full"></span>
        <h3 class="text-lg font-semibold" style="color: var(--docs-text);">Toggle Component</h3>
    </div>
    <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
        Streamlined boolean state management with <code class="px-1.5 py-0.5 rounded text-sm border border-[var(--docs-border)]" style="background: var(--docs-bg);">&lt;x-accelade::toggle&gt;</code>.
        Perfect for show/hide toggles, accordions, and boolean flags.
    </p>

    <div class="space-y-4 mb-4">
        <!-- Basic Toggle -->
        <div class="rounded-xl p-4 border border-indigo-500/30" style="background: rgba(99, 102, 241, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-indigo-500/20 text-indigo-500 rounded">Basic</span>
                Simple Toggle
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Single boolean toggle with <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">toggle()</code> and <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">setToggle()</code>.
            </p>

            <x-accelade::toggle>
                <div class="space-y-4">
                    <button
                        @click.prevent="toggle()"
                        class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors"
                    >
                        Show Content
                    </button>

                    <div {{ $showAttr }}="toggled" class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p class="mb-3" style="color: var(--docs-text);">This content is now visible!</p>
                        <button
                            @click.prevent="setToggle(false)"
                            class="px-3 py-1 rounded hover:opacity-80 transition-colors border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                        >
                            Hide Content
                        </button>
                    </div>

                    <p class="text-sm" style="color: var(--docs-text-muted);">
                        State: <span class="font-mono" {{ $textAttr }}="toggled ? 'true' : 'false'">false</span>
                    </p>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Default True -->
        <div class="rounded-xl p-4 border border-emerald-500/30" style="background: rgba(16, 185, 129, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-emerald-500/20 text-emerald-500 rounded">Default</span>
                Initially Visible
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Start with <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">toggled</code> set to true using <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">:data="true"</code>.
            </p>

            <x-accelade::toggle :data="true">
                <div class="space-y-4">
                    <div {{ $showAttr }}="toggled" class="p-4 rounded-lg border border-[var(--docs-border)]" style="background: var(--docs-bg);">
                        <p style="color: var(--docs-text);">This content is visible by default!</p>
                    </div>

                    <div class="flex gap-2">
                        <button
                            @click.prevent="setToggle(true)"
                            class="px-3 py-1.5 bg-emerald-500 text-white rounded hover:bg-emerald-600 transition-colors"
                        >
                            Show
                        </button>
                        <button
                            @click.prevent="setToggle(false)"
                            class="px-3 py-1.5 rounded hover:opacity-80 transition-colors border border-[var(--docs-border)]"
                            style="background: var(--docs-bg-alt); color: var(--docs-text);"
                        >
                            Hide
                        </button>
                        <button
                            @click.prevent="toggle()"
                            class="px-3 py-1.5 bg-emerald-500/20 text-emerald-500 rounded hover:bg-emerald-500/30 transition-colors"
                        >
                            Toggle
                        </button>
                    </div>

                    <p class="text-sm" style="color: var(--docs-text-muted);">
                        State: <span class="font-mono" {{ $textAttr }}="toggled ? 'true' : 'false'">true</span>
                    </p>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Multiple Toggles -->
        <div class="rounded-xl p-4 border border-amber-500/30" style="background: rgba(245, 158, 11, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-amber-500/20 text-amber-500 rounded">Multiple</span>
                Named Toggles
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Manage multiple booleans with comma-separated keys: <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">data="isCompany, hasVat"</code>.
            </p>

            <x-accelade::toggle data="isCompany, hasVatNumber, wantsNewsletter">
                <div class="space-y-4">
                    <div class="flex flex-wrap gap-2">
                        <button
                            @click.prevent="toggle('isCompany')"
                            class="px-3 py-1.5 bg-amber-500 text-white rounded hover:bg-amber-600 transition-colors"
                        >
                            Toggle Company
                        </button>
                        <button
                            @click.prevent="toggle('hasVatNumber')"
                            class="px-3 py-1.5 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors"
                        >
                            Toggle VAT
                        </button>
                        <button
                            @click.prevent="toggle('wantsNewsletter')"
                            class="px-3 py-1.5 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition-colors"
                        >
                            Toggle Newsletter
                        </button>
                    </div>

                    <div class="p-4 rounded-lg border border-[var(--docs-border)] space-y-2" style="background: var(--docs-bg);">
                        <div {{ $showAttr }}="isCompany" class="p-2 bg-amber-500/20 rounded text-amber-500">
                            Company mode enabled - show company fields
                        </div>
                        <div {{ $showAttr }}="hasVatNumber" class="p-2 bg-orange-500/20 rounded text-orange-500">
                            VAT number required - show VAT input
                        </div>
                        <div {{ $showAttr }}="wantsNewsletter" class="p-2 bg-yellow-500/20 rounded text-yellow-500">
                            Newsletter subscription active
                        </div>
                    </div>

                    <div class="text-sm space-y-1" style="color: var(--docs-text-muted);">
                        <p>isCompany: <span class="font-mono" {{ $textAttr }}="isCompany ? 'true' : 'false'">false</span></p>
                        <p>hasVatNumber: <span class="font-mono" {{ $textAttr }}="hasVatNumber ? 'true' : 'false'">false</span></p>
                        <p>wantsNewsletter: <span class="font-mono" {{ $textAttr }}="wantsNewsletter ? 'true' : 'false'">false</span></p>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <!-- Form Example -->
        <div class="rounded-xl p-4 border border-sky-500/30" style="background: rgba(14, 165, 233, 0.1);">
            <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
                <span class="text-xs px-2 py-1 bg-sky-500/20 text-sky-500 rounded">Form</span>
                Registration Form
            </h4>
            <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
                Conditional form fields based on toggle state.
            </p>

            <x-accelade::toggle data="isCompany, showAddress">
                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Name</label>
                        <input
                            type="text"
                            placeholder="Your name"
                            class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-sky-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg); color: var(--docs-text);"
                        >
                    </div>

                    <div class="flex items-center gap-2">
                        <button
                            type="button"
                            @click.prevent="toggle('isCompany')"
                            class="px-3 py-1.5 rounded transition-colors"
                            :class="isCompany ? 'bg-sky-500 text-white' : 'border border-[var(--docs-border)]'"
                            :style="!isCompany ? 'background: var(--docs-bg-alt); color: var(--docs-text);' : ''"
                        >
                            I'm a company
                        </button>
                    </div>

                    <div {{ $showAttr }}="isCompany" class="space-y-3 p-3 bg-sky-500/10 rounded-lg">
                        <div>
                            <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Company Name</label>
                            <input
                                type="text"
                                placeholder="Company name"
                                class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-sky-500 border border-[var(--docs-border)]"
                                style="background: var(--docs-bg); color: var(--docs-text);"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">VAT Number</label>
                            <input
                                type="text"
                                placeholder="VAT number"
                                class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-sky-500 border border-[var(--docs-border)]"
                                style="background: var(--docs-bg); color: var(--docs-text);"
                            >
                        </div>
                    </div>

                    <div class="flex items-center gap-2">
                        <button
                            type="button"
                            @click.prevent="toggle('showAddress')"
                            class="text-sm text-sky-500 hover:text-sky-400"
                        >
                            <span {{ $showAttr }}="!showAddress">+ Add shipping address</span>
                            <span {{ $showAttr }}="showAddress">- Hide shipping address</span>
                        </button>
                    </div>

                    <div {{ $showAttr }}="showAddress" class="p-3 bg-sky-500/10 rounded-lg">
                        <label class="block text-sm font-medium mb-1" style="color: var(--docs-text);">Address</label>
                        <textarea
                            placeholder="Shipping address"
                            rows="2"
                            class="w-full px-3 py-2 rounded-lg focus:ring-2 focus:ring-sky-500 border border-[var(--docs-border)]"
                            style="background: var(--docs-bg); color: var(--docs-text);"
                        ></textarea>
                    </div>
                </form>
            </x-accelade::toggle>
        </div>
    </div>

    <!-- Accordion Example -->
    <div class="rounded-xl p-4 border border-purple-500/30 mb-4" style="background: rgba(168, 85, 247, 0.1);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-purple-500/20 text-purple-500 rounded">Accordion</span>
            FAQ Accordion
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Build accordions by combining multiple toggle components.
        </p>

        <div class="space-y-2">
            <x-accelade::toggle>
                <div class="border border-purple-500/30 rounded-lg overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left flex items-center justify-between hover:bg-purple-500/10 transition-colors"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span class="font-medium">What is Accelade?</span>
                        <span class="text-purple-500" {{ $textAttr }}="toggled ? '−' : '+'">+</span>
                    </button>
                    <div {{ $showAttr }}="toggled" class="px-4 py-3 bg-purple-500/10 border-t border-purple-500/30">
                        <p style="color: var(--docs-text-muted);">Accelade is a Laravel package that adds reactivity to your Blade templates without requiring a full JavaScript framework.</p>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle>
                <div class="border border-purple-500/30 rounded-lg overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left flex items-center justify-between hover:bg-purple-500/10 transition-colors"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span class="font-medium">How does the Toggle component work?</span>
                        <span class="text-purple-500" {{ $textAttr }}="toggled ? '−' : '+'">+</span>
                    </button>
                    <div {{ $showAttr }}="toggled" class="px-4 py-3 bg-purple-500/10 border-t border-purple-500/30">
                        <p style="color: var(--docs-text-muted);">The Toggle component provides a simplified interface for managing boolean values. It exposes <code class="px-1 rounded" style="background: var(--docs-bg);">toggle()</code>, <code class="px-1 rounded" style="background: var(--docs-bg);">setToggle()</code>, and <code class="px-1 rounded" style="background: var(--docs-bg);">toggled</code> properties.</p>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle>
                <div class="border border-purple-500/30 rounded-lg overflow-hidden">
                    <button
                        @click.prevent="toggle()"
                        class="w-full px-4 py-3 text-left flex items-center justify-between hover:bg-purple-500/10 transition-colors"
                        style="background: var(--docs-bg); color: var(--docs-text);"
                    >
                        <span class="font-medium">Can I use multiple toggles?</span>
                        <span class="text-purple-500" {{ $textAttr }}="toggled ? '−' : '+'">+</span>
                    </button>
                    <div {{ $showAttr }}="toggled" class="px-4 py-3 bg-purple-500/10 border-t border-purple-500/30">
                        <p style="color: var(--docs-text-muted);">Yes! Pass comma-separated keys to manage multiple boolean values: <code class="px-1 rounded" style="background: var(--docs-bg);">data="key1, key2, key3"</code>. Then use <code class="px-1 rounded" style="background: var(--docs-bg);">toggle('key1')</code> to toggle specific values.</p>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>
    </div>

    <!-- Animation Presets -->
    <div class="rounded-xl p-4 border border-green-500/30 mb-4" style="background: rgba(34, 197, 94, 0.1);">
        <h4 class="font-medium mb-3 flex items-center gap-2" style="color: var(--docs-text);">
            <span class="text-xs px-2 py-1 bg-green-500 text-white rounded">Animation</span>
            Toggle with Animation
        </h4>
        <p class="text-sm mb-4" style="color: var(--docs-text-muted);">
            Add smooth animations with <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">animation="preset"</code>.
            All <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">{{ $showAttr }}</code> elements automatically animate.
        </p>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
            <x-accelade::toggle animation="fade">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-green-500 text-white text-sm rounded hover:bg-green-600">fade</button>
                    <div {{ $showAttr }}="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg); color: var(--docs-text);">Fades</div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="scale">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-emerald-500 text-white text-sm rounded hover:bg-emerald-600">scale</button>
                    <div {{ $showAttr }}="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg); color: var(--docs-text);">Scales</div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-up">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-teal-500 text-white text-sm rounded hover:bg-teal-600">slide-up</button>
                    <div class="overflow-hidden">
                        <div {{ $showAttr }}="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg); color: var(--docs-text);">Slides</div>
                    </div>
                </div>
            </x-accelade::toggle>

            <x-accelade::toggle animation="slide-down">
                <div class="space-y-2">
                    <button @click.prevent="toggle()" class="w-full px-3 py-2 bg-cyan-500 text-white text-sm rounded hover:bg-cyan-600">slide-down</button>
                    <div class="overflow-hidden">
                        <div {{ $showAttr }}="toggled" class="p-2 rounded border border-[var(--docs-border)] text-center text-sm" style="background: var(--docs-bg); color: var(--docs-text);">Slides</div>
                    </div>
                </div>
            </x-accelade::toggle>
        </div>

        <p class="text-xs" style="color: var(--docs-text-muted);">Available: <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">default</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">fade</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">scale</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">collapse</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">slide-up</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">slide-down</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">slide-left</code>, <code class="px-1 rounded border border-[var(--docs-border)]" style="background: var(--docs-bg);">slide-right</code></p>
    </div>

    <!-- All Props -->
    <div class="rounded-xl p-4 border border-[var(--docs-border)] mb-4" style="background: var(--docs-bg);">
        <h4 class="font-medium mb-4" style="color: var(--docs-text);">Component Props & Methods</h4>
        <div class="overflow-x-auto mb-4">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Prop</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Type</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Default</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">data</code></td>
                        <td class="py-2 px-3">bool|string</td>
                        <td class="py-2 px-3">false</td>
                        <td class="py-2 px-3">Default value (bool) or comma-separated keys (string)</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-indigo-500">animation</code></td>
                        <td class="py-2 px-3">string</td>
                        <td class="py-2 px-3">null</td>
                        <td class="py-2 px-3">Animation preset for show/hide (fade, scale, slide-*)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h5 class="font-medium mb-2" style="color: var(--docs-text);">Exposed Properties</h5>
        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b border-[var(--docs-border)]">
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Property/Method</th>
                        <th class="text-left py-2 px-3" style="color: var(--docs-text-muted);">Description</th>
                    </tr>
                </thead>
                <tbody style="color: var(--docs-text-muted);">
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">toggled</code></td>
                        <td class="py-2 px-3">Boolean state (single mode)</td>
                    </tr>
                    <tr class="border-b border-[var(--docs-border)]">
                        <td class="py-2 px-3"><code class="text-indigo-500">toggle(key?)</code></td>
                        <td class="py-2 px-3">Toggle the value (key required for multi-mode)</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-3"><code class="text-indigo-500">setToggle(value)</code></td>
                        <td class="py-2 px-3">Set specific value (single mode: bool, multi mode: key + bool)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <x-accelade::code-block language="blade" filename="toggle-examples.blade.php">
{{-- Basic toggle --}}
&lt;x-accelade::toggle&gt;
    &lt;button @click.prevent="toggle()"&gt;Show/Hide&lt;/button&gt;
    &lt;div a-show="toggled"&gt;Toggled content&lt;/div&gt;
&lt;/x-accelade::toggle&gt;

{{-- With animation (recommended!) --}}
&lt;x-accelade::toggle animation="fade"&gt;
    &lt;button @click.prevent="toggle()"&gt;Toggle&lt;/button&gt;
    &lt;div a-show="toggled"&gt;Animated content!&lt;/div&gt;
&lt;/x-accelade::toggle&gt;

{{-- Collapse animation for accordions (no overlap) --}}
&lt;x-accelade::toggle animation="collapse"&gt;
    &lt;button @click.prevent="toggle()"&gt;Accordion Header&lt;/button&gt;
    &lt;div a-show="toggled"&gt;Accordion content...&lt;/div&gt;
&lt;/x-accelade::toggle&gt;

{{-- Multiple toggles --}}
&lt;x-accelade::toggle data="isCompany, hasVat" animation="scale"&gt;
    &lt;button @click.prevent="toggle('isCompany')"&gt;Company&lt;/button&gt;
    &lt;div a-show="isCompany"&gt;Company fields...&lt;/div&gt;
&lt;/x-accelade::toggle&gt;
    </x-accelade::code-block>
</section>
</file>

<file path="src/Http/Controllers/DocsController.php">
<?php

declare(strict_types=1);

namespace Accelade\Http\Controllers;

use Accelade\Docs\DocsRegistry;
use Illuminate\Http\Request;
use Illuminate\Routing\Controller;
use Illuminate\Support\Facades\File;
use Illuminate\View\View;
use League\CommonMark\Environment\Environment;
use League\CommonMark\Extension\CommonMark\CommonMarkCoreExtension;
use League\CommonMark\Extension\GithubFlavoredMarkdownExtension;
use League\CommonMark\MarkdownConverter;

class DocsController extends Controller
{
    public function __construct(
        protected DocsRegistry $registry,
    ) {}

    /**
     * Show a documentation section.
     */
    public function show(Request $request, string $section): View
    {
        $framework = $request->query('framework', 'vanilla');

        // Validate framework
        if (! $this->registry->isValidFramework($framework)) {
            $framework = 'vanilla';
        }

        // Get prefix for framework
        $prefix = $this->registry->getFrameworkPrefix($framework);

        // Get section from registry
        $docSection = $this->registry->getSection($section);

        // Check if section has a demo
        $hasDemo = $docSection->hasDemo ?? false;

        // Get documentation content
        $documentation = $this->getDocumentation($section);

        // Determine which view to render
        $viewName = $docSection?->getViewName() ?? 'accelade::docs.sections.getting-started';

        return view($viewName, [
            'framework' => $framework,
            'prefix' => $prefix,
            'section' => $section,
            'documentation' => $documentation,
            'hasDemo' => $hasDemo,
            'docSection' => $docSection,
            'navigation' => $this->registry->getNavigation(),
        ]);
    }

    /**
     * Get the documentation content for a section.
     */
    protected function getDocumentation(string $section): ?string
    {
        $docSection = $this->registry->getSection($section);

        if ($docSection === null) {
            return null;
        }

        $docPath = $docSection->getMarkdownPath($this->registry);

        if ($docPath === null || ! File::exists($docPath)) {
            return null;
        }

        $markdown = File::get($docPath);

        return $this->parseMarkdown($markdown);
    }

    /**
     * Parse markdown to HTML.
     */
    protected function parseMarkdown(string $markdown): string
    {
        $environment = new Environment([
            'html_input' => 'allow',
            'allow_unsafe_links' => false,
        ]);

        $environment->addExtension(new CommonMarkCoreExtension);
        $environment->addExtension(new GithubFlavoredMarkdownExtension);

        $converter = new MarkdownConverter($environment);

        $html = $converter->convert($markdown)->getContent();

        // Transform code blocks to match the code-block component style
        return $this->transformCodeBlocks($html);
    }

    /**
     * Transform code blocks to match the x-accelade::code-block component style.
     */
    protected function transformCodeBlocks(string $html): string
    {
        // Match <pre><code class="language-xxx">...</code></pre> patterns
        $pattern = '/<pre><code class="language-([^"]*)">(.*?)<\/code><\/pre>/s';

        return preg_replace_callback($pattern, function ($matches) {
            $language = $matches[1] ?? 'text';
            $code = $matches[2];
            $id = 'code-'.bin2hex(random_bytes(4));

            // Map language names to display labels
            $languageLabels = [
                'php' => 'PHP',
                'blade' => 'Blade',
                'html' => 'HTML',
                'javascript' => 'JavaScript',
                'js' => 'JavaScript',
                'css' => 'CSS',
                'bash' => 'Bash',
                'shell' => 'Shell',
                'json' => 'JSON',
                'xml' => 'XML',
                'sql' => 'SQL',
                'yaml' => 'YAML',
                'vue' => 'Vue',
                'typescript' => 'TypeScript',
                'ts' => 'TypeScript',
            ];

            $label = $languageLabels[$language] ?? strtoupper($language);

            // Map to Prism language class
            $prismLanguage = match ($language) {
                'blade' => 'php',
                'html', 'xml' => 'markup',
                'js' => 'javascript',
                'ts' => 'typescript',
                'shell' => 'bash',
                default => $language,
            };

            return <<<HTML
<div class="code-block-wrapper rounded-xl overflow-hidden shadow-lg my-4" dir="ltr" style="background:#1e293b;border:1px solid #334155;" data-code-block="{$id}">
    <div class="flex items-center justify-between px-4 py-3" style="background:#1e293b;border-bottom:1px solid #334155;">
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full" style="background:#ef4444;"></span>
                <span class="w-3 h-3 rounded-full" style="background:#eab308;"></span>
                <span class="w-3 h-3 rounded-full" style="background:#22c55e;"></span>
            </div>
            <span class="text-xs font-medium uppercase tracking-wider" style="color:#94a3b8;">{$label}</span>
        </div>
        <div class="flex items-center gap-2">
            <button type="button" class="code-copy-btn flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-md transition-all" style="color:#94a3b8;background:rgba(51,65,85,0.5);" data-code-target="{$id}" title="Copy code">
                <svg class="copy-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                <svg class="check-icon w-4 h-4 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                <span class="copy-text">Copy</span>
            </button>
            <button type="button" class="code-download-btn flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-md transition-all" style="color:#94a3b8;background:rgba(51,65,85,0.5);" data-code-target="{$id}" title="Download as image">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                <span>Image</span>
            </button>
        </div>
    </div>
    <div class="code-content overflow-x-auto" style="background:#1e293b;">
        <pre id="{$id}" class="language-{$prismLanguage}" style="margin:0;border-radius:0;background:#1e293b !important;"><code class="language-{$prismLanguage}" style="background:transparent !important;">{$code}</code></pre>
    </div>
</div>
HTML;
        }, $html) ?? $html;
    }

    /**
     * Search documentation.
     */
    public function search(Request $request): array
    {
        $query = strtolower($request->query('q', ''));

        if (strlen($query) < 2) {
            return ['results' => []];
        }

        $results = [];

        foreach ($this->registry->getAllSections() as $slug => $section) {
            $docPath = $section->getMarkdownPath($this->registry);

            // Check section metadata
            $matchesMetadata = str_contains(strtolower($slug), $query)
                || str_contains(strtolower($section->label), $query)
                || str_contains(strtolower($section->description ?? ''), $query)
                || $this->matchesKeywords($query, $section->keywords);

            // Check content if file exists
            $matchesContent = false;
            if ($docPath !== null && File::exists($docPath)) {
                $content = strtolower(File::get($docPath));
                $matchesContent = str_contains($content, $query);
            }

            if ($matchesMetadata || $matchesContent) {
                $results[] = [
                    'section' => $slug,
                    'label' => $section->label,
                    'hasDemo' => $section->hasDemo,
                    'package' => $section->package,
                    'description' => $section->description,
                ];
            }
        }

        return ['results' => $results];
    }

    /**
     * Check if query matches any keywords.
     *
     * @param  array<int, string>  $keywords
     */
    protected function matchesKeywords(string $query, array $keywords): bool
    {
        foreach ($keywords as $keyword) {
            if (str_contains(strtolower($keyword), $query)) {
                return true;
            }
        }

        return false;
    }

    /**
     * Get navigation structure for the docs sidebar.
     */
    public function navigation(): array
    {
        return [
            'navigation' => $this->registry->getNavigation(),
            'frameworks' => $this->registry->getFrameworkPrefixes(),
        ];
    }
}
</file>

<file path="composer.json">
{
    "name": "accelade/accelade",
    "description": "Reactive Blade templates with Vue, React, Svelte, Angular, or vanilla JavaScript",
    "type": "library",
    "license": "MIT",
    "authors": [
        {
            "name": "Fady Mondy",
            "email": "info@3x1.io",
            "homepage": "https://3x1.io",
            "role": "Developer"
        }
    ],
    "homepage": "https://github.com/fadymondy/accelade",
    "keywords": [
        "laravel",
        "blade",
        "vue",
        "react",
        "svelte",
        "angular",
        "reactive",
        "components",
        "spa",
        "notifications"
    ],
    "require": {
        "php": "^8.2",
        "illuminate/support": "^11.0|^12.0",
        "illuminate/view": "^11.0|^12.0",
        "illuminate/routing": "^11.0|^12.0",
        "league/commonmark": "^2.8"
    },
    "require-dev": {
        "laravel/pint": "^1.18",
        "orchestra/testbench": "^9.0|^10.0",
        "pestphp/pest": "^3.0",
        "pestphp/pest-plugin-laravel": "^3.0"
    },
    "autoload": {
        "psr-4": {
            "Accelade\\": "src/"
        }
    },
    "autoload-dev": {
        "psr-4": {
            "Accelade\\Tests\\": "tests/"
        }
    },
    "extra": {
        "laravel": {
            "providers": [
                "Accelade\\AcceladeServiceProvider"
            ],
            "aliases": {
                "Accelade": "Accelade\\Facades\\Accelade",
                "Notify": "Accelade\\Facades\\Notify"
            }
        }
    },
    "scripts": {
        "test": "pest",
        "test:coverage": "pest --coverage",
        "format": "pint",
        "format:test": "pint --test",
        "mago": "./mago lint src/ || mago lint src/",
        "mago:fix": "./mago lint src/ --fix || mago lint src/ --fix",
        "analyse": [
            "@format:test",
            "@mago"
        ],
        "ci": [
            "@analyse",
            "@test"
        ]
    },
    "config": {
        "allow-plugins": {
            "pestphp/pest-plugin": true
        }
    },
    "minimum-stability": "stable",
    "prefer-stable": true
}
</file>

<file path="resources/js/core/router.ts">
/**
 * Accelade SPA Router
 * Client-side navigation without full page reloads
 */

import { getProgress, startProgress, doneProgress, type ProgressConfig } from './progress';
import { handleLinkClick, initLinks, parseLinkConfig } from './link/LinkManager';
import { modalManager, initModals } from './modal/ModalFactory';

export interface NavigationOptions {
    /** Whether to push to browser history (default: true) */
    pushState?: boolean;
    /** Whether to scroll to top after navigation (default: true) */
    scrollToTop?: boolean;
    /** Whether to preserve scroll position (default: false) */
    preserveScroll?: boolean;
    /** Whether to preserve component state (default: false) */
    preserveState?: boolean;
    /** Custom headers for the fetch request */
    headers?: Record<string, string>;
    /** Target container selector (default: body or [data-accelade-page]) */
    target?: string;
    /** Skip progress bar for this navigation */
    skipProgress?: boolean;
    /** Try to restore from cache (default: false, true for back/forward) */
    useCache?: boolean;
}

export interface RouterConfig {
    /** Selector for links to intercept */
    linkSelector: string;
    /** Selector for the page content container */
    pageSelector: string;
    /** CSS class added during navigation */
    loadingClass: string;
    /** Enable progress bar (default: true) */
    showProgress?: boolean;
    /** Progress bar configuration */
    progress?: ProgressConfig;
    /** Page transition duration in ms (default: 150) */
    transitionDuration?: number;
    /** Max pages to keep in memory (default: 10, 0 = disabled) */
    maxKeepAlive?: number;
    /** Default preserve scroll behavior (default: false) */
    defaultPreserveScroll?: boolean;
    /** Callback before navigation starts */
    onBeforeNavigate?: (url: string) => boolean | void;
    /** Callback after navigation completes */
    onAfterNavigate?: (url: string) => void;
    /** Callback on navigation error */
    onError?: (error: Error, url: string) => void;
    /** Callback when navigation starts */
    onStart?: (url: string) => void;
    /** Callback when navigation finishes (success or error) */
    onFinish?: (url: string, success: boolean) => void;
}

/**
 * Cached page entry for keep-alive feature
 */
interface CachedPage {
    /** The HTML content of the page container */
    html: string;
    /** The page title */
    title: string;
    /** Scroll position */
    scrollX: number;
    scrollY: number;
    /** Component states */
    states: Map<string, Record<string, unknown>>;
    /** Timestamp when cached */
    timestamp: number;
}

const defaultConfig: RouterConfig = {
    linkSelector: 'a[data-accelade-link], a[a-link], [data-spa-link]',
    pageSelector: '[data-accelade-page], main, body',
    loadingClass: 'accelade-loading',
    showProgress: true,
    transitionDuration: 150,
    maxKeepAlive: 10,
    defaultPreserveScroll: false,
};

/**
 * Get navigation config from AcceladeConfig
 */
function getNavigationConfig(): Partial<RouterConfig> {
    const config: Partial<RouterConfig> = {};

    if (typeof window !== 'undefined' && (window as any).AcceladeConfig?.navigation) {
        const nav = (window as any).AcceladeConfig.navigation;
        if (typeof nav.max_keep_alive === 'number') {
            config.maxKeepAlive = nav.max_keep_alive;
        }
        if (typeof nav.transition_duration === 'number') {
            config.transitionDuration = nav.transition_duration;
        }
        if (typeof nav.preserve_scroll === 'boolean') {
            config.defaultPreserveScroll = nav.preserve_scroll;
        }
    }

    return config;
}

/** Selector for modal/slideover/bottom-sheet links */
const modalLinkSelector = 'a[data-modal], a[data-slideover], a[data-bottom-sheet]';

/**
 * Accelade Router class
 */
export class AcceladeRouter {
    private config: RouterConfig;
    private abortController: AbortController | null = null;
    private initialized = false;
    /** Page cache for keep-alive feature */
    private pageCache: Map<string, CachedPage> = new Map();

    constructor(config: Partial<RouterConfig> = {}) {
        // Merge: defaults -> AcceladeConfig -> user config
        const navConfig = getNavigationConfig();
        this.config = { ...defaultConfig, ...navConfig, ...config };

        // Configure progress bar if provided
        if (this.config.progress) {
            getProgress(this.config.progress);
        }
    }

    /**
     * Get the max keep-alive limit
     */
    get maxKeepAlive(): number {
        return this.config.maxKeepAlive ?? 10;
    }

    /**
     * Cache the current page state
     */
    private cachePage(url: string, container: HTMLElement): void {
        if (this.maxKeepAlive <= 0) return;

        // Normalize URL
        const normalizedUrl = this.normalizeUrl(url);

        // Capture component states
        const states = new Map<string, Record<string, unknown>>();
        const components = container.querySelectorAll<HTMLElement>('[data-accelade]');
        components.forEach((el, index) => {
            const id = el.dataset.acceladeId ?? `component-${index}`;
            const stateStr = el.dataset.acceladeState;
            if (stateStr) {
                try {
                    states.set(id, JSON.parse(stateStr));
                } catch {
                    // Ignore parse errors
                }
            }
        });

        // Create cache entry
        const entry: CachedPage = {
            html: container.innerHTML,
            title: document.title,
            scrollX: window.scrollX,
            scrollY: window.scrollY,
            states,
            timestamp: Date.now(),
        };

        // Add to cache
        this.pageCache.set(normalizedUrl, entry);

        // Enforce cache size limit (remove oldest entries)
        if (this.pageCache.size > this.maxKeepAlive) {
            const entriesToRemove = this.pageCache.size - this.maxKeepAlive;
            const keys = Array.from(this.pageCache.keys());
            for (let i = 0; i < entriesToRemove; i++) {
                this.pageCache.delete(keys[i]);
            }
        }
    }

    /**
     * Get a cached page
     */
    private getCachedPage(url: string): CachedPage | undefined {
        return this.pageCache.get(this.normalizeUrl(url));
    }

    /**
     * Normalize URL for cache key
     */
    private normalizeUrl(url: string): string {
        const parsed = new URL(url, window.location.origin);
        return parsed.pathname + parsed.search;
    }

    /**
     * Clear the page cache
     */
    clearCache(): void {
        this.pageCache.clear();
    }

    /**
     * Get cache size
     */
    getCacheSize(): number {
        return this.pageCache.size;
    }

    /**
     * Saved persistent elements during navigation
     */
    private persistentElements: Map<string, HTMLElement> = new Map();

    /**
     * Save persistent elements before navigation
     */
    private savePersistentElements(): void {
        this.persistentElements.clear();

        const elements = document.querySelectorAll<HTMLElement>('[data-accelade-persistent]');
        elements.forEach((el) => {
            const id = el.getAttribute('data-accelade-persistent') || `persistent-${this.persistentElements.size}`;
            // Clone the element to preserve its state
            const clone = el.cloneNode(true) as HTMLElement;
            this.persistentElements.set(id, clone);

            // Store reference to original for state preservation (media playback, etc.)
            (clone as any)._originalElement = el;
        });
    }

    /**
     * Restore persistent elements after navigation
     */
    private restorePersistentElements(container: HTMLElement): void {
        if (this.persistentElements.size === 0) return;

        // Find placeholder elements in the new content
        const placeholders = container.querySelectorAll<HTMLElement>('[data-accelade-persistent]');

        placeholders.forEach((placeholder) => {
            const id = placeholder.getAttribute('data-accelade-persistent');
            if (!id) return;

            const saved = this.persistentElements.get(id);
            if (saved) {
                // Get the original element if it still exists in DOM
                const original = (saved as any)._originalElement as HTMLElement | undefined;

                if (original && original.isConnected) {
                    // Move the original element (preserves media playback state)
                    placeholder.replaceWith(original);
                } else {
                    // Use the cloned element
                    placeholder.replaceWith(saved);
                }
            }
        });

        this.persistentElements.clear();
    }

    /**
     * Check if page has persistent elements
     */
    hasPersistentElements(): boolean {
        return document.querySelectorAll('[data-accelade-persistent]').length > 0;
    }

    /**
     * Initialize the router
     */
    init(): void {
        if (this.initialized) return;

        // Intercept link clicks
        document.addEventListener('click', this.handleClick.bind(this));

        // Handle browser back/forward
        window.addEventListener('popstate', this.handlePopState.bind(this));

        // Initialize modal system
        initModals();

        this.initialized = true;
    }

    /**
     * Configure the progress bar
     */
    configureProgress(config: ProgressConfig): void {
        getProgress(config);
    }

    /**
     * Handle link clicks
     */
    private handleClick(event: MouseEvent): void {
        const target = event.target as HTMLElement;

        // Check for modal/slideover links first
        const modalLink = target.closest<HTMLAnchorElement>(modalLinkSelector);
        if (modalLink) {
            // Skip if modifier keys are pressed
            if (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey) return;

            event.preventDefault();
            this.handleModalLink(modalLink);
            return;
        }

        const link = target.closest<HTMLAnchorElement>(this.config.linkSelector);

        if (!link) return;

        // Skip if modifier keys are pressed (allow opening in new tab)
        if (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey) return;

        // Skip if link has target="_blank"
        if (link.target === '_blank') return;

        // Skip downloads
        if (link.hasAttribute('download')) return;

        // Parse link config to check for special handling
        const linkConfig = parseLinkConfig(link);

        // Handle external links (away attribute)
        if (linkConfig.away) {
            // Let the LinkManager handle it (may show confirmation)
            event.preventDefault();
            void handleLinkClick(link, event);
            return;
        }

        // Skip external links (different origin)
        const url = new URL(link.href, window.location.origin);
        if (url.origin !== window.location.origin) return;

        // Skip hash-only links for named modals
        if (url.pathname === window.location.pathname && url.hash) {
            // Check if this is a named modal
            const modalName = url.hash.slice(1);
            if (modalManager.getByName(modalName)) {
                event.preventDefault();
                modalManager.openNamed(modalName);
                return;
            }
            return;
        }

        event.preventDefault();

        // Use LinkManager for enhanced handling (confirmation, methods, etc.)
        void handleLinkClick(link, event);
    }

    /**
     * Handle modal/slideover/bottom-sheet link clicks
     */
    private async handleModalLink(link: HTMLAnchorElement): Promise<void> {
        const href = link.getAttribute('href');
        if (!href) return;

        // Check for hash link (pre-loaded modal)
        if (href.startsWith('#')) {
            const name = href.slice(1);
            modalManager.openNamed(name);
            return;
        }

        // Parse options from link
        const options = modalManager.parseLinkOptions(link);
        if (!options) return;

        // Determine modal type
        let type: 'modal' | 'slideover' | 'bottom-sheet' = 'modal';
        if (options.bottomSheet) {
            type = 'bottom-sheet';
        } else if (options.slideover) {
            type = 'slideover';
        }

        // Open modal with URL
        await modalManager.openUrl(href, {
            type,
            maxWidth: options.maxWidth,
            position: options.position,
            slideoverPosition: options.slideoverPosition,
        });
    }

    /**
     * Handle browser back/forward navigation
     */
    private handlePopState(_event: PopStateEvent): void {
        // Try to restore from cache for back/forward navigation
        void this.navigate(window.location.href, { pushState: false, useCache: true });
    }

    /**
     * Saved component states for preserve-state navigation
     */
    private savedStates: Map<string, Record<string, unknown>> = new Map();

    /**
     * Restore a page from cache
     */
    private async restoreFromCache(
        cached: CachedPage,
        container: HTMLElement,
        transitionDuration: number
    ): Promise<boolean> {
        // Remove leaving class, add entering class
        container.classList.remove('accelade-leaving');
        container.classList.add('accelade-entering');

        // Restore the HTML
        container.innerHTML = cached.html;

        // Restore persistent elements (media players, etc.)
        this.restorePersistentElements(container);

        // Restore component states
        const components = container.querySelectorAll<HTMLElement>('[data-accelade]');
        components.forEach((el, index) => {
            const id = el.dataset.acceladeId ?? `component-${index}`;
            const savedState = cached.states.get(id);
            if (savedState) {
                el.dataset.acceladeState = JSON.stringify(savedState);
            }
        });

        // Update page title
        document.title = cached.title;

        // Re-initialize Accelade components
        await this.wait(10);
        if ((window as any).Accelade?.init) {
            (window as any).Accelade.init();
        }

        // Remove entering class
        await this.wait(20);
        container.classList.remove('accelade-entering');

        // Re-bind SPA links
        this.bindLinks(container);

        // Restore scroll position
        window.scrollTo({
            top: cached.scrollY,
            left: cached.scrollX,
            behavior: 'instant'
        });

        return true;
    }

    /**
     * Navigate to a URL
     */
    async navigate(url: string, options: NavigationOptions = {}): Promise<boolean> {
        const {
            pushState = true,
            scrollToTop = true,
            preserveScroll = this.config.defaultPreserveScroll ?? false,
            preserveState = false,
            headers = {},
            target,
            skipProgress = false,
            useCache = false,
        } = options;

        const showProgress = this.config.showProgress && !skipProgress;
        const transitionDuration = this.config.transitionDuration ?? 150;

        // Capture scroll position if preserveScroll is enabled
        const savedScrollX = preserveScroll ? window.scrollX : 0;
        const savedScrollY = preserveScroll ? window.scrollY : 0;

        // Capture component states if preserveState is enabled
        if (preserveState) {
            this.captureComponentStates();
        }

        // Check if this is a framework switch (demo pages only)
        // If navigating to a DIFFERENT framework demo, do a full page reload
        const currentFramework = document.querySelector('meta[name="accelade-framework"]')?.getAttribute('content');
        if (currentFramework) {
            const urlPath = new URL(url, window.location.origin).pathname;

            // Only check for framework switches on demo routes
            const frameworkFromUrl = this.detectFrameworkFromUrl(urlPath);

            if (frameworkFromUrl && frameworkFromUrl !== currentFramework) {
                if (showProgress) startProgress();
                window.location.href = url;
                return true;
            }
        }

        // Allow cancellation of navigation
        if (this.config.onBeforeNavigate) {
            const result = this.config.onBeforeNavigate(url);
            if (result === false) return false;
        }

        // Abort any pending navigation
        if (this.abortController) {
            this.abortController.abort();
        }
        this.abortController = new AbortController();

        // Find the target container
        const containerSelector = target ?? this.config.pageSelector;
        const container = document.querySelector<HTMLElement>(containerSelector);

        if (!container) {
            console.error('Accelade Router: Container not found:', containerSelector);
            return false;
        }

        // Cache current page before navigating (for keep-alive)
        if (this.maxKeepAlive > 0) {
            this.cachePage(window.location.href, container);
        }

        // Check if we can restore from cache
        const cachedPage = useCache ? this.getCachedPage(url) : undefined;

        // Start progress bar (skip if restoring from cache)
        if (showProgress && !cachedPage) {
            startProgress();
        }

        // Callback: onStart
        if (this.config.onStart) {
            this.config.onStart(url);
        }

        // Save persistent elements before navigation
        this.savePersistentElements();

        // Add leaving class for exit animation
        container.classList.add('accelade-leaving');

        // Wait for exit animation
        await this.wait(transitionDuration);

        let success = false;

        try {
            // Try to restore from cache first (for back/forward navigation)
            if (cachedPage) {
                success = await this.restoreFromCache(cachedPage, container, transitionDuration);

                // Update browser history
                if (pushState) {
                    window.history.pushState({ url }, cachedPage.title, url);
                }

                // Callback: onAfterNavigate
                if (this.config.onAfterNavigate) {
                    this.config.onAfterNavigate(url);
                }

                // Callback: onFinish
                if (this.config.onFinish) {
                    this.config.onFinish(url, true);
                }

                this.abortController = null;
                return true;
            }

            // Fetch the page from server
            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'X-Accelade-SPA': 'true',
                    'X-Requested-With': 'XMLHttpRequest',
                    'Accept': 'text/html',
                    ...headers,
                },
                signal: this.abortController.signal,
            });

            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }

            const html = await response.text();

            // Parse the response
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');

            // Find the content in the response
            const newContainer = doc.querySelector<HTMLElement>(containerSelector);
            const newContent = newContainer?.innerHTML ?? doc.body.innerHTML;

            // Remove leaving class, add entering class
            container.classList.remove('accelade-leaving');
            container.classList.add('accelade-entering');

            // Update the page content (components will have data-accelade-cloak)
            container.innerHTML = newContent;

            // Restore persistent elements (media players, etc.)
            this.restorePersistentElements(container);

            // Execute inline scripts in the new content
            this.executeScripts(container);

            // Update the page title
            const newTitle = doc.querySelector('title')?.textContent;
            if (newTitle) {
                document.title = newTitle;
            }

            // Update browser history
            if (pushState) {
                window.history.pushState({ url }, newTitle ?? '', url);
            }

            // Restore component states BEFORE init if preserveState was enabled
            // This ensures init sees the restored state
            if (preserveState) {
                this.restoreComponentStates();
            }

            // Re-initialize Accelade components in the new content
            await this.wait(10);
            if (window.Accelade?.init) {
                window.Accelade.init();
            }

            // Remove entering class after a frame
            await this.wait(20);
            container.classList.remove('accelade-entering');

            // Re-bind SPA links in new content
            this.bindLinks(container);

            // Handle scroll position
            if (preserveScroll) {
                // Restore previous scroll position
                window.scrollTo({ top: savedScrollY, left: savedScrollX, behavior: 'instant' });
            } else if (scrollToTop) {
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'instant' });
            }

            // Callback
            if (this.config.onAfterNavigate) {
                this.config.onAfterNavigate(url);
            }

            success = true;
            return true;
        } catch (error) {
            if ((error as Error).name === 'AbortError') {
                // Navigation was cancelled
                return false;
            }

            console.error('Accelade Router: Navigation failed:', error);

            // Remove transition classes on error
            container.classList.remove('accelade-leaving', 'accelade-entering');

            if (this.config.onError) {
                this.config.onError(error as Error, url);
            } else {
                // Fallback to traditional navigation
                window.location.href = url;
            }

            return false;
        } finally {
            // Complete progress bar
            if (showProgress) {
                doneProgress();
            }

            // Callback: onFinish
            if (this.config.onFinish) {
                this.config.onFinish(url, success);
            }

            this.abortController = null;
        }
    }

    /**
     * Promise-based wait helper
     */
    private wait(ms: number): Promise<void> {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    /**
     * Execute scripts in a container
     * When innerHTML is set, script tags don't execute automatically
     * IMPORTANT: Be very selective about which scripts to execute to avoid loops
     */
    private executeScripts(container: HTMLElement): void {
        const scripts = container.querySelectorAll<HTMLScriptElement>('script');

        scripts.forEach((oldScript) => {
            // Skip accelade:script tags - these are processed by the framework
            if (oldScript.hasAttribute('a-script') ||
                oldScript.hasAttribute('v-script') ||
                oldScript.hasAttribute('state-script')) {
                return;
            }

            // Skip if it's an accelade bundle script (already loaded)
            if (oldScript.src && oldScript.src.includes('accelade')) {
                return;
            }

            // Skip Vite/build-related scripts
            if (oldScript.src && (
                oldScript.src.includes('@vite') ||
                oldScript.src.includes('vite') ||
                oldScript.src.includes('node_modules')
            )) {
                return;
            }

            // Skip module scripts that might cause issues
            if (oldScript.type === 'module' && oldScript.src) {
                return;
            }

            // Skip inline scripts that call Accelade.init() to prevent loops
            const content = oldScript.textContent ?? '';
            if (content.includes('Accelade.init') || content.includes('Accelade?.init')) {
                return;
            }

            // Create a new script element to force execution
            const newScript = document.createElement('script');

            // Copy attributes
            Array.from(oldScript.attributes).forEach((attr) => {
                newScript.setAttribute(attr.name, attr.value);
            });

            // Copy content
            newScript.textContent = content;

            // Replace old script with new one (this triggers execution)
            oldScript.parentNode?.replaceChild(newScript, oldScript);
        });
    }

    /**
     * Bind SPA behavior to links within a container
     */
    bindLinks(container: HTMLElement): void {
        // Initialize link features (prefetching, etc.)
        initLinks(container);
    }

    /**
     * Prefetch a URL (for performance)
     */
    async prefetch(url: string): Promise<void> {
        try {
            const link = document.createElement('link');
            link.rel = 'prefetch';
            link.href = url;
            document.head.appendChild(link);
        } catch {
            // Ignore prefetch errors
        }
    }

    /**
     * Get current URL
     */
    getCurrentUrl(): string {
        return window.location.href;
    }

    /**
     * Check if a URL is the current page
     */
    isCurrentUrl(url: string): boolean {
        const current = new URL(window.location.href);
        const check = new URL(url, window.location.origin);
        return current.pathname === check.pathname && current.search === check.search;
    }

    /**
     * Detect framework from URL path (for demo routes)
     * Returns null if not a framework demo route
     */
    private detectFrameworkFromUrl(urlPath: string): string | null {
        if (urlPath.includes('/demo/vanilla')) return 'vanilla';
        if (urlPath.includes('/demo/vue')) return 'vue';
        if (urlPath.includes('/demo/react')) return 'react';
        if (urlPath.includes('/demo/svelte')) return 'svelte';
        if (urlPath.includes('/demo/angular')) return 'angular';
        return null;
    }

    /**
     * Capture component states before navigation
     */
    private captureComponentStates(): void {
        this.savedStates.clear();

        const components = document.querySelectorAll<HTMLElement>('[data-accelade]');
        components.forEach((el) => {
            const id = el.dataset.acceladeId;
            const stateStr = el.dataset.acceladeState;

            if (id && stateStr) {
                try {
                    // Try to get the current live state from the component
                    // This works because we store state in data attributes or can access via window
                    const state = JSON.parse(stateStr) as Record<string, unknown>;
                    this.savedStates.set(id, state);
                } catch {
                    // Ignore parse errors
                }
            }
        });
    }

    /**
     * Restore component states after navigation
     */
    private restoreComponentStates(): void {
        if (this.savedStates.size === 0) return;

        const components = document.querySelectorAll<HTMLElement>('[data-accelade]');
        components.forEach((el) => {
            const id = el.dataset.acceladeId;

            // Try to find a matching saved state
            // Since IDs are generated randomly, we match by position/order
            const savedStateKeys = Array.from(this.savedStates.keys());
            const componentIndex = Array.from(components).indexOf(el);

            if (componentIndex < savedStateKeys.length) {
                const savedKey = savedStateKeys[componentIndex];
                const savedState = this.savedStates.get(savedKey);

                if (savedState) {
                    // Update the data attribute so init picks it up
                    el.dataset.acceladeState = JSON.stringify(savedState);
                }
            }
        });

        this.savedStates.clear();
    }
}

// Singleton instance
let routerInstance: AcceladeRouter | null = null;

/**
 * Get or create the router instance
 */
export function getRouter(config?: Partial<RouterConfig>): AcceladeRouter {
    if (!routerInstance) {
        routerInstance = new AcceladeRouter(config);
    }
    return routerInstance;
}

/**
 * Initialize the router
 */
export function initRouter(config?: Partial<RouterConfig>): AcceladeRouter {
    const router = getRouter(config);
    router.init();
    return router;
}

/**
 * Navigate to a URL
 */
export function navigate(url: string, options?: NavigationOptions): Promise<boolean> {
    return getRouter().navigate(url, options);
}

// Re-export progress functions for convenience
export {
    getProgress,
    startProgress,
    doneProgress,
    type ProgressConfig,
} from './progress';

// Re-export link functions
export {
    showConfirmDialog,
    confirm,
    confirmDanger,
} from './link/ConfirmDialog';

export {
    parseLinkConfig,
    handleLinkClick,
    initLinks,
} from './link/LinkManager';

export type { LinkConfig, HttpMethod, ConfirmDialogOptions } from './link/types';

// Re-export modal functions
export { modalManager, initModals, initModalLinks } from './modal/ModalFactory';
export type { ModalConfig, ModalInstance, ModalOpenOptions, ModalMaxWidth, ModalPosition, SlideoverPosition } from './modal/types';

export default {
    AcceladeRouter,
    getRouter,
    initRouter,
    navigate,
    modal: modalManager,
};
</file>

<file path="resources/js/core/types.ts">
/**
 * Accelade Type Definitions
 */

// Import router types
import type { AcceladeRouter, NavigationOptions } from './router';
import type { ProgressConfig, AcceladeProgress } from './progress';

// Global window extension
declare global {
    interface Window {
        AcceladeConfig?: AcceladeConfig;
        Accelade?: AcceladeInstance;
    }
}

// Re-export router types
export type { NavigationOptions };

/**
 * Progress bar API
 */
export interface AcceladeProgressAPI {
    configure: (config: ProgressConfig) => void;
    start: () => void;
    done: (force?: boolean) => void;
    instance: (config?: ProgressConfig) => AcceladeProgress;
}

/**
 * Framework type
 */
export type FrameworkType = 'vanilla' | 'vue' | 'react' | 'svelte' | 'angular';

/**
 * Shared data type
 */
export type SharedData = Record<string, unknown>;

/**
 * Accelade configuration from server
 */
export interface AcceladeConfig {
    framework?: FrameworkType;
    syncDebounce?: number;
    csrfToken?: string;
    updateUrl?: string;
    batchUpdateUrl?: string;
    progress?: Partial<ProgressConfig>;
    debug?: boolean;
    shared?: SharedData;
}

/**
 * Accelade global instance
 */
export interface AcceladeInstance {
    init: (options?: { framework?: FrameworkType; debug?: boolean }) => void;
    navigate?: (url: string, options?: NavigationOptions) => Promise<boolean>;
    router?: AcceladeRouter;
    progress?: AcceladeProgressAPI;
    debug?: boolean;
    devtools?: unknown;
    getFramework?: () => FrameworkType;
    getComponent?: (id: string) => unknown;
    getComponents?: () => Map<string, unknown>;
    [key: string]: unknown;
}

/**
 * Parsed component configuration
 */
export interface AcceladeComponentConfig {
    id: string;
    state: Record<string, unknown>;
    sync: string[];
    props?: Record<string, unknown>;
    rememberKey?: string;
    localStorageKey?: string;
    storeName?: string;
}

/**
 * State change callback
 */
export type StateChangeCallback = (
    newValue: unknown,
    oldValue: unknown,
    key: string
) => void;

/**
 * State set options
 */
export interface StateSetOptions {
    sync?: boolean;
}

/**
 * State change record
 */
export interface StateChange {
    key: string;
    value: unknown;
    oldValue: unknown;
}

/**
 * Sync update payload
 */
export interface SyncUpdatePayload {
    component: string | null;
    property: string;
    value: unknown;
}

/**
 * Batch sync update payload
 */
export interface BatchSyncUpdatePayload {
    component: string | null;
    updates: Array<{
        property: string;
        value: unknown;
    }>;
}

/**
 * Event callback type for event bus
 */
export type EventCallback<T = unknown> = (data: T) => void;

/**
 * Accelade actions for state manipulation
 */
export interface AcceladeActions {
    increment: (key?: string, amount?: number) => void;
    decrement: (key?: string, amount?: number) => void;
    set: (key: string, value: unknown) => void;
    get: (key: string) => unknown;
    toggle: (key: string) => void;
    reset: (key: string) => void;
    // Aliases with $ prefix for template usage
    $set: (key: string, value: unknown) => void;
    $get: (key: string) => unknown;
    $toggle: (key: string) => void;
    $store: (name: string) => Record<string, unknown> | null;
    // Event bus methods
    $emit: <T = unknown>(event: string, data?: T) => void;
    $on: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
    $once: <T = unknown>(event: string, callback: EventCallback<T>) => () => void;
    $off: <T = unknown>(event: string, callback: EventCallback<T>) => void;
}

/**
 * Hook result for useAccelade
 */
export interface UseAcceladeResult<T extends Record<string, unknown>> {
    state: T;
    setState: React.Dispatch<React.SetStateAction<T>>;
    actions: AcceladeActions;
}

/**
 * Accelade provider props
 */
export interface AcceladeProviderProps<T extends Record<string, unknown>> {
    initialState: T;
    componentId?: string;
    syncProperties?: string[];
    children: React.ReactNode | ((accelade: UseAcceladeResult<T>) => React.ReactNode);
}

/**
 * Counter component props
 */
export interface AcceladeCounterProps {
    initialCount?: number;
    sync?: string;
}

/**
 * Generic component props
 */
export interface AcceladeComponentProps {
    template: string;
    config: AcceladeComponentConfig;
}

export {};
</file>

<file path="resources/js/vanilla/accelade.ts">
/**
 * Accelade Vanilla JavaScript Integration
 * Pure JavaScript reactivity without any framework dependencies
 */

import type { AcceladeComponentConfig, AcceladeActions } from '../core/types';
import { initRouter, navigate, getRouter, type NavigationOptions } from '../core/router';
import { getProgress, configureProgress, startProgress, doneProgress, type ProgressConfig } from '../core/progress';

/**
 * Reactive state with Proxy
 */
type ReactiveState = Record<string, unknown>;

/**
 * Component instance
 */
interface ComponentInstance {
    id: string;
    element: HTMLElement;
    state: ReactiveState;
    originalState: ReactiveState;
    templates: Map<HTMLElement, string>;
    actions: AcceladeActions;
    syncProperties: Set<string>;
    customMethods: Record<string, (...args: unknown[]) => unknown>;
    rememberKey?: string;
    localStorageKey?: string;
    storeName?: string;
}

/**
 * Global stores for shared reactive state
 */
const globalStores: Map<string, ReactiveState> = new Map();

/**
 * Extended HTMLElement with initialization flag
 */
interface AcceladeHTMLElement extends HTMLElement {
    __accelade_vanilla_initialized?: boolean;
}

/**
 * Main Accelade manager
 */
class AcceladeManager {
    private components: Map<string, ComponentInstance> = new Map();
    private initialized = false;

    /**
     * Parse element configuration
     */
    private parseAcceladeElement(el: HTMLElement): AcceladeComponentConfig & {
        rememberKey?: string;
        localStorageKey?: string;
        storeName?: string;
    } {
        const id = el.dataset.acceladeId ?? `accelade-${Math.random().toString(36).slice(2, 10)}`;
        const stateStr = el.dataset.acceladeState ?? '{}';
        const stateJsStr = el.dataset.acceladeStateJs;
        const syncStr = el.dataset.acceladeSync ?? '';
        const rememberKey = el.dataset.acceladeRemember;
        const localStorageKey = el.dataset.acceladeLocalStorage;
        const storeName = el.dataset.acceladeStore;

        let state: Record<string, unknown> = {};

        // First try to parse JSON state
        if (stateStr && stateStr !== '{}') {
            try {
                state = JSON.parse(stateStr) as Record<string, unknown>;
            } catch {
                console.error('Accelade: Invalid state JSON', stateStr);
            }
        }

        // If we have a JS object string (for JavaScript object notation like { count: 0 })
        if (stateJsStr) {
            try {
                // Use Function to evaluate JS object notation
                const evalFn = new Function(`return (${stateJsStr})`) as () => Record<string, unknown>;
                state = evalFn();
            } catch {
                console.error('Accelade: Invalid state JS object', stateJsStr);
            }
        }

        const sync = syncStr ? syncStr.split(',').filter(Boolean) : [];

        return { id, state, sync, rememberKey, localStorageKey, storeName };
    }

    /**
     * Load state from storage (sessionStorage or localStorage)
     */
    private loadFromStorage(key: string, useLocalStorage: boolean): Record<string, unknown> | null {
        try {
            const storage = useLocalStorage ? localStorage : sessionStorage;
            const storageKey = `accelade:${key}`;
            const stored = storage.getItem(storageKey);
            if (stored) {
                return JSON.parse(stored) as Record<string, unknown>;
            }
        } catch {
            // Storage not available or invalid data
        }
        return null;
    }

    /**
     * Save state to storage (sessionStorage or localStorage)
     */
    private saveToStorage(key: string, state: Record<string, unknown>, useLocalStorage: boolean): void {
        try {
            const storage = useLocalStorage ? localStorage : sessionStorage;
            const storageKey = `accelade:${key}`;
            storage.setItem(storageKey, JSON.stringify(state));
        } catch {
            // Storage not available or quota exceeded
        }
    }

    /**
     * Get or create a global store
     */
    private getOrCreateStore(storeName: string, initialState: Record<string, unknown>): ReactiveState {
        if (globalStores.has(storeName)) {
            return globalStores.get(storeName)!;
        }

        // Create a new store with the initial state
        const store = { ...initialState };
        globalStores.set(storeName, store);
        return store;
    }

    /**
     * Create reactive proxy for state
     */
    private createReactiveProxy(component: ComponentInstance, obj: ReactiveState): ReactiveState {
        const manager = this;

        return new Proxy(obj, {
            set(target: ReactiveState, prop: string, value: unknown): boolean {
                const oldValue = target[prop];
                target[prop] = value;

                if (oldValue !== value) {
                    manager.updateComponent(component);

                    // Sync to server if property is marked for sync
                    if (component.syncProperties.has(prop)) {
                        manager.syncToServer(component.id, prop, value);
                    }

                    // Save to sessionStorage if remember key is set
                    if (component.rememberKey) {
                        manager.saveToStorage(component.rememberKey, { ...target }, false);
                    }

                    // Save to localStorage if localStorage key is set
                    if (component.localStorageKey) {
                        manager.saveToStorage(component.localStorageKey, { ...target }, true);
                    }

                    // Update global store if this component uses one
                    if (component.storeName && globalStores.has(component.storeName)) {
                        const store = globalStores.get(component.storeName)!;
                        store[prop] = value;
                        // Update all other components using this store
                        manager.updateStoreComponents(component.storeName, component.id);
                    }
                }

                return true;
            },
            get(target: ReactiveState, prop: string): unknown {
                return target[prop];
            }
        });
    }

    /**
     * Update all components using a specific store (except the triggering one)
     */
    private updateStoreComponents(storeName: string, excludeId: string): void {
        this.components.forEach((comp) => {
            if (comp.storeName === storeName && comp.id !== excludeId) {
                // Sync the store state to this component
                const store = globalStores.get(storeName);
                if (store) {
                    Object.keys(store).forEach((key) => {
                        (comp.state as Record<string, unknown>)[key] = store[key];
                    });
                }
                this.updateComponent(comp);
            }
        });
    }

    /**
     * Sync state to server
     */
    private syncToServer(componentId: string, property: string, value: unknown): void {
        const config = window.AcceladeConfig;
        const url = config?.updateUrl ?? '/accelade/update';
        const csrfToken = config?.csrfToken ?? '';

        // Show progress bar during sync
        startProgress();

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': csrfToken,
                'Accept': 'application/json'
            },
            body: JSON.stringify({
                component: componentId,
                property: property,
                value: value
            })
        })
        .then(() => {
            doneProgress();
        })
        .catch(() => {
            doneProgress();
        });
    }

    /**
     * Create actions for a component
     */
    private createActions(component: ComponentInstance): AcceladeActions {
        return {
            increment: (key = 'count', amount = 1): void => {
                const currentValue = component.state[key];
                component.state[key] = (parseInt(String(currentValue), 10) || 0) + amount;
            },
            decrement: (key = 'count', amount = 1): void => {
                const currentValue = component.state[key];
                component.state[key] = (parseInt(String(currentValue), 10) || 0) - amount;
            },
            set: (key: string, value: unknown): void => {
                component.state[key] = value;
            },
            toggle: (key: string): void => {
                component.state[key] = !component.state[key];
            },
            reset: (key: string): void => {
                const originalValue = component.originalState[key];
                if (typeof originalValue === 'number') {
                    component.state[key] = 0;
                } else if (typeof originalValue === 'boolean') {
                    component.state[key] = false;
                } else {
                    component.state[key] = '';
                }
            },

            get: (key: string): unknown => {
                return component.state[key];
            },

            // Aliases with $ prefix for template usage
            $set: (key: string, value: unknown): void => {
                component.state[key] = value;
            },

            $get: (key: string): unknown => {
                return component.state[key];
            },

            $toggle: (key: string): void => {
                component.state[key] = !component.state[key];
            },

            // Store helper - get a global store by name
            $store: (name: string): ReactiveState | null => {
                return globalStores.get(name) ?? null;
            }
        };
    }

    /**
     * Process <script a-script>, <accelade-script>, or <accelade:script> blocks
     */
    private processScripts(component: ComponentInstance): void {
        const el = component.element;

        // Find script elements with a-script attribute, accelade-script tag, or accelade:script tag
        // Note: CSS selector needs escaped colon for accelade:script
        const scriptElements = el.querySelectorAll<HTMLScriptElement>('script[a-script], accelade-script, accelade\\:script');

        scriptElements.forEach((scriptEl) => {
            const code = scriptEl.textContent ?? '';
            if (!code.trim()) return;

            try {
                // Create a function with access to state, actions, and helpers
                const scriptFn = new Function(
                    'state',
                    'actions',
                    '$set',
                    '$get',
                    '$toggle',
                    '$navigate',
                    'component',
                    code
                ) as (
                    state: ReactiveState,
                    actions: AcceladeActions,
                    $set: (key: string, value: unknown) => void,
                    $get: (key: string) => unknown,
                    $toggle: (key: string) => void,
                    $navigate: (url: string, options?: NavigationOptions) => Promise<boolean>,
                    component: ComponentInstance
                ) => Record<string, (...args: unknown[]) => unknown> | void;

                // Helper functions
                const $set = (key: string, value: unknown): void => {
                    component.state[key] = value;
                };
                const $get = (key: string): unknown => component.state[key];
                const $toggle = (key: string): void => {
                    component.state[key] = !component.state[key];
                };

                // Execute and get returned methods
                const result = scriptFn(
                    component.state,
                    component.actions,
                    $set,
                    $get,
                    $toggle,
                    navigate,
                    component
                );

                // If the script returns an object with methods, add them to customMethods
                if (result && typeof result === 'object') {
                    Object.assign(component.customMethods, result);
                }

                // Remove the script element from DOM (already executed)
                scriptEl.remove();
            } catch (e) {
                console.error('Accelade: Error executing script:', e);
            }
        });
    }

    /**
     * Initialize a component
     */
    initComponent(el: AcceladeHTMLElement): void {
        if (el.__accelade_vanilla_initialized) return;

        const config = this.parseAcceladeElement(el);

        // Determine initial state
        let initialState = { ...config.state };

        // If using a global store, get or create it
        if (config.storeName) {
            const store = this.getOrCreateStore(config.storeName, initialState);
            initialState = { ...store };
        }

        // If remember key is set, try to load from sessionStorage
        if (config.rememberKey) {
            const storedState = this.loadFromStorage(config.rememberKey, false);
            if (storedState) {
                initialState = { ...initialState, ...storedState };
            }
        }

        // If localStorage key is set, try to load from localStorage
        if (config.localStorageKey) {
            const storedState = this.loadFromStorage(config.localStorageKey, true);
            if (storedState) {
                initialState = { ...initialState, ...storedState };
            }
        }

        // Create component instance
        const component: ComponentInstance = {
            id: config.id,
            element: el,
            state: {},
            originalState: { ...config.state },
            templates: new Map(),
            actions: {} as AcceladeActions,
            syncProperties: new Set(config.sync),
            customMethods: {},
            rememberKey: config.rememberKey,
            localStorageKey: config.localStorageKey,
            storeName: config.storeName
        };

        // Create reactive state
        component.state = this.createReactiveProxy(component, initialState);

        // Create actions
        component.actions = this.createActions(component);

        // Store component
        this.components.set(config.id, component);

        // Process custom scripts before binding events
        this.processScripts(component);

        // Store templates for elements that need them
        this.storeTemplates(component);

        // Bind event handlers
        this.bindEventHandlers(component);

        // Initial render
        this.updateComponent(component);

        // Remove cloak and add ready class for smooth reveal
        el.removeAttribute('data-accelade-cloak');
        el.removeAttribute('a-cloak');
        el.classList.add('accelade-ready');

        el.__accelade_vanilla_initialized = true;
    }

    /**
     * Store templates for elements
     */
    private storeTemplates(component: ComponentInstance): void {
        // Store a-for templates
        const forElements = component.element.querySelectorAll<HTMLElement>('[a-for]');
        forElements.forEach(el => {
            component.templates.set(el, el.innerHTML);
        });
    }

    /**
     * Bind event handlers
     */
    private bindEventHandlers(component: ComponentInstance): void {
        const allElements = component.element.querySelectorAll<HTMLElement>('*');

        allElements.forEach((element) => {
            Array.from(element.attributes).forEach((attr) => {
                let eventName: string | null = null;
                let actionExpr: string | null = null;

                // Handle @event syntax (primary)
                if (attr.name.startsWith('@')) {
                    eventName = attr.name.slice(1);
                    actionExpr = attr.value;
                }
                // Handle a-on:event syntax (backward compatibility)
                else if (attr.name.startsWith('a-on:')) {
                    eventName = attr.name.slice(5);
                    actionExpr = attr.value;
                }

                if (eventName && actionExpr) {
                    element.addEventListener(eventName, (e: Event) => {
                        this.executeAction(component, actionExpr!, e);
                    });
                }
            });
        });
    }

    /**
     * Execute an action expression
     */
    private executeAction(component: ComponentInstance, expr: string, _event: Event): void {
        // Handle action:key format (e.g., "increment:count", "toggle:showMessage")
        if (expr.includes(':')) {
            const [action, key] = expr.split(':');

            // Check custom methods first
            if (component.customMethods[action]) {
                (component.customMethods[action] as (key: string, event: Event) => void)(key, _event);
                return;
            }

            const actionMethod = component.actions[action as keyof AcceladeActions];
            if (typeof actionMethod === 'function') {
                (actionMethod as (key: string) => void)(key);
                return;
            }
        }

        // Handle method('key') format
        const match = expr.match(/^(\w+)\s*\(\s*['"]?([^'"]*?)['"]?\s*\)$/);
        if (match) {
            const [, method, arg] = match;

            // Check custom methods first
            if (component.customMethods[method]) {
                (component.customMethods[method] as (...args: unknown[]) => void)(arg, _event);
                return;
            }

            const actionMethod = component.actions[method as keyof AcceladeActions];
            if (typeof actionMethod === 'function') {
                (actionMethod as (key: string) => void)(arg);
                return;
            }
        }

        // Try custom method directly
        if (component.customMethods[expr]) {
            (component.customMethods[expr] as (event: Event) => void)(_event);
            return;
        }

        // Try direct action name
        const directAction = component.actions[expr as keyof AcceladeActions];
        if (typeof directAction === 'function') {
            (directAction as () => void)();
            return;
        }

        // Try to evaluate as expression
        try {
            const fn = new Function('state', 'actions', 'methods', 'event', '$navigate', `
                with (state) {
                    with (actions) {
                        with (methods) {
                            ${expr}
                        }
                    }
                }
            `) as (
                state: ReactiveState,
                actions: AcceladeActions,
                methods: Record<string, (...args: unknown[]) => unknown>,
                event: Event,
                $navigate: typeof navigate
            ) => void;
            fn(component.state, component.actions, component.customMethods, _event, navigate);
        } catch {
            // Action execution failed
        }
    }

    /**
     * Update a component's DOM
     */
    private updateComponent(component: ComponentInstance): void {
        const el = component.element;
        const state = component.state;

        // Update the data-accelade-state attribute so MutationObservers can detect changes
        // This is important for lazy loading conditional triggers
        el.dataset.acceladeState = JSON.stringify(state);

        // a-text binding
        const textElements = el.querySelectorAll<HTMLElement>('[a-text]');
        textElements.forEach((element) => {
            const prop = element.getAttribute('a-text');
            if (!prop) return;

            const value = this.getNestedValue(state, prop);
            element.textContent = value !== undefined ? String(value) : '';
        });

        // a-show binding
        const showElements = el.querySelectorAll<HTMLElement>('[a-show]');
        showElements.forEach((element) => {
            const expr = element.getAttribute('a-show');
            if (!expr) return;

            const result = this.evaluateExpression(expr, state);
            element.style.display = result ? '' : 'none';
        });

        // a-if binding
        const ifElements = el.querySelectorAll<HTMLElement>('[a-if]');
        ifElements.forEach((element) => {
            const expr = element.getAttribute('a-if');
            if (!expr) return;

            const result = this.evaluateExpression(expr, state);

            // Store reference to placeholder
            const placeholderKey = '__accelade_placeholder';
            const elementWithPlaceholder = element as HTMLElement & { [placeholderKey]?: Comment };

            if (!result) {
                if (!elementWithPlaceholder[placeholderKey]) {
                    const placeholder = document.createComment('a-if');
                    elementWithPlaceholder[placeholderKey] = placeholder;
                }
                if (element.parentNode) {
                    element.parentNode.replaceChild(elementWithPlaceholder[placeholderKey]!, element);
                }
            } else if (elementWithPlaceholder[placeholderKey]?.parentNode) {
                elementWithPlaceholder[placeholderKey]!.parentNode.replaceChild(element, elementWithPlaceholder[placeholderKey]!);
            }
        });

        // a-model binding (two-way)
        const modelElements = el.querySelectorAll<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>('[a-model]');
        modelElements.forEach((element) => {
            const prop = element.getAttribute('a-model');
            if (!prop) return;

            const inputElement = element as HTMLInputElement;
            const value = state[prop];

            // Update DOM from state
            if (inputElement.type === 'checkbox') {
                if (inputElement.checked !== Boolean(value)) {
                    inputElement.checked = Boolean(value);
                }
            } else if (inputElement.type === 'radio') {
                inputElement.checked = inputElement.value === value;
            } else if (element.value !== String(value ?? '')) {
                element.value = value !== undefined ? String(value) : '';
            }

            // Bind input event if not already bound
            const boundKey = '__accelade_model_bound';
            const elementWithBound = element as typeof element & { [boundKey]?: boolean };
            if (!elementWithBound[boundKey]) {
                const eventType = (inputElement.type === 'checkbox' || inputElement.type === 'radio') ? 'change' : 'input';
                element.addEventListener(eventType, () => {
                    if (inputElement.type === 'checkbox') {
                        state[prop] = inputElement.checked;
                    } else if (inputElement.type === 'radio') {
                        state[prop] = inputElement.value;
                    } else if (inputElement.type === 'number' || inputElement.type === 'range') {
                        state[prop] = parseFloat(element.value) || 0;
                    } else {
                        state[prop] = element.value;
                    }
                });
                elementWithBound[boundKey] = true;
            }
        });

        // a-bind:attr binding
        const allElements = el.querySelectorAll<HTMLElement>('*');
        allElements.forEach((element) => {
            Array.from(element.attributes).forEach((attr) => {
                if (attr.name.startsWith('a-bind:') || (attr.name.startsWith(':') && !attr.name.startsWith('::'))) {
                    const attrName = attr.name.startsWith(':')
                        ? attr.name.slice(1)
                        : attr.name.slice(7);
                    const expr = attr.value;

                    const value = this.evaluateExpression(expr, state);
                    if (attrName === 'class') {
                        if (typeof value === 'object' && value !== null) {
                            Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                                element.classList.toggle(className, Boolean(condition));
                            });
                        } else {
                            element.setAttribute('class', String(value));
                        }
                    } else if (value === false || value === null || value === undefined) {
                        element.removeAttribute(attrName);
                    } else if (value === true) {
                        element.setAttribute(attrName, '');
                    } else {
                        element.setAttribute(attrName, String(value));
                    }
                }
            });
        });

        // a-class binding
        const classElements = el.querySelectorAll<HTMLElement>('[a-class]');
        classElements.forEach((element) => {
            const expr = element.getAttribute('a-class');
            if (!expr) return;

            try {
                const classObj = this.evaluateExpression(expr, state) as Record<string, boolean>;
                if (typeof classObj === 'object' && classObj !== null) {
                    Object.entries(classObj).forEach(([className, condition]) => {
                        element.classList.toggle(className, Boolean(condition));
                    });
                }
            } catch {
                // Ignore class binding errors
            }
        });
    }

    /**
     * Evaluate expression against state
     */
    private evaluateExpression(expr: string, state: ReactiveState): unknown {
        try {
            // Simple property access
            if (/^[\w.]+$/.test(expr)) {
                return this.getNestedValue(state, expr);
            }

            // Create evaluation function
            const keys = Object.keys(state);
            const values = Object.values(state);
            const fn = new Function(...keys, 'return ' + expr) as (...args: unknown[]) => unknown;
            return fn(...values);
        } catch {
            return undefined;
        }
    }

    /**
     * Get nested value from object
     */
    private getNestedValue(obj: ReactiveState, path: string): unknown {
        return path.split('.').reduce<unknown>(
            (current, key) => {
                if (current !== null && typeof current === 'object') {
                    return (current as Record<string, unknown>)[key];
                }
                return undefined;
            },
            obj
        );
    }

    /**
     * Initialize all Accelade components on the page
     */
    init(): void {
        const elements = document.querySelectorAll<AcceladeHTMLElement>('[data-accelade]');

        elements.forEach((el) => {
            try {
                this.initComponent(el);
            } catch (e) {
                console.error('Accelade: Failed to init component', e);
            }
        });

        // Initialize the router only once
        if (!this.initialized) {
            initRouter();
            this.initialized = true;
        }
    }
}

// Create singleton instance
const acceladeManager = new AcceladeManager();

/**
 * Initialize function
 */
export function init(): void {
    acceladeManager.init();
}

// Progress API object
const progress = {
    configure: configureProgress,
    start: startProgress,
    done: doneProgress,
    instance: getProgress,
};

// Stores API object for accessing global stores
const stores = {
    /**
     * Get a store by name
     */
    get: (name: string): ReactiveState | undefined => globalStores.get(name),

    /**
     * Check if a store exists
     */
    has: (name: string): boolean => globalStores.has(name),

    /**
     * Get all store names
     */
    names: (): string[] => Array.from(globalStores.keys()),

    /**
     * Get all stores
     */
    all: (): Map<string, ReactiveState> => new Map(globalStores),
};

// Export for window
if (typeof window !== 'undefined') {
    // Configure progress from AcceladeConfig if available
    const progressConfig = window.AcceladeConfig?.progress;
    if (progressConfig && Object.keys(progressConfig).length > 0) {
        configureProgress(progressConfig as ProgressConfig);
    }

    // Auto-init on DOMContentLoaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => init());
    } else {
        init();
    }
}

// Export everything including progress and stores
export { navigate, getRouter, initRouter, configureProgress, startProgress, doneProgress, progress, stores };
export default { init, navigate, getRouter, initRouter, configureProgress, startProgress, doneProgress, progress, stores };
</file>

<file path="resources/js/vue/accelade.ts">
/**
 * Accelade Vue.js Integration
 * Uses Vue's reactivity system without runtime compilation
 */

import { reactive, watch, effect, type UnwrapNestedRefs } from 'vue';
import type { AcceladeComponentConfig, AcceladeActions } from '../core/types';
import { initRouter, navigate, getRouter, type NavigationOptions } from '../core/router';
import { getProgress, configureProgress, startProgress, doneProgress, type ProgressConfig } from '../core/progress';

/**
 * Custom methods type
 */
type CustomMethods = Record<string, (...args: unknown[]) => unknown>;

/**
 * Global stores for shared reactive state
 */
const globalStores: Map<string, Record<string, unknown>> = new Map();

/**
 * Extended config with storage keys
 */
interface ExtendedConfig extends AcceladeComponentConfig {
    rememberKey?: string;
    localStorageKey?: string;
    storeName?: string;
}

/**
 * Load state from storage (sessionStorage or localStorage)
 */
function loadFromStorage(key: string, useLocalStorage: boolean): Record<string, unknown> | null {
    try {
        const storage = useLocalStorage ? localStorage : sessionStorage;
        const stored = storage.getItem(`accelade:${key}`);
        if (stored) {
            return JSON.parse(stored) as Record<string, unknown>;
        }
    } catch {
        // Storage not available or invalid data
    }
    return null;
}

/**
 * Save state to storage (sessionStorage or localStorage)
 */
function saveToStorage(key: string, state: Record<string, unknown>, useLocalStorage: boolean): void {
    try {
        const storage = useLocalStorage ? localStorage : sessionStorage;
        storage.setItem(`accelade:${key}`, JSON.stringify(state));
    } catch {
        // Storage not available or quota exceeded
    }
}

/**
 * Get or create a global store
 */
function getOrCreateStore(storeName: string, initialState: Record<string, unknown>): Record<string, unknown> {
    if (globalStores.has(storeName)) {
        return globalStores.get(storeName)!;
    }

    // Create a new store with the initial state
    const store = { ...initialState };
    globalStores.set(storeName, store);
    return store;
}

/**
 * Parse Accelade element data attributes
 */
function parseAcceladeElement(el: HTMLElement): ExtendedConfig {
    const id = el.dataset.acceladeId ?? `accelade-${Math.random().toString(36).slice(2, 10)}`;
    const stateStr = el.dataset.acceladeState ?? '{}';
    const stateJsStr = el.dataset.acceladeStateJs;
    const syncStr = el.dataset.acceladeSync ?? '';
    const rememberKey = el.dataset.acceladeRemember;
    const localStorageKey = el.dataset.acceladeLocalStorage;
    const storeName = el.dataset.acceladeStore;

    let state: Record<string, unknown> = {};

    // First try to parse JSON state
    if (stateStr && stateStr !== '{}') {
        try {
            state = JSON.parse(stateStr) as Record<string, unknown>;
        } catch {
            console.error('Accelade Vue: Invalid state JSON', stateStr);
        }
    }

    // If we have a JS object string (for JavaScript object notation like { count: 0 })
    if (stateJsStr) {
        try {
            // Use Function to evaluate JS object notation
            const evalFn = new Function(`return (${stateJsStr})`) as () => Record<string, unknown>;
            state = evalFn();
        } catch {
            console.error('Accelade Vue: Invalid state JS object', stateJsStr);
        }
    }

    const sync = syncStr ? syncStr.split(',').filter(Boolean) : [];

    return { id, state, sync, rememberKey, localStorageKey, storeName };
}

/**
 * Sync state to server
 */
function syncToServer(componentId: string, property: string, value: unknown): void {
    const config = window.AcceladeConfig;
    const url = config?.updateUrl ?? '/accelade/update';
    const csrfToken = config?.csrfToken ?? '';

    // Show progress bar during sync
    startProgress();

    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-TOKEN': csrfToken,
            'Accept': 'application/json'
        },
        body: JSON.stringify({
            component: componentId,
            property: property,
            value: value
        })
    })
    .then(() => {
        doneProgress();
    })
    .catch((err: unknown) => {
        console.error('Accelade Vue: Sync failed', err);
        doneProgress();
    });
}

/**
 * Process <script v-script>, <accelade-script>, or <accelade:script> blocks
 */
function processScripts(
    el: HTMLElement,
    state: UnwrapNestedRefs<Record<string, unknown>>,
    actions: AcceladeActions,
    originalState: Record<string, unknown>
): CustomMethods {
    const customMethods: CustomMethods = {};

    // Find script elements with v-script attribute, accelade-script tag, or accelade:script tag
    // Note: CSS selector needs escaped colon for accelade:script
    const scriptElements = el.querySelectorAll<HTMLScriptElement>('script[v-script], accelade-script, accelade\\:script');

    scriptElements.forEach((scriptEl) => {
        const code = scriptEl.textContent ?? '';
        if (!code.trim()) return;

        try {
            // Create a function with access to state, actions, and helpers
            const scriptFn = new Function(
                'state',
                'actions',
                '$set',
                '$get',
                '$toggle',
                '$navigate',
                '$watch',
                'originalState',
                code
            ) as (
                state: UnwrapNestedRefs<Record<string, unknown>>,
                actions: AcceladeActions,
                $set: (key: string, value: unknown) => void,
                $get: (key: string) => unknown,
                $toggle: (key: string) => void,
                $navigate: (url: string, options?: NavigationOptions) => Promise<boolean>,
                $watch: (key: string, callback: (newVal: unknown, oldVal: unknown) => void) => void,
                originalState: Record<string, unknown>
            ) => CustomMethods | void;

            // Helper functions
            const $set = (key: string, value: unknown): void => {
                state[key] = value;
            };
            const $get = (key: string): unknown => state[key];
            const $toggle = (key: string): void => {
                state[key] = !state[key];
            };
            const $watch = (key: string, callback: (newVal: unknown, oldVal: unknown) => void): void => {
                watch(() => state[key], callback);
            };

            // Execute and get returned methods
            const result = scriptFn(
                state,
                actions,
                $set,
                $get,
                $toggle,
                navigate,
                $watch,
                originalState
            );

            // If the script returns an object with methods, add them to customMethods
            if (result && typeof result === 'object') {
                Object.assign(customMethods, result);
            }

            // Remove the script element from DOM (already executed)
            scriptEl.remove();
        } catch (e) {
            console.error('Accelade Vue: Error executing script:', e);
        }
    });

    return customMethods;
}

/**
 * Initialize an Accelade Vue component
 */
function initVueComponent(el: HTMLElement, config: ExtendedConfig): void {
    // Determine initial state
    let initialState = { ...config.state };

    // If using a global store, get or create it
    if (config.storeName) {
        const store = getOrCreateStore(config.storeName, initialState);
        initialState = { ...store };
    }

    // If remember key is set, try to load from sessionStorage
    if (config.rememberKey) {
        const storedState = loadFromStorage(config.rememberKey, false);
        if (storedState) {
            initialState = { ...initialState, ...storedState };
        }
    }

    // If localStorage key is set, try to load from localStorage
    if (config.localStorageKey) {
        const storedState = loadFromStorage(config.localStorageKey, true);
        if (storedState) {
            initialState = { ...initialState, ...storedState };
        }
    }

    // Create reactive state
    const state = reactive(initialState) as UnwrapNestedRefs<Record<string, unknown>>;
    const originalState = { ...config.state };

    // Create actions
    const actions: AcceladeActions = {
        increment: (key = 'count', amount = 1): void => {
            const currentValue = state[key];
            state[key] = (parseInt(String(currentValue), 10) || 0) + amount;
        },
        decrement: (key = 'count', amount = 1): void => {
            const currentValue = state[key];
            state[key] = (parseInt(String(currentValue), 10) || 0) - amount;
        },
        set: (key: string, value: unknown): void => {
            state[key] = value;
        },
        toggle: (key: string): void => {
            state[key] = !state[key];
        },
        reset: (key: string): void => {
            const initialValue = originalState[key];
            if (typeof initialValue === 'number') {
                state[key] = 0;
            } else if (typeof initialValue === 'boolean') {
                state[key] = false;
            } else {
                state[key] = '';
            }
        },

        get: (key: string): unknown => {
            return state[key];
        },

        // Aliases with $ prefix for template usage
        $set: (key: string, value: unknown): void => {
            state[key] = value;
        },

        $get: (key: string): unknown => {
            return state[key];
        },

        $toggle: (key: string): void => {
            state[key] = !state[key];
        },

        // Store helper - get a global store by name
        $store: (name: string): Record<string, unknown> | null => {
            return globalStores.get(name) ?? null;
        }
    };

    // Process custom scripts first
    const customMethods = processScripts(el, state, actions, originalState);

    // Bind event handlers (v-on:click, @click)
    bindEventHandlers(el, state, actions, customMethods);

    // Setup reactive effects for v-text, v-show, v-if, v-model
    setupReactiveBindings(el, state);

    // Update the data-accelade-state attribute so MutationObservers can detect changes
    // This is important for lazy loading conditional triggers
    effect(() => {
        el.dataset.acceladeState = JSON.stringify(state);
    });

    // Watch for storage persistence - use effect to track all state changes
    if (config.rememberKey || config.localStorageKey || config.storeName) {
        // Use watch on the reactive state object directly
        watch(
            state,
            () => {
                const currentState = { ...state };

                // Save to sessionStorage if remember key is set
                if (config.rememberKey) {
                    saveToStorage(config.rememberKey, currentState, false);
                }

                // Save to localStorage if localStorage key is set
                if (config.localStorageKey) {
                    saveToStorage(config.localStorageKey, currentState, true);
                }

                // Update global store if this component uses one
                if (config.storeName && globalStores.has(config.storeName)) {
                    const store = globalStores.get(config.storeName)!;
                    Object.assign(store, currentState);
                }
            },
            { deep: true, flush: 'sync' }
        );
    }

    // Watch for sync properties
    if (config.sync.length > 0) {
        config.sync.forEach(prop => {
            watch(
                () => state[prop],
                (newVal: unknown) => {
                    syncToServer(config.id, prop, newVal);
                }
            );
        });
    }

    // Remove cloak and add ready class for smooth reveal
    el.removeAttribute('data-accelade-cloak');
    el.removeAttribute('v-cloak');
    el.classList.add('accelade-ready');
}

/**
 * Bind event handlers
 */
function bindEventHandlers(
    el: HTMLElement,
    state: UnwrapNestedRefs<Record<string, unknown>>,
    actions: AcceladeActions,
    customMethods: CustomMethods
): void {
    const allElements = el.querySelectorAll<HTMLElement>('*');

    allElements.forEach((element) => {
        Array.from(element.attributes).forEach((attr) => {
            // Handle v-on:event and @event syntax
            if (attr.name.startsWith('v-on:') || attr.name.startsWith('@')) {
                const eventName = attr.name.startsWith('@')
                    ? attr.name.slice(1)
                    : attr.name.slice(5);
                const actionExpr = attr.value;

                element.addEventListener(eventName, (e: Event) => {
                    executeAction(actionExpr, state, actions, customMethods, e);
                });
            }
        });
    });
}

/**
 * Execute an action expression
 */
function executeAction(
    expr: string,
    state: UnwrapNestedRefs<Record<string, unknown>>,
    actions: AcceladeActions,
    customMethods: CustomMethods,
    _event: Event
): void {
    // Parse expressions like:
    // - increment('count')
    // - decrement('count')
    // - toggle('showMessage')
    // - customMethod()

    // Try custom method first (for simple method calls)
    if (customMethods[expr]) {
        (customMethods[expr] as (event: Event) => void)(_event);
        return;
    }

    // Handle method('arg') format
    const match = expr.match(/^(\w+)\s*\(\s*['"]?([^'"]*?)['"]?\s*\)$/);
    if (match) {
        const [, method, arg] = match;

        // Check custom methods first
        if (customMethods[method]) {
            (customMethods[method] as (...args: unknown[]) => void)(arg, _event);
            return;
        }

        const actionMethod = actions[method as keyof AcceladeActions];
        if (typeof actionMethod === 'function') {
            (actionMethod as (key: string) => void)(arg);
            return;
        }
    }

    // Try to evaluate as simple expression
    try {
        const fn = new Function('state', 'actions', 'methods', 'event', '$navigate', `
            with (state) {
                with (actions) {
                    with (methods) {
                        ${expr}
                    }
                }
            }
        `) as (
            state: UnwrapNestedRefs<Record<string, unknown>>,
            actions: AcceladeActions,
            methods: CustomMethods,
            event: Event,
            $navigate: typeof navigate
        ) => void;
        fn(state, actions, customMethods, _event, navigate);
    } catch {
        // Action execution failed
    }
}

/**
 * Setup reactive bindings
 */
function setupReactiveBindings(
    el: HTMLElement,
    state: UnwrapNestedRefs<Record<string, unknown>>
): void {
    // v-text binding
    const vTextElements = el.querySelectorAll<HTMLElement>('[v-text]');
    vTextElements.forEach((element) => {
        const prop = element.getAttribute('v-text');
        if (!prop) return;

        effect(() => {
            const value = getNestedValue(state, prop);
            element.textContent = value !== undefined ? String(value) : '';
        });
    });

    // v-show binding
    const vShowElements = el.querySelectorAll<HTMLElement>('[v-show]');
    vShowElements.forEach((element) => {
        const expr = element.getAttribute('v-show');
        if (!expr) return;

        effect(() => {
            const result = evaluateExpression(expr, state);
            element.style.display = result ? '' : 'none';
        });
    });

    // v-if binding
    const vIfElements = el.querySelectorAll<HTMLElement>('[v-if]');
    vIfElements.forEach((element) => {
        const expr = element.getAttribute('v-if');
        if (!expr) return;

        const placeholder = document.createComment('v-if');
        let isInserted = true;

        effect(() => {
            const result = evaluateExpression(expr, state);
            if (result && !isInserted) {
                placeholder.replaceWith(element);
                isInserted = true;
            } else if (!result && isInserted) {
                element.replaceWith(placeholder);
                isInserted = false;
            }
        });
    });

    // v-model binding (two-way)
    const vModelElements = el.querySelectorAll<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>('[v-model]');
    vModelElements.forEach((element) => {
        const prop = element.getAttribute('v-model');
        if (!prop) return;

        const inputElement = element as HTMLInputElement;
        const eventType = (inputElement.type === 'checkbox' || inputElement.type === 'radio') ? 'change' : 'input';

        // Update DOM from state
        effect(() => {
            const value = state[prop];
            if (inputElement.type === 'checkbox') {
                inputElement.checked = Boolean(value);
            } else if (inputElement.type === 'radio') {
                inputElement.checked = inputElement.value === value;
            } else if (element.value !== String(value ?? '')) {
                element.value = value !== undefined ? String(value) : '';
            }
        });

        // Update state from DOM
        element.addEventListener(eventType, () => {
            if (inputElement.type === 'checkbox') {
                state[prop] = inputElement.checked;
            } else if (inputElement.type === 'radio') {
                state[prop] = inputElement.value;
            } else if (inputElement.type === 'number' || inputElement.type === 'range') {
                state[prop] = parseFloat(element.value) || 0;
            } else {
                state[prop] = element.value;
            }
        });
    });

    // v-bind:attr binding
    const allElements = el.querySelectorAll<HTMLElement>('*');
    allElements.forEach((element) => {
        Array.from(element.attributes).forEach((attr) => {
            if (attr.name.startsWith('v-bind:') || (attr.name.startsWith(':') && !attr.name.startsWith('::'))) {
                const attrName = attr.name.startsWith(':')
                    ? attr.name.slice(1)
                    : attr.name.slice(7);
                const expr = attr.value;

                effect(() => {
                    const value = evaluateExpression(expr, state);
                    if (attrName === 'class') {
                        if (typeof value === 'object' && value !== null) {
                            Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                                element.classList.toggle(className, Boolean(condition));
                            });
                        } else {
                            element.setAttribute('class', String(value));
                        }
                    } else if (value === false || value === null || value === undefined) {
                        element.removeAttribute(attrName);
                    } else if (value === true) {
                        element.setAttribute(attrName, '');
                    } else {
                        element.setAttribute(attrName, String(value));
                    }
                });
            }
        });
    });
}

/**
 * Evaluate an expression against state
 */
function evaluateExpression(
    expr: string,
    state: UnwrapNestedRefs<Record<string, unknown>>
): unknown {
    try {
        // Simple property access
        if (/^[\w.]+$/.test(expr)) {
            return getNestedValue(state, expr);
        }

        // Create evaluation function
        const keys = Object.keys(state);
        const values = Object.values(state);
        const fn = new Function(...keys, 'return ' + expr) as (...args: unknown[]) => unknown;
        return fn(...values);
    } catch {
        return undefined;
    }
}

/**
 * Get nested value from object
 */
function getNestedValue(obj: Record<string, unknown>, path: string): unknown {
    return path.split('.').reduce<unknown>(
        (current, key) => {
            if (current !== null && typeof current === 'object') {
                return (current as Record<string, unknown>)[key];
            }
            return undefined;
        },
        obj
    );
}

/**
 * Extended HTMLElement with initialization flag
 */
interface AcceladeHTMLElement extends HTMLElement {
    __accelade_vue_initialized?: boolean;
}

// Module-level initialization guard
let acceladeInitialized = false;

/**
 * Initialize all Accelade components on the page
 */
export function init(): void {
    const elements = document.querySelectorAll<AcceladeHTMLElement>('[data-accelade]');

    elements.forEach((el) => {
        if (el.__accelade_vue_initialized) return;

        const config = parseAcceladeElement(el);

        try {
            initVueComponent(el, config);
            el.__accelade_vue_initialized = true;
        } catch (e) {
            console.error('Accelade Vue: Failed to init component', config.id, e);
        }
    });

    // Initialize the router only once
    if (!acceladeInitialized) {
        initRouter();
        acceladeInitialized = true;
    }
}

// Progress API object
const progress = {
    configure: configureProgress,
    start: startProgress,
    done: doneProgress,
    instance: getProgress,
};

// Stores API object for accessing global stores
const stores = {
    /**
     * Get a store by name
     */
    get: (name: string): Record<string, unknown> | undefined => globalStores.get(name),

    /**
     * Check if a store exists
     */
    has: (name: string): boolean => globalStores.has(name),

    /**
     * Get all store names
     */
    names: (): string[] => Array.from(globalStores.keys()),

    /**
     * Get all stores
     */
    all: (): Map<string, Record<string, unknown>> => new Map(globalStores),
};

// Export for window
if (typeof window !== 'undefined') {
    // Configure progress from AcceladeConfig if available
    const progressConfig = window.AcceladeConfig?.progress;
    if (progressConfig && Object.keys(progressConfig).length > 0) {
        configureProgress(progressConfig as ProgressConfig);
    }

    // Auto-init on DOMContentLoaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => init());
    } else {
        init();
    }
}

// Export everything including progress and stores
export { navigate, getRouter, initRouter, configureProgress, startProgress, doneProgress, progress, stores };
export default { init, navigate, getRouter, initRouter, configureProgress, startProgress, doneProgress, progress, stores };
</file>

<file path=".github/workflows/fix-php-code-styling.yml">
name: Fix PHP Code Styling

on:
  push:
    branches: [main, develop]
    paths:
      - '**.php'
  pull_request:
    branches: [main, develop]
    paths:
      - '**.php'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  php-code-styling:
    runs-on: ubuntu-latest
    name: Fix PHP Code Styling

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.3'
          extensions: dom, curl, libxml, mbstring, zip
          coverage: none

      - name: Get Composer cache directory
        id: composer-cache
        run: echo "dir=$(composer config cache-files-dir)" >> $GITHUB_OUTPUT

      - name: Cache Composer dependencies
        uses: actions/cache@v4
        with:
          path: ${{ steps.composer-cache.outputs.dir }}
          key: ${{ runner.os }}-composer-${{ hashFiles('composer.lock') }}
          restore-keys: ${{ runner.os }}-composer-

      - name: Install dependencies
        run: composer install --prefer-dist --no-interaction --no-progress

      - name: Run Laravel Pint
        run: ./vendor/bin/pint

      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "style: fix PHP code styling"
          commit_user_name: "GitHub Actions"
          commit_user_email: "actions@github.com"
          commit_author: "GitHub Actions <actions@github.com>"
          skip_dirty_check: false
</file>

<file path="config/accelade.php">
<?php

return [
    /*
    |--------------------------------------------------------------------------
    | Frontend Framework
    |--------------------------------------------------------------------------
    |
    | Specify which frontend framework to use with Accelade. Choose between
    | 'vue' or 'react'. This determines which pre-compiled assets will be
    | served to the browser.
    |
    */
    'framework' => env('ACCELADE_FRAMEWORK', 'vanilla'),

    /*
    |--------------------------------------------------------------------------
    | Asset Serving Mode
    |--------------------------------------------------------------------------
    |
    | Determines how Accelade serves its JavaScript assets.
    | 'route' - Serve via Laravel route (default, no publishing needed)
    | 'published' - Serve from published assets in public/vendor/accelade
    |
    */
    'asset_mode' => env('ACCELADE_ASSET_MODE', 'route'),

    /*
    |--------------------------------------------------------------------------
    | Route Prefix
    |--------------------------------------------------------------------------
    |
    | The URL prefix for Accelade routes (asset serving and AJAX sync).
    |
    */
    'prefix' => 'accelade',

    /*
    |--------------------------------------------------------------------------
    | Middleware
    |--------------------------------------------------------------------------
    |
    | Middleware to apply to Accelade routes.
    |
    */
    'middleware' => ['web'],

    /*
    |--------------------------------------------------------------------------
    | State TTL
    |--------------------------------------------------------------------------
    |
    | Time-to-live in seconds for server-synced component state.
    | Default is 1 hour (3600 seconds).
    |
    */
    'state_ttl' => env('ACCELADE_STATE_TTL', 3600),

    /*
    |--------------------------------------------------------------------------
    | Flash Data Sharing
    |--------------------------------------------------------------------------
    |
    | Automatically share Laravel's session flash data with the frontend.
    | When enabled, flash data is available via the <x-accelade::flash>
    | component and Accelade::shared()->get('flash').
    |
    | Options:
    | - enabled: Enable/disable automatic flash data sharing (default: true)
    | - keys: Array of flash keys to share, or null for all (default: null)
    |
    */
    'flash' => [
        'enabled' => env('ACCELADE_FLASH_ENABLED', true),
        'keys' => null, // null = all keys, or ['message', 'success', 'error', etc.]
    ],

    /*
    |--------------------------------------------------------------------------
    | Sync Debounce
    |--------------------------------------------------------------------------
    |
    | Debounce time in milliseconds for server sync requests.
    | Prevents excessive server calls during rapid state changes.
    |
    */
    'sync_debounce' => env('ACCELADE_SYNC_DEBOUNCE', 300),

    /*
    |--------------------------------------------------------------------------
    | Navigation Configuration
    |--------------------------------------------------------------------------
    |
    | Configure SPA navigation behavior including page state caching.
    |
    | Available options:
    | - max_keep_alive: Maximum number of pages to keep in memory (default: 10)
    |   Set to 0 to disable page state caching
    | - transition_duration: Page transition animation duration in ms (default: 150)
    | - preserve_scroll: Default scroll behavior after navigation (default: false)
    |
    */
    'navigation' => [
        'max_keep_alive' => env('ACCELADE_MAX_KEEP_ALIVE', 10),
        'transition_duration' => env('ACCELADE_TRANSITION_DURATION', 150),
        'preserve_scroll' => env('ACCELADE_PRESERVE_SCROLL', false),
    ],

    /*
    |--------------------------------------------------------------------------
    | Progress Bar Configuration
    |--------------------------------------------------------------------------
    |
    | Customize the SPA navigation progress bar appearance.
    | All options are optional - defaults will be used if not specified.
    |
    | Available options:
    | - delay: Delay in ms before showing progress bar (default: 250)
    | - color: Progress bar primary color (default: '#6366f1')
    | - gradientColor: Secondary gradient color (default: '#8b5cf6')
    | - gradientColor2: Third gradient color (default: '#a855f7')
    | - useGradient: Use gradient colors (default: true)
    | - height: Progress bar height in pixels (default: 3)
    | - showBar: Show progress bar (default: true)
    | - includeSpinner: Include spinner indicator (default: true)
    | - spinnerSize: Spinner size in pixels (default: 18)
    | - spinnerPosition: 'top-left', 'top-right', 'bottom-left', 'bottom-right' (default: 'top-right')
    | - position: 'top' or 'bottom' (default: 'top')
    | - minimum: Minimum progress percentage on start (default: 8)
    | - easing: Animation easing function (default: 'ease-out')
    | - speed: Animation speed in ms (default: 200)
    | - trickleSpeed: How fast progress trickles (default: 200)
    | - zIndex: Z-index for the progress bar (default: 99999)
    |
    */
    'progress' => [
        'color' => '#6366f1',
        'gradientColor' => '#8b5cf6',
        'gradientColor2' => '#a855f7',
        'height' => 3,
        'showBar' => true,
        'includeSpinner' => true,
        'spinnerPosition' => 'top-right',
        'position' => 'top',
    ],

    /*
    |--------------------------------------------------------------------------
    | Documentation Portal
    |--------------------------------------------------------------------------
    |
    | Configuration for the Accelade documentation portal with live demos.
    |
    | Options:
    | - enabled: Enable/disable docs routes (default: false in production)
    | - prefix: URL prefix for docs routes (default: 'docs')
    | - middleware: Middleware to apply to docs routes (default: ['web'])
    | - github_repo: GitHub repository for "Edit on GitHub" links
    |
    */
    'docs' => [
        'enabled' => env('ACCELADE_DOCS_ENABLED', env('APP_ENV') !== 'production'),
        'prefix' => env('ACCELADE_DOCS_PREFIX', 'docs'),
        'middleware' => ['web'],
        'github_repo' => 'accelade/accelade',
    ],

    /*
    |--------------------------------------------------------------------------
    | Testing Configuration
    |--------------------------------------------------------------------------
    |
    | Configuration for running Accelade's test suite.
    |
    | Options:
    | - base_url: Base URL for E2E tests (default: APP_URL)
    |
    */
    'testing' => [
        'base_url' => env('ACCELADE_TEST_URL', env('APP_URL', 'http://localhost')),
    ],

    /*
    |--------------------------------------------------------------------------
    | Error Handling Configuration
    |--------------------------------------------------------------------------
    |
    | Configure how Accelade handles errors in the browser.
    |
    | Options:
    | - suppress_errors: In production, show toast notifications instead of
    |   throwing errors that may cause blank pages (default: true in production)
    | - show_toasts: Show toast notifications for errors (default: true)
    | - log_errors: Log errors to browser console (default: true)
    | - debug: Include debug information in error responses (uses APP_DEBUG)
    |
    */
    'errors' => [
        'suppress_errors' => env('ACCELADE_SUPPRESS_ERRORS', env('APP_ENV') === 'production'),
        'show_toasts' => env('ACCELADE_ERROR_TOASTS', true),
        'log_errors' => env('ACCELADE_LOG_ERRORS', true),
        'debug' => env('APP_DEBUG', false),
    ],

    /*
    |--------------------------------------------------------------------------
    | SEO Configuration
    |--------------------------------------------------------------------------
    |
    | Configure default SEO values, title formatting, OpenGraph and Twitter
    | card settings. These values are used by the SEO facade.
    |
    */
    'seo' => [
        /*
        |--------------------------------------------------------------------------
        | Default Values
        |--------------------------------------------------------------------------
        |
        | Default SEO values used when no specific values are set.
        |
        */
        'defaults' => [
            'title' => null,
            'description' => null,
            'keywords' => [],
        ],

        /*
        |--------------------------------------------------------------------------
        | Title Configuration
        |--------------------------------------------------------------------------
        |
        | Configure how the page title is formatted.
        | - title_separator: Separator between title parts (e.g., " | ")
        | - title_prefix: Text prepended to the title (optional)
        | - title_suffix: Text appended to the title (e.g., site name)
        |
        */
        'title_separator' => ' | ',
        'title_prefix' => null,
        'title_suffix' => null,

        /*
        |--------------------------------------------------------------------------
        | Canonical URL
        |--------------------------------------------------------------------------
        |
        | Automatically generate canonical URL from the current request URL.
        | Set to false to disable automatic canonical link generation.
        |
        */
        'auto_canonical_link' => true,

        /*
        |--------------------------------------------------------------------------
        | OpenGraph Configuration
        |--------------------------------------------------------------------------
        |
        | Configure OpenGraph (Facebook/LinkedIn) meta tags.
        | - auto_fill: Automatically fill OG title/description from main SEO values
        | - defaults: Default OpenGraph values
        |
        */
        'open_graph' => [
            'auto_fill' => true,
            'defaults' => [
                'type' => 'website',
                'site_name' => null,
                'locale' => null,
            ],
        ],

        /*
        |--------------------------------------------------------------------------
        | Twitter Card Configuration
        |--------------------------------------------------------------------------
        |
        | Configure Twitter Card meta tags.
        | - auto_fill: Automatically fill Twitter title/description from main SEO
        | - defaults: Default Twitter card values
        |
        */
        'twitter' => [
            'auto_fill' => true,
            'defaults' => [
                'card' => 'summary_large_image',
                'site' => null,
                'creator' => null,
            ],
        ],
    ],
];
</file>

<file path="resources/js/adapters/vue/VueBindingAdapter.ts">
/**
 * VueBindingAdapter - Vue reactive DOM bindings using effect()
 */

import { effect, type ReactiveEffectRunner } from 'vue';
import type { IBindingAdapter, IStateAdapter, CleanupFn } from '../types';
import type { AcceladeActions } from '../../core/types';
import type { CustomMethods } from '../../core/factories/ScriptExecutor';
import { ScriptExecutor } from '../../core/factories/ScriptExecutor';
import {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    parseClassObject,
    getNestedValue,
} from '../../core/expressions';

/**
 * Binding cleanup record
 */
interface BindingRecord {
    element: HTMLElement;
    type: string;
    cleanup: CleanupFn;
}

/**
 * Animation configuration for show bindings
 */
interface AnimationConfig {
    enter: string;
    enterFrom: string;
    enterTo: string;
    leave: string;
    leaveFrom: string;
    leaveTo: string;
}

/**
 * VueBindingAdapter - Uses Vue's effect() for reactive bindings
 */
export class VueBindingAdapter implements IBindingAdapter {
    private element: HTMLElement | null = null;
    private stateAdapter: IStateAdapter | null = null;
    private bindings: BindingRecord[] = [];
    private effects: ReactiveEffectRunner[] = [];
    private eventListeners: Array<{ element: HTMLElement; event: string; handler: EventListener }> = [];
    private ifPlaceholders: Map<HTMLElement, Comment> = new Map();
    private modelBound: WeakSet<Element> = new WeakSet();

    /**
     * Initialize the binding adapter
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void {
        this.element = element;
        this.stateAdapter = stateAdapter;
    }

    /**
     * Get reactive state from Vue adapter
     */
    private getReactiveState(): Record<string, unknown> {
        return this.stateAdapter?.getReactiveState() as Record<string, unknown> ?? {};
    }

    /**
     * Bind text content with Vue effect
     */
    bindText(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();

        const runner = effect(() => {
            // Use evaluateStringExpression to support expressions like "name || 'default'"
            const value = evaluateStringExpression(expression, state);
            element.textContent = value;
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'text',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Bind HTML content with Vue effect
     */
    bindHtml(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();

        const runner = effect(() => {
            // Use evaluateStringExpression to support expressions
            const value = evaluateStringExpression(expression, state);
            element.innerHTML = value;
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'html',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Bind visibility with Vue effect and smooth transitions
     */
    bindShow(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();
        const originalDisplay = element.style.display || '';
        let isFirstRun = true;

        // Check for animation config from parent toggle
        let animation: AnimationConfig | undefined;
        const toggleParent = element.closest('[data-toggle-animation]');
        if (toggleParent) {
            try {
                const animData = toggleParent.getAttribute('data-toggle-animation');
                if (animData) {
                    animation = JSON.parse(animData);
                }
            } catch {
                // Invalid JSON, skip animation
            }
        }

        const runner = effect(() => {
            const visible = evaluateBooleanExpression(expression, state);
            const isCurrentlyHidden = element.style.display === 'none';

            if (animation) {
                // Use custom animation classes
                if (visible && isCurrentlyHidden) {
                    // Enter animation
                    element.style.display = originalDisplay;
                    this.addClasses(element, animation.enter);
                    this.addClasses(element, animation.enterFrom);
                    // Force reflow
                    void element.offsetHeight;
                    // Transition to enterTo
                    this.removeClasses(element, animation.enterFrom);
                    this.addClasses(element, animation.enterTo);
                    // Cleanup after animation
                    const duration = this.getAnimationDuration(animation.enter);
                    setTimeout(() => {
                        this.removeClasses(element, animation.enter);
                    }, duration);
                } else if (!visible && !isCurrentlyHidden) {
                    // Leave animation
                    this.removeClasses(element, animation.enterTo);
                    this.addClasses(element, animation.leave);
                    this.addClasses(element, animation.leaveFrom);
                    // Force reflow
                    void element.offsetHeight;
                    // Transition to leaveTo
                    this.removeClasses(element, animation.leaveFrom);
                    this.addClasses(element, animation.leaveTo);
                    // Hide after animation
                    const duration = this.getAnimationDuration(animation.leave);
                    setTimeout(() => {
                        if (element.classList.contains(animation.leaveTo.split(/\s+/)[0])) {
                            element.style.display = 'none';
                            this.removeClasses(element, animation.leave);
                            this.removeClasses(element, animation.leaveTo);
                        }
                    }, duration);
                } else if (isFirstRun && !visible) {
                    // Initial hide without animation
                    element.style.display = 'none';
                } else if (isFirstRun && visible) {
                    // Initial show without animation
                    this.addClasses(element, animation.enterTo);
                }
            } else {
                // Default simple animation
                if (visible) {
                    // Show: first set display, then animate in
                    if (isCurrentlyHidden) {
                        element.style.display = originalDisplay;
                        // Force reflow to ensure transition works
                        void element.offsetHeight;
                    }
                    element.classList.remove('accelade-hiding');
                    element.classList.add('accelade-visible');
                } else {
                    if (isFirstRun) {
                        // Skip transition on initial hide - just hide immediately
                        element.style.display = 'none';
                    } else if (!isCurrentlyHidden) {
                        // Animate out, then set display:none after transition
                        element.classList.add('accelade-hiding');
                        element.classList.remove('accelade-visible');
                        setTimeout(() => {
                            // Only hide if still supposed to be hidden
                            if (element.classList.contains('accelade-hiding')) {
                                element.style.display = 'none';
                            }
                        }, 200); // Match CSS transition duration
                    }
                }
            }
            isFirstRun = false;
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'show',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Helper to add space-separated classes
     */
    private addClasses(element: HTMLElement, classes: string): void {
        classes.split(/\s+/).filter(c => c).forEach(c => element.classList.add(c));
    }

    /**
     * Helper to remove space-separated classes
     */
    private removeClasses(element: HTMLElement, classes: string): void {
        classes.split(/\s+/).filter(c => c).forEach(c => element.classList.remove(c));
    }

    /**
     * Extract duration from Tailwind duration class
     */
    private getAnimationDuration(classes: string): number {
        const match = classes.match(/duration-(\d+)/);
        if (match) {
            return parseInt(match[1], 10);
        }
        return 200; // Default fallback
    }

    /**
     * Bind conditional rendering with Vue effect
     */
    bindIf(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();
        const placeholder = document.createComment('v-if');
        this.ifPlaceholders.set(element, placeholder);
        let isInserted = true;

        const runner = effect(() => {
            const result = evaluateBooleanExpression(expression, state);

            if (result && !isInserted) {
                placeholder.replaceWith(element);
                isInserted = true;
            } else if (!result && isInserted && element.parentNode) {
                element.replaceWith(placeholder);
                isInserted = false;
            }
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'if',
            cleanup: () => {
                runner.effect.stop();
                this.ifPlaceholders.delete(element);
            },
        });
    }

    /**
     * Bind two-way input with Vue effect
     */
    bindModel(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (this.modelBound.has(element)) return;
        this.modelBound.add(element);

        const state = this.getReactiveState();
        const inputElement = element as HTMLInputElement;
        const isCheckbox = inputElement.type === 'checkbox';
        const isRadio = inputElement.type === 'radio';
        const isNumber = inputElement.type === 'number' || inputElement.type === 'range';
        const eventType = isCheckbox || isRadio ? 'change' : 'input';

        // Update DOM from state using Vue effect
        const runner = effect(() => {
            // Use getNestedValue to support nested paths like "props.count"
            const value = getNestedValue(state as Record<string, unknown>, property);

            if (isCheckbox) {
                inputElement.checked = Boolean(value);
            } else if (isRadio) {
                inputElement.checked = inputElement.value === value;
            } else if (element.value !== String(value ?? '')) {
                element.value = value !== undefined ? String(value) : '';
            }
        });

        // Update state from DOM
        const updateState = () => {
            if (!this.stateAdapter) return;

            if (isCheckbox) {
                this.stateAdapter.set(property, inputElement.checked);
            } else if (isRadio) {
                this.stateAdapter.set(property, inputElement.value);
            } else if (isNumber) {
                this.stateAdapter.set(property, parseFloat(element.value) || 0);
            } else {
                this.stateAdapter.set(property, element.value);
            }
        };

        element.addEventListener(eventType, updateState);
        this.eventListeners.push({ element, event: eventType, handler: updateState });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'model',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Bind attribute with Vue effect
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void {
        const state = this.getReactiveState();

        const runner = effect(() => {
            const value = evaluateExpression(expression, state);

            if (attr === 'class') {
                if (typeof value === 'object' && value !== null) {
                    Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                        element.classList.toggle(className, Boolean(condition));
                    });
                } else {
                    element.setAttribute('class', String(value));
                }
            } else if (value === false || value === null || value === undefined) {
                element.removeAttribute(attr);
            } else if (value === true) {
                element.setAttribute(attr, '');
            } else {
                element.setAttribute(attr, String(value));
            }
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: `attr:${attr}`,
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Bind event handler
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void {
        const state = this.getReactiveState();

        // Parse event modifiers (e.g., click.prevent.stop -> click with prevent and stop modifiers)
        const parts = event.split('.');
        const eventName = parts[0];
        const modifiers = new Set(parts.slice(1));

        const listener = (e: Event) => {
            // Apply modifiers
            if (modifiers.has('prevent')) {
                e.preventDefault();
            }
            if (modifiers.has('stop')) {
                e.stopPropagation();
            }

            // Handle keyboard modifiers for keydown/keyup events
            if (e instanceof KeyboardEvent) {
                if (modifiers.has('enter') && e.key !== 'Enter') return;
                if (modifiers.has('escape') && e.key !== 'Escape') return;
                if (modifiers.has('tab') && e.key !== 'Tab') return;
                if (modifiers.has('space') && e.key !== ' ') return;
                if (modifiers.has('up') && e.key !== 'ArrowUp') return;
                if (modifiers.has('down') && e.key !== 'ArrowDown') return;
                if (modifiers.has('left') && e.key !== 'ArrowLeft') return;
                if (modifiers.has('right') && e.key !== 'ArrowRight') return;
            }

            // Handle mouse button modifiers
            if (e instanceof MouseEvent) {
                if (modifiers.has('left') && e.button !== 0) return;
                if (modifiers.has('middle') && e.button !== 1) return;
                if (modifiers.has('right') && e.button !== 2) return;
            }

            // Handle modifier key requirements
            if (e instanceof KeyboardEvent || e instanceof MouseEvent) {
                if (modifiers.has('ctrl') && !e.ctrlKey) return;
                if (modifiers.has('alt') && !e.altKey) return;
                if (modifiers.has('shift') && !e.shiftKey) return;
                if (modifiers.has('meta') && !e.metaKey) return;
            }

            ScriptExecutor.executeAction(handler, state, actions, customMethods, e);
        };

        // Handle 'once' modifier
        const options: AddEventListenerOptions = {};
        if (modifiers.has('once')) {
            options.once = true;
        }
        if (modifiers.has('passive')) {
            options.passive = true;
        }
        if (modifiers.has('capture')) {
            options.capture = true;
        }

        element.addEventListener(eventName, listener, options);
        this.eventListeners.push({ element, event: eventName, handler: listener });
    }

    /**
     * Bind class object with Vue effect
     */
    bindClass(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();

        const runner = effect(() => {
            const classObj = parseClassObject(expression, state);
            Object.entries(classObj).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'class',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Bind style object with Vue effect
     */
    bindStyle(element: HTMLElement, expression: string): void {
        const state = this.getReactiveState();

        const runner = effect(() => {
            const value = evaluateExpression(expression, state);

            if (typeof value === 'object' && value !== null) {
                Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                    element.style.setProperty(prop, val);
                });
            }
        });

        this.effects.push(runner);
        this.bindings.push({
            element,
            type: 'style',
            cleanup: () => runner.effect.stop(),
        });
    }

    /**
     * Update all bindings (no-op for Vue - effects handle updates automatically)
     */
    update(): void {
        // Vue's effect() automatically tracks dependencies and re-runs when state changes
        // No manual update needed
    }

    /**
     * Dispose all bindings and effects
     */
    dispose(): void {
        // Stop all Vue effects
        for (const runner of this.effects) {
            runner.effect.stop();
        }
        this.effects = [];

        // Remove event listeners
        for (const { element, event, handler } of this.eventListeners) {
            element.removeEventListener(event, handler);
        }
        this.eventListeners = [];

        // Run cleanup functions
        for (const binding of this.bindings) {
            binding.cleanup();
        }
        this.bindings = [];

        // Clear placeholders
        this.ifPlaceholders.clear();

        // Clear references
        this.element = null;
        this.stateAdapter = null;
    }
}

export default VueBindingAdapter;
</file>

<file path="src/AcceladeServiceProvider.php">
<?php

declare(strict_types=1);

namespace Accelade;

use Accelade\Animation\AnimationManager;
use Accelade\Bridge\BridgeManager;
use Accelade\Compilers\AcceladeTagCompiler;
use Accelade\Console\InstallCommand;
use Accelade\Docs\DocsRegistry;
use Accelade\Notification\NotificationManager;
use Accelade\SEO\SEO;
use Illuminate\Support\Facades\Blade;
use Illuminate\Support\Facades\Route;
use Illuminate\Support\ServiceProvider;

class AcceladeServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        $this->mergeConfigFrom(__DIR__.'/../config/accelade.php', 'accelade');

        $this->app->singleton('accelade', function ($app) {
            return new Accelade($app);
        });

        $this->app->singleton('accelade.notify', function ($app) {
            $manager = new NotificationManager;
            if ($app->bound('session.store')) {
                $manager->setSession($app['session.store']);
            }

            return $manager;
        });

        $this->app->singleton('accelade.seo', function () {
            return new SEO;
        });

        $this->app->singleton('accelade.animation', function () {
            return new AnimationManager;
        });

        $this->app->singleton('accelade.bridge', function () {
            return new BridgeManager;
        });

        $this->app->singleton('accelade.docs', function () {
            return new DocsRegistry;
        });

        // Bind the class to the singleton alias for dependency injection
        $this->app->alias('accelade.docs', DocsRegistry::class);
    }

    public function boot(): void
    {
        $this->registerBladeDirectives();
        $this->registerBladePrecompiler();
        $this->registerComponents();
        $this->registerRoutes();
        $this->registerPublishing();
        $this->registerCommands();
        $this->registerDefaultDocs();

        $this->loadViewsFrom(__DIR__.'/../resources/views', 'accelade');
    }

    protected function registerBladeDirectives(): void
    {
        // @acceladeScripts - Include the JavaScript
        Blade::directive('acceladeScripts', function () {
            return "<?php echo app('accelade')->scripts(); ?>";
        });

        // @acceladeStyles - Include any CSS
        Blade::directive('acceladeStyles', function () {
            return "<?php echo app('accelade')->styles(); ?>";
        });

        // @accelade - Start an inline reactive block
        Blade::directive('accelade', function ($expression) {
            if (empty($expression)) {
                return "<?php app('accelade')->startComponent(); ?>";
            }

            return "<?php app('accelade')->startComponent({$expression}); ?>";
        });

        // @endaccelade - End inline reactive block
        Blade::directive('endaccelade', function () {
            return "<?php echo app('accelade')->endComponent(); ?>";
        });

        // @acceladeComponent - Internal directive for compiled components
        Blade::directive('acceladeComponent', function ($expression) {
            return "<?php app('accelade')->startComponentFromTag({$expression}); ?>";
        });

        // @endacceladeComponent - End compiled component
        Blade::directive('endacceladeComponent', function () {
            return "<?php echo app('accelade')->endComponentFromTag(); ?>";
        });

        // @acceladeNotifications - Render notifications container
        Blade::directive('acceladeNotifications', function () {
            return "<?php echo view('accelade::components.notifications')->render(); ?>";
        });

        // SEO Directives
        $this->registerSeoDirectives();
    }

    protected function registerSeoDirectives(): void
    {
        // @seoTitle('Title') - Set the page title
        Blade::directive('seoTitle', function ($expression) {
            return "<?php app('accelade.seo')->title({$expression}); ?>";
        });

        // @seoDescription('Description') - Set the page description
        Blade::directive('seoDescription', function ($expression) {
            return "<?php app('accelade.seo')->description({$expression}); ?>";
        });

        // @seoKeywords('keyword1, keyword2') - Set the page keywords
        Blade::directive('seoKeywords', function ($expression) {
            return "<?php app('accelade.seo')->keywords({$expression}); ?>";
        });

        // @seoCanonical('url') - Set the canonical URL
        Blade::directive('seoCanonical', function ($expression) {
            return "<?php app('accelade.seo')->canonical({$expression}); ?>";
        });

        // @seoRobots('index, follow') - Set the robots meta tag
        Blade::directive('seoRobots', function ($expression) {
            return "<?php app('accelade.seo')->robots({$expression}); ?>";
        });

        // @seoAuthor('Author Name') - Set the author meta tag
        Blade::directive('seoAuthor', function ($expression) {
            return "<?php app('accelade.seo')->author({$expression}); ?>";
        });

        // @seoOpenGraph(['type' => 'article', ...]) - Set OpenGraph data
        Blade::directive('seoOpenGraph', function ($expression) {
            return "<?php
                \$__seoOgData = {$expression};
                \$__seo = app('accelade.seo');
                if (isset(\$__seoOgData['type'])) \$__seo->openGraphType(\$__seoOgData['type']);
                if (isset(\$__seoOgData['site_name'])) \$__seo->openGraphSiteName(\$__seoOgData['site_name']);
                if (isset(\$__seoOgData['title'])) \$__seo->openGraphTitle(\$__seoOgData['title']);
                if (isset(\$__seoOgData['description'])) \$__seo->openGraphDescription(\$__seoOgData['description']);
                if (isset(\$__seoOgData['url'])) \$__seo->openGraphUrl(\$__seoOgData['url']);
                if (isset(\$__seoOgData['image'])) \$__seo->openGraphImage(\$__seoOgData['image'], \$__seoOgData['image_alt'] ?? null);
                if (isset(\$__seoOgData['locale'])) \$__seo->openGraphLocale(\$__seoOgData['locale']);
            ?>";
        });

        // @seoTwitter(['card' => 'summary_large_image', ...]) - Set Twitter Card data
        Blade::directive('seoTwitter', function ($expression) {
            return "<?php
                \$__seoTwitterData = {$expression};
                \$__seo = app('accelade.seo');
                if (isset(\$__seoTwitterData['card'])) \$__seo->twitterCard(\$__seoTwitterData['card']);
                if (isset(\$__seoTwitterData['site'])) \$__seo->twitterSite(\$__seoTwitterData['site']);
                if (isset(\$__seoTwitterData['creator'])) \$__seo->twitterCreator(\$__seoTwitterData['creator']);
                if (isset(\$__seoTwitterData['title'])) \$__seo->twitterTitle(\$__seoTwitterData['title']);
                if (isset(\$__seoTwitterData['description'])) \$__seo->twitterDescription(\$__seoTwitterData['description']);
                if (isset(\$__seoTwitterData['image'])) \$__seo->twitterImage(\$__seoTwitterData['image'], \$__seoTwitterData['image_alt'] ?? null);
            ?>";
        });

        // @seoMeta('name', 'content') - Add a custom meta tag by name
        Blade::directive('seoMeta', function ($expression) {
            return "<?php app('accelade.seo')->metaByName({$expression}); ?>";
        });

        // @seo - Output all SEO meta tags (place in <head>)
        Blade::directive('seo', function () {
            return "<?php echo app('accelade.seo')->toHtml(); ?>";
        });
    }

    protected function registerBladePrecompiler(): void
    {
        // Precompiler transforms <x-accelade:component> tags before standard Blade compilation
        Blade::precompiler(function (string $template) {
            return (new AcceladeTagCompiler($this->app))->compile($template);
        });
    }

    protected function registerComponents(): void
    {
        // Register accelade:: component namespace
        Blade::componentNamespace('Accelade\\Components', 'accelade');
    }

    protected function registerRoutes(): void
    {
        // Core Accelade routes
        Route::group([
            'prefix' => config('accelade.prefix', 'accelade'),
            'middleware' => config('accelade.middleware', ['web']),
        ], function () {
            $this->loadRoutesFrom(__DIR__.'/../routes/web.php');
        });

        // Bridge routes (always enabled)
        $this->loadRoutesFrom(__DIR__.'/../routes/bridge.php');

        // Docs routes (configurable)
        $this->registerDocsRoutes();
    }

    protected function registerDocsRoutes(): void
    {
        if (! config('accelade.docs.enabled', false)) {
            return;
        }

        Route::group([
            'prefix' => config('accelade.docs.prefix', 'docs'),
            'middleware' => config('accelade.docs.middleware', ['web']),
        ], function () {
            $this->loadRoutesFrom(__DIR__.'/../routes/docs.php');
        });
    }

    protected function registerPublishing(): void
    {
        if ($this->app->runningInConsole()) {
            // Publish config
            $this->publishes([
                __DIR__.'/../config/accelade.php' => config_path('accelade.php'),
            ], 'accelade-config');

            // Publish assets
            $this->publishes([
                __DIR__.'/../dist' => public_path('vendor/accelade'),
            ], 'accelade-assets');

            // Publish views
            $this->publishes([
                __DIR__.'/../resources/views' => resource_path('views/vendor/accelade'),
            ], 'accelade-views');
        }
    }

    protected function registerCommands(): void
    {
        if ($this->app->runningInConsole()) {
            $this->commands([
                InstallCommand::class,
            ]);
        }
    }

    protected function registerDefaultDocs(): void
    {
        /** @var DocsRegistry $docs */
        $docs = $this->app->make('accelade.docs');

        // Register Accelade package path
        $docs->registerPackage('accelade', __DIR__.'/../docs');

        // Register navigation groups
        $docs->registerGroup('getting-started', 'Getting Started', 'book', 10);
        $docs->registerGroup('components', 'Components', 'cube', 20);
        $docs->registerGroup('data', 'Data & State', 'database', 30);
        $docs->registerGroup('navigation', 'Navigation', 'arrow-right', 40);
        $docs->registerGroup('advanced', 'Advanced', 'cog', 50);
        $docs->registerGroup('resources', 'Resources', 'folder', 60);

        // Register sections by group
        $this->registerGettingStartedDocs($docs);
        $this->registerComponentsDocs($docs);
        $this->registerDataDocs($docs);
        $this->registerNavigationDocs($docs);
        $this->registerAdvancedDocs($docs);
        $this->registerResourcesDocs($docs);
    }

    protected function registerGettingStartedDocs(DocsRegistry $docs): void
    {
        $docs->section('getting-started')->label('Getting Started')->markdown('getting-started.md')->demo()->inGroup('getting-started')->register();
        $docs->section('installation')->label('Installation')->markdown('installation.md')->inGroup('getting-started')->register();
        $docs->section('configuration')->label('Configuration')->markdown('configuration.md')->inGroup('getting-started')->register();
    }

    protected function registerComponentsDocs(DocsRegistry $docs): void
    {
        $docs->section('counter')->label('Counter Demo')->markdown('components.md')->demo()->inGroup('components')->register();
        $docs->section('data')->label('Data Component')->markdown('data.md')->demo()->inGroup('components')->register();
        $docs->section('state')->label('State Management')->markdown('state.md')->demo()->inGroup('components')->register();
        $docs->section('modal')->label('Modal')->markdown('modal.md')->demo()->inGroup('components')->register();
        $docs->section('toggle')->label('Toggle')->markdown('toggle.md')->demo()->inGroup('components')->register();
        $docs->section('transition')->label('Transitions')->markdown('animations.md')->demo()->inGroup('components')->register();
        $docs->section('notifications')->label('Notifications')->markdown('notifications.md')->demo()->inGroup('components')->register();
        $docs->section('code-block')->label('Code Block')->markdown('code-block.md')->demo()->inGroup('components')->register();
    }

    protected function registerDataDocs(DocsRegistry $docs): void
    {
        $docs->section('lazy')->label('Lazy Loading')->markdown('lazy-loading.md')->demo()->inGroup('data')->register();
        $docs->section('defer')->label('Defer')->markdown('content.md')->demo()->inGroup('data')->register();
        $docs->section('content')->label('Content')->markdown('content.md')->demo()->inGroup('data')->register();
        $docs->section('rehydrate')->label('Rehydrate')->markdown('rehydrate.md')->demo()->inGroup('data')->register();
        $docs->section('teleport')->label('Teleport')->markdown('teleport.md')->demo()->inGroup('data')->register();
    }

    protected function registerNavigationDocs(DocsRegistry $docs): void
    {
        $docs->section('navigation')->label('SPA Navigation')->markdown('spa-navigation.md')->demo()->inGroup('navigation')->register();
        $docs->section('link')->label('Link Component')->markdown('link.md')->demo()->inGroup('navigation')->register();
        $docs->section('progress')->label('Progress Bar')->markdown('spa-navigation.md')->demo()->inGroup('navigation')->register();
        $docs->section('persistent')->label('Persistent Layout')->markdown('persistent-layout.md')->demo()->inGroup('navigation')->register();
    }

    protected function registerAdvancedDocs(DocsRegistry $docs): void
    {
        $docs->section('event-bus')->label('Event Bus')->markdown('event-bus.md')->demo()->inGroup('advanced')->register();
        $docs->section('event')->label('Event Component')->markdown('event.md')->demo()->inGroup('advanced')->register();
        $docs->section('bridge')->label('Bridge (PHP/JS)')->markdown('bridge.md')->demo()->inGroup('advanced')->register();
        $docs->section('shared-data')->label('Shared Data')->markdown('shared-data.md')->demo()->inGroup('advanced')->register();
        $docs->section('flash')->label('Flash Messages')->markdown('flash.md')->demo()->inGroup('advanced')->register();
        $docs->section('errors')->label('Error Handling')->markdown('exception-handling.md')->demo()->inGroup('advanced')->register();
        $docs->section('scripts')->label('Scripts')->markdown('scripts.md')->demo()->inGroup('advanced')->register();
    }

    protected function registerResourcesDocs(DocsRegistry $docs): void
    {
        $docs->section('api-reference')->label('API Reference')->markdown('api-reference.md')->inGroup('resources')->register();
        $docs->section('frameworks')->label('Frameworks')->markdown('frameworks.md')->inGroup('resources')->register();
        $docs->section('architecture')->label('Architecture')->markdown('architecture.md')->inGroup('resources')->register();
        $docs->section('testing')->label('Testing')->markdown('testing.md')->inGroup('resources')->register();
        $docs->section('contributing')->label('Contributing')->markdown('contributing.md')->inGroup('resources')->register();
        $docs->section('sponsor')->label('Sponsor')->markdown('sponsor.md')->inGroup('resources')->register();
        $docs->section('thanks')->label('Thanks')->markdown('thanks.md')->inGroup('resources')->register();
    }
}
</file>

<file path=".github/workflows/playwright.yml">
name: Playwright E2E Tests

on:
  workflow_dispatch:
    inputs:
      debug:
        description: 'Run with debug output'
        required: false
        default: false
        type: boolean

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  e2e:
    runs-on: ubuntu-latest
    name: E2E Tests
    timeout-minutes: 30

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install npm dependencies
        run: npm ci

      - name: Build JavaScript assets
        run: npm run build

      - name: Install Playwright browsers
        run: npx playwright install chromium --with-deps

      - name: Run Playwright tests
        run: npx playwright test --reporter=list
        env:
          CI: true
          ACCELADE_TEST_URL: ${{ vars.ACCELADE_TEST_URL || 'http://localhost:8000' }}
          DEBUG: ${{ inputs.debug && 'pw:api' || '' }}

      - name: Upload Playwright report
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: playwright-report
          path: playwright-report
          retention-days: 7

      - name: Upload test screenshots
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: test-screenshots
          path: test-results
          retention-days: 7
</file>

<file path="resources/js/adapters/vanilla/VanillaBindingAdapter.ts">
/**
 * VanillaBindingAdapter - DOM bindings for vanilla JavaScript
 */

import type { IBindingAdapter, IStateAdapter, CleanupFn } from '../types';
import type { AcceladeActions } from '../../core/types';
import type { CustomMethods } from '../../core/factories/ScriptExecutor';
import { ScriptExecutor } from '../../core/factories/ScriptExecutor';
import {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    parseClassObject,
    getNestedValue,
} from '../../core/expressions';
import { TextInterpolator } from '../../core/interpolation';

/**
 * Binding cleanup record
 */
interface BindingRecord {
    element: HTMLElement;
    type: string;
    cleanup: CleanupFn;
}

/**
 * Element binding with expression for reactive updates
 * This allows tracking elements regardless of DOM position (for teleport support)
 */
interface ElementBinding {
    element: HTMLElement;
    expression: string;
}

/**
 * Animation configuration for show bindings
 */
interface AnimationConfig {
    enter: string;
    enterFrom: string;
    enterTo: string;
    leave: string;
    leaveFrom: string;
    leaveTo: string;
}

/**
 * Show binding with optional animation
 */
interface ShowBinding extends ElementBinding {
    originalDisplay: string;
    animation?: AnimationConfig;
}

/**
 * VanillaBindingAdapter - Handles DOM bindings with manual updates
 */
export class VanillaBindingAdapter implements IBindingAdapter {
    private element: HTMLElement | null = null;
    private stateAdapter: IStateAdapter | null = null;
    private bindings: BindingRecord[] = [];
    private eventListeners: Array<{ element: HTMLElement; event: string; handler: EventListener }> = [];
    private ifPlaceholders: Map<HTMLElement, Comment> = new Map();
    private modelBound: WeakSet<Element> = new WeakSet();
    private textInterpolator: TextInterpolator | null = null;

    // Element bindings storage for teleport support (elements tracked regardless of DOM position)
    private textBindings: ElementBinding[] = [];
    private showBindings: ShowBinding[] = [];
    private classBindings: ElementBinding[] = [];
    private styleBindings: ElementBinding[] = [];
    private attrBindings: Array<{ element: HTMLElement; attr: string; expression: string }> = [];
    private modelBindings: Array<{ element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement; property: string }> = [];

    /**
     * Initialize the binding adapter
     */
    init(element: HTMLElement, stateAdapter: IStateAdapter): void {
        this.element = element;
        this.stateAdapter = stateAdapter;

        // Initialize text interpolation for {{ }} syntax
        this.textInterpolator = new TextInterpolator(element, stateAdapter.getState());
        this.textInterpolator.init();

        // Subscribe to state changes for reactive updates
        const unsubscribe = stateAdapter.subscribe(() => {
            this.update();
        });

        this.bindings.push({
            element,
            type: 'subscription',
            cleanup: unsubscribe,
        });
    }

    /**
     * Bind text content
     */
    bindText(element: HTMLElement, expression: string): void {
        // Store binding for teleport support
        this.textBindings.push({ element, expression });

        const update = () => {
            if (!this.stateAdapter) return;
            const value = evaluateStringExpression(expression, this.stateAdapter.getState());
            element.textContent = value;
        };

        update();
        this.bindings.push({ element, type: 'text', cleanup: () => {} });
    }

    /**
     * Bind HTML content
     */
    bindHtml(element: HTMLElement, expression: string): void {
        const update = () => {
            if (!this.stateAdapter) return;
            const value = evaluateStringExpression(expression, this.stateAdapter.getState());
            element.innerHTML = value;
        };

        update();
        this.bindings.push({ element, type: 'html', cleanup: () => {} });
    }

    /**
     * Bind visibility with smooth transitions
     */
    bindShow(element: HTMLElement, expression: string): void {
        // Get computed display style if no inline style is set
        const originalDisplay = element.style.display || '';

        // Check for animation config from parent toggle
        let animation: AnimationConfig | undefined;
        const toggleParent = element.closest('[data-toggle-animation]');
        if (toggleParent) {
            try {
                const animData = toggleParent.getAttribute('data-toggle-animation');
                if (animData) {
                    animation = JSON.parse(animData);
                }
            } catch {
                // Invalid JSON, skip animation
            }
        }

        // Store binding for teleport support
        this.showBindings.push({ element, expression, originalDisplay, animation });

        // Initial update (no animation on first render)
        if (this.stateAdapter) {
            const visible = evaluateBooleanExpression(expression, this.stateAdapter.getState());
            if (visible) {
                element.style.display = originalDisplay;
                if (animation) {
                    // Apply enterTo classes immediately for initial visible state
                    this.addClasses(element, animation.enterTo);
                } else {
                    element.classList.add('accelade-visible');
                }
            } else {
                // Hide immediately on initial render (no animation)
                element.style.display = 'none';
            }
        }

        this.bindings.push({ element, type: 'show', cleanup: () => {} });
    }

    /**
     * Helper to add space-separated classes
     */
    private addClasses(element: HTMLElement, classes: string): void {
        classes.split(/\s+/).filter(c => c).forEach(c => element.classList.add(c));
    }

    /**
     * Helper to remove space-separated classes
     */
    private removeClasses(element: HTMLElement, classes: string): void {
        classes.split(/\s+/).filter(c => c).forEach(c => element.classList.remove(c));
    }

    /**
     * Extract duration from Tailwind duration class
     */
    private getAnimationDuration(classes: string): number {
        const match = classes.match(/duration-(\d+)/);
        if (match) {
            return parseInt(match[1], 10);
        }
        return 200; // Default fallback
    }

    /**
     * Bind conditional rendering
     */
    bindIf(element: HTMLElement, expression: string): void {
        const placeholder = document.createComment('a-if');
        this.ifPlaceholders.set(element, placeholder);
        let isInserted = true;

        const update = () => {
            if (!this.stateAdapter) return;
            const result = evaluateBooleanExpression(expression, this.stateAdapter.getState());

            if (result && !isInserted) {
                placeholder.replaceWith(element);
                isInserted = true;
            } else if (!result && isInserted && element.parentNode) {
                element.replaceWith(placeholder);
                isInserted = false;
            }
        };

        update();
        this.bindings.push({
            element,
            type: 'if',
            cleanup: () => {
                this.ifPlaceholders.delete(element);
            },
        });
    }

    /**
     * Bind two-way input
     */
    bindModel(
        element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement,
        property: string
    ): void {
        if (this.modelBound.has(element)) return;
        this.modelBound.add(element);

        // Store binding for teleport support
        this.modelBindings.push({ element, property });

        const inputElement = element as HTMLInputElement;
        const isCheckbox = inputElement.type === 'checkbox';
        const isRadio = inputElement.type === 'radio';
        const isNumber = inputElement.type === 'number' || inputElement.type === 'range';
        const eventType = isCheckbox || isRadio ? 'change' : 'input';

        // Update DOM from state
        const updateDOM = () => {
            if (!this.stateAdapter) return;
            const value = this.stateAdapter.get(property);

            if (isCheckbox) {
                inputElement.checked = Boolean(value);
            } else if (isRadio) {
                inputElement.checked = inputElement.value === value;
            } else if (element.value !== String(value ?? '')) {
                element.value = value !== undefined ? String(value) : '';
            }
        };

        // Update state from DOM
        const updateState = () => {
            if (!this.stateAdapter) return;

            if (isCheckbox) {
                this.stateAdapter.set(property, inputElement.checked);
            } else if (isRadio) {
                this.stateAdapter.set(property, inputElement.value);
            } else if (isNumber) {
                this.stateAdapter.set(property, parseFloat(element.value) || 0);
            } else {
                this.stateAdapter.set(property, element.value);
            }
        };

        // Initial update
        updateDOM();

        // Bind event
        element.addEventListener(eventType, updateState);
        this.eventListeners.push({ element, event: eventType, handler: updateState });

        this.bindings.push({ element, type: 'model', cleanup: () => {} });
    }

    /**
     * Bind attribute
     */
    bindAttribute(element: HTMLElement, attr: string, expression: string): void {
        // Store binding for teleport support
        this.attrBindings.push({ element, attr, expression });

        const update = () => {
            if (!this.stateAdapter) return;
            const value = evaluateExpression(expression, this.stateAdapter.getState());

            if (attr === 'class') {
                if (typeof value === 'object' && value !== null) {
                    Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                        element.classList.toggle(className, Boolean(condition));
                    });
                } else {
                    element.setAttribute('class', String(value));
                }
            } else if (value === false || value === null || value === undefined) {
                element.removeAttribute(attr);
            } else if (value === true) {
                element.setAttribute(attr, '');
            } else {
                element.setAttribute(attr, String(value));
            }
        };

        update();
        this.bindings.push({ element, type: `attr:${attr}`, cleanup: () => {} });
    }

    /**
     * Bind event handler
     */
    bindEvent(
        element: HTMLElement,
        event: string,
        handler: string,
        actions: AcceladeActions,
        customMethods: CustomMethods
    ): void {
        // Parse event modifiers (e.g., click.prevent.stop -> click with prevent and stop modifiers)
        const parts = event.split('.');
        const eventName = parts[0];
        const modifiers = new Set(parts.slice(1));

        const listener = (e: Event) => {
            if (!this.stateAdapter) return;

            // Apply modifiers
            if (modifiers.has('prevent')) {
                e.preventDefault();
            }
            if (modifiers.has('stop')) {
                e.stopPropagation();
            }

            // Handle keyboard modifiers for keydown/keyup events
            if (e instanceof KeyboardEvent) {
                if (modifiers.has('enter') && e.key !== 'Enter') return;
                if (modifiers.has('escape') && e.key !== 'Escape') return;
                if (modifiers.has('tab') && e.key !== 'Tab') return;
                if (modifiers.has('space') && e.key !== ' ') return;
                if (modifiers.has('up') && e.key !== 'ArrowUp') return;
                if (modifiers.has('down') && e.key !== 'ArrowDown') return;
                if (modifiers.has('left') && e.key !== 'ArrowLeft') return;
                if (modifiers.has('right') && e.key !== 'ArrowRight') return;
            }

            // Handle mouse button modifiers
            if (e instanceof MouseEvent) {
                if (modifiers.has('left') && e.button !== 0) return;
                if (modifiers.has('middle') && e.button !== 1) return;
                if (modifiers.has('right') && e.button !== 2) return;
            }

            // Handle modifier key requirements
            if (e instanceof KeyboardEvent || e instanceof MouseEvent) {
                if (modifiers.has('ctrl') && !e.ctrlKey) return;
                if (modifiers.has('alt') && !e.altKey) return;
                if (modifiers.has('shift') && !e.shiftKey) return;
                if (modifiers.has('meta') && !e.metaKey) return;
            }

            ScriptExecutor.executeAction(
                handler,
                this.stateAdapter.getState(),
                actions,
                customMethods,
                e
            );
        };

        // Handle 'once' modifier
        const options: AddEventListenerOptions = {};
        if (modifiers.has('once')) {
            options.once = true;
        }
        if (modifiers.has('passive')) {
            options.passive = true;
        }
        if (modifiers.has('capture')) {
            options.capture = true;
        }

        element.addEventListener(eventName, listener, options);
        this.eventListeners.push({ element, event: eventName, handler: listener });
    }

    /**
     * Bind class object
     */
    bindClass(element: HTMLElement, expression: string): void {
        // Store binding for teleport support
        this.classBindings.push({ element, expression });

        const update = () => {
            if (!this.stateAdapter) return;
            const classObj = parseClassObject(expression, this.stateAdapter.getState());
            Object.entries(classObj).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        };

        update();
        this.bindings.push({ element, type: 'class', cleanup: () => {} });
    }

    /**
     * Bind style object
     */
    bindStyle(element: HTMLElement, expression: string): void {
        // Store binding for teleport support
        this.styleBindings.push({ element, expression });

        const update = () => {
            if (!this.stateAdapter) return;
            const value = evaluateExpression(expression, this.stateAdapter.getState());

            if (typeof value === 'object' && value !== null) {
                Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                    element.style.setProperty(prop, val);
                });
            }
        };

        update();
        this.bindings.push({ element, type: 'style', cleanup: () => {} });
    }

    /**
     * Update all bindings
     * Uses stored element references to support teleported content (elements moved outside container)
     */
    update(): void {
        if (!this.stateAdapter) return;

        const state = this.stateAdapter.getState();

        // Update text interpolation
        if (this.textInterpolator) {
            this.textInterpolator.setState(state);
        }

        // Update text bindings using stored references (supports teleported elements)
        for (const { element, expression } of this.textBindings) {
            element.textContent = evaluateStringExpression(expression, state);
        }

        // Update show bindings using stored references with smooth transitions
        for (const { element, expression, originalDisplay, animation } of this.showBindings) {
            const visible = evaluateBooleanExpression(expression, state);
            const isCurrentlyHidden = element.style.display === 'none';

            if (animation) {
                // Use custom animation classes
                if (visible && isCurrentlyHidden) {
                    // Enter animation
                    element.style.display = originalDisplay;
                    this.addClasses(element, animation.enter);
                    this.addClasses(element, animation.enterFrom);
                    // Force reflow
                    void element.offsetHeight;
                    // Transition to enterTo
                    this.removeClasses(element, animation.enterFrom);
                    this.addClasses(element, animation.enterTo);
                    // Cleanup after animation
                    const duration = this.getAnimationDuration(animation.enter);
                    setTimeout(() => {
                        this.removeClasses(element, animation.enter);
                    }, duration);
                } else if (!visible && !isCurrentlyHidden) {
                    // Leave animation
                    this.removeClasses(element, animation.enterTo);
                    this.addClasses(element, animation.leave);
                    this.addClasses(element, animation.leaveFrom);
                    // Force reflow
                    void element.offsetHeight;
                    // Transition to leaveTo
                    this.removeClasses(element, animation.leaveFrom);
                    this.addClasses(element, animation.leaveTo);
                    // Hide after animation
                    const duration = this.getAnimationDuration(animation.leave);
                    setTimeout(() => {
                        if (element.classList.contains(animation.leaveTo.split(/\s+/)[0])) {
                            element.style.display = 'none';
                            this.removeClasses(element, animation.leave);
                            this.removeClasses(element, animation.leaveTo);
                        }
                    }, duration);
                }
            } else {
                // Default simple animation
                if (visible) {
                    // Show: first set display, then animate in
                    if (isCurrentlyHidden) {
                        element.style.display = originalDisplay;
                        // Force reflow to ensure transition works
                        void element.offsetHeight;
                    }
                    element.classList.remove('accelade-hiding');
                    element.classList.add('accelade-visible');
                } else {
                    // Hide: animate out, then set display:none after transition
                    if (!isCurrentlyHidden) {
                        element.classList.add('accelade-hiding');
                        element.classList.remove('accelade-visible');
                        // Set display:none after transition completes
                        setTimeout(() => {
                            // Only hide if still supposed to be hidden
                            if (element.classList.contains('accelade-hiding')) {
                                element.style.display = 'none';
                            }
                        }, 200); // Match CSS transition duration
                    }
                }
            }
        }

        // Update model bindings using stored references
        for (const { element, property } of this.modelBindings) {
            // Use getNestedValue to support nested paths like "props.count"
            const value = getNestedValue(state, property);
            const inputElement = element as HTMLInputElement;

            if (inputElement.type === 'checkbox') {
                inputElement.checked = Boolean(value);
            } else if (inputElement.type === 'radio') {
                inputElement.checked = inputElement.value === value;
            } else if (element.value !== String(value ?? '')) {
                element.value = value !== undefined ? String(value) : '';
            }
        }

        // Update class bindings using stored references
        for (const { element, expression } of this.classBindings) {
            const classObj = parseClassObject(expression, state);
            Object.entries(classObj).forEach(([className, condition]) => {
                element.classList.toggle(className, Boolean(condition));
            });
        }

        // Update style bindings using stored references
        for (const { element, expression } of this.styleBindings) {
            const value = evaluateExpression(expression, state);
            if (typeof value === 'object' && value !== null) {
                Object.entries(value as Record<string, string>).forEach(([prop, val]) => {
                    element.style.setProperty(prop, val);
                });
            }
        }

        // Update attribute bindings using stored references
        for (const { element, attr, expression } of this.attrBindings) {
            const value = evaluateExpression(expression, state);

            if (attr === 'class' && typeof value === 'object' && value !== null) {
                Object.entries(value as Record<string, boolean>).forEach(([className, condition]) => {
                    element.classList.toggle(className, Boolean(condition));
                });
            } else if (value === false || value === null || value === undefined) {
                element.removeAttribute(attr);
            } else if (value === true) {
                element.setAttribute(attr, '');
            } else {
                element.setAttribute(attr, String(value));
            }
        }
    }

    /**
     * Dispose all bindings
     */
    dispose(): void {
        // Destroy text interpolator
        if (this.textInterpolator) {
            this.textInterpolator.destroy();
            this.textInterpolator = null;
        }

        // Remove event listeners
        for (const { element, event, handler } of this.eventListeners) {
            element.removeEventListener(event, handler);
        }
        this.eventListeners = [];

        // Run cleanup functions
        for (const binding of this.bindings) {
            binding.cleanup();
        }
        this.bindings = [];

        // Clear element binding arrays (teleport support)
        this.textBindings = [];
        this.showBindings = [];
        this.classBindings = [];
        this.styleBindings = [];
        this.attrBindings = [];
        this.modelBindings = [];

        // Clear placeholders
        this.ifPlaceholders.clear();

        // Clear references
        this.element = null;
        this.stateAdapter = null;
    }
}

export default VanillaBindingAdapter;
</file>

<file path="resources/views/demo/angular.blade.php">
<x-accelade::layouts.demo :framework="'angular'">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-red-600 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A reactive counter powered by Angular-style signals.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" framework="angular" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="0" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-red-600 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Angular counter that syncs state with Laravel backend.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" framework="angular" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="10" sync="count" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-pink-600 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; with Angular signals.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Native Angular Syntax -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="text-xs px-2 py-1 bg-red-100 text-red-700 rounded">Native</span>
                    ng-on-click Syntax
                </h3>
                @accelade(['count' => 0, 'message' => 'Click me!'])
                    <div class="text-center">
                        <p class="text-lg text-slate-800 mb-2" ng-text="message">Click me!</p>
                        <p class="text-3xl font-bold text-red-600 mb-4" ng-text="count">0</p>
                        <div class="flex gap-2 justify-center">
                            <button class="px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition" ng-on-click="$set('count', count + 1)">+1</button>
                            <button class="px-4 py-2 bg-pink-600 text-white rounded-lg text-sm font-medium hover:bg-pink-700 transition" ng-on-click="$set('count', count * 2)">x2</button>
                            <button class="px-4 py-2 bg-slate-600 text-white rounded-lg text-sm font-medium hover:bg-slate-700 transition" ng-on-click="reset('count')">Reset</button>
                        </div>
                    </div>
                @endaccelade
            </div>

            <!-- Unified @ Syntax -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">Unified</span>
                    @click Syntax
                </h3>
                @accelade(['count' => 0, 'message' => 'Click me!'])
                    <div class="text-center">
                        <p class="text-lg text-slate-800 mb-2" ng-text="message">Click me!</p>
                        <p class="text-3xl font-bold text-pink-600 mb-4" ng-text="count">0</p>
                        <div class="flex gap-2 justify-center">
                            <button class="px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition" @click="$set('count', count + 1)">+1</button>
                            <button class="px-4 py-2 bg-pink-600 text-white rounded-lg text-sm font-medium hover:bg-pink-700 transition" @click="$set('count', count * 2)">x2</button>
                            <button class="px-4 py-2 bg-slate-600 text-white rounded-lg text-sm font-medium hover:bg-slate-700 transition" @click="reset('count')">Reset</button>
                        </div>
                    </div>
                @endaccelade
            </div>
        </div>

        <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6">
            <p class="text-amber-800 text-sm">
                <strong>Both syntaxes work!</strong> Use <code class="bg-amber-100 px-1.5 py-0.5 rounded">ng-on-click</code> for Angular-style or <code class="bg-amber-100 px-1.5 py-0.5 rounded">@click</code> for unified syntax across all frameworks.
            </p>
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">&lt;!-- Native Angular syntax --&gt;
&lt;button ng-on-click="$set('count', count + 1)"&gt;+1&lt;/button&gt;
&lt;span ng-text="count"&gt;0&lt;/span&gt;

&lt;!-- Unified syntax (works on all frameworks) --&gt;
&lt;button @click="$set('count', count + 1)"&gt;+1&lt;/button&gt;</pre>
        </div>
    </section>

    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-purple-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.angular') }}"
                    class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition"
                >
                    Reload This Page (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}?time={{ time() }}"
                    class="px-6 py-3 bg-pink-600 text-white rounded-xl font-medium hover:bg-pink-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the counter state reset without a full page reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.angular') }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Scroll down, update the counter, then click to test preservation!</p>
        </div>

        <!-- Framework Switch (Full Page Reload) -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Vanilla Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}"
                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition"
                >
                    Vue Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}"
                    class="px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 transition"
                >
                    React Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}"
                    class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition"
                >
                    Svelte Demo
                </x-accelade::link>
            </div>
        </div>
    </section>

    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.progress?.start()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">Start Progress</button>
                    <button onclick="window.Accelade?.progress?.done()" class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm">Complete</button>
                    <button onclick="window.Accelade?.progress?.done(true)" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm">Force Complete</button>
                </div>
            </div>
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="testServerRequest()" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm">Test Sync Request</button>
                    <button onclick="testSlowRequest()" class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm">Test Slow Request (2s)</button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>
        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';
                window.Accelade?.progress?.start();
                fetch('/accelade/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content, 'Accept': 'application/json' },
                    body: JSON.stringify({ component: 'demo-test', property: 'testValue', value: Date.now() })
                }).then(res => res.json()).then(data => { status.textContent = 'Success! Response: ' + JSON.stringify(data); window.Accelade?.progress?.done(); }).catch(err => { status.textContent = 'Error: ' + err.message; window.Accelade?.progress?.done(); });
            }
            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';
                window.Accelade?.progress?.start();
                setTimeout(() => { status.textContent = 'Slow request completed!'; window.Accelade?.progress?.done(); }, 2000);
            }
        </script>
    </section>

    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="backend-notify-success">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="backend-notify-info">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="backend-notify-warning">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="backend-notify-danger">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4 bg-white/60 rounded-lg p-3">
                    <pre class="text-xs font-mono text-slate-700">// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();</pre>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="notify-success">Success</button>
                    <button onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="notify-info">Info</button>
                    <button onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="notify-warning">Warning</button>
                    <button onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="notify-danger">Danger</button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Right</button>
                </div>
            </div>
        </div>
        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({ id: 'pos-' + Date.now(), title: position, message: 'Notification at ' + position, type: 'info', position: position, duration: 3000, dismissible: true });
            }
        </script>
    </section>

    <!-- Shared Data Section -->
    @include('accelade::demo.partials._shared-data', ['prefix' => 'ng'])

    <!-- Lazy Loading Section -->
    @include('accelade::demo.partials._lazy-loading', ['prefix' => 'ng'])

    <!-- Content Component Section -->
    @include('accelade::demo.partials._content')

    <!-- Data Component Section -->
    @include('accelade::demo.partials._data-component', ['prefix' => 'ng'])

    <!-- Defer Component Section -->
    @include('accelade::demo.partials._defer-component', ['prefix' => 'ng'])

    <!-- Rehydrate Component Section -->
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => 'ng'])

    <!-- Errors Component Section -->
    @include('accelade::demo.partials._errors-component', ['prefix' => 'ng'])

    <!-- Angular Features -->
    <section class="bg-gradient-to-r from-red-600 to-pink-600 rounded-2xl shadow-xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-8 text-center">Angular Features</h2>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">ng-*</div>
                <h3 class="font-semibold text-lg mb-2">Angular Bindings</h3>
                <p class="text-red-100 text-sm">ng-text, ng-show, ng-if, ng-model, ng-on-click, ng-class</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">signal()</div>
                <h3 class="font-semibold text-lg mb-2">Angular Signals</h3>
                <p class="text-red-100 text-sm">Angular 17+ style signals for fine-grained reactivity.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">effect()</div>
                <h3 class="font-semibold text-lg mb-2">Computed Effects</h3>
                <p class="text-red-100 text-sm">Automatic side effects with Angular's effect() pattern.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">SPA</div>
                <h3 class="font-semibold text-lg mb-2">Built-in Router</h3>
                <p class="text-red-100 text-sm">SPA navigation with &lt;accelade:link&gt; component.</p>
            </div>
        </div>
    </section>
</x-accelade::layouts.demo>
</file>

<file path="resources/views/demo/react.blade.php">
<x-accelade::layouts.demo :framework="'react'">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A reactive counter powered by React 18 with hooks.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" framework="react" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="0" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">React counter that syncs state with Laravel backend via useEffect.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" framework="react" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="10" sync="count" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; with React state.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Native React Syntax -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">Native</span>
                    data-on-click Syntax
                </h3>
                @accelade(['count' => 0, 'message' => 'Click me!'])
                    <div class="text-center">
                        <p class="text-lg text-slate-800 mb-2" data-state-text="message">Click me!</p>
                        <p class="text-3xl font-bold text-blue-600 mb-4" data-state-text="count">0</p>
                        <div class="flex gap-2 justify-center">
                            <button class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition" data-on-click="$set('count', count + 1)">+1</button>
                            <button class="px-4 py-2 bg-cyan-600 text-white rounded-lg text-sm font-medium hover:bg-cyan-700 transition" data-on-click="$set('count', count * 2)">x2</button>
                            <button class="px-4 py-2 bg-slate-600 text-white rounded-lg text-sm font-medium hover:bg-slate-700 transition" data-on-click="reset('count')">Reset</button>
                        </div>
                    </div>
                @endaccelade
            </div>

            <!-- Unified @ Syntax -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">Unified</span>
                    @click Syntax
                </h3>
                @accelade(['count' => 0, 'message' => 'Click me!'])
                    <div class="text-center">
                        <p class="text-lg text-slate-800 mb-2" data-state-text="message">Click me!</p>
                        <p class="text-3xl font-bold text-cyan-600 mb-4" data-state-text="count">0</p>
                        <div class="flex gap-2 justify-center">
                            <button class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition" @click="$set('count', count + 1)">+1</button>
                            <button class="px-4 py-2 bg-cyan-600 text-white rounded-lg text-sm font-medium hover:bg-cyan-700 transition" @click="$set('count', count * 2)">x2</button>
                            <button class="px-4 py-2 bg-slate-600 text-white rounded-lg text-sm font-medium hover:bg-slate-700 transition" @click="reset('count')">Reset</button>
                        </div>
                    </div>
                @endaccelade
            </div>
        </div>

        <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6">
            <p class="text-amber-800 text-sm">
                <strong>Both syntaxes work!</strong> Use <code class="bg-amber-100 px-1.5 py-0.5 rounded">data-on-click</code> for React-style or <code class="bg-amber-100 px-1.5 py-0.5 rounded">@click</code> for unified syntax across all frameworks.
            </p>
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">&lt;!-- Native React syntax --&gt;
&lt;button data-on-click="$set('count', count + 1)"&gt;+1&lt;/button&gt;
&lt;span data-state-text="count"&gt;0&lt;/span&gt;

&lt;!-- Unified syntax (works on all frameworks) --&gt;
&lt;button @click="$set('count', count + 1)"&gt;+1&lt;/button&gt;</pre>
        </div>
    </section>

    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-sky-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.react') }}"
                    class="px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 transition"
                >
                    Reload This Page (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}?time={{ time() }}"
                    class="px-6 py-3 bg-cyan-600 text-white rounded-xl font-medium hover:bg-cyan-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the counter state reset without a full page reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.react') }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}?t={{ time() }}"
                    :preserveScroll="true"
                    :preserveState="true"
                    class="px-6 py-3 bg-rose-600 text-white rounded-xl font-medium hover:bg-rose-700 transition"
                >
                    Preserve Both
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Scroll down, update the counter, then click to test preservation!</p>
        </div>

        <!-- Framework Switch (Full Page Reload) -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Vanilla Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}"
                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition"
                >
                    Vue Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}"
                    class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition"
                >
                    Svelte Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}"
                    class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition"
                >
                    Angular Demo
                </x-accelade::link>
            </div>
        </div>
    </section>

    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.progress?.start()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">Start Progress</button>
                    <button onclick="window.Accelade?.progress?.done()" class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm">Complete</button>
                    <button onclick="window.Accelade?.progress?.done(true)" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm">Force Complete</button>
                </div>
            </div>
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="testServerRequest()" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm">Test Sync Request</button>
                    <button onclick="testSlowRequest()" class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm">Test Slow Request (2s)</button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>
        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';
                window.Accelade?.progress?.start();
                fetch('/accelade/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content, 'Accept': 'application/json' },
                    body: JSON.stringify({ component: 'demo-test', property: 'testValue', value: Date.now() })
                }).then(res => res.json()).then(data => { status.textContent = 'Success! Response: ' + JSON.stringify(data); window.Accelade?.progress?.done(); }).catch(err => { status.textContent = 'Error: ' + err.message; window.Accelade?.progress?.done(); });
            }
            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';
                window.Accelade?.progress?.start();
                setTimeout(() => { status.textContent = 'Slow request completed!'; window.Accelade?.progress?.done(); }, 2000);
            }
        </script>
    </section>

    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="backend-notify-success">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="backend-notify-info">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="backend-notify-warning">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="backend-notify-danger">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4 bg-white/60 rounded-lg p-3">
                    <pre class="text-xs font-mono text-slate-700">// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();</pre>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="notify-success">Success</button>
                    <button onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="notify-info">Info</button>
                    <button onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="notify-warning">Warning</button>
                    <button onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="notify-danger">Danger</button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Right</button>
                </div>
            </div>
        </div>
        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({ id: 'pos-' + Date.now(), title: position, message: 'Notification at ' + position, type: 'info', position: position, duration: 3000, dismissible: true });
            }
        </script>
    </section>

    <!-- Shared Data Section -->
    @include('accelade::demo.partials._shared-data', ['prefix' => 'data-state'])

    <!-- Lazy Loading Section -->
    @include('accelade::demo.partials._lazy-loading', ['prefix' => 'data-state'])

    <!-- Content Component Section -->
    @include('accelade::demo.partials._content')

    <!-- Data Component Section -->
    @include('accelade::demo.partials._data-component', ['prefix' => 'data-state'])

    <!-- Defer Component Section -->
    @include('accelade::demo.partials._defer-component', ['prefix' => 'data-state'])

    <!-- Rehydrate Component Section -->
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => 'data-state'])

    <!-- Errors Component Section -->
    @include('accelade::demo.partials._errors-component', ['prefix' => 'data-state'])

    <!-- React Features -->
    <section class="bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl shadow-xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-8 text-center">React Features</h2>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">data-state-*</div>
                <h3 class="font-semibold text-lg mb-2">React Bindings</h3>
                <p class="text-blue-100 text-sm">data-state-text, data-on-click, and more React-style bindings.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">useState</div>
                <h3 class="font-semibold text-lg mb-2">React Hooks</h3>
                <p class="text-blue-100 text-sm">Modern hooks-based state management with useState and useEffect.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">useEffect</div>
                <h3 class="font-semibold text-lg mb-2">Side Effects</h3>
                <p class="text-blue-100 text-sm">Server sync handled elegantly with useEffect hooks.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">SPA</div>
                <h3 class="font-semibold text-lg mb-2">Built-in Router</h3>
                <p class="text-blue-100 text-sm">SPA navigation with &lt;accelade:link&gt; component.</p>
            </div>
        </div>
    </section>
</x-accelade::layouts.demo>
</file>

<file path="resources/views/demo/svelte.blade.php">
<x-accelade::layouts.demo :framework="'svelte'">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-orange-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A reactive counter powered by Svelte-style stores.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" framework="svelte" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="0" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-orange-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Svelte counter that syncs state with Laravel backend.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" framework="svelte" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="10" sync="count" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-red-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; with Svelte stores.</p>

        @accelade(['count' => 0, 'message' => 'Click the buttons!'])
            <div class="text-center p-6 bg-gradient-to-r from-orange-50 to-red-50 rounded-xl mb-6">
                <p class="text-2xl text-slate-800 mb-4 font-medium" s-text="message">
                    Click the buttons!
                </p>

                <p class="text-4xl font-bold text-orange-600 mb-4" s-text="count">0</p>

                <div class="flex gap-2 justify-center">
                    <button
                        class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition shadow-lg shadow-orange-200"
                        s-on-click="addFive()"
                    >
                        +5
                    </button>
                    <button
                        class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition shadow-lg shadow-red-200"
                        s-on-click="double()"
                    >
                        Double
                    </button>
                    <button
                        class="px-6 py-3 bg-slate-600 text-white rounded-xl font-medium hover:bg-slate-700 transition shadow-lg shadow-slate-200"
                        s-on-click="reset('count')"
                    >
                        Reset
                    </button>
                </div>
            </div>

            <accelade:script>
                return {
                    addFive() {
                        $set('count', $get('count') + 5);
                        $set('message', 'Added 5!');
                    },
                    double() {
                        const current = $get('count');
                        $set('count', current * 2);
                        $set('message', 'Doubled to ' + (current * 2) + '!');
                    }
                };
            </accelade:script>
        @endaccelade

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">&lt;accelade:script&gt;
    return {
        addFive() {
            $set('count', $get('count') + 5);
        },
        double() {
            $set('count', $get('count') * 2);
        }
    };
&lt;/accelade:script&gt;</pre>
        </div>
    </section>

    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.svelte') }}"
                    class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition"
                >
                    Reload This Page (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}?time={{ time() }}"
                    class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the counter state reset without a full page reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.svelte') }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Scroll down, update the counter, then click to test preservation!</p>
        </div>

        <!-- Framework Switch (Full Page Reload) -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Vanilla Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}"
                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition"
                >
                    Vue Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}"
                    class="px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 transition"
                >
                    React Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}"
                    class="px-6 py-3 bg-red-700 text-white rounded-xl font-medium hover:bg-red-800 transition"
                >
                    Angular Demo
                </x-accelade::link>
            </div>
        </div>
    </section>

    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.progress?.start()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">Start Progress</button>
                    <button onclick="window.Accelade?.progress?.done()" class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm">Complete</button>
                    <button onclick="window.Accelade?.progress?.done(true)" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm">Force Complete</button>
                </div>
            </div>
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="testServerRequest()" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm">Test Sync Request</button>
                    <button onclick="testSlowRequest()" class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm">Test Slow Request (2s)</button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>
        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';
                window.Accelade?.progress?.start();
                fetch('/accelade/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content, 'Accept': 'application/json' },
                    body: JSON.stringify({ component: 'demo-test', property: 'testValue', value: Date.now() })
                }).then(res => res.json()).then(data => { status.textContent = 'Success! Response: ' + JSON.stringify(data); window.Accelade?.progress?.done(); }).catch(err => { status.textContent = 'Error: ' + err.message; window.Accelade?.progress?.done(); });
            }
            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';
                window.Accelade?.progress?.start();
                setTimeout(() => { status.textContent = 'Slow request completed!'; window.Accelade?.progress?.done(); }, 2000);
            }
        </script>
    </section>

    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="backend-notify-success">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="backend-notify-info">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="backend-notify-warning">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="backend-notify-danger">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4 bg-white/60 rounded-lg p-3">
                    <pre class="text-xs font-mono text-slate-700">// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();</pre>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="notify-success">Success</button>
                    <button onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="notify-info">Info</button>
                    <button onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="notify-warning">Warning</button>
                    <button onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="notify-danger">Danger</button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Right</button>
                </div>
            </div>
        </div>
        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({ id: 'pos-' + Date.now(), title: position, message: 'Notification at ' + position, type: 'info', position: position, duration: 3000, dismissible: true });
            }
        </script>
    </section>

    <!-- Shared Data Section -->
    @include('accelade::demo.partials._shared-data', ['prefix' => 's'])

    <!-- Lazy Loading Section -->
    @include('accelade::demo.partials._lazy-loading', ['prefix' => 's'])

    <!-- Content Component Section -->
    @include('accelade::demo.partials._content')

    <!-- Data Component Section -->
    @include('accelade::demo.partials._data-component', ['prefix' => 's'])

    <!-- Defer Component Section -->
    @include('accelade::demo.partials._defer-component', ['prefix' => 's'])

    <!-- Rehydrate Component Section -->
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => 's'])

    <!-- Errors Component Section -->
    @include('accelade::demo.partials._errors-component', ['prefix' => 's'])

    <!-- Svelte Features -->
    <section class="bg-gradient-to-r from-orange-600 to-red-600 rounded-2xl shadow-xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-8 text-center">Svelte Features</h2>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">s-*</div>
                <h3 class="font-semibold text-lg mb-2">Svelte Bindings</h3>
                <p class="text-orange-100 text-sm">s-text, s-show, s-if, s-model, s-on-click, s-class</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">writable()</div>
                <h3 class="font-semibold text-lg mb-2">Store Reactivity</h3>
                <p class="text-orange-100 text-sm">Svelte-style writable stores for reactive state.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">$store</div>
                <h3 class="font-semibold text-lg mb-2">Auto-Subscription</h3>
                <p class="text-orange-100 text-sm">Automatic store subscriptions with $ prefix syntax.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">SPA</div>
                <h3 class="font-semibold text-lg mb-2">Built-in Router</h3>
                <p class="text-orange-100 text-sm">SPA navigation with &lt;accelade:link&gt; component.</p>
            </div>
        </div>
    </section>
</x-accelade::layouts.demo>
</file>

<file path="resources/views/demo/vue.blade.php">
<x-accelade::layouts.demo :framework="'vue'">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-green-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A reactive counter powered by Vue.js 3 reactivity system.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" framework="vue" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="0" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Vue reactive counter that syncs state with Laravel backend.</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" framework="vue" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="10" sync="count" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; with Vue reactivity.</p>

        @accelade(['count' => 0, 'message' => 'Click the buttons!'])
            <div class="text-center p-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl mb-6">
                <p class="text-2xl text-slate-800 mb-4 font-medium" v-text="message">
                    Click the buttons!
                </p>

                <p class="text-4xl font-bold text-green-600 mb-4" v-text="count">0</p>

                <div class="flex gap-2 justify-center">
                    <button
                        class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition shadow-lg shadow-green-200"
                        v-on:click="addFive()"
                    >
                        +5
                    </button>
                    <button
                        class="px-6 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 transition shadow-lg shadow-emerald-200"
                        v-on:click="double()"
                    >
                        Double
                    </button>
                    <button
                        class="px-6 py-3 bg-slate-600 text-white rounded-xl font-medium hover:bg-slate-700 transition shadow-lg shadow-slate-200"
                        v-on:click="reset('count')"
                    >
                        Reset
                    </button>
                </div>
            </div>

            <accelade:script>
                return {
                    addFive() {
                        $set('count', $get('count') + 5);
                        $set('message', 'Added 5!');
                    },
                    double() {
                        const current = $get('count');
                        $set('count', current * 2);
                        $set('message', 'Doubled to ' + (current * 2) + '!');
                    }
                };
            </accelade:script>
        @endaccelade

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">&lt;accelade:script&gt;
    return {
        addFive() {
            $set('count', $get('count') + 5);
        },
        double() {
            $set('count', $get('count') * 2);
        }
    };
&lt;/accelade:script&gt;</pre>
        </div>
    </section>

    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-teal-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vue') }}"
                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition"
                >
                    Reload This Page (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}?time={{ time() }}"
                    class="px-6 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the counter state reset without a full page reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vue') }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vue') }}?t={{ time() }}"
                    :preserveScroll="true"
                    :preserveState="true"
                    class="px-6 py-3 bg-rose-600 text-white rounded-xl font-medium hover:bg-rose-700 transition"
                >
                    Preserve Both
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Scroll down, update the counter, then click to test preservation!</p>
        </div>

        <!-- Framework Switch (Full Page Reload) -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Vanilla Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}"
                    class="px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 transition"
                >
                    React Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}"
                    class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition"
                >
                    Svelte Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}"
                    class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition"
                >
                    Angular Demo
                </x-accelade::link>
            </div>
        </div>
    </section>

    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.progress?.start()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">Start Progress</button>
                    <button onclick="window.Accelade?.progress?.done()" class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm">Complete</button>
                    <button onclick="window.Accelade?.progress?.done(true)" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm">Force Complete</button>
                </div>
            </div>
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="testServerRequest()" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm">Test Sync Request</button>
                    <button onclick="testSlowRequest()" class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm">Test Slow Request (2s)</button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>
        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';
                window.Accelade?.progress?.start();
                fetch('/accelade/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content, 'Accept': 'application/json' },
                    body: JSON.stringify({ component: 'demo-test', property: 'testValue', value: Date.now() })
                }).then(res => res.json()).then(data => { status.textContent = 'Success! Response: ' + JSON.stringify(data); window.Accelade?.progress?.done(); }).catch(err => { status.textContent = 'Error: ' + err.message; window.Accelade?.progress?.done(); });
            }
            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';
                window.Accelade?.progress?.start();
                setTimeout(() => { status.textContent = 'Slow request completed!'; window.Accelade?.progress?.done(); }, 2000);
            }
        </script>
    </section>

    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="backend-notify-success">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="backend-notify-info">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="backend-notify-warning">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="backend-notify-danger">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4 bg-white/60 rounded-lg p-3">
                    <pre class="text-xs font-mono text-slate-700">// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();</pre>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="notify-success">Success</button>
                    <button onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="notify-info">Info</button>
                    <button onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="notify-warning">Warning</button>
                    <button onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="notify-danger">Danger</button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Right</button>
                </div>
            </div>
        </div>
        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({ id: 'pos-' + Date.now(), title: position, message: 'Notification at ' + position, type: 'info', position: position, duration: 3000, dismissible: true });
            }
        </script>
    </section>

    <!-- Shared Data Section -->
    @include('accelade::demo.partials._shared-data', ['prefix' => 'v'])

    <!-- Lazy Loading Section -->
    @include('accelade::demo.partials._lazy-loading', ['prefix' => 'v'])

    <!-- Content Component Section -->
    @include('accelade::demo.partials._content')

    <!-- Data Component Section -->
    @include('accelade::demo.partials._data-component', ['prefix' => 'v'])

    <!-- Defer Component Section -->
    @include('accelade::demo.partials._defer-component', ['prefix' => 'v'])

    <!-- Rehydrate Component Section -->
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => 'v'])

    <!-- Errors Component Section -->
    @include('accelade::demo.partials._errors-component', ['prefix' => 'v'])

    <!-- Vue.js Features -->
    <section class="bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl shadow-xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-8 text-center">Vue.js Features</h2>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">v-*</div>
                <h3 class="font-semibold text-lg mb-2">Vue Directives</h3>
                <p class="text-green-100 text-sm">v-text, v-show, v-if, v-model, v-on:click, v-bind</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">reactive()</div>
                <h3 class="font-semibold text-lg mb-2">Vue Reactivity</h3>
                <p class="text-green-100 text-sm">Built with Vue 3's reactive() and effect() for reactivity.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">$watch</div>
                <h3 class="font-semibold text-lg mb-2">Watchers</h3>
                <p class="text-green-100 text-sm">Use $watch() in scripts to react to state changes.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">SPA</div>
                <h3 class="font-semibold text-lg mb-2">Built-in Router</h3>
                <p class="text-green-100 text-sm">SPA navigation with &lt;accelade:link&gt; component.</p>
            </div>
        </div>
    </section>
</x-accelade::layouts.demo>
</file>

<file path="resources/views/demo/vanilla.blade.php">
<x-accelade::layouts.demo :framework="'vanilla'">
    <!-- Demo: Counter (Client-side) -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-indigo-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter Component</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">A simple reactive counter using pure vanilla JavaScript. No build tools required!</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="0" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="0" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Counter with Server Sync -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-indigo-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Counter with Server Sync</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Counter that syncs state with the server (persisted across requests).</p>

        <div class="flex justify-center mb-6">
            <x-accelade::counter :initial-count="10" sync="count" />
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <code class="text-sm font-mono text-slate-700">
                &lt;x-accelade.counter :initial-count="10" sync="count" /&gt;
            </code>
        </div>
    </section>

    <!-- Demo: Custom Script Functions -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-purple-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Custom Script Functions</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Define custom functions using &lt;accelade:script&gt; that can access state.</p>

        @accelade(['count' => 0, 'message' => 'Click the buttons!'])
            <div class="text-center p-6 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl mb-6">
                <p class="text-2xl text-slate-800 mb-4 font-medium" a-text="message">
                    Click the buttons!
                </p>

                <p class="text-4xl font-bold text-indigo-600 mb-4" a-text="count">0</p>

                <div class="flex gap-2 justify-center">
                    <button
                        class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition shadow-lg shadow-indigo-200"
                        @click="addFive()"
                    >
                        +5
                    </button>
                    <button
                        class="px-6 py-3 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition shadow-lg shadow-purple-200"
                        @click="double()"
                    >
                        Double
                    </button>
                    <button
                        class="px-6 py-3 bg-slate-600 text-white rounded-xl font-medium hover:bg-slate-700 transition shadow-lg shadow-slate-200"
                        @click="reset('count')"
                    >
                        Reset
                    </button>
                </div>
            </div>

            <accelade:script>
                return {
                    addFive() {
                        $set('count', $get('count') + 5);
                        $set('message', 'Added 5!');
                    },
                    double() {
                        const current = $get('count');
                        $set('count', current * 2);
                        $set('message', 'Doubled to ' + (current * 2) + '!');
                    }
                };
            </accelade:script>
        @endaccelade

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">&lt;accelade:script&gt;
    return {
        addFive() {
            $set('count', $get('count') + 5);
        },
        double() {
            $set('count', $get('count') * 2);
        }
    };
&lt;/accelade:script&gt;</pre>
        </div>
    </section>

    <!-- Demo: SPA Navigation -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-cyan-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">SPA Navigation</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Navigate without full page reloads using &lt;x-accelade::link&gt;.</p>

        <!-- SPA Demo (Same Framework - No Page Reload) -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">SPA Navigation (Same Framework)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}"
                    class="px-6 py-3 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition"
                >
                    Reload This Page (SPA)
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}?time={{ time() }}"
                    class="px-6 py-3 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition"
                >
                    Navigate with Query (SPA)
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Watch the counter state reset without a full page reload!</p>
        </div>

        <!-- Preserve Scroll & State -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Preserve Scroll & State</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}?t={{ time() }}"
                    :preserveScroll="true"
                    class="px-6 py-3 bg-teal-600 text-white rounded-xl font-medium hover:bg-teal-700 transition"
                >
                    Preserve Scroll Position
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}?t={{ time() }}"
                    :preserveState="true"
                    class="px-6 py-3 bg-amber-600 text-white rounded-xl font-medium hover:bg-amber-700 transition"
                >
                    Preserve Component State
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.vanilla') }}?t={{ time() }}"
                    :preserveScroll="true"
                    :preserveState="true"
                    class="px-6 py-3 bg-rose-600 text-white rounded-xl font-medium hover:bg-rose-700 transition"
                >
                    Preserve Both
                </x-accelade::link>
            </div>
            <p class="text-xs text-slate-400 text-center mt-2">Scroll down, update the counter, then click to test preservation!</p>
        </div>

        <!-- Framework Switch (Full Page Reload) -->
        <div>
            <h3 class="text-sm font-semibold text-slate-600 mb-3 text-center">Switch Framework (Full Reload)</h3>
            <div class="flex gap-4 justify-center flex-wrap">
                <x-accelade::link
                    href="{{ route('demo.vue') }}"
                    class="px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 transition"
                >
                    Vue Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.react') }}"
                    class="px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 transition"
                >
                    React Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.svelte') }}"
                    class="px-6 py-3 bg-orange-600 text-white rounded-xl font-medium hover:bg-orange-700 transition"
                >
                    Svelte Demo
                </x-accelade::link>
                <x-accelade::link
                    href="{{ route('demo.angular') }}"
                    class="px-6 py-3 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition"
                >
                    Angular Demo
                </x-accelade::link>
            </div>
        </div>
    </section>

    <!-- Demo: Progress Bar Testing -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-amber-500 rounded-full animate-pulse"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Progress Bar Demo</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Test the progress bar with manual controls and simulated requests.</p>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Manual Controls -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Manual Controls</h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="window.Accelade?.progress?.start()"
                        class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm"
                    >
                        Start Progress
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done()"
                        class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm"
                    >
                        Complete
                    </button>
                    <button
                        onclick="window.Accelade?.progress?.done(true)"
                        class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm"
                    >
                        Force Complete
                    </button>
                </div>
            </div>

            <!-- Simulated Request -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Simulated Server Request</h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="testServerRequest()"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm"
                    >
                        Test Sync Request
                    </button>
                    <button
                        onclick="testSlowRequest()"
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm"
                    >
                        Test Slow Request (2s)
                    </button>
                </div>
                <p id="request-status" class="text-sm text-slate-500 mt-3"></p>
            </div>
        </div>

        <!-- Progress Config -->
        <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
            <h3 class="font-medium text-slate-700 mb-4">Configure Progress Bar</h3>
            <div class="grid md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Color</label>
                    <input
                        type="color"
                        id="progress-color"
                        value="#6366f1"
                        onchange="updateProgressConfig()"
                        class="w-full h-10 rounded-lg cursor-pointer"
                    />
                </div>
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Height (px)</label>
                    <input
                        type="range"
                        id="progress-height"
                        min="2"
                        max="10"
                        value="3"
                        onchange="updateProgressConfig()"
                        class="w-full"
                    />
                </div>
                <div>
                    <label class="block text-sm text-slate-600 mb-1">Position</label>
                    <select
                        id="progress-position"
                        onchange="updateProgressConfig()"
                        class="w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"
                    >
                        <option value="top">Top</option>
                        <option value="bottom">Bottom</option>
                    </select>
                </div>
            </div>
        </div>

        <script>
            function testServerRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Sending request...';

                window.Accelade?.progress?.start();

                fetch('/accelade/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content,
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        component: 'demo-test',
                        property: 'testValue',
                        value: Date.now()
                    })
                })
                .then(res => res.json())
                .then(data => {
                    status.textContent = 'Success! Response: ' + JSON.stringify(data);
                    window.Accelade?.progress?.done();
                })
                .catch(err => {
                    status.textContent = 'Error: ' + err.message;
                    window.Accelade?.progress?.done();
                });
            }

            function testSlowRequest() {
                const status = document.getElementById('request-status');
                status.textContent = 'Starting slow request (2 seconds)...';

                window.Accelade?.progress?.start();

                setTimeout(() => {
                    status.textContent = 'Slow request completed!';
                    window.Accelade?.progress?.done();
                }, 2000);
            }

            function updateProgressConfig() {
                const config = {
                    color: document.getElementById('progress-color').value,
                    height: parseInt(document.getElementById('progress-height').value),
                    position: document.getElementById('progress-position').value
                };
                window.Accelade?.progress?.configure(config);
            }
        </script>
    </section>

    <!-- Demo: Notifications -->
    <section class="bg-white rounded-2xl shadow-xl shadow-slate-200/50 p-8 mb-8 border border-slate-100">
        <div class="flex items-center gap-3 mb-2">
            <span class="w-3 h-3 bg-emerald-500 rounded-full"></span>
            <h2 class="text-2xl font-semibold text-slate-800">Notifications</h2>
        </div>
        <p class="text-slate-500 mb-6 ml-6">Filament-style notifications from PHP backend or JavaScript frontend.</p>

        <!-- Backend (PHP) Notifications -->
        <div class="mb-6">
            <h3 class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                <span class="w-2 h-2 bg-violet-500 rounded-full"></span>
                Backend (PHP) - Triggered from server, persists across redirects
            </h3>
            <div class="bg-violet-50 rounded-xl p-6 border border-violet-100">
                <div class="flex flex-wrap gap-3 mb-4">
                    <a href="{{ route('demo.notify', 'success') }}" class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm" data-testid="backend-notify-success">Success</a>
                    <a href="{{ route('demo.notify', 'info') }}" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm" data-testid="backend-notify-info">Info</a>
                    <a href="{{ route('demo.notify', 'warning') }}" class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm" data-testid="backend-notify-warning">Warning</a>
                    <a href="{{ route('demo.notify', 'danger') }}" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm" data-testid="backend-notify-danger">Danger</a>
                </div>
                <div class="flex flex-wrap gap-3">
                    <a href="{{ route('demo.notify', 'persistent') }}" class="px-4 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition text-sm">Persistent</a>
                    <a href="{{ route('demo.notify', 'actions') }}" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition text-sm">With Actions</a>
                    <a href="{{ route('demo.notify', 'custom') }}" class="px-4 py-2 bg-pink-600 text-white rounded-lg font-medium hover:bg-pink-700 transition text-sm">Custom Icon</a>
                </div>
                <div class="mt-4 bg-white/60 rounded-lg p-3">
                    <pre class="text-xs font-mono text-slate-700">// PHP Controller
Notify::success('Saved!')->body('Changes saved.');
return redirect()->back();</pre>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- Frontend (JS) Quick Notifications -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-cyan-500 rounded-full"></span>
                    Frontend (JavaScript)
                </h3>
                <div class="flex flex-wrap gap-3">
                    <button
                        onclick="window.Accelade?.notify?.success('Success!', 'Operation completed successfully.')"
                        class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 transition text-sm"
                        data-testid="notify-success"
                    >
                        Success
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.info('Info', 'Here is some information.')"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm"
                        data-testid="notify-info"
                    >
                        Info
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.warning('Warning', 'Please be careful!')"
                        class="px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition text-sm"
                        data-testid="notify-warning"
                    >
                        Warning
                    </button>
                    <button
                        onclick="window.Accelade?.notify?.danger('Error', 'Something went wrong.')"
                        class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm"
                        data-testid="notify-danger"
                    >
                        Danger
                    </button>
                </div>
            </div>

            <!-- Position Control -->
            <div class="bg-slate-50 rounded-xl p-6 border border-slate-100">
                <h3 class="font-medium text-slate-700 mb-4">Position</h3>
                <div class="flex flex-wrap gap-2">
                    <button onclick="testNotifyPosition('top-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Left</button>
                    <button onclick="testNotifyPosition('top-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Center</button>
                    <button onclick="testNotifyPosition('top-right')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Top Right</button>
                    <button onclick="testNotifyPosition('bottom-left')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Left</button>
                    <button onclick="testNotifyPosition('bottom-center')" class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition">Bottom Center</button>
                    <button onclick="testNotifyPosition('bottom-right')"
                        class="px-3 py-1.5 bg-slate-600 text-white rounded-lg text-xs hover:bg-slate-700 transition"
                    >
                        Bottom Right
                    </button>
                </div>
            </div>
        </div>

        <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
            <pre class="text-sm font-mono text-slate-700 whitespace-pre-wrap">// JavaScript API
window.Accelade.notify.success('Title', 'Message');
window.Accelade.notify.info('Title', 'Message');
window.Accelade.notify.warning('Title', 'Message');
window.Accelade.notify.danger('Title', 'Message');

// PHP (Backend)
Notify::success('Saved!')->message('Changes saved.');</pre>
        </div>

        <script>
            function testNotifyPosition(position) {
                window.Accelade?.notify?.show({
                    id: 'pos-' + Date.now(),
                    title: position,
                    message: 'Notification at ' + position,
                    type: 'info',
                    position: position,
                    duration: 3000,
                    dismissible: true
                });
            }
        </script>
    </section>

    <!-- Shared Data Section -->
    @include('accelade::demo.partials._shared-data', ['prefix' => 'a'])

    <!-- Lazy Loading Section -->
    @include('accelade::demo.partials._lazy-loading', ['prefix' => 'a'])

    <!-- Content Component Section -->
    @include('accelade::demo.partials._content')

    <!-- Data Component Section -->
    @include('accelade::demo.partials._data-component', ['prefix' => 'a'])

    <!-- Defer Component Section -->
    @include('accelade::demo.partials._defer-component', ['prefix' => 'a'])

    <!-- Rehydrate Component Section -->
    @include('accelade::demo.partials._rehydrate-component', ['prefix' => 'a'])

    <!-- Errors Component Section -->
    @include('accelade::demo.partials._errors-component', ['prefix' => 'a'])

    <!-- Vanilla JS Features -->
    <section class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-8 text-center">Vanilla JS Features</h2>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">a-*</div>
                <h3 class="font-semibold text-lg mb-2">Directives</h3>
                <p class="text-indigo-100 text-sm">a-text, a-show, a-if, a-model, @click, a-bind</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">~6KB</div>
                <h3 class="font-semibold text-lg mb-2">Ultra Lightweight</h3>
                <p class="text-indigo-100 text-sm">Minimal footprint for maximum performance.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">SPA</div>
                <h3 class="font-semibold text-lg mb-2">Built-in Router</h3>
                <p class="text-indigo-100 text-sm">SPA navigation with &lt;accelade:link&gt; component.</p>
            </div>

            <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
                <div class="text-3xl mb-3">JS</div>
                <h3 class="font-semibold text-lg mb-2">Custom Scripts</h3>
                <p class="text-indigo-100 text-sm">Define custom functions with &lt;accelade:script&gt;.</p>
            </div>
        </div>
    </section>
</x-accelade::layouts.demo>
</file>

<file path="package.json">
{
    "name": "@accelade/accelade",
    "version": "0.2.0",
    "description": "Reactive Blade templates with Vue, React, Svelte, Angular, or vanilla JavaScript",
    "author": "Fady Mondy <info@3x1.io> (https://3x1.io)",
    "license": "MIT",
    "homepage": "https://github.com/fadymondy/accelade",
    "repository": {
        "type": "git",
        "url": "https://github.com/fadymondy/accelade.git"
    },
    "bugs": {
        "url": "https://github.com/fadymondy/accelade/issues"
    },
    "private": true,
    "type": "module",
    "main": "dist/accelade.js",
    "module": "dist/accelade.esm.js",
    "types": "dist/index.d.ts",
    "exports": {
        ".": {
            "types": "./dist/index.d.ts",
            "import": "./dist/accelade.esm.js",
            "require": "./dist/accelade.js"
        },
        "./react": {
            "types": "./dist/index.d.ts",
            "import": "./dist/accelade.esm.js",
            "require": "./dist/accelade.js"
        }
    },
    "scripts": {
        "dev": "vite --mode unified",
        "build": "vite build --mode unified",
        "build:unified": "vite build --mode unified",
        "build:vanilla": "vite build --mode vanilla",
        "build:vue": "vite build --mode vue",
        "build:react": "vite build --mode react",
        "build:all": "npm run build:unified && npm run build:vanilla && npm run build:vue && npm run build:react",
        "typecheck": "tsc --noEmit",
        "demo": "npx serve . -p 3000",
        "test": "playwright test",
        "test:e2e": "playwright test",
        "test:e2e:ui": "playwright test --ui",
        "test:e2e:headed": "playwright test --headed",
        "test:e2e:debug": "playwright test --debug",
        "test:install": "playwright install chromium"
    },
    "devDependencies": {
        "@playwright/test": "^1.57.0",
        "@types/node": "^25.0.6",
        "@types/react": "^19.2.8",
        "@types/react-dom": "^19.2.3",
        "@vitejs/plugin-react": "^5.1.2",
        "@vitejs/plugin-vue": "^6.0.3",
        "react": "^19.2.3",
        "react-dom": "^19.2.3",
        "terser": "^5.31.0",
        "typescript": "^5.7.0",
        "vite": "^7.3.1",
        "vue": "^3.5.0"
    }
}
</file>

<file path=".github/workflows/tests.yml">
name: Tests

on:
  push:
    branches: [main, master, develop]
  pull_request:
    branches: [main, master, develop]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    name: Build JS

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install dependencies
        run: npm install

      - name: Build
        run: npm run build

      - name: Type check
        run: npm run typecheck

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: accelade-dist
          path: dist
          retention-days: 1

  php-tests:
    runs-on: ${{ matrix.os }}
    name: PHP ${{ matrix.php }} - ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        php: ['8.2', '8.3', '8.4']

    steps:
      - uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php }}
          extensions: dom, curl, libxml, mbstring, zip, pcntl, pdo, sqlite, pdo_sqlite
          coverage: none

      - name: Get Composer cache directory
        id: composer-cache
        shell: bash
        run: echo "dir=$(composer config cache-files-dir)" >> $GITHUB_OUTPUT

      - name: Cache Composer dependencies
        uses: actions/cache@v4
        with:
          path: ${{ steps.composer-cache.outputs.dir }}
          key: ${{ runner.os }}-php${{ matrix.php }}-composer-${{ hashFiles('composer.lock') }}
          restore-keys: ${{ runner.os }}-php${{ matrix.php }}-composer-

      - name: Install dependencies
        run: composer install --prefer-dist --no-interaction --no-progress

      - name: Run PEST tests
        run: ./vendor/bin/pest --colors=always

  code-quality:
    runs-on: ubuntu-latest
    name: Code Quality

    steps:
      - uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.3'
          extensions: dom, curl, libxml, mbstring, zip
          coverage: none

      - name: Get Composer cache directory
        id: composer-cache
        run: echo "dir=$(composer config cache-files-dir)" >> $GITHUB_OUTPUT

      - name: Cache Composer dependencies
        uses: actions/cache@v4
        with:
          path: ${{ steps.composer-cache.outputs.dir }}
          key: ${{ runner.os }}-composer-${{ hashFiles('composer.lock') }}
          restore-keys: ${{ runner.os }}-composer-

      - name: Install dependencies
        run: composer install --prefer-dist --no-interaction --no-progress

      - name: Check code formatting
        run: ./vendor/bin/pint --test

      - name: Install and Run Mago
        run: |
          curl -sSfL https://raw.githubusercontent.com/carthage-software/mago/main/scripts/install.sh | bash
          mago lint src/
</file>

<file path="docs/api-reference.md">
# API Reference

Complete API documentation for Accelade.

---

## PHP API

### Accelade Facade

```php
use Accelade\Facades\Accelade;
```

| Method | Description |
|--------|-------------|
| `scripts()` | Returns script tags for inclusion |
| `styles()` | Returns style tags for inclusion |
| `startComponent(array $state)` | Start a reactive block |
| `endComponent()` | End reactive block, returns HTML |

### Notify Facade

```php
use Accelade\Facades\Notify;
```

| Method | Returns | Description |
|--------|---------|-------------|
| `make()` | Notification | Create new notification |
| `title(string)` | Notification | Create with title |
| `success(string)` | Notification | Create success notification |
| `info(string)` | Notification | Create info notification |
| `warning(string)` | Notification | Create warning notification |
| `danger(string)` | Notification | Create danger notification |
| `push(Notification)` | void | Add to queue |
| `flush()` | Collection | Get and clear all |
| `close(string $id)` | void | Remove by ID |
| `defaultPosition(string)` | self | Set default position |
| `defaultDuration(int)` | self | Set default duration (ms) |

### Notification Class

```php
use Accelade\Notification\Notification;
```

#### Static Methods

| Method | Returns | Description |
|--------|---------|-------------|
| `make(?string $title)` | Notification | Create new instance |

#### Instance Methods

| Method | Returns | Description |
|--------|---------|-------------|
| `title(string)` | self | Set title |
| `body(string)` | self | Set body text |
| `message(string)` | self | Alias for body() |
| `status(string)` | self | Set status type |
| `success()` | self | Set success status |
| `info()` | self | Set info status |
| `warning()` | self | Set warning status |
| `danger()` | self | Set danger status |
| `icon(string)` | self | Set custom icon HTML |
| `iconColor(string)` | self | Set icon color |
| `color(string)` | self | Set accent color |
| `position(string)` | self | Set position |
| `duration(int)` | self | Set duration (ms) |
| `seconds(int)` | self | Set duration (seconds) |
| `autoDismiss(int)` | self | Alias for seconds() |
| `persistent()` | self | Disable auto-dismiss |
| `actions(array)` | self | Set action buttons |
| `send()` | self | Send notification |
| `getId()` | string | Get unique ID |
| `jsonSerialize()` | array | Serialize to array |

#### Positions

- `top-left`
- `top-center`
- `top-right` (default)
- `bottom-left`
- `bottom-center`
- `bottom-right`

#### Action Array Structure

```php
[
    'name' => 'action-name',      // Required: identifier
    'label' => 'Button Text',     // Required: display text
    'url' => '/path',             // Optional: link URL
    'openInNewTab' => false,      // Optional: target="_blank"
    'close' => false,             // Optional: close on click
    'dispatch' => 'event-name',   // Optional: browser event
]
```

### NotificationManager Class

```php
use Accelade\Notification\NotificationManager;
```

| Method | Returns | Description |
|--------|---------|-------------|
| `make()` | Notification | Create notification |
| `title(string)` | Notification | Create with title |
| `success(string)` | Notification | Create success |
| `info(string)` | Notification | Create info |
| `warning(string)` | Notification | Create warning |
| `danger(string)` | Notification | Create danger |
| `push(Notification)` | void | Add to queue |
| `flush()` | Collection | Get and clear all |
| `toArray()` | array | Get all as array |
| `close(string $id)` | void | Remove by ID |
| `setSession(SessionStore)` | void | Set session store |
| `defaultPosition(string)` | self | Default position |
| `defaultDuration(int)` | self | Default duration |

### Event Response (Broadcasting)

```php
use Accelade\Broadcasting\EventResponse;
```

| Method | Returns | Description |
|--------|---------|-------------|
| `redirect(string $url)` | EventResponse | Create redirect action |
| `redirectToRoute(string $route, array $params)` | EventResponse | Redirect to named route |
| `refresh()` | EventResponse | Create page refresh action |
| `toast(string $message, string $type)` | EventResponse | Create toast notification |
| `success(string $message)` | EventResponse | Success toast shorthand |
| `info(string $message)` | EventResponse | Info toast shorthand |
| `warning(string $message)` | EventResponse | Warning toast shorthand |
| `danger(string $message)` | EventResponse | Danger toast shorthand |
| `->withTitle(string $title)` | self | Add title to toast |
| `->with(array $data)` | self | Add custom data |
| `->toArray()` | array | Convert for broadcasting |

#### Accelade Event Helpers

```php
use Accelade\Facades\Accelade;
```

| Method | Returns | Description |
|--------|---------|-------------|
| `redirectOnEvent(string $url)` | EventResponse | Create redirect action |
| `redirectToRouteOnEvent(string $route, array $params)` | EventResponse | Redirect to named route |
| `refreshOnEvent()` | EventResponse | Create page refresh action |
| `toastOnEvent(string $message, string $type)` | EventResponse | Create toast notification |
| `successOnEvent(string $message)` | EventResponse | Success toast shorthand |
| `infoOnEvent(string $message)` | EventResponse | Info toast shorthand |
| `warningOnEvent(string $message)` | EventResponse | Warning toast shorthand |
| `dangerOnEvent(string $message)` | EventResponse | Danger toast shorthand |

### SEO Facade

```php
use Accelade\Facades\SEO;
```

| Method | Returns | Description |
|--------|---------|-------------|
| `title(?string)` | self | Set page title |
| `getTitle()` | ?string | Get page title |
| `description(?string)` | self | Set page description |
| `getDescription()` | ?string | Get page description |
| `keywords(string\|array)` | self | Set keywords |
| `getKeywords()` | array | Get keywords |
| `canonical(?string)` | self | Set canonical URL |
| `getCanonical()` | ?string | Get canonical URL |
| `robots(?string)` | self | Set robots meta |
| `getRobots()` | ?string | Get robots meta |
| `author(?string)` | self | Set author meta |
| `getAuthor()` | ?string | Get author meta |
| `openGraphType(?string)` | self | Set OG type |
| `openGraphSiteName(?string)` | self | Set OG site name |
| `openGraphTitle(?string)` | self | Set OG title |
| `openGraphDescription(?string)` | self | Set OG description |
| `openGraphUrl(?string)` | self | Set OG URL |
| `openGraphImage(?string, ?string)` | self | Set OG image + alt |
| `openGraphLocale(?string)` | self | Set OG locale |
| `getOpenGraph()` | array | Get all OG values |
| `twitterCard(?string)` | self | Set Twitter card type |
| `twitterSite(?string)` | self | Set Twitter site |
| `twitterCreator(?string)` | self | Set Twitter creator |
| `twitterTitle(?string)` | self | Set Twitter title |
| `twitterDescription(?string)` | self | Set Twitter description |
| `twitterImage(?string, ?string)` | self | Set Twitter image + alt |
| `getTwitter()` | array | Get all Twitter values |
| `metaByName(string, string)` | self | Add meta by name |
| `metaByProperty(string, string)` | self | Add meta by property |
| `meta(array)` | self | Add custom meta |
| `getMeta()` | array | Get all custom meta |
| `reset()` | self | Reset all values |
| `buildTitle()` | ?string | Build formatted title |
| `buildDescription()` | ?string | Get effective description |
| `buildKeywords()` | array | Get effective keywords |
| `buildCanonical()` | ?string | Get effective canonical |
| `toArray()` | array | Convert to array |
| `toHtml()` | string | Generate HTML meta tags |
| `render()` | string | Alias for toHtml() |

---

## Blade Directives

### @acceladeScripts

Outputs JavaScript bundle and configuration:

```blade
@acceladeScripts
```

Output:
```html
<script>
    window.AcceladeConfig = { /* config */ };
</script>
<script src="/accelade/accelade-v2.js" defer></script>
```

### @acceladeStyles

Outputs CSS for notifications and progress bar:

```blade
@acceladeStyles
```

### @acceladeNotifications

Renders the notifications container:

```blade
@acceladeNotifications
```

### @accelade / @endaccelade

Creates a reactive component block:

```blade
@accelade(['count' => 0, 'name' => ''])
    {{-- Reactive content --}}
@endaccelade

{{-- With custom ID --}}
@accelade(['count' => 0], 'my-counter')
    {{-- Content --}}
@endaccelade
```

### Script Component

The `<x-accelade::script>` component allows you to define custom JavaScript functions that have full access to the component's state and built-in actions.

```blade
@accelade(['count' => 0, 'items' => []])
    <button @click="customIncrement()">Add 5</button>
    <button @click="addItem('New Item')">Add Item</button>
    <button @click="handleSubmit($event)">Submit</button>

    <x-accelade::script>
        return {
            customIncrement() {
                $set('count', $get('count') + 5);
            },
            addItem(name) {
                const items = $get('items');
                items.push({ name, id: Date.now() });
                $set('items', items);
            },
            handleSubmit(event) {
                event.preventDefault();
                // Do something with state...
                $navigate('/success');
            }
        };
    </x-accelade::script>
@endaccelade
```

**Available Functions Inside Script:**

| Function | Description |
|----------|-------------|
| `$set(key, value)` | Set a state value |
| `$get(key)` | Get a state value |
| `$toggle(key)` | Toggle a boolean state value |
| `$reset(key?)` | Reset state to initial (all or specific key) |
| `$navigate(url, options?)` | Navigate to a URL using SPA |
| `$watch(key, callback)` | Watch a state property (Vue only) |
| `increment(key, amount?)` | Increment a numeric state value |
| `decrement(key, amount?)` | Decrement a numeric state value |
| `state` | Direct access to the reactive state object |
| `actions` | Access to built-in action methods |

**Framework-Specific Rendering:**

The component automatically renders the correct script attribute based on your configured framework:

| Framework | Output |
|-----------|--------|
| Vanilla | `<script a-script>...</script>` |
| Vue | `<script v-script>...</script>` |
| React | `<script state-script>...</script>` |
| Svelte | `<script state-script>...</script>` |
| Angular | `<script state-script>...</script>` |

**Example: Form with Custom Validation**

```blade
@accelade(['email' => '', 'password' => '', 'errors' => []])
    <form @submit.prevent="validate()">
        <input a-model="email" type="email" placeholder="Email">
        <p a-show="errors.email" a-text="errors.email" class="error"></p>

        <input a-model="password" type="password" placeholder="Password">
        <p a-show="errors.password" a-text="errors.password" class="error"></p>

        <button type="submit">Login</button>
    </form>

    <x-accelade::script>
        return {
            validate() {
                const errors = {};
                const email = $get('email');
                const password = $get('password');

                if (!email) {
                    errors.email = 'Email is required';
                } else if (!email.includes('@')) {
                    errors.email = 'Invalid email format';
                }

                if (!password) {
                    errors.password = 'Password is required';
                } else if (password.length < 8) {
                    errors.password = 'Password must be at least 8 characters';
                }

                $set('errors', errors);

                if (Object.keys(errors).length === 0) {
                    this.submitForm();
                }
            },
            async submitForm() {
                // Submit to server...
                $navigate('/dashboard');
            }
        };
    </x-accelade::script>
@endaccelade
```

**Example: Async Data Loading**

```blade
@accelade(['loading' => false, 'users' => [], 'error' => null])
    <button @click="loadUsers()" a-show="!loading">Load Users</button>
    <span a-show="loading">Loading...</span>

    <ul a-show="users.length">
        <template a-for="user in users">
            <li a-text="user.name"></li>
        </template>
    </ul>

    <p a-show="error" a-text="error" class="error"></p>

    <x-accelade::script>
        return {
            async loadUsers() {
                $set('loading', true);
                $set('error', null);

                try {
                    const response = await fetch('/api/users');
                    if (!response.ok) throw new Error('Failed to load users');

                    const data = await response.json();
                    $set('users', data);
                } catch (e) {
                    $set('error', e.message);
                } finally {
                    $set('loading', false);
                }
            }
        };
    </x-accelade::script>
@endaccelade
```

### SEO Directives

```blade
{{-- Set page title --}}
@seoTitle('My Page Title')

{{-- Set page description --}}
@seoDescription('Page description')

{{-- Set keywords --}}
@seoKeywords('php, laravel, accelade')

{{-- Set canonical URL --}}
@seoCanonical('https://example.com/page')

{{-- Set robots meta --}}
@seoRobots('index, follow')

{{-- Set author --}}
@seoAuthor('John Doe')

{{-- Set OpenGraph data --}}
@seoOpenGraph([
    'type' => 'article',
    'site_name' => 'My Site',
    'title' => 'OG Title',
    'description' => 'OG Description',
    'image' => 'https://example.com/og.jpg',
])

{{-- Set Twitter Card data --}}
@seoTwitter([
    'card' => 'summary_large_image',
    'site' => '@mysite',
    'creator' => '@johndoe',
])

{{-- Add custom meta by name --}}
@seoMeta('theme-color', '#6366f1')

{{-- Output all SEO meta tags (place in <head>) --}}
@seo
```

### Lazy Loading Component

```blade
{{-- Basic lazy loading with shimmer --}}
<x-accelade::lazy :shimmer="true">
    Content to load lazily
</x-accelade::lazy>

{{-- With custom shimmer options --}}
<x-accelade::lazy
    :shimmer="true"
    :shimmer-lines="5"
    shimmer-height="200px"
    :shimmer-rounded="true"
>
    Content here
</x-accelade::lazy>

{{-- Circle shimmer for avatars --}}
<x-accelade::lazy :shimmer="true" :shimmer-circle="true">
    <img src="{{ $avatar }}" alt="Avatar">
</x-accelade::lazy>

{{-- Custom placeholder --}}
<x-accelade::lazy>
    <x-slot:placeholder>
        <div class="loading">Loading...</div>
    </x-slot:placeholder>
    Content here
</x-accelade::lazy>

{{-- Load from URL --}}
<x-accelade::lazy url="/api/content" :shimmer="true" />

{{-- Conditional loading --}}
<x-accelade::lazy show="isVisible" :shimmer="true">
    Content shown when isVisible is true
</x-accelade::lazy>

{{-- With delay --}}
<x-accelade::lazy :delay="500" :shimmer="true">
    Content loads after 500ms
</x-accelade::lazy>
```

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `shimmer` | bool | `false` | Enable shimmer placeholder |
| `shimmer-lines` | int | `3` | Number of shimmer lines |
| `shimmer-height` | string | auto | Custom height |
| `shimmer-width` | string | auto | Custom width |
| `shimmer-rounded` | bool | `false` | Rounded corners |
| `shimmer-circle` | bool | `false` | Circle shape |
| `url` | string | null | URL to fetch content |
| `method` | string | `GET` | HTTP method |
| `data` | array | `[]` | POST data |
| `delay` | int | `0` | Delay in ms |
| `show` | bool/string | `true` | Condition for loading |
| `name` | string | null | Component name |

### Event Component (Laravel Echo)

```blade
{{-- Basic event listener --}}
<x-accelade::event channel="orders" listen="OrderCreated">
    <p a-if="subscribed">Listening for orders...</p>
</x-accelade::event>

{{-- Private channel --}}
<x-accelade::event
    channel="user.{{ auth()->id() }}"
    :private="true"
    listen="MessageReceived,NotificationReceived"
>
    <span a-text="events.length"></span> new events
</x-accelade::event>

{{-- Presence channel --}}
<x-accelade::event
    channel="chat.room.1"
    :presence="true"
    listen="UserJoined,UserLeft"
/>

{{-- With scroll preservation --}}
<x-accelade::event
    channel="dashboard"
    listen="DataUpdated"
    :preserve-scroll="true"
/>
```

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `channel` | string | null | Channel name to subscribe to |
| `private` | bool | `false` | Use private (authenticated) channel |
| `presence` | bool | `false` | Use presence channel |
| `listen` | string | '' | Comma-separated event names |
| `preserve-scroll` | bool | `false` | Preserve scroll on refresh |

**Exposed State:**

| State | Type | Description |
|-------|------|-------------|
| `subscribed` | boolean | Whether connected to channel |
| `events` | array | Received events with `name`, `data`, `timestamp` |

### Flash Component (Session Flash Data)

```blade
{{-- Basic flash message display --}}
<x-accelade::flash>
    <div a-if="flash.has('success')" class="alert alert-success">
        <span a-text="flash.success"></span>
    </div>

    <div a-if="flash.has('error')" class="alert alert-danger">
        <span a-text="flash.error"></span>
    </div>
</x-accelade::flash>

{{-- With custom styling --}}
<x-accelade::flash class="fixed top-4 right-4 z-50">
    <div a-show="flash.has('message')" class="p-4 bg-white shadow-lg rounded">
        <p a-text="flash.message"></p>
    </div>
</x-accelade::flash>

{{-- Disable global sharing --}}
<x-accelade::flash :shared="false">
    <p a-text="flash.info"></p>
</x-accelade::flash>
```

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `shared` | bool | `true` | Share flash data globally via `Accelade::share()` |

**Exposed State:**

| State | Type | Description |
|-------|------|-------------|
| `flash` | object | Flash data object with `.has()` method and direct property access |

**Flash Object Methods:**

| Method | Description |
|--------|-------------|
| `flash.has(key)` | Check if a flash key exists and has a truthy value |
| `flash.key` | Access flash value directly by key |
| `flash.get(key, default)` | Get value with optional default |
| `flash.all()` | Get all flash data as an object |

### Modal Component (Dialogs & Slideovers)

```blade
{{-- Pre-loaded modal with hash link --}}
<x-accelade::link href="#my-modal">Open Modal</x-accelade::link>

<x-accelade::modal name="my-modal">
    <h2>Modal Title</h2>
    <p>Modal content...</p>
    <button data-modal-close>Close</button>
</x-accelade::modal>

{{-- Async modal (load from URL) --}}
<x-accelade::link href="/users/create" :modal="true">
    Create User
</x-accelade::link>

{{-- Slideover panel --}}
<x-accelade::modal name="settings" :slideover="true">
    <nav>Settings content...</nav>
</x-accelade::modal>

{{-- Custom size and position --}}
<x-accelade::modal name="large" max-width="4xl" position="top">
    Large content...
</x-accelade::modal>
```

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `name` | string | `null` | Modal name for hash-based opening |
| `slideover` | bool | `false` | Render as slideover instead of modal |
| `maxWidth` | string | `2xl` / `md` | Max width (sm, md, lg, xl, 2xl, 3xl, 4xl, 5xl, 6xl, 7xl) |
| `position` | string | `center` | Vertical position (top, center, bottom) |
| `slideoverPosition` | string | `right` | Slideover position (left, right) |
| `closeExplicitly` | bool | `false` | Disable ESC and outside click closing |
| `closeButton` | bool | `true` | Show the X close button |
| `opened` | bool | `false` | Open immediately on page load |

**Link Component Modal Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `modal` | bool | `false` | Open link in modal |
| `slideover` | bool | `false` | Open link in slideover |
| `modalMaxWidth` | string | `null` | Override modal max-width |
| `modalPosition` | string | `null` | Override modal position |
| `slideoverPosition` | string | `null` | Override slideover position |

**JavaScript API:**

```javascript
// Open named modal
window.Accelade.modal.openNamed('my-modal');

// Open from URL
await window.Accelade.modal.openUrl('/form', { maxWidth: '4xl' });

// Close all modals
window.Accelade.modal.closeAll();
```

### Link Component (Enhanced Navigation)

```blade
{{-- Basic SPA navigation --}}
<x-accelade::link href="/dashboard">Dashboard</x-accelade::link>

{{-- With HTTP methods --}}
<x-accelade::link
    href="/api/items"
    method="POST"
    :data="['name' => 'New Item']"
>
    Create Item
</x-accelade::link>

{{-- DELETE with confirmation --}}
<x-accelade::link
    href="/api/items/123"
    method="DELETE"
    confirm-text="Delete this item?"
    confirm-button="Delete"
    :confirm-danger="true"
>
    Delete
</x-accelade::link>

{{-- External link --}}
<x-accelade::link href="https://example.com" :away="true">
    External Site
</x-accelade::link>

{{-- With navigation options --}}
<x-accelade::link
    href="/page"
    :preserve-scroll="true"
    :prefetch="true"
>
    Navigate
</x-accelade::link>
```

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `href` | string | - | Target URL (required) |
| `method` | string | `GET` | HTTP method (GET, POST, PUT, PATCH, DELETE) |
| `data` | array | `null` | Request payload data |
| `headers` | array | `null` | Custom HTTP headers |
| `spa` | bool | `true` | Enable SPA navigation |
| `away` | bool | `false` | Treat as external link (full page navigation) |
| `activeClass` | string | `active` | CSS class added when on current URL |
| `prefetch` | bool | `false` | Prefetch page on hover |
| `preserveScroll` | bool | `false` | Keep scroll position after navigation |
| `preserveState` | bool | `false` | Preserve component state |
| `replace` | bool | `false` | Replace history instead of push |
| `confirm` | bool/string | `null` | Show confirmation dialog |
| `confirmText` | string | `null` | Custom confirmation message |
| `confirmTitle` | string | `null` | Confirmation dialog title |
| `confirmButton` | string | `Confirm` | Confirm button label |
| `cancelButton` | string | `Cancel` | Cancel button label |
| `confirmDanger` | bool | `false` | Render confirm button in red (danger) style |

**Framework-Specific Attributes:**

| Framework | Attribute |
|-----------|-----------|
| Vanilla | `a-link` |
| Vue | `data-accelade-link` |
| React | `data-spa-link` |
| Svelte | `data-spa-link` |
| Angular | `data-spa-link` |

**JavaScript Events:**

| Event | Description |
|-------|-------------|
| `accelade:link-before` | Fired before link is handled. Set `e.detail.cancelled = true` to prevent navigation |
| `accelade:link-response` | Fired after response received |
| `accelade:link-error` | Fired on navigation error |

**Programmatic Confirmation:**

```javascript
import { confirm, confirmDanger, showConfirmDialog } from 'accelade';

// Simple confirm
const result = await confirm('Are you sure?');

// Danger confirm
const deleted = await confirmDanger('Delete this item?', 'Delete');

// Full options
const result = await showConfirmDialog({
    title: 'Confirm Action',
    text: 'This will modify your data.',
    confirmButton: 'Proceed',
    cancelButton: 'Cancel',
    danger: false,
});
```

---

## JavaScript API

### Window.Accelade

```typescript
interface Accelade {
    init(): void;
    navigate(url: string, options?: NavigateOptions): void;
    router: Router;
    progress: Progress;
    notify: NotificationManager;
    getComponent(id: string): Component | undefined;
    extend(extensions: object): void;
}
```

### Router

```typescript
interface Router {
    currentUrl: string;
    navigate(url: string, options?: NavigateOptions): Promise<void>;
    replace(url: string): void;
    prefetch(url: string): void;
    back(): void;
    forward(): void;
}

interface NavigateOptions {
    preserveScroll?: boolean;
    preserveState?: boolean;
    replace?: boolean;
}
```

### Progress

```typescript
interface Progress {
    start(): void;
    done(force?: boolean): void;
    set(percent: number): void;
    inc(amount?: number): void;
    configure(options: ProgressOptions): void;
}

interface ProgressOptions {
    color?: string;
    height?: number;
    showBar?: boolean;
    includeSpinner?: boolean;
    spinnerPosition?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';
    position?: 'top' | 'bottom';
}
```

### NotificationManager (JS)

```typescript
interface NotificationManager {
    show(options: NotificationOptions): string;
    success(title: string, body?: string): string;
    info(title: string, body?: string): string;
    warning(title: string, body?: string): string;
    danger(title: string, body?: string): string;
    close(id: string): void;
    closeAll(): void;
}

interface NotificationOptions {
    id?: string;
    title: string;
    body?: string;
    status?: 'success' | 'info' | 'warning' | 'danger';
    position?: NotificationPosition;
    duration?: number;
    persistent?: boolean;
    actions?: NotificationAction[];
}
```

### Component

```typescript
interface Component {
    id: string;
    state: Record<string, any>;
    getState(): Record<string, any>;
    setState(key: string, value: any): void;
    get(key: string): any;
    set(key: string, value: any): void;
    toggle(key: string): void;
    reset(key?: string): void;
    destroy(): void;
}
```

---

## Events

### Browser Events

| Event | Detail | Description |
|-------|--------|-------------|
| `accelade:init` | `{}` | Accelade initialized |
| `accelade:navigate-start` | `{ url }` | Navigation started |
| `accelade:navigate-end` | `{ url }` | Navigation completed |
| `accelade:navigate-error` | `{ error }` | Navigation failed |
| `accelade:state-change` | `{ componentId, key, value }` | State changed |
| `accelade:notification-show` | `{ notification }` | Notification shown |
| `accelade:notification-close` | `{ id }` | Notification closed |
| `accelade:echo` | `{ name, data }` | Laravel Echo event received |

### Listening to Events

```javascript
document.addEventListener('accelade:navigate-end', (event) => {
    console.log('Navigated to:', event.detail.url);
});
```

---

## Component Directives

### Text/Content

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-text` | Vanilla | Bind text content |
| `v-text` | Vue | Bind text content |
| `state:text` | React | Bind text content |
| `bind:text` | Svelte | Bind text content |
| `ng-text` | Angular | Bind text content |

### HTML

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-html` | Vanilla | Bind HTML content |
| `v-html` | Vue | Bind HTML content |
| `state:html` | React | Bind HTML content |
| `bind:html` | Svelte | Bind HTML content |
| `ng-html` | Angular | Bind HTML content |

### Visibility

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-show` | Vanilla | Toggle display |
| `v-show` | Vue | Toggle display |
| `state:show` | React | Toggle display |
| `bind:show` | Svelte | Toggle display |
| `ng-show` | Angular | Toggle display |

### Conditional

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-if` | Vanilla | Conditional render |
| `v-if` | Vue | Conditional render |
| `state:if` | React | Conditional render |
| `bind:if` | Svelte | Conditional render |
| `ng-if` | Angular | Conditional render |

### Two-Way Binding

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-model` | Vanilla | Form input binding |
| `v-model` | Vue | Form input binding |
| `state:model` | React | Form input binding |
| `bind:value` | Svelte | Form input binding |
| `ng-model` | Angular | Form input binding |

### Events

All frameworks use `@event` syntax for event handling:

| Directive | Description | Example |
|-----------|-------------|---------|
| `@click` | Click event | `<button @click="increment()">` |
| `@submit` | Form submit | `<form @submit.prevent="save()">` |
| `@input` | Input change | `<input @input="validate()">` |
| `@change` | Value change | `<select @change="update()">` |
| `@keydown` | Key press | `<input @keydown.enter="submit()">` |

### Classes

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-class` | Vanilla | Dynamic classes |
| `v-bind:class` / `:class` | Vue | Dynamic classes |
| `state:className` | React | Dynamic classes |
| `class:name` | Svelte | Dynamic classes |
| `ng-class` | Angular | Dynamic classes |

### Server Sync

| Directive | Framework | Description |
|-----------|-----------|-------------|
| `a-sync` | All | Sync with server |

---

## Configuration Reference

```php
// config/accelade.php
return [
    // Frontend framework: vanilla, vue, react, svelte, angular
    'framework' => env('ACCELADE_FRAMEWORK', 'vanilla'),

    // Asset mode: route, published
    'asset_mode' => env('ACCELADE_ASSET_MODE', 'route'),

    // Route prefix
    'prefix' => 'accelade',

    // Middleware for routes
    'middleware' => ['web'],

    // Server state TTL (seconds)
    'state_ttl' => env('ACCELADE_STATE_TTL', 3600),

    // Sync debounce (milliseconds)
    'sync_debounce' => env('ACCELADE_SYNC_DEBOUNCE', 300),

    // Flash data sharing
    'flash' => [
        'enabled' => env('ACCELADE_FLASH_ENABLED', true),
        'keys' => null, // null = common keys, or ['message', 'success', 'error']
    ],

    // Progress bar options
    'progress' => [
        'delay' => 250,
        'color' => '#6366f1',
        'gradientColor' => '#8b5cf6',
        'gradientColor2' => '#a855f7',
        'useGradient' => true,
        'height' => 3,
        'showBar' => true,
        'includeSpinner' => true,
        'spinnerSize' => 18,
        'spinnerPosition' => 'top-right',
        'position' => 'top',
        'minimum' => 8,
        'easing' => 'ease-out',
        'speed' => 200,
        'trickleSpeed' => 200,
        'zIndex' => 99999,
    ],

    // Demo routes
    'demo' => [
        'enabled' => env('ACCELADE_DEMO_ENABLED', env('APP_ENV') !== 'production'),
        'prefix' => env('ACCELADE_DEMO_PREFIX', 'demo'),
        'middleware' => ['web'],
    ],

    // Testing
    'testing' => [
        'base_url' => env('ACCELADE_TEST_URL', env('APP_URL', 'http://localhost')),
    ],
];
```

---

## CSS Variables

```css
:root {
    /* Notification container */
    --accelade-notif-width: 24rem;
    --accelade-notif-radius: 0.75rem;
    --accelade-notif-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
    --accelade-notif-bg: #fff;
    --accelade-notif-animation-duration: 0.3s;

    /* Success */
    --accelade-notif-success-icon: #10b981;
    --accelade-notif-success-bg: #ecfdf5;
    --accelade-notif-success-border: #a7f3d0;

    /* Info */
    --accelade-notif-info-icon: #3b82f6;
    --accelade-notif-info-bg: #eff6ff;
    --accelade-notif-info-border: #bfdbfe;

    /* Warning */
    --accelade-notif-warning-icon: #f59e0b;
    --accelade-notif-warning-bg: #fffbeb;
    --accelade-notif-warning-border: #fde68a;

    /* Danger */
    --accelade-notif-danger-icon: #ef4444;
    --accelade-notif-danger-bg: #fef2f2;
    --accelade-notif-danger-border: #fecaca;
}
```
</file>

<file path="src/Accelade.php">
<?php

declare(strict_types=1);

namespace Accelade;

use Accelade\Broadcasting\EventResponse;
use Accelade\Exceptions\ExceptionHandler;
use Accelade\Support\SharedData;
use Closure;
use Illuminate\Contracts\Foundation\Application;
use Illuminate\Foundation\Exceptions\Handler;
use Illuminate\Support\Str;

class Accelade
{
    protected Application $app;

    protected array $componentStack = [];

    protected int $componentCounter = 0;

    protected SharedData $sharedData;

    public function __construct(Application $app)
    {
        $this->app = $app;
        $this->sharedData = new SharedData;
    }

    /**
     * Current framework override (set via setFramework method)
     */
    protected ?string $frameworkOverride = null;

    /**
     * Share data globally across the application.
     * Data will be available in the frontend via state.shared.
     *
     * @param  array<string, mixed>|string  $key
     */
    public function share(array|string $key, mixed $value = null): self
    {
        $this->sharedData->share($key, $value);

        return $this;
    }

    /**
     * Get a shared value by key.
     */
    public function getShared(string $key, mixed $default = null): mixed
    {
        return $this->sharedData->get($key, $default);
    }

    /**
     * Get all shared data.
     *
     * @return array<string, mixed>
     */
    public function allShared(): array
    {
        return $this->sharedData->all();
    }

    /**
     * Get the SharedData instance.
     */
    public function shared(): SharedData
    {
        return $this->sharedData;
    }

    /**
     * Set the framework to use for the current request.
     * This overrides the config value.
     */
    public function setFramework(string $framework): self
    {
        $this->frameworkOverride = $framework;

        return $this;
    }

    /**
     * Get the current framework.
     */
    public function getFramework(): string
    {
        return $this->frameworkOverride ?? config('accelade.framework', 'vanilla');
    }

    /**
     * Generate the script tags for Accelade.
     */
    public function scripts(): string
    {
        $framework = $this->getFramework();
        $assetMode = config('accelade.asset_mode', 'route');
        $syncDebounce = config('accelade.sync_debounce', 300);

        // Inline the JavaScript - use unified bundle (includes all frameworks)
        $jsPath = __DIR__.'/../dist/accelade.js';

        // Fallback to framework-specific bundle if unified doesn't exist
        if (! file_exists($jsPath)) {
            $jsPath = __DIR__."/../dist/accelade-{$framework}.js";
        }
        if (! file_exists($jsPath)) {
            $jsPath = __DIR__.'/../dist/accelade-vanilla.js';
        }

        $inlineJs = file_exists($jsPath) ? file_get_contents($jsPath) : "console.error('Accelade JS not found at: ' + '{$jsPath}');";

        // Get progress config
        $progressConfig = config('accelade.progress', []);
        $progressJson = json_encode($progressConfig);

        // Get navigation config
        $navigationConfig = config('accelade.navigation', []);
        $navigationJson = json_encode($navigationConfig);

        // Get shared data
        $sharedData = $this->allShared();
        $sharedJson = json_encode($sharedData, JSON_THROW_ON_ERROR);

        // Get error handling config
        $errorConfig = config('accelade.errors', []);
        $errorsJson = json_encode([
            'suppressErrors' => $errorConfig['suppress_errors'] ?? false,
            'showToasts' => $errorConfig['show_toasts'] ?? true,
            'logErrors' => $errorConfig['log_errors'] ?? true,
            'debug' => $errorConfig['debug'] ?? config('app.debug', false),
        ]);

        return <<<HTML
<script>
    window.AcceladeConfig = {
        framework: '{$framework}',
        syncDebounce: {$syncDebounce},
        csrfToken: document.querySelector('meta[name=\"csrf-token\"]')?.content || '',
        updateUrl: '/accelade/update',
        batchUpdateUrl: '/accelade/batch-update',
        progress: {$progressJson},
        navigation: {$navigationJson},
        shared: {$sharedJson},
        errors: {$errorsJson}
    };
</script>
<script>
{$inlineJs}
</script>
HTML;
    }

    /**
     * Generate any style tags for Accelade.
     */
    public function styles(): string
    {
        return <<<'HTML'
<style>
    /* ========================================
       Accelade Progress Bar (Inertia.js style)
       ======================================== */
    #accelade-progress {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        z-index: 99999;
        pointer-events: none;
        background: transparent;
        overflow: hidden;
    }

    #accelade-progress .bar {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.7), 0 0 5px rgba(139, 92, 246, 0.5);
        transition: width 0.2s ease-out;
        border-radius: 0 2px 2px 0;
    }

    #accelade-progress .bar.indeterminate {
        width: 100% !important;
        animation: accelade-progress-indeterminate 1.5s ease-in-out infinite;
        background: linear-gradient(90deg,
            transparent 0%,
            #6366f1 20%,
            #8b5cf6 50%,
            #a855f7 80%,
            transparent 100%
        );
        background-size: 200% 100%;
    }

    @keyframes accelade-progress-indeterminate {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    #accelade-progress .spinner {
        position: fixed;
        top: 15px;
        inset-inline-end: 15px;
        width: 18px;
        height: 18px;
        border: 2px solid transparent;
        border-top-color: #6366f1;
        border-inline-start-color: #8b5cf6;
        border-radius: 50%;
        animation: accelade-spinner 0.6s linear infinite;
        opacity: 0;
        transition: opacity 0.2s ease;
    }

    #accelade-progress .spinner.visible {
        opacity: 1;
    }

    @keyframes accelade-spinner {
        to { transform: rotate(360deg); }
    }

    /* ========================================
       Accelade Component Styles
       ======================================== */
    [data-accelade] {
        display: block;
    }

    /* Cloak: hide uninitialized components */
    [data-accelade-cloak],
    [a-cloak],
    [v-cloak] {
        opacity: 0 !important;
        pointer-events: none !important;
    }

    /* ========================================
       Page Transitions
       ======================================== */
    [data-accelade-page] {
        transition: opacity 0.15s ease-out, transform 0.15s ease-out;
    }

    [data-accelade-page].accelade-leaving {
        opacity: 0;
        transform: translateY(-8px);
    }

    [data-accelade-page].accelade-entering {
        opacity: 0;
        transform: translateY(8px);
    }

    /* Loading state during SPA navigation */
    .accelade-navigating {
        cursor: progress;
    }

    .accelade-navigating [data-accelade-page] {
        pointer-events: none;
    }

    /* ========================================
       Component Reveal Animation
       ======================================== */
    [data-accelade].accelade-ready {
        animation: accelade-reveal 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    @keyframes accelade-reveal {
        from {
            opacity: 0;
            transform: translateY(8px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Staggered reveal for multiple components */
    [data-accelade].accelade-ready:nth-child(1) { animation-delay: 0ms; }
    [data-accelade].accelade-ready:nth-child(2) { animation-delay: 50ms; }
    [data-accelade].accelade-ready:nth-child(3) { animation-delay: 100ms; }
    [data-accelade].accelade-ready:nth-child(4) { animation-delay: 150ms; }
    [data-accelade].accelade-ready:nth-child(5) { animation-delay: 200ms; }

    /* ========================================
       Accelade Notifications (Filament-style)
       CSS Variables for customization
       ======================================== */
    :root {
        --accelade-notif-width: 24rem;
        --accelade-notif-radius: 0.75rem;
        --accelade-notif-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --accelade-notif-bg: #fff;
        --accelade-notif-border: 1px solid rgb(229 231 235);
        --accelade-notif-title-color: #111827;
        --accelade-notif-body-color: #6b7280;
        --accelade-notif-success-icon: #10b981;
        --accelade-notif-success-bg: #ecfdf5;
        --accelade-notif-info-icon: #3b82f6;
        --accelade-notif-info-bg: #eff6ff;
        --accelade-notif-warning-icon: #f59e0b;
        --accelade-notif-warning-bg: #fffbeb;
        --accelade-notif-danger-icon: #ef4444;
        --accelade-notif-danger-bg: #fef2f2;
        --accelade-notif-action-color: #4f46e5;
        --accelade-notif-action-hover-bg: #f3f4f6;
        --accelade-notif-close-color: #9ca3af;
        --accelade-notif-close-hover-bg: #f3f4f6;
        --accelade-notif-close-hover-color: #6b7280;
    }

    /* Dark mode notifications */
    .dark, [data-theme="dark"] {
        --accelade-notif-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.3), 0 8px 10px -6px rgb(0 0 0 / 0.2);
        --accelade-notif-bg: #1e293b;
        --accelade-notif-border: 1px solid rgb(51 65 85);
        --accelade-notif-title-color: #f1f5f9;
        --accelade-notif-body-color: #94a3b8;
        --accelade-notif-success-icon: #34d399;
        --accelade-notif-success-bg: rgba(16, 185, 129, 0.15);
        --accelade-notif-info-icon: #60a5fa;
        --accelade-notif-info-bg: rgba(59, 130, 246, 0.15);
        --accelade-notif-warning-icon: #fbbf24;
        --accelade-notif-warning-bg: rgba(245, 158, 11, 0.15);
        --accelade-notif-danger-icon: #f87171;
        --accelade-notif-danger-bg: rgba(239, 68, 68, 0.15);
        --accelade-notif-action-color: #818cf8;
        --accelade-notif-action-hover-bg: #334155;
        --accelade-notif-close-color: #64748b;
        --accelade-notif-close-hover-bg: #334155;
        --accelade-notif-close-hover-color: #94a3b8;
    }

    .accelade-notifications {
        position: fixed;
        z-index: 99999;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: 1rem;
        width: var(--accelade-notif-width);
        max-width: calc(100vw - 2rem);
        pointer-events: none;
    }

    .accelade-notifications-top-right { top: 0; inset-inline-end: 0; }
    .accelade-notifications-top-left { top: 0; inset-inline-start: 0; }
    .accelade-notifications-top-center { top: 0; left: 50%; transform: translateX(-50%); }
    .accelade-notifications-bottom-right { bottom: 0; inset-inline-end: 0; flex-direction: column-reverse; }
    .accelade-notifications-bottom-left { bottom: 0; inset-inline-start: 0; flex-direction: column-reverse; }
    .accelade-notifications-bottom-center { bottom: 0; left: 50%; transform: translateX(-50%); flex-direction: column-reverse; }

    .accelade-notif {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 1rem;
        background: var(--accelade-notif-bg);
        border: var(--accelade-notif-border);
        border-radius: var(--accelade-notif-radius);
        box-shadow: var(--accelade-notif-shadow);
        pointer-events: auto;
        opacity: 0;
        transform: translateY(-0.5rem);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .accelade-notif-show { opacity: 1; transform: translateY(0); }
    .accelade-notif-hide { opacity: 0; transform: translateY(-0.5rem); }

    .accelade-notif-icon {
        flex-shrink: 0;
        width: 2rem;
        height: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
    }
    .accelade-notif-icon svg { width: 1.25rem; height: 1.25rem; }

    .accelade-notif-success .accelade-notif-icon { background: var(--accelade-notif-success-bg); color: var(--accelade-notif-success-icon); }
    .accelade-notif-info .accelade-notif-icon { background: var(--accelade-notif-info-bg); color: var(--accelade-notif-info-icon); }
    .accelade-notif-warning .accelade-notif-icon { background: var(--accelade-notif-warning-bg); color: var(--accelade-notif-warning-icon); }
    .accelade-notif-danger .accelade-notif-icon { background: var(--accelade-notif-danger-bg); color: var(--accelade-notif-danger-icon); }

    .accelade-notif-content { flex: 1; min-width: 0; }
    .accelade-notif-title { font-weight: 600; font-size: 0.875rem; color: var(--accelade-notif-title-color); line-height: 1.25rem; }
    .accelade-notif-body { font-size: 0.875rem; color: var(--accelade-notif-body-color); margin-top: 0.25rem; line-height: 1.25rem; }

    .accelade-notif-actions { display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-wrap: wrap; }
    .accelade-notif-action {
        display: inline-flex;
        align-items: center;
        padding: 0.375rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--accelade-notif-action-color);
        background: transparent;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: background 0.15s;
        text-decoration: none;
    }
    .accelade-notif-action:hover { background: var(--accelade-notif-action-hover-bg); }

    .accelade-notif-close {
        flex-shrink: 0;
        width: 1.5rem;
        height: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        background: transparent;
        cursor: pointer;
        color: var(--accelade-notif-close-color);
        border-radius: 0.375rem;
        transition: all 0.15s;
        margin-block: -0.25rem;
        margin-inline: 0 -0.25rem;
    }
    .accelade-notif-close:hover { background: var(--accelade-notif-close-hover-bg); color: var(--accelade-notif-close-hover-color); }
    .accelade-notif-close svg { width: 1rem; height: 1rem; }

    /* ========================================
       Accelade Show/Hide Transitions
       ======================================== */
    [a-show],
    [v-show],
    [s-show],
    [ng-show],
    [data-state-show] {
        transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        transform-origin: top center;
    }

    .accelade-hiding {
        opacity: 0 !important;
        transform: scale(0.98);
        pointer-events: none;
    }

    .accelade-visible {
        opacity: 1;
        transform: scale(1);
    }

    /* ========================================
       Animation Preset Utility Classes
       (Tailwind-compatible for animation presets)
       ======================================== */

    /* Transitions */
    .transition { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-opacity { transition-property: opacity; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-transform { transition-property: transform; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }

    /* Durations */
    .duration-100 { transition-duration: 100ms; }
    .duration-150 { transition-duration: 150ms; }
    .duration-200 { transition-duration: 200ms; }
    .duration-300 { transition-duration: 300ms; }
    .duration-500 { transition-duration: 500ms; }

    /* Easing */
    .ease-in { transition-timing-function: cubic-bezier(0.4, 0, 1, 1); }
    .ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }
    .ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); }

    /* Opacity */
    .opacity-0 { opacity: 0; }
    .opacity-100 { opacity: 1; }

    /* Scale */
    .scale-0 { transform: scale(0); }
    .scale-95 { transform: scale(0.95); }
    .scale-100 { transform: scale(1); }

    /* Translate X */
    .translate-x-0 { transform: translateX(0); }
    .translate-x-full { transform: translateX(100%); }
    .-translate-x-full { transform: translateX(-100%); }

    /* Translate Y */
    .translate-y-0 { transform: translateY(0); }
    .translate-y-full { transform: translateY(100%); }
    .-translate-y-full { transform: translateY(-100%); }

    /* Combined transforms (for animations that use multiple) */
    .opacity-0.scale-95 { opacity: 0; transform: scale(0.95); }
    .opacity-100.scale-100 { opacity: 1; transform: scale(1); }
    .opacity-0.scale-0 { opacity: 0; transform: scale(0); }
    .opacity-0.-translate-x-full { opacity: 0; transform: translateX(-100%); }
    .opacity-100.translate-x-0 { opacity: 1; transform: translateX(0); }
    .opacity-0.translate-x-full { opacity: 0; transform: translateX(100%); }
    .opacity-0.translate-y-full { opacity: 0; transform: translateY(100%); }
    .opacity-100.translate-y-0 { opacity: 1; transform: translateY(0); }
    .opacity-0.-translate-y-full { opacity: 0; transform: translateY(-100%); }

    /* ========================================
       Accelade Lazy Loading
       ======================================== */
    .accelade-lazy-wrapper {
        position: relative;
    }

    .accelade-lazy-placeholder {
        transition: opacity 0.2s ease-out;
    }

    .accelade-lazy-placeholder.accelade-lazy-hiding {
        opacity: 0;
    }

    .accelade-lazy-content {
        opacity: 0;
        transition: opacity 0.3s ease-out;
    }

    .accelade-lazy-content.accelade-lazy-visible {
        opacity: 1;
    }

    /* Default spinner */
    .accelade-lazy-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
    }

    .accelade-lazy-spinner {
        width: 24px;
        height: 24px;
        border: 2px solid #e5e7eb;
        border-top-color: #6366f1;
        border-radius: 50%;
        animation: accelade-lazy-spin 0.8s linear infinite;
    }

    @keyframes accelade-lazy-spin {
        to { transform: rotate(360deg); }
    }

    /* ========================================
       Shimmer / Skeleton Loader
       ======================================== */
    .accelade-shimmer-container {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: 0.25rem 0;
    }

    .accelade-shimmer-container.accelade-shimmer-rounded {
        border-radius: 0.5rem;
        overflow: hidden;
    }

    .accelade-shimmer-container.accelade-shimmer-circle {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        padding: 0;
        overflow: hidden;
    }

    .accelade-shimmer-line {
        height: 1rem;
        background: linear-gradient(
            90deg,
            #f0f0f0 0%,
            #e0e0e0 20%,
            #f0f0f0 40%,
            #f0f0f0 100%
        );
        background-size: 200% 100%;
        animation: accelade-shimmer 1.5s ease-in-out infinite;
        border-radius: 0.25rem;
    }

    .accelade-shimmer-line-short {
        width: 60%;
    }

    .accelade-shimmer-circle-inner {
        width: 100%;
        height: 100%;
        background: linear-gradient(
            90deg,
            #f0f0f0 0%,
            #e0e0e0 20%,
            #f0f0f0 40%,
            #f0f0f0 100%
        );
        background-size: 200% 100%;
        animation: accelade-shimmer 1.5s ease-in-out infinite;
    }

    @keyframes accelade-shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* Shimmer variants - dark mode auto-detected */
    .dark .accelade-shimmer-line,
    .dark .accelade-shimmer-circle-inner,
    .dark .accelade-shimmer-inline,
    [data-theme="dark"] .accelade-shimmer-line,
    [data-theme="dark"] .accelade-shimmer-circle-inner,
    [data-theme="dark"] .accelade-shimmer-inline,
    .accelade-shimmer-dark .accelade-shimmer-line,
    .accelade-shimmer-dark .accelade-shimmer-circle-inner {
        background: linear-gradient(
            90deg,
            #374151 0%,
            #4b5563 20%,
            #374151 40%,
            #374151 100%
        );
        background-size: 200% 100%;
    }

    /* Card shimmer preset */
    .accelade-shimmer-card {
        padding: 1rem;
        background: #fff;
        border-radius: 0.5rem;
        border: 1px solid #e5e7eb;
    }
    .dark .accelade-shimmer-card,
    [data-theme="dark"] .accelade-shimmer-card {
        background: #1e293b;
        border-color: #334155;
    }

    .accelade-shimmer-card .accelade-shimmer-line:first-child {
        height: 1.5rem;
        width: 40%;
        margin-bottom: 0.5rem;
    }

    /* Image shimmer preset */
    .accelade-shimmer-image {
        aspect-ratio: 16/9;
        border-radius: 0.5rem;
    }

    .accelade-shimmer-image .accelade-shimmer-line {
        height: 100%;
        border-radius: 0.5rem;
    }

    /* Avatar shimmer preset */
    .accelade-shimmer-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        flex-shrink: 0;
    }

    .accelade-shimmer-avatar .accelade-shimmer-line {
        height: 100%;
        border-radius: 50%;
    }

    /* Inline shimmer (for text) */
    .accelade-shimmer-inline {
        display: inline-block;
        height: 1em;
        width: 100px;
        vertical-align: middle;
        border-radius: 0.25rem;
        background: linear-gradient(
            90deg,
            #f0f0f0 0%,
            #e0e0e0 20%,
            #f0f0f0 40%,
            #f0f0f0 100%
        );
        background-size: 200% 100%;
        animation: accelade-shimmer 1.5s ease-in-out infinite;
    }
</style>
HTML;
    }

    /**
     * Start an inline reactive component.
     */
    public function startComponent(array $state = [], string|array|null $sync = null): void
    {
        $this->componentCounter++;
        $componentId = $this->generateComponentId();

        // Parse sync properties
        $syncProperties = [];
        if ($sync !== null) {
            $syncProperties = is_array($sync) ? $sync : explode(',', $sync);
            $syncProperties = array_filter(array_map('trim', $syncProperties));
        }

        $this->componentStack[] = [
            'id' => $componentId,
            'state' => $state,
            'sync' => $syncProperties,
        ];

        ob_start();
    }

    /**
     * End an inline reactive component and return the rendered output.
     */
    public function endComponent(): string
    {
        $content = ob_get_clean();
        $component = array_pop($this->componentStack);

        return $this->wrapComponent($component, $content);
    }

    /**
     * Get the current component's state (for use in views).
     */
    public function getCurrentState(): array
    {
        if (empty($this->componentStack)) {
            return [];
        }

        return end($this->componentStack)['state'] ?? [];
    }

    /**
     * Start a component from a compiled tag.
     */
    public function startComponentFromTag(string $name, array $attributes = []): void
    {
        $this->componentCounter++;
        $componentId = $this->generateComponentId($name);

        // Extract sync properties
        $syncProperties = [];
        if (isset($attributes['sync'])) {
            $syncProperties = is_array($attributes['sync'])
                ? $attributes['sync']
                : explode(',', $attributes['sync']);
            unset($attributes['sync']);
        }

        // Separate bound attributes from regular ones
        $state = [];
        $props = [];
        foreach ($attributes as $key => $value) {
            if (Str::startsWith($key, 'bind:')) {
                $stateKey = Str::after($key, 'bind:');
                $state[$stateKey] = $value;

                // Normalize common patterns: initial-X becomes X
                if (Str::startsWith($stateKey, 'initial-')) {
                    $normalizedKey = Str::after($stateKey, 'initial-');
                    $state[$normalizedKey] = $value;
                }
            } elseif (Str::startsWith($key, 'on:')) {
                // Event handlers are passed to JS
                $props[$key] = $value;
            } else {
                $props[$key] = $value;
            }
        }

        $this->componentStack[] = [
            'id' => $componentId,
            'name' => $name,
            'state' => $state,
            'props' => $props,
            'sync' => $syncProperties,
        ];

        ob_start();
    }

    /**
     * End a tag-based component and return the rendered output.
     */
    public function endComponentFromTag(): string
    {
        $content = ob_get_clean();
        $component = array_pop($this->componentStack);

        return $this->wrapComponent($component, $content);
    }

    /**
     * Wrap component content with Accelade data attributes.
     */
    protected function wrapComponent(array $component, string $content): string
    {
        $id = $component['id'];
        $state = json_encode($component['state'] ?? []);
        $sync = implode(',', $component['sync'] ?? []);
        $props = json_encode($component['props'] ?? []);

        return <<<HTML
<div data-accelade
     data-accelade-cloak
     data-accelade-id="{$id}"
     data-accelade-state='{$state}'
     data-accelade-sync="{$sync}"
     data-accelade-props='{$props}'>
    {$content}
</div>
HTML;
    }

    /**
     * Generate a unique component ID.
     */
    protected function generateComponentId(?string $name = null): string
    {
        $base = $name ?? 'accelade';

        return $base.'-'.Str::random(8);
    }

    /**
     * Get the configured framework.
     */
    public function framework(): string
    {
        return config('accelade.framework', 'vue');
    }

    /**
     * Create a redirect action for broadcast events.
     *
     * When this payload is broadcast, the client will redirect to the given URL.
     *
     * @param  string  $url  The URL to redirect to
     */
    public static function redirectOnEvent(string $url): EventResponse
    {
        return EventResponse::redirect($url);
    }

    /**
     * Create a redirect to route action for broadcast events.
     *
     * @param  string  $route  The route name
     * @param  array  $parameters  Route parameters
     */
    public static function redirectToRouteOnEvent(string $route, array $parameters = []): EventResponse
    {
        return EventResponse::redirectToRoute($route, $parameters);
    }

    /**
     * Create a refresh action for broadcast events.
     *
     * When this payload is broadcast, the client will refresh the page.
     */
    public static function refreshOnEvent(): EventResponse
    {
        return EventResponse::refresh();
    }

    /**
     * Create a toast notification action for broadcast events.
     *
     * When this payload is broadcast, the client will show a toast notification.
     *
     * @param  string  $message  The toast message
     * @param  string  $type  The toast type (success, info, warning, danger)
     */
    public static function toastOnEvent(string $message, string $type = 'info'): EventResponse
    {
        return EventResponse::toast($message, $type);
    }

    /**
     * Create a success toast action for broadcast events.
     */
    public static function successOnEvent(string $message): EventResponse
    {
        return EventResponse::success($message);
    }

    /**
     * Create an info toast action for broadcast events.
     */
    public static function infoOnEvent(string $message): EventResponse
    {
        return EventResponse::info($message);
    }

    /**
     * Create a warning toast action for broadcast events.
     */
    public static function warningOnEvent(string $message): EventResponse
    {
        return EventResponse::warning($message);
    }

    /**
     * Create a danger toast action for broadcast events.
     */
    public static function dangerOnEvent(string $message): EventResponse
    {
        return EventResponse::danger($message);
    }

    /**
     * Create an exception handler for Accelade requests.
     *
     * Register this in your app/Exceptions/Handler.php:
     *
     * ```php
     * use Accelade\Facades\Accelade;
     *
     * public function register(): void
     * {
     *     $this->renderable(Accelade::exceptionHandler($this));
     * }
     * ```
     *
     * With custom handler for specific exceptions:
     *
     * ```php
     * $this->renderable(Accelade::exceptionHandler($this, function ($e, $request) {
     *     if ($e instanceof \Symfony\Component\HttpKernel\Exception\HttpException) {
     *         if ($e->getStatusCode() === 419) {
     *             return redirect()->route('login', ['reason' => 'timeout']);
     *         }
     *     }
     * }));
     * ```
     *
     * @param  Handler  $handler  The Laravel exception handler
     * @param  Closure|null  $customHandler  Optional custom handler for specific exceptions
     */
    public static function exceptionHandler(Handler $handler, ?Closure $customHandler = null): Closure
    {
        return ExceptionHandler::handle($handler, $customHandler);
    }
}
</file>

<file path="CHANGELOG.md">
# Changelog

All notable changes to Accelade will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

- **Animation System** - CSS class-based enter/leave animations
  - `Animation` facade for registering custom animation presets
  - Built-in presets: `default`, `fade`, `opacity`, `scale`, `collapse`, `slide-up`, `slide-down`, `slide-left`, `slide-right`
  - `AnimationManager` class for managing animation presets
  - `AnimationPreset` value object for animation configuration
  - Animation utility CSS classes included in `@acceladeStyles`

- **Transition Component** - Standalone CSS transition wrapper
  - `<x-accelade::transition>` Blade component for animated show/hide
  - `show` attribute for reactive visibility expression
  - `animation` attribute for preset selection
  - Custom class props: `enter`, `enter-from`, `enter-to`, `leave`, `leave-from`, `leave-to`
  - Works with any animation preset or custom Tailwind classes

- **Toggle Animation** - Animation prop for toggle component
  - `animation` attribute on `<x-accelade::toggle>` component
  - Automatically animates all `a-show` elements inside the toggle
  - Simplest usage: `<x-accelade::toggle animation="fade">`
  - All built-in presets available: fade, scale, collapse, slide-*

- **Shared Data** - Share data from Laravel backend to JavaScript frontend
  - `Accelade::share()` method to share data globally from PHP
  - `Accelade::getShared()` and `Accelade::allShared()` helper methods
  - `Accelade::shared()` to access the underlying SharedData instance
  - Support for lazy-loaded data via closures
  - JavaScript API via `window.Accelade.shared`
    - `get(key, default)` - Get shared value with dot notation support
    - `has(key)` - Check if key exists
    - `all()` - Get all shared data
    - `set(key, value)` - Set value client-side
    - `merge(data)` - Merge multiple values
    - `subscribe(key, callback)` - Subscribe to specific key changes
    - `subscribeAll(callback)` - Subscribe to all changes
  - `ShareAcceladeData` middleware for sharing data on every request
  - Demo page at `/demo/shared-data`
  - Full documentation in `docs/shared-data.md`

- **Text Interpolation** - Use `@{{ expression }}` syntax in Blade templates
  - Automatic `{{ }}` text node interpolation in components
  - Access component state: `@{{ count }}`, `@{{ user.name }}`
  - Access shared data: `@{{ shared.appName }}`, `@{{ $shared.settings.theme }}`
  - Reactive updates when state or shared data changes
  - `TextInterpolator` class for programmatic use

- **SEO Engine** - Fluent API for managing page metadata
  - `SEO` facade with chainable methods for title, description, keywords
  - OpenGraph support: type, site_name, title, description, url, image, locale
  - Twitter Cards support: card, site, creator, title, description, image
  - Custom meta tags via `metaByName()`, `metaByProperty()`, and `meta()`
  - Blade directives:
    - `@seoTitle()`, `@seoDescription()`, `@seoKeywords()`
    - `@seoCanonical()`, `@seoRobots()`, `@seoAuthor()`
    - `@seoOpenGraph()`, `@seoTwitter()`
    - `@seoMeta()` for custom meta tags
    - `@seo` to output all meta tags
  - Auto-fill OpenGraph/Twitter from main SEO values
  - Auto-canonical URL generation from current request
  - Configurable title separator and suffix
  - Macroable for custom extensions
  - Full documentation in `docs/seo.md`

- **Event Binding Syntax** - Unified `@` prefix for events across all frameworks
  - All event handlers now use `@click`, `@submit`, `@input`, etc.
  - Works consistently across Vanilla, Vue, React, Svelte, and Angular
  - Legacy syntax (`a-on:`, `v-on:`, etc.) still supported for backward compatibility

- **Lazy Loading** - Defer content rendering with beautiful placeholders
  - `<x-accelade::lazy>` Blade component for lazy loading content
  - Shimmer placeholder with single `shimmer` attribute
  - Customizable shimmer lines, height, width, rounded, and circle shapes
  - Custom placeholder slot for advanced loading UI
  - URL mode for loading content from endpoints
  - Conditional loading with `show` attribute
  - Delay option for timed loading
  - JavaScript API: `Accelade.lazy.load()`, `Accelade.lazy.reload()`, `Accelade.lazy.hide()`
  - Events: `load`, `loaded`, `error`
  - Full documentation in `docs/lazy-loading.md`

- **Content Component** - Render pre-rendered HTML without interpolation
  - `<x-accelade::content>` Blade component for static HTML content
  - Customizable wrapper element with `as` attribute (div, article, section, etc.)
  - Perfect for Markdown, CMS content, or syntax-highlighted code
  - Security: Only use with trusted content (bypasses sanitization)
  - Full documentation in `docs/content.md`

- **Data Component** - Reactive data containers with storage persistence
  - `<x-accelade::data>` Blade component for reactive data management
  - `default` attribute for initial state (supports arrays, collections, Eloquent models)
  - `remember` attribute for session storage persistence (survives page refreshes)
  - `local-storage` attribute for localStorage persistence (survives browser close)
  - `store` attribute for global shared state across components
  - JavaScript object notation support for initial state
  - Reserved store names validation (data, form, toggle, state, store)
  - JavaScript API via `window.Accelade.stores`
    - `get(name)` - Get a store by name
    - `has(name)` - Check if store exists
    - `names()` - Get all store names
    - `all()` - Get all stores
  - `$store(name)` helper function in components
  - Full documentation in `docs/data.md`

- **Event Component** - Laravel Echo broadcast event integration
  - `<x-accelade::event>` Blade component for real-time event listening
  - Support for public, private, and presence channels
  - Comma-separated event names with `listen` attribute
  - Exposed reactive state: `subscribed` (boolean), `events` (array)
  - Automatic action handling from broadcast events:
    - `Accelade::redirectOnEvent($url)` - Navigate to URL
    - `Accelade::refreshOnEvent()` - Refresh page (with optional scroll preservation)
    - `Accelade::toastOnEvent($message, $type)` - Show toast notification
  - `EventResponse` class for building broadcast payloads
  - Custom event dispatch: `accelade:echo` for advanced usage
  - Graceful degradation when Laravel Echo is not configured
  - Full documentation in `docs/event.md`

- **Navigation Keep-Alive** - Page state caching for SPA navigation
  - Configurable via `config/accelade.php` navigation settings
  - `max_keep_alive` - Maximum pages to cache (default: 10, 0 to disable)
  - `transition_duration` - Page transition animation duration in ms
  - `preserve_scroll` - Default scroll behavior after navigation
  - Automatic state restoration when navigating back/forward
  - Component states preserved across navigation
  - Cache automatically clears oldest entries when limit reached
  - JavaScript API: `router.clearCache()`, `router.getCacheSize()`

- **Persistent Layout** - Keep elements active during SPA navigation
  - `<x-accelade::persistent>` Blade component for persistent regions
  - `PersistentComponent` PHP class for custom persistent layouts
  - Media players continue playing across navigation
  - Elements matched by `id` attribute between pages
  - Preserves DOM state (form inputs, playback position, etc.)
  - Automatic save/restore during SPA transitions
  - Full documentation in `docs/persistent-layout.md`

- **Event Bus** - Global event bus for decoupled component communication
  - Global API: `Accelade.emit()`, `Accelade.on()`, `Accelade.once()`, `Accelade.off()`
  - Component context: `$emit()`, `$on()`, `$once()`, `$off()`
  - Data payload support for passing information with events
  - Automatic unsubscribe function returned from `on()` and `once()`
  - `events.clear()` to remove all listeners for an event
  - `events.hasListeners()`, `events.listenerCount()`, `events.eventNames()`
  - Full documentation in `docs/event-bus.md`

- **Bridge Components (Beta)** - Two-way binding between PHP and JavaScript
  - `WithBridge` trait for Blade components enables PHP/JS communication
  - Public PHP properties accessible as `props` object in templates
  - Call public PHP methods from JavaScript via AJAX
  - Methods can return `BridgeResponse` with:
    - Toast notifications via `toastSuccess()`, `toastInfo()`, etc.
    - Redirects via `redirectTo()` or `redirectToRoute()`
    - Page refresh via `refresh(preserveScroll)`
    - Event emissions via `emit(event, data)`
  - `<x-accelade::bridge>` Blade component for wrapping bridge-enabled components
  - Encrypted state payload for security
  - `Bridge` facade for programmatic access
  - JavaScript API via `Accelade.bridge.get()`, `Accelade.bridge.getAll()`
  - Full documentation in `docs/bridge.md`

## [0.2.0] - 2024-01-11

### Added
- Initial release with core features:
  - Reactive Blade components with `@accelade` directive
  - Multi-framework support (Vanilla, Vue, React, Svelte, Angular)
  - SPA navigation with `<x-accelade::link>` component
  - Progress bar during navigation
  - Toast notifications (PHP and JavaScript)
  - Server state sync
  - Custom script functions with `<accelade:script>`

### Changed

### Deprecated

### Removed

### Fixed

### Security
</file>

<file path="docs/components.md">
# Components

Accelade components bring reactivity to your Blade templates. This guide covers creating and using reactive components.

## Basic Component

Use the `@accelade` directive to create a reactive block:

```blade
@accelade(['count' => 0, 'name' => 'World'])
    <div>
        <h1>Hello, <span a-text="name">World</span>!</h1>
        <p>Count: <span a-text="count">0</span></p>
        <input a-model="name" placeholder="Enter name">
        <button @click="$set('count', count + 1)">Increment</button>
    </div>
@endaccelade
```

The array passed to `@accelade` defines the initial state.

## Binding Directives

### Text Binding (`a-text`)

Binds element's text content to a state property:

```blade
<span a-text="message">Default text</span>
<p a-text="user.name">Guest</p>
<div a-text="items.length + ' items'">0 items</div>
```

### HTML Binding (`a-html`)

Binds raw HTML content (use with caution):

```blade
<div a-html="htmlContent"></div>
```

### Show/Hide (`a-show`)

Toggles element visibility using CSS display:

```blade
<div a-show="isVisible">This can be toggled</div>
<div a-show="count > 0">Count is positive</div>
<div a-show="!isEmpty">Has content</div>
```

### Conditional Rendering (`a-if`)

Removes/adds element from DOM based on condition:

```blade
<div a-if="isLoggedIn">Welcome back!</div>
<div a-if="items.length === 0">No items found</div>
```

### Two-Way Binding (`a-model`)

Creates two-way data binding for form inputs:

```blade
{{-- Text input --}}
<input a-model="username" type="text">

{{-- Textarea --}}
<textarea a-model="description"></textarea>

{{-- Checkbox --}}
<input a-model="isActive" type="checkbox">

{{-- Select --}}
<select a-model="selectedOption">
    <option value="a">Option A</option>
    <option value="b">Option B</option>
</select>

{{-- Radio buttons --}}
<input a-model="gender" type="radio" value="male"> Male
<input a-model="gender" type="radio" value="female"> Female
```

### Event Handling (`@event`)

Binds event listeners:

```blade
{{-- Click events --}}
<button @click="handleClick()">Click me</button>
<button @click="$set('count', count + 1)">Increment</button>

{{-- Form events --}}
<form @submit.prevent="handleSubmit()">
<input @input="validateField()">
<input @change="onSelectionChange()">

{{-- Keyboard events --}}
<input @keyup.enter="submitForm()">
<input @keydown.escape="cancel()">

{{-- Mouse events --}}
<div @mouseenter="showTooltip()">
<div @mouseleave="hideTooltip()">
```

### Dynamic Classes (`a-class`)

Conditionally applies CSS classes:

```blade
<div a-class="{ active: isActive, disabled: isDisabled }">
    Conditional classes
</div>

<button a-class="{ 'btn-primary': isPrimary, 'btn-lg': isLarge }">
    Button
</button>
```

### Dynamic Styles (`a-style`)

Applies inline styles dynamically:

```blade
<div a-style="{ color: textColor, fontSize: size + 'px' }">
    Dynamic styles
</div>
```

### Server Sync (`a-sync`)

Syncs property changes with the Laravel backend:

```blade
@accelade(['count' => 0])
    <div a-sync="count">
        <span a-text="count">0</span>
        <button @click="$set('count', count + 1)">+1</button>
    </div>
@endaccelade
```

When `count` changes, it's automatically persisted to the server.

## Built-in Functions

Inside `@accelade` blocks, these functions are available:

### `$get(key)`

Get a state value:

```blade
<button @click="alert($get('name'))">Show Name</button>
```

### `$set(key, value)`

Set a state value:

```blade
<button @click="$set('count', 0)">Reset</button>
<button @click="$set('items', [...items, newItem])">Add Item</button>
```

### `$toggle(key)`

Toggle a boolean value:

```blade
<button @click="$toggle('isOpen')">Toggle Menu</button>
```

### `$reset(key)`

Reset a property to its initial value:

```blade
<button @click="$reset('count')">Reset Count</button>
<button @click="$reset()">Reset All</button>
```

## Custom Scripts

Define custom functions using `<accelade:script>`:

```blade
@accelade(['count' => 0, 'step' => 1])
    <div>
        <span a-text="count">0</span>
        <button @click="increment()">+</button>
        <button @click="decrement()">-</button>
        <button @click="double()">Double</button>
    </div>

    <accelade:script>
        return {
            increment() {
                $set('count', $get('count') + $get('step'));
            },
            decrement() {
                $set('count', $get('count') - $get('step'));
            },
            double() {
                $set('count', $get('count') * 2);
            }
        };
    </accelade:script>
@endaccelade
```

## Blade Components

Create reusable components as Blade component classes:

### Counter Component

```php
// app/View/Components/Counter.php
namespace App\View\Components;

use Accelade\Components\AcceladeComponent;

class Counter extends AcceladeComponent
{
    public int $initialCount;
    public ?string $sync;

    public function __construct(int $initialCount = 0, ?string $sync = null)
    {
        $this->initialCount = $initialCount;
        $this->sync = $sync;
    }

    public function render()
    {
        return view('components.counter');
    }
}
```

```blade
{{-- resources/views/components/counter.blade.php --}}
@accelade(['count' => $initialCount])
    <div @if($sync) a-sync="{{ $sync }}" @endif>
        <span a-text="count">{{ $initialCount }}</span>
        <button @click="$set('count', count + 1)">+</button>
        <button @click="$set('count', count - 1)">-</button>
    </div>
@endaccelade
```

Usage:

```blade
<x-counter :initial-count="5" />
<x-counter :initial-count="10" sync="count" />
```

## Built-in Components

Accelade includes pre-built components:

### Link Component

Enhanced navigation with HTTP methods, confirmation dialogs, and SPA routing:

```blade
{{-- Basic SPA navigation --}}
<x-accelade::link href="/dashboard">Dashboard</x-accelade::link>

{{-- With navigation options --}}
<x-accelade::link
    href="/settings"
    class="nav-link"
    :preserve-scroll="true"
    :prefetch="true"
>
    Settings
</x-accelade::link>

{{-- HTTP methods for form-like submissions --}}
<x-accelade::link
    href="/api/items"
    method="POST"
    :data="['name' => 'New Item', 'status' => 'active']"
>
    Create Item
</x-accelade::link>

{{-- DELETE with confirmation dialog --}}
<x-accelade::link
    href="/api/items/123"
    method="DELETE"
    confirm-text="Delete this item permanently?"
    confirm-button="Delete"
    :confirm-danger="true"
>
    Delete Item
</x-accelade::link>

{{-- External link --}}
<x-accelade::link href="https://example.com" :away="true">
    Visit External Site
</x-accelade::link>

{{-- Fully customized confirmation --}}
<x-accelade::link
    href="/account/delete"
    confirm-title="Delete Account"
    confirm-text="This action cannot be undone."
    confirm-button="Yes, delete"
    cancel-button="No, keep my account"
    :confirm-danger="true"
>
    Delete Account
</x-accelade::link>
```

The Link component supports: GET, POST, PUT, PATCH, DELETE methods, request data and headers, confirmation dialogs, prefetching, scroll/state preservation, and history replacement. See [Link Component](link.md) for full documentation.

### Modal Component

Modal dialogs, slideover panels, and bottom sheets with async content loading:

```blade
{{-- Pre-loaded modal with hash link --}}
<x-accelade::link href="#my-modal">Open Modal</x-accelade::link>

<x-accelade::modal name="my-modal">
    <h2>Welcome!</h2>
    <p>Modal content here...</p>
    <button data-modal-close>Close</button>
</x-accelade::modal>

{{-- Async modal (load from URL) --}}
<x-accelade::link href="/users/create" :modal="true">
    Create User
</x-accelade::link>

{{-- Slideover panel --}}
<x-accelade::link href="#settings">Settings</x-accelade::link>

<x-accelade::modal name="settings" :slideover="true" slideover-position="right">
    <nav>Settings navigation...</nav>
</x-accelade::modal>

{{-- Bottom sheet (mobile-friendly) --}}
<x-accelade::link href="#actions">Actions</x-accelade::link>

<x-accelade::modal name="actions" :bottom-sheet="true">
    <button>Option 1</button>
    <button>Option 2</button>
    <button data-modal-close>Cancel</button>
</x-accelade::modal>

{{-- Custom size and position --}}
<x-accelade::modal
    name="large-dialog"
    max-width="4xl"
    position="top"
    :close-explicitly="true"
>
    <p>Important content...</p>
    <button data-modal-close>I Understand</button>
</x-accelade::modal>
```

The Modal component supports: pre-loaded content, async loading from URLs, slideover panels (left/right), bottom sheets for mobile, customizable sizes (sm to 7xl), vertical positioning (top/center/bottom), explicit close mode, and JavaScript API. See [Modal Component](modal.md) for full documentation.

### Counter Component

```blade
<x-accelade::counter :initial-count="0" />
<x-accelade::counter :initial-count="10" sync="count" framework="vue" />
```

### Event Component (Laravel Echo)

Listen to Laravel Echo broadcast events in real-time:

```blade
{{-- Basic event listener --}}
<x-accelade::event channel="orders" listen="OrderCreated">
    <p a-if="subscribed">Listening for orders...</p>
    <p a-if="!subscribed">Connecting...</p>
</x-accelade::event>

{{-- Private channel --}}
<x-accelade::event
    channel="user.{{ auth()->id() }}"
    :private="true"
    listen="MessageReceived"
>
    <span a-text="events.length"></span> new messages
</x-accelade::event>

{{-- Auto-refresh on event --}}
<x-accelade::event
    channel="dashboard"
    listen="DataUpdated"
    :preserve-scroll="true"
/>
```

The component exposes `subscribed` (boolean) and `events` (array) state. See [Event Component](event.md) for full documentation.

### Flash Component (Session Flash Data)

Access Laravel's session flash data in your templates:

```blade
{{-- Basic flash message display --}}
<x-accelade::flash>
    <div a-if="flash.has('success')" class="alert alert-success">
        <span a-text="flash.success"></span>
    </div>

    <div a-if="flash.has('error')" class="alert alert-danger">
        <span a-text="flash.error"></span>
    </div>
</x-accelade::flash>

{{-- Notification-style positioning --}}
<x-accelade::flash class="fixed top-4 right-4 z-50">
    <div a-show="flash.has('message')" class="p-4 bg-white shadow-lg rounded">
        <p a-text="flash.message"></p>
    </div>
</x-accelade::flash>
```

The component exposes a `flash` object with `.has()` method and direct property access. See [Flash Component](flash.md) for full documentation.

### Rehydrate Component (Selective Reloading)

Reload specific sections without full page refresh:

```blade
{{-- Event-triggered reload --}}
<x-accelade::rehydrate on="item-created">
    <ul>
        @foreach($items as $item)
            <li>{{ $item->name }}</li>
        @endforeach
    </ul>
</x-accelade::rehydrate>

{{-- Emit event to trigger reload --}}
<script>
    Accelade.emit('item-created');
</script>

{{-- Multiple events --}}
<x-accelade::rehydrate :on="['created', 'updated', 'deleted']">
    ...
</x-accelade::rehydrate>

{{-- Auto-polling every 5 seconds --}}
<x-accelade::rehydrate :poll="5000">
    Current score: {{ $score }}
</x-accelade::rehydrate>
```

The component supports event-triggered reloading, automatic polling, and JavaScript API for manual control. See [Rehydrate Component](rehydrate.md) for full documentation.

### State Component (Unified Errors, Flash & Shared)

Unified access to validation errors, flash messages, and shared data:

```blade
{{-- Basic validation error display --}}
<x-accelade::state>
    <div a-show="state.hasErrors" class="alert alert-danger">
        Please fix the errors below.
    </div>

    <div a-show="hasError('email')" class="text-red-500">
        <span a-text="getError('email')"></span>
    </div>
</x-accelade::state>

{{-- Flash message display --}}
<x-accelade::state>
    <div a-show="hasFlash('success')" class="alert alert-success">
        <span a-text="getFlash('success')"></span>
    </div>
</x-accelade::state>

{{-- Shared data access --}}
<x-accelade::state>
    <div a-show="hasShared('user')">
        Welcome, <span a-text="getShared('user.name')"></span>!
    </div>
</x-accelade::state>
```

The component exposes `state` object with errors/flash/shared, plus helper methods: `hasError()`, `getError()`, `getErrors()`, `hasFlash()`, `getFlash()`, `hasShared()`, `getShared()`. See [State Component](state.md) for full documentation.

### Teleport Component (DOM Relocation)

Relocate template sections to different DOM nodes while preserving reactivity:

```blade
{{-- Content teleports to footer --}}
<x-accelade::teleport to="#footer">
    <p>This content appears in the footer</p>
</x-accelade::teleport>

<div id="footer"></div>

{{-- Reactive content in teleport --}}
<div data-accelade data-accelade-state='{"search": ""}'>
    <input a-model="search" placeholder="Search...">

    <x-accelade::teleport to="#search-preview">
        <p>Searching for: <span a-text="search"></span></p>
    </x-accelade::teleport>
</div>

<div id="search-preview"></div>

{{-- Disabled teleport (stays in place) --}}
<x-accelade::teleport to="#target" :disabled="true">
    <p>Content stays here</p>
</x-accelade::teleport>
```

The component accepts CSS selectors and maintains parent component reactivity. Useful for modals, notifications, and cross-layout content. See [Teleport Component](teleport.md) for full documentation.

### Toggle Component (Boolean State)

Simplified boolean state management for show/hide toggles and flags:

```blade
{{-- Basic toggle --}}
<x-accelade::toggle>
    <button @click.prevent="toggle()">Show Content</button>
    <div a-show="toggled">
        <p>Toggled content!</p>
        <button @click.prevent="setToggle(false)">Hide</button>
    </div>
</x-accelade::toggle>

{{-- Start with toggled = true --}}
<x-accelade::toggle :data="true">
    <div a-show="toggled">Visible by default</div>
</x-accelade::toggle>

{{-- Multiple named toggles --}}
<x-accelade::toggle data="isCompany, hasVatNumber">
    <button @click.prevent="toggle('isCompany')">Company Mode</button>
    <div a-show="isCompany">Company fields...</div>

    <button @click.prevent="setToggle('hasVatNumber', true)">Enable VAT</button>
    <div a-show="hasVatNumber">VAT fields...</div>
</x-accelade::toggle>
```

The Toggle component exposes `toggle()`, `setToggle()`, and `toggled` (or named keys). Perfect for accordions, dropdowns, and conditional form fields. See [Toggle Component](toggle.md) for full documentation.

## Nested Components

Components can be nested:

```blade
@accelade(['parent' => 'value'])
    <div>
        <p a-text="parent">Parent value</p>

        @accelade(['child' => 'nested'])
            <div>
                <p a-text="child">Child value</p>
            </div>
        @endaccelade
    </div>
@endaccelade
```

Each nested component has its own isolated state.

## Component IDs

Each component gets a unique ID. You can specify a custom ID:

```blade
@accelade(['count' => 0], 'my-counter')
    {{-- Component content --}}
@endaccelade
```

Access the component by ID in JavaScript:

```javascript
const component = window.Accelade.getComponent('my-counter');
component.setState('count', 5);
```

## Best Practices

1. **Keep State Minimal** - Only include state that needs to be reactive
2. **Use Server Sync Sparingly** - Only sync what needs to persist
3. **Prefer Blade Components** - Extract reusable logic into components
4. **Escape User Input** - Always escape when using `a-html`
5. **Name Components** - Use meaningful IDs for debugging

## Next Steps

- [Frameworks](frameworks.md) - Framework-specific syntax
- [Link Component](link.md) - Enhanced navigation
- [Modal Component](modal.md) - Dialogs and slideovers
- [Event Component](event.md) - Laravel Echo integration
- [Flash Component](flash.md) - Session flash data
- [Rehydrate Component](rehydrate.md) - Selective section reloading
- [State Component](state.md) - Unified errors, flash & shared data
- [Teleport Component](teleport.md) - DOM relocation
- [Toggle Component](toggle.md) - Boolean state management
- [SPA Navigation](spa-navigation.md) - Client-side routing
- [Notifications](notifications.md) - Toast notifications
</file>

<file path="resources/js/index.ts">
/**
 * Accelade - Unified Entry Point
 *
 * Single bundle with runtime framework detection supporting:
 * - Vanilla JavaScript (Proxy-based)
 * - Vue.js (reactive/effect)
 * - React (useState/hooks)
 * - Svelte (stores)
 * - Angular (signals/RxJS)
 */

// Types
export type {
    AcceladeComponentConfig,
    AcceladeActions,
    StateChangeCallback,
} from './core/types';

export type {
    FrameworkType,
    ComponentInstance,
    IStateAdapter,
    IBindingAdapter,
    IFrameworkAdapter,
} from './adapters/types';

// Core utilities
export { ConfigFactory } from './core/factories/ConfigFactory';
export { SyncFactory } from './core/factories/SyncFactory';
export { ActionsFactory } from './core/factories/ActionsFactory';
export { ScriptExecutor } from './core/factories/ScriptExecutor';
export {
    evaluateExpression,
    evaluateBooleanExpression,
    evaluateStringExpression,
    interpolate,
    parseClassObject,
} from './core/expressions';

// Router
export {
    initRouter,
    navigate,
    getRouter,
    type NavigationOptions,
    type RouterConfig,
} from './core/router';

// Progress
export {
    getProgress,
    configureProgress,
    startProgress,
    doneProgress,
    type ProgressConfig,
} from './core/progress';

// Notifications
export {
    NotificationManager,
    type NotificationData,
    type NotificationConfig,
    type NotificationStatus,
    type NotificationPosition,
} from './core/notification';

// Debug system
export {
    DebugManager,
    StateHistory,
    NetworkInspector,
    type DebugConfig,
    type AcceladeDevtools,
    type StateSnapshot,
    type NetworkRecord,
} from './core/debug';

// Shared data
export {
    SharedDataManager,
    type SharedDataChangeCallback,
} from './core/shared';

// Text interpolation
export {
    TextInterpolator,
    createTextInterpolator,
} from './core/interpolation';

// Lazy loading
export {
    LazyLoaderManager,
    getLazyLoader,
    initLazy,
    registerLazy,
    loadLazy,
    configureLazy,
    type LazyConfig,
    type LazyInstance,
} from './core/lazy';

// Rehydrate
export {
    rehydrateManager,
    initRehydrate,
    initRehydrateSystem,
    emit,
    type RehydrateConfig,
    type RehydrateInstance,
    type RehydrateEventDetail,
} from './core/rehydrate';

// State Component (errors, flash, shared)
export {
    createState,
    initState,
    type StateConfig,
    type StateInstance,
    type StateObject,
    type StateHelpers,
    type ValidationErrors,
    type FlashData,
    type SharedData as StateSharedData,
} from './core/state/index';

// Teleport
export {
    teleportManager,
    initTeleport,
    registerTeleport,
    type TeleportConfig,
    type TeleportInstance,
    type TeleportEventDetail,
} from './core/teleport';

// Event Bus
export {
    EventBus,
    getEventBus,
    emit as eventEmit,
    on as eventOn,
    once as eventOnce,
    off as eventOff,
    type EventCallback,
} from './core/events';

// Error Handler
export {
    default as ErrorHandler,
    init as initErrorHandler,
    handleError,
    handleAjaxError,
    handleFetchError,
    handleValidationError,
    processResponse as processErrorResponse,
    createErrorHandlingFetch,
    type ErrorConfig,
    type AcceladeErrorResponse,
} from './core/errors/ErrorHandler';

// Toggle
export {
    ToggleFactory,
    createToggle,
    createToggleMethods,
    type ToggleConfig,
    type ToggleInstance,
    type ToggleMethods,
    type ToggleState,
} from './core/toggle';

// Bridge
export {
    BridgeFactory,
    createBridge,
    getBridge,
    getAllBridges,
    createMethodProxies,
    disposeBridge,
    type BridgeConfig,
    type BridgeCallResponse,
    type BridgeInstance,
} from './core/bridge';

// Framework registry
export { FrameworkRegistry } from './registry/FrameworkRegistry';

// Adapters
export {
    BaseAdapter,
    VanillaAdapter,
    VueAdapter,
    ReactAdapter,
    SvelteAdapter,
    AngularAdapter,
} from './adapters';

// React hooks and components
export {
    useAccelade,
    useAcceladeSync,
    AcceladeProvider,
    useAcceladeContext,
    AcceladeLink,
    Show,
    For,
    Switch,
    Match,
    type UseAcceladeResult,
    type UseAcceladeOptions,
    type AcceladeProviderProps,
    type AcceladeLinkProps,
} from './adapters/react';

// Import for initialization
import { FrameworkRegistry } from './registry/FrameworkRegistry';
import { VanillaAdapter } from './adapters/vanilla';
import { VueAdapter } from './adapters/vue';
import { ReactAdapter } from './adapters/react';
import { SvelteAdapter } from './adapters/svelte';
import { AngularAdapter } from './adapters/angular';
import { ConfigFactory } from './core/factories/ConfigFactory';
import { ScriptExecutor } from './core/factories/ScriptExecutor';
import { DebugManager } from './core/debug';
import { SharedDataManager } from './core/shared';
import { initRouter, navigate, getRouter } from './core/router';
import {
    getProgress,
    configureProgress,
    startProgress,
    doneProgress,
    type ProgressConfig,
} from './core/progress';
import { NotificationManager } from './core/notification';
import type { FrameworkType, ComponentInstance } from './adapters/types';
import type { SharedData } from './core/types';
import { initLazy, getLazyLoader, registerLazy, loadLazy, configureLazy, type LazyConfig } from './core/lazy';
import { rehydrateManager, initRehydrate, initRehydrateSystem, emit as rehydrateEmit } from './core/rehydrate';
import { teleportManager, initTeleport, registerTeleport } from './core/teleport';
import { getEventBus, emit as eventBusEmit, on as eventBusOn, once as eventBusOnce, off as eventBusOff, type EventCallback } from './core/events';
import { getBridge, getAllBridges } from './core/bridge';
import ErrorHandler, { init as initErrorHandler, handleError, handleAjaxError, type ErrorConfig } from './core/errors/ErrorHandler';

// Singleton notification manager
let notificationManager: NotificationManager | null = null;

function getNotify(): NotificationManager {
    if (!notificationManager) {
        notificationManager = new NotificationManager();
    }
    return notificationManager;
}

// Active component instances
const components = new Map<string, ComponentInstance>();

/**
 * Register all framework adapters
 */
function registerAdapters(): void {
    // Register adapters with priority (higher priority = checked first)
    FrameworkRegistry.register('vue', () => new VueAdapter(), { priority: 80 });
    FrameworkRegistry.register('react', () => new ReactAdapter(), { priority: 70 });
    FrameworkRegistry.register('svelte', () => new SvelteAdapter(), { priority: 60 });
    FrameworkRegistry.register('angular', () => new AngularAdapter(), { priority: 50 });
    FrameworkRegistry.register('vanilla', () => new VanillaAdapter(), { priority: 10 });
}

/**
 * Extended HTMLElement with initialization flag
 */
interface AcceladeHTMLElement extends HTMLElement {
    __accelade_initialized?: boolean;
    __accelade_component_id?: string;
}

/**
 * Initialize an Accelade component
 */
function initComponent(el: AcceladeHTMLElement, framework?: FrameworkType): ComponentInstance | null {
    if (el.__accelade_initialized) {
        const existingId = el.__accelade_component_id;
        return existingId ? components.get(existingId) ?? null : null;
    }

    try {
        const config = ConfigFactory.parseElement(el);
        const adapter = FrameworkRegistry.getAdapter(framework);
        const instance = adapter.initComponent(el, config);

        // Track the component
        components.set(instance.id, instance);
        el.__accelade_initialized = true;
        el.__accelade_component_id = instance.id;

        // Register with debug manager
        const debug = DebugManager.getInstance();
        debug.registerComponent(instance);

        // Remove cloak attribute for smooth reveal
        el.removeAttribute('data-accelade-cloak');
        el.removeAttribute('v-cloak');
        el.removeAttribute('a-cloak');
        el.classList.add('accelade-ready');

        return instance;
    } catch (e) {
        console.error('Accelade: Failed to init component', e);
        return null;
    }
}

/**
 * Dispose a component
 */
function disposeComponent(componentId: string): void {
    const instance = components.get(componentId);
    if (!instance) return;

    const adapter = FrameworkRegistry.getAdapter(instance.framework);
    adapter.disposeComponent(instance);

    // Unregister from debug manager
    const debug = DebugManager.getInstance();
    debug.unregisterComponent(componentId);

    components.delete(componentId);
}

// Module-level initialization guard
let acceladeInitialized = false;

/**
 * Initialize all Accelade components on the page
 */
function init(options?: { framework?: FrameworkType; debug?: boolean }): void {
    const elements = document.querySelectorAll<AcceladeHTMLElement>('[data-accelade]');

    elements.forEach((el) => {
        initComponent(el, options?.framework);
    });

    // Initialize the router only once
    if (!acceladeInitialized) {
        initRouter();
        acceladeInitialized = true;

        // Initialize debug if requested
        if (options?.debug) {
            const debug = DebugManager.getInstance();
            debug.setEnabled(true);
        }
    }
}

/**
 * Get a component instance by ID
 */
function getComponent(componentId: string): ComponentInstance | undefined {
    return components.get(componentId);
}

/**
 * Get all component instances
 */
function getComponents(): Map<string, ComponentInstance> {
    return new Map(components);
}

/**
 * Get detected framework
 */
function getFramework(): FrameworkType {
    return FrameworkRegistry.detect();
}

// Progress API object
const progress = {
    configure: configureProgress,
    start: startProgress,
    done: doneProgress,
    instance: getProgress,
};

// Router API object
const router = {
    init: initRouter,
    navigate,
    instance: getRouter,
};

// Notification API object
const notify = {
    success: (title: string, message = '') => getNotify().success(title, message),
    info: (title: string, message = '') => getNotify().info(title, message),
    warning: (title: string, message = '') => getNotify().warning(title, message),
    danger: (title: string, message = '') => getNotify().danger(title, message),
    show: (data: Parameters<typeof NotificationManager.prototype.show>[0]) => getNotify().show(data),
    dismiss: (id: string) => getNotify().dismiss(id),
    configure: (config: Parameters<typeof NotificationManager.prototype.configure>[0]) => getNotify().configure(config),
    instance: getNotify,
};

// Shared data API object
const shared = {
    /**
     * Get a shared value by key (supports dot notation)
     */
    get: <T = unknown>(key: string, defaultValue?: T): T =>
        SharedDataManager.getInstance().get(key, defaultValue),

    /**
     * Check if a shared key exists
     */
    has: (key: string): boolean =>
        SharedDataManager.getInstance().has(key),

    /**
     * Get all shared data
     */
    all: (): SharedData =>
        SharedDataManager.getInstance().all(),

    /**
     * Set a shared value (client-side only)
     */
    set: (key: string, value: unknown): void =>
        SharedDataManager.getInstance().set(key, value),

    /**
     * Merge data into shared data
     */
    merge: (data: SharedData): void =>
        SharedDataManager.getInstance().merge(data),

    /**
     * Subscribe to changes for a specific key
     */
    subscribe: (key: string, callback: (key: string, newValue: unknown, oldValue: unknown) => void): (() => void) =>
        SharedDataManager.getInstance().subscribe(key, callback),

    /**
     * Subscribe to all changes
     */
    subscribeAll: (callback: (key: string, newValue: unknown, oldValue: unknown) => void): (() => void) =>
        SharedDataManager.getInstance().subscribeAll(callback),

    /**
     * Get the SharedDataManager instance
     */
    instance: (): SharedDataManager =>
        SharedDataManager.getInstance(),
};

// Lazy loading API object
const lazy = {
    /**
     * Initialize all lazy components on the page
     */
    init: initLazy,

    /**
     * Register a lazy component element
     */
    register: registerLazy,

    /**
     * Load a lazy component by ID
     */
    load: loadLazy,

    /**
     * Configure lazy loading options
     */
    configure: configureLazy,

    /**
     * Get a lazy instance by ID
     */
    get: (id: string) => getLazyLoader().get(id),

    /**
     * Get all lazy instances
     */
    getAll: () => getLazyLoader().getAll(),

    /**
     * Reload a lazy component
     */
    reload: (id: string) => getLazyLoader().reload(id),

    /**
     * Hide a lazy component (show placeholder)
     */
    hide: (id: string) => getLazyLoader().hide(id),

    /**
     * Subscribe to lazy events
     */
    on: (event: 'load' | 'loaded' | 'error', callback: Parameters<typeof getLazyLoader>['0']['on'] extends (e: infer E, c: infer C) => void ? C : never) =>
        getLazyLoader().on(event, callback as Parameters<ReturnType<typeof getLazyLoader>['on']>[1]),

    /**
     * Get the LazyLoaderManager instance
     */
    instance: getLazyLoader,
};

// Rehydrate API object
const rehydrate = {
    /**
     * Initialize all rehydrate components on the page
     */
    init: initRehydrate,

    /**
     * Emit an event that can trigger rehydration
     */
    emit: rehydrateEmit,

    /**
     * Trigger rehydration by event name
     */
    trigger: (eventName: string) => rehydrateManager.triggerByEvent(eventName),

    /**
     * Get a rehydrate instance by ID
     */
    get: (id: string) => rehydrateManager.get(id),

    /**
     * Get all rehydrate instances
     */
    getAll: () => rehydrateManager.getAll(),

    /**
     * Manually rehydrate a component by ID
     */
    reload: (id: string) => rehydrateManager.rehydrate(id),

    /**
     * Rehydrate all components
     */
    reloadAll: () => rehydrateManager.rehydrateAll(),

    /**
     * Get the RehydrateManager instance
     */
    instance: () => rehydrateManager,
};

// Teleport API object
const teleport = {
    /**
     * Initialize all teleport components on the page
     */
    init: initTeleport,

    /**
     * Register a teleport element
     */
    register: registerTeleport,

    /**
     * Get a teleport instance by ID
     */
    get: (id: string) => teleportManager.get(id),

    /**
     * Get all teleport instances
     */
    getAll: () => teleportManager.getAll(),

    /**
     * Teleport content by ID
     */
    teleport: (id: string) => teleportManager.teleport(id),

    /**
     * Return teleported content by ID
     */
    return: (id: string) => teleportManager.return(id),

    /**
     * Update target for a teleport instance
     */
    updateTarget: (id: string, selector: string) => teleportManager.updateTarget(id, selector),

    /**
     * Get the TeleportManager instance
     */
    instance: () => teleportManager,
};

// Event Bus API object
const events = {
    /**
     * Emit an event with optional data
     */
    emit: eventBusEmit,

    /**
     * Listen for an event
     * @returns Unsubscribe function
     */
    on: eventBusOn,

    /**
     * Listen for an event once (auto-removes after first call)
     * @returns Unsubscribe function
     */
    once: eventBusOnce,

    /**
     * Remove a specific listener
     */
    off: eventBusOff,

    /**
     * Remove all listeners for an event (or all events if no name provided)
     */
    clear: (event?: string) => getEventBus().clear(event),

    /**
     * Check if an event has listeners
     */
    hasListeners: (event: string) => getEventBus().hasListeners(event),

    /**
     * Get the number of listeners for an event
     */
    listenerCount: (event: string) => getEventBus().listenerCount(event),

    /**
     * Get all registered event names
     */
    eventNames: () => getEventBus().eventNames(),

    /**
     * Get the EventBus instance
     */
    instance: getEventBus,
};

// Bridge API object
const bridge = {
    /**
     * Get a bridge instance by ID
     */
    get: getBridge,

    /**
     * Get all bridge instances
     */
    getAll: getAllBridges,
};

// Errors API object
const errors = {
    /**
     * Initialize error handling with config
     */
    init: initErrorHandler,

    /**
     * Handle a generic error
     */
    handle: handleError,

    /**
     * Handle an AJAX error response
     */
    handleAjax: handleAjaxError,

    /**
     * Get the ErrorHandler module
     */
    handler: ErrorHandler,
};

/**
 * Main Accelade API
 */
const Accelade = {
    // Core
    init,
    initComponent,
    disposeComponent,
    getComponent,
    getComponents,

    // Framework
    getFramework,
    registry: FrameworkRegistry,

    // Navigation
    navigate,
    router,

    // Progress
    progress,

    // Notifications
    notify,

    // Shared data
    shared,

    // Lazy loading
    lazy,

    // Rehydrate
    rehydrate,

    // Teleport
    teleport,

    // Event Bus
    events,

    // Bridge
    bridge,

    // Errors
    errors,

    // Convenience event bus methods (Splade-compatible API)
    emit: eventBusEmit,
    on: eventBusOn,
    once: eventBusOnce,
    off: eventBusOff,

    // Debug (set via DebugManager when enabled)
    debug: false as boolean,
    devtools: null as unknown,
};

// Export for window
if (typeof window !== 'undefined') {
    // Register all adapters
    registerAdapters();

    // Initialize event bus methods for ScriptExecutor
    ScriptExecutor.setEventBusMethods({
        emit: eventBusEmit,
        on: eventBusOn,
        once: eventBusOnce,
        off: eventBusOff,
    });

    // Configure progress from AcceladeConfig if available
    const globalConfig = ConfigFactory.getGlobalConfig();
    if (globalConfig.progress && Object.keys(globalConfig.progress).length > 0) {
        configureProgress(globalConfig.progress as ProgressConfig);
    }

    // Initialize shared data from config
    if (globalConfig.shared) {
        SharedDataManager.getInstance().init(globalConfig.shared as SharedData);
    }

    // Check for debug mode
    if (globalConfig.debug) {
        const debug = DebugManager.getInstance();
        debug.setEnabled(true);
    }

    // Initialize error handler from config
    if (globalConfig.errors) {
        const errorConfig = globalConfig.errors as {
            suppressErrors?: boolean;
            showToasts?: boolean;
            logErrors?: boolean;
            debug?: boolean;
        };
        initErrorHandler({
            suppressErrors: errorConfig.suppressErrors ?? true,
            showToasts: errorConfig.showToasts ?? true,
            logErrors: errorConfig.logErrors ?? true,
            debug: errorConfig.debug ?? false,
        });
    } else {
        // Default initialization
        initErrorHandler();
    }

    // Expose on window
    (window as unknown as Record<string, unknown>).Accelade = Accelade;

    // Initialize rehydrate system
    initRehydrateSystem();

    // Auto-init on DOMContentLoaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            init();
            initLazy();
            initRehydrate();
            initTeleport();
        });
    } else {
        init();
        initLazy();
        initRehydrate();
        initTeleport();
    }
}

// Default export
export default Accelade;
</file>

<file path="README.md">
# Accelade

<p align="center">
<strong>Reactive Blade. Zero Complexity.</strong>
</p>

<p align="center">
<a href="https://github.com/fadymondy/accelade/actions"><img src="https://github.com/fadymondy/accelade/actions/workflows/tests.yml/badge.svg" alt="Tests"></a>
<a href="https://packagist.org/packages/accelade/accelade"><img src="https://img.shields.io/packagist/v/accelade/accelade" alt="Latest Version"></a>
<a href="https://packagist.org/packages/accelade/accelade"><img src="https://img.shields.io/packagist/dt/accelade/accelade" alt="Total Downloads"></a>
<a href="LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License"></a>
</p>

---

Add reactivity to your Laravel Blade templates without the overhead of a full SPA framework. Keep your server-rendered templates and sprinkle in reactive components exactly where you need them.

```blade
@accelade(['count' => 0])
    <button @click="$set('count', count + 1)">
        Clicked <span a-text="count">0</span> times
    </button>
@endaccelade
```

**That's it.** No build step required. No JavaScript to write. Just Blade.

---

## Why Accelade?

- **Blade-First** — Your templates stay in Blade. Add reactivity where needed.
- **No Build Required** — Works out of the box. Zero configuration.
- **Multi-Framework** — Use Vanilla JS, Vue, React, Svelte, or Angular syntax.
- **SPA Navigation** — Client-side routing with automatic progress bar.
- **Server Sync** — Seamlessly persist state to Laravel backend.
- **Shared Data** — Pass data from PHP to JavaScript globally across your app.
- **Animations** — Built-in animation presets for smooth transitions.
- **Lazy Loading** — Defer content with beautiful shimmer placeholders.
- **Persistent Layout** — Keep media players and widgets active during navigation.
- **SEO Engine** — Fluent API for managing meta tags, OpenGraph, and Twitter Cards.
- **Toast Notifications** — Beautiful Filament-style notifications from PHP or JS.
- **Lightweight** — ~28KB gzipped. No heavy dependencies.

---

## Quick Start

```bash
composer require accelade/accelade
```

Add to your layout:

```blade
<head>
    @acceladeStyles
</head>
<body>
    {{ $slot }}

    @acceladeScripts
    @acceladeNotifications
</body>
```

Start building:

```blade
@accelade(['name' => ''])
    <input a-model="name" placeholder="Your name">
    <p a-show="name">Hello, <span a-text="name"></span>!</p>
@endaccelade
```

---

## Features at a Glance

### Reactive Components
```blade
@accelade(['items' => [], 'newItem' => ''])
    <input a-model="newItem">
    <button @click="$set('items', [...items, newItem]); $set('newItem', '')">Add</button>
    <ul>
        <template a-for="item in items">
            <li a-text="item"></li>
        </template>
    </ul>
@endaccelade
```

### Server State Sync
```blade
@accelade(['preferences' => $userPreferences])
    <div a-sync="preferences">
        <select a-model="preferences.theme">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
        </select>
    </div>
@endaccelade
```

### Toast Notifications
```php
// From PHP
Notify::success('Saved!')->body('Your changes have been saved.');

// From JavaScript
window.Accelade.notify.success('Success!', 'Operation completed.');
```

### Shared Data
```php
// Share data from PHP (controller, middleware, etc.)
Accelade::share('user', auth()->user()->only('id', 'name'));
Accelade::share('settings', ['theme' => 'dark']);
```

```javascript
// Access in JavaScript anywhere
const userName = window.Accelade.shared.get('user.name');
const theme = window.Accelade.shared.get('settings.theme');
```

### Text Interpolation
```blade
@accelade(['count' => 0, 'name' => 'World'])
    <p>Hello, @{{ name }}!</p>
    <p>Count: @{{ count }}</p>
    <p>User: @{{ shared.user.name }}</p>
    <button @click="$set('count', count + 1)">Click</button>
@endaccelade
```

### Animations & Transitions
```blade
{{-- Simple toggle with animation --}}
<x-accelade::toggle animation="fade">
    <button @click="toggle()">Toggle</button>
    <div a-show="toggled">Fades in and out!</div>
</x-accelade::toggle>

{{-- Accordion with collapse animation --}}
<x-accelade::toggle animation="collapse">
    <button @click="toggle()">FAQ Question</button>
    <div a-show="toggled">Answer content...</div>
</x-accelade::toggle>

{{-- Available presets: fade, scale, collapse, slide-up, slide-down, slide-left, slide-right --}}
```

```php
// Register custom animation preset
Animation::new(
    name: 'bounce',
    enter: 'transition ease-bounce duration-300',
    enterFrom: 'opacity-0 scale-50',
    enterTo: 'opacity-100 scale-100',
    leave: 'transition ease-in duration-200',
    leaveFrom: 'opacity-100 scale-100',
    leaveTo: 'opacity-0 scale-50',
);
```

### Lazy Loading with Shimmer
```blade
<x-accelade::lazy :shimmer="true">
    @foreach($items as $item)
        <div class="card">{{ $item->name }}</div>
    @endforeach
</x-accelade::lazy>

{{-- Circle shimmer for avatars --}}
<x-accelade::lazy :shimmer="true" :shimmer-circle="true">
    <img src="{{ $user->avatar }}" alt="Avatar">
</x-accelade::lazy>
```

### SEO Management
```blade
@seoTitle('My Page Title')
@seoDescription('Page description for search engines')
@seoKeywords('laravel, blade, reactive')
@seoOpenGraph(['type' => 'article', 'image' => '/og-image.jpg'])

{{-- In layout <head> --}}
@seo
```

```php
// From PHP controller
SEO::title($post->title)
    ->description($post->excerpt)
    ->openGraphImage($post->featured_image);
```

### SPA Navigation
```blade
<x-accelade::link href="/dashboard">Dashboard</x-accelade::link>
```

### Content Component
```blade
{{-- Render pre-rendered HTML (Markdown, CMS content, etc.) --}}
<x-accelade::content :html="$renderedMarkdown" />

{{-- With custom wrapper and styling --}}
<x-accelade::content as="article" class="prose dark:prose-invert" :html="$html" />
```

---

## Choose Your Framework

Accelade adapts to your preferred syntax. Events use `@click`, `@submit`, etc. across all frameworks:

| Framework | Prefix | Example |
|-----------|--------|---------|
| Vanilla JS | `a-` | `<span a-text="name">`, `<button @click="...">` |
| Vue | `v-` | `<span v-text="name">`, `<button @click="...">` |
| React | `data-state-` | `<span data-state-text="name">`, `<button @click="...">` |
| Svelte | `s-` | `<span s-text="name">`, `<button @click="...">` |
| Angular | `ng-` | `<span ng-text="name">`, `<button @click="...">` |

```env
ACCELADE_FRAMEWORK=vue
```

---

## Requirements

- PHP 8.2+
- Laravel 11.x or 12.x

---

## Documentation

| Guide | Description |
|-------|-------------|
| [Getting Started](docs/getting-started.md) | Installation and first steps |
| [Components](docs/components.md) | Building reactive components |
| [Animations](docs/animations.md) | Animation presets and transitions |
| [Data Component](docs/data.md) | Reactive data with storage persistence |
| [Shared Data](docs/shared-data.md) | Share data from PHP to JavaScript |
| [Lazy Loading](docs/lazy-loading.md) | Deferred content with shimmer |
| [Persistent Layout](docs/persistent-layout.md) | Keep elements active during navigation |
| [Event Bus](docs/event-bus.md) | Decoupled component communication |
| [Bridge Components](docs/bridge.md) | Two-way PHP/JavaScript binding (Beta) |
| [Content](docs/content.md) | Render pre-rendered HTML (Markdown, CMS) |
| [SEO](docs/seo.md) | Meta tags, OpenGraph, Twitter Cards |
| [Notifications](docs/notifications.md) | Toast notification system |
| [SPA Navigation](docs/spa-navigation.md) | Client-side routing |
| [Frameworks](docs/frameworks.md) | Vue, React, Svelte, Angular |
| [Configuration](docs/configuration.md) | All config options |
| [API Reference](docs/api-reference.md) | Complete API docs |

---

## Credits

Built with inspiration from [Livewire](https://livewire.laravel.com), [Filament](https://filamentphp.com), and [Inertia.js](https://inertiajs.com).

---

## License

MIT License. See [LICENSE](LICENSE) for details.
</file>

<file path="resources/js/adapters/BaseAdapter.ts">
/**
 * BaseAdapter - Abstract base class with shared adapter logic
 */

import type {
    IFrameworkAdapter,
    IStateAdapter,
    IBindingAdapter,
    ComponentInstance,
    FrameworkType,
    BindingAttributeMap,
    CleanupFn,
} from './types';
import type { AcceladeComponentConfig, AcceladeActions } from '../core/types';
import { ConfigFactory } from '../core/factories/ConfigFactory';
import { SyncFactory } from '../core/factories/SyncFactory';
import { ActionsFactory } from '../core/factories/ActionsFactory';
import { ScriptExecutor } from '../core/factories/ScriptExecutor';
import type { CustomMethods } from '../core/factories/ScriptExecutor';
import { DeferFactory } from '../core/factories/DeferFactory';
import type { DeferInstance } from '../core/factories/DeferFactory';
import { EchoFactory } from '../core/echo/EchoFactory';
import type { EchoInstance } from '../core/echo/EchoFactory';
import { FlashFactory } from '../core/flash/FlashFactory';
import type { FlashInstance } from '../core/flash/FlashFactory';
import { createModal } from '../core/modal/ModalFactory';
import type { ModalAdapterInstance } from '../core/modal/ModalFactory';
import { createState } from '../core/state/StateFactory';
import type { StateInstance } from '../core/state/StateFactory';
import { createToggle, createToggleMethods } from '../core/toggle/ToggleFactory';
import type { ToggleInstance } from '../core/toggle/ToggleFactory';
import { createTransition } from '../core/transition/TransitionFactory';
import type { TransitionInstance } from '../core/transition/types';
import { createBridge, createMethodProxies, disposeBridge } from '../core/bridge';
import type { BridgeInstance } from '../core/bridge';

/**
 * Global stores for shared reactive state
 */
const globalStores: Map<string, Record<string, unknown>> = new Map();

/**
 * Default binding attribute map (vanilla/base)
 */
const DEFAULT_BINDING_ATTRIBUTES: BindingAttributeMap = {
    text: 'a-text',
    html: 'a-html',
    show: 'a-show',
    if: 'a-if',
    model: 'a-model',
    class: 'a-class',
    style: 'a-style',
    bind: 'a-bind:',
    on: '@',
    cloak: 'data-accelade-cloak',
};

/**
 * Abstract base adapter with shared functionality
 */
export abstract class BaseAdapter implements IFrameworkAdapter {
    abstract readonly type: FrameworkType;

    protected components: Map<string, ComponentInstance> = new Map();
    protected cleanupFns: Map<string, CleanupFn[]> = new Map();

    /**
     * Create a state adapter (framework-specific)
     */
    abstract createStateAdapter(): IStateAdapter;

    /**
     * Create a binding adapter (framework-specific)
     */
    abstract createBindingAdapter(): IBindingAdapter;

    /**
     * Check if framework is available
     */
    isAvailable(): boolean {
        return true; // Override in subclasses that need runtime checks
    }

    /**
     * Get attribute prefix
     */
    getAttributePrefix(): string {
        return 'a-';
    }

    /**
     * Get event prefix
     */
    getEventPrefix(): string {
        return '@';
    }

    /**
     * Get script selector
     */
    getScriptSelector(): string {
        return 'script[a-script], accelade-script, accelade\\:script';
    }

    /**
     * Get binding attribute map
     */
    getBindingAttributes(): BindingAttributeMap {
        return DEFAULT_BINDING_ATTRIBUTES;
    }

    /**
     * Load state from storage (sessionStorage or localStorage)
     */
    protected loadFromStorage(key: string, useLocalStorage: boolean): Record<string, unknown> | null {
        try {
            const storage = useLocalStorage ? localStorage : sessionStorage;
            const stored = storage.getItem(`accelade:${key}`);
            if (stored) {
                return JSON.parse(stored) as Record<string, unknown>;
            }
        } catch {
            // Storage not available or invalid data
        }
        return null;
    }

    /**
     * Save state to storage (sessionStorage or localStorage)
     */
    protected saveToStorage(key: string, state: Record<string, unknown>, useLocalStorage: boolean): void {
        try {
            const storage = useLocalStorage ? localStorage : sessionStorage;
            storage.setItem(`accelade:${key}`, JSON.stringify(state));
        } catch {
            // Storage not available or quota exceeded
        }
    }

    /**
     * Get or create a global store
     */
    protected getOrCreateStore(storeName: string, initialState: Record<string, unknown>): Record<string, unknown> {
        if (globalStores.has(storeName)) {
            return globalStores.get(storeName)!;
        }
        const store = { ...initialState };
        globalStores.set(storeName, store);
        return store;
    }

    /**
     * Initialize a component
     */
    initComponent(element: HTMLElement, config: AcceladeComponentConfig): ComponentInstance {
        // Determine initial state (with storage loading)
        let initialState = { ...config.state };

        // If using a global store, get or create it
        if (config.storeName) {
            const store = this.getOrCreateStore(config.storeName, initialState);
            initialState = { ...store };
        }

        // If remember key is set, try to load from sessionStorage
        if (config.rememberKey) {
            const storedState = this.loadFromStorage(config.rememberKey, false);
            if (storedState) {
                initialState = { ...initialState, ...storedState };
            }
        }

        // If localStorage key is set, try to load from localStorage
        if (config.localStorageKey) {
            const storedState = this.loadFromStorage(config.localStorageKey, true);
            if (storedState) {
                initialState = { ...initialState, ...storedState };
            }
        }

        // Create state adapter
        const stateAdapter = this.createStateAdapter();
        stateAdapter.init(initialState);

        // Store original state
        const originalState = { ...config.state };

        // Create actions
        const actions = ActionsFactory.create(
            () => stateAdapter.getState(),
            (key, value) => stateAdapter.set(key, value),
            originalState
        );

        // Create binding adapter
        const bindingAdapter = this.createBindingAdapter();
        bindingAdapter.init(element, stateAdapter);

        // Setup sync properties
        const syncProperties = new Set(config.sync);
        this.setupSyncWatchers(config.id, stateAdapter, syncProperties);

        // Create script helpers
        const helpers = ScriptExecutor.createHelpers(
            () => stateAdapter.getState(),
            (key, value) => stateAdapter.set(key, value),
            this.createWatchFn(stateAdapter)
        );

        // Execute custom scripts
        const customMethods = ScriptExecutor.execute(
            element,
            {
                state: stateAdapter.getState(),
                actions,
                helpers,
                setState: (key, value) => stateAdapter.set(key, value),
                getState: () => stateAdapter.getState(),
                originalState,
            },
            this.type
        );

        // Setup Toggle component BEFORE event bindings (so toggle/setToggle are available)
        let toggleInstance: ToggleInstance | undefined;
        if (element.hasAttribute('data-accelade-toggle')) {
            toggleInstance = this.setupToggle(element, config.id, stateAdapter, customMethods);
        }

        // Setup Bridge component BEFORE event bindings (so PHP methods are available)
        let bridgeInstance: BridgeInstance | undefined;
        if (element.hasAttribute('data-accelade-bridge')) {
            bridgeInstance = this.setupBridge(element, config.id, stateAdapter, customMethods);
        }

        // Setup event bindings
        this.setupEventBindings(element, stateAdapter, actions, customMethods, bindingAdapter);

        // Setup reactive bindings
        this.setupReactiveBindings(element, stateAdapter, bindingAdapter);

        // Setup defer component if applicable
        let deferInstance: DeferInstance | undefined;
        if (element.hasAttribute('data-accelade-defer')) {
            deferInstance = this.setupDefer(element, config.id, stateAdapter, customMethods);
        }

        // Setup Echo event listener if applicable
        let echoInstance: EchoInstance | undefined;
        if (element.hasAttribute('data-accelade-echo')) {
            echoInstance = this.setupEcho(element, config.id, stateAdapter);
        }

        // Setup Flash data if applicable
        let flashInstance: FlashInstance | undefined;
        if (element.hasAttribute('data-accelade-flash')) {
            flashInstance = this.setupFlash(element, config.id, stateAdapter);
        }

        // Setup Modal if applicable
        let modalInstance: ModalAdapterInstance | undefined;
        if (element.hasAttribute('data-accelade-modal')) {
            modalInstance = this.setupModal(element, config.id, stateAdapter);
        }

        // Setup State component if applicable
        let stateInstance: StateInstance | undefined;
        if (element.hasAttribute('data-accelade-state-component')) {
            stateInstance = this.setupState(element, config.id, stateAdapter);
        }

        // Setup Transition elements inside this component
        this.setupTransitions(element, config.id, stateAdapter);

        // Setup state attribute sync for lazy loading conditional triggers
        const stateAttrCleanup = stateAdapter.subscribe(() => {
            element.dataset.acceladeState = JSON.stringify(stateAdapter.getState());
        });
        this.addCleanups(config.id, [stateAttrCleanup]);

        // Setup storage persistence watchers
        if (config.rememberKey || config.localStorageKey || config.storeName) {
            const storageCleanup = stateAdapter.subscribe(() => {
                const currentState = stateAdapter.getState();

                // Save to sessionStorage if remember key is set
                if (config.rememberKey) {
                    this.saveToStorage(config.rememberKey, currentState, false);
                }

                // Save to localStorage if localStorage key is set
                if (config.localStorageKey) {
                    this.saveToStorage(config.localStorageKey, currentState, true);
                }

                // Update global store if this component uses one
                if (config.storeName && globalStores.has(config.storeName)) {
                    const store = globalStores.get(config.storeName)!;
                    Object.assign(store, currentState);
                }
            });
            this.addCleanups(config.id, [storageCleanup]);
        }

        // Create component instance
        const instance: ComponentInstance = {
            id: config.id,
            element,
            framework: this.type,
            state: stateAdapter.getState(),
            originalState,
            actions,
            customMethods,
            syncProperties,
            stateAdapter,
            bindingAdapter,
            dispose: () => this.disposeComponent(instance),
        };

        // Store component
        this.components.set(config.id, instance);

        // Remove cloak
        this.removeCloak(element);

        return instance;
    }

    /**
     * Create watch function (override in framework-specific adapters)
     */
    protected createWatchFn(
        stateAdapter: IStateAdapter
    ): ((key: string, callback: (newVal: unknown, oldVal: unknown) => void) => void) | undefined {
        return (key, callback) => {
            stateAdapter.subscribeKey(key, callback);
        };
    }

    /**
     * Setup sync watchers for properties that should sync to server
     */
    protected setupSyncWatchers(
        componentId: string,
        stateAdapter: IStateAdapter,
        syncProperties: Set<string>
    ): void {
        if (syncProperties.size === 0) return;

        const cleanups: CleanupFn[] = [];

        for (const prop of syncProperties) {
            const unsubscribe = stateAdapter.subscribeKey(prop, (newVal) => {
                SyncFactory.sync(componentId, prop, newVal);
            });
            cleanups.push(unsubscribe);
        }

        this.addCleanups(componentId, cleanups);
    }

    /**
     * Setup event bindings
     */
    protected setupEventBindings(
        element: HTMLElement,
        stateAdapter: IStateAdapter,
        actions: AcceladeActions,
        customMethods: CustomMethods,
        bindingAdapter: IBindingAdapter
    ): void {
        const eventPrefix = this.getEventPrefix();
        const altEventPrefix = this.getAltEventPrefix();
        const allElements = element.querySelectorAll<HTMLElement>('*');

        allElements.forEach((el) => {
            Array.from(el.attributes).forEach((attr) => {
                let eventName: string | null = null;
                let handler: string | null = null;

                if (attr.name.startsWith(eventPrefix)) {
                    eventName = attr.name.slice(eventPrefix.length);
                    handler = attr.value;
                } else if (altEventPrefix && attr.name.startsWith(altEventPrefix)) {
                    eventName = attr.name.slice(altEventPrefix.length);
                    handler = attr.value;
                }

                if (eventName && handler) {
                    bindingAdapter.bindEvent(el, eventName, handler, actions, customMethods);
                }
            });
        });
    }

    /**
     * Get alternate event prefix (e.g., '@' for Vue)
     */
    protected getAltEventPrefix(): string | null {
        return null;
    }

    /**
     * Setup reactive bindings
     */
    protected setupReactiveBindings(
        element: HTMLElement,
        stateAdapter: IStateAdapter,
        bindingAdapter: IBindingAdapter
    ): void {
        const attrs = this.getBindingAttributes();

        // Text bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.text}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.text);
            if (expr) bindingAdapter.bindText(el, expr);
        });

        // HTML bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.html}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.html);
            if (expr) bindingAdapter.bindHtml(el, expr);
        });

        // Show bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.show}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.show);
            if (expr) bindingAdapter.bindShow(el, expr);
        });

        // If bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.if}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.if);
            if (expr) bindingAdapter.bindIf(el, expr);
        });

        // Model bindings
        element.querySelectorAll<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>(
            `[${attrs.model}]`
        ).forEach((el) => {
            const prop = el.getAttribute(attrs.model);
            if (prop) bindingAdapter.bindModel(el, prop);
        });

        // Class bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.class}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.class);
            if (expr) bindingAdapter.bindClass(el, expr);
        });

        // Style bindings
        element.querySelectorAll<HTMLElement>(`[${attrs.style}]`).forEach((el) => {
            const expr = el.getAttribute(attrs.style);
            if (expr) bindingAdapter.bindStyle(el, expr);
        });

        // Attribute bindings (a-bind:*, :*)
        const bindPrefix = attrs.bind;
        element.querySelectorAll<HTMLElement>('*').forEach((el) => {
            Array.from(el.attributes).forEach((attr) => {
                if (attr.name.startsWith(bindPrefix)) {
                    const attrName = attr.name.slice(bindPrefix.length);
                    bindingAdapter.bindAttribute(el, attrName, attr.value);
                } else if (attr.name.startsWith(':') && !attr.name.startsWith('::')) {
                    const attrName = attr.name.slice(1);
                    bindingAdapter.bindAttribute(el, attrName, attr.value);
                }
            });
        });
    }

    /**
     * Setup defer component
     */
    protected setupDefer(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter,
        customMethods: CustomMethods
    ): DeferInstance | undefined {
        const config = DeferFactory.parseConfig(element);
        if (!config) {
            return undefined;
        }

        // Create setState function
        const setState = (key: string, value: unknown): void => {
            stateAdapter.set(key, value);
        };

        // Create getState function
        const getState = (): Record<string, unknown> => {
            return stateAdapter.getState();
        };

        // Create dispatchEvent function
        const dispatchEvent = (name: string, detail: unknown): void => {
            const event = new CustomEvent(`accelade:defer:${name}`, {
                detail,
                bubbles: true,
                cancelable: true,
            });
            element.dispatchEvent(event);
        };

        // Create defer instance
        const instance = DeferFactory.create(
            componentId,
            config,
            setState,
            getState,
            dispatchEvent
        );

        // Add reload to customMethods
        customMethods.reload = instance.reload;

        // Setup watch if configured
        if (config.watchValue) {
            const unsubscribe = stateAdapter.subscribeKey(config.watchValue, () => {
                DeferFactory.triggerReloadDebounced(
                    componentId,
                    config.watchDebounce ?? 150,
                    instance.reload
                );
            });
            this.addCleanups(componentId, [unsubscribe]);
        }

        // Add cleanup for defer instance
        this.addCleanups(componentId, [() => DeferFactory.dispose(componentId)]);

        return instance;
    }

    /**
     * Setup Echo event listener
     */
    protected setupEcho(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter
    ): EchoInstance | undefined {
        const instance = EchoFactory.create(componentId, element, stateAdapter);
        if (!instance) {
            return undefined;
        }

        // Add cleanup for Echo instance
        this.addCleanups(componentId, [() => EchoFactory.dispose(instance)]);

        return instance;
    }

    /**
     * Setup Flash data
     */
    protected setupFlash(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter
    ): FlashInstance | undefined {
        const instance = FlashFactory.create(componentId, element, stateAdapter);
        if (!instance) {
            return undefined;
        }

        // Add cleanup for Flash instance
        this.addCleanups(componentId, [() => instance.dispose()]);

        return instance;
    }

    /**
     * Setup Modal component
     */
    protected setupModal(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter
    ): ModalAdapterInstance | undefined {
        const instance = createModal(componentId, element, stateAdapter);
        if (!instance) {
            return undefined;
        }

        // Add cleanup for Modal instance
        this.addCleanups(componentId, [() => instance.dispose()]);

        return instance;
    }

    /**
     * Setup State component
     */
    protected setupState(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter
    ): StateInstance | undefined {
        const instance = createState(componentId, element, stateAdapter);
        if (!instance) {
            return undefined;
        }

        // Add cleanup for State instance
        this.addCleanups(componentId, [() => instance.dispose()]);

        return instance;
    }

    /**
     * Setup Toggle component
     */
    protected setupToggle(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter,
        customMethods: CustomMethods
    ): ToggleInstance | undefined {
        const instance = createToggle(componentId, element, stateAdapter);
        if (!instance) {
            return undefined;
        }

        // Add toggle and setToggle methods to customMethods
        const toggleMethods = createToggleMethods(instance);
        customMethods.toggle = toggleMethods.toggle;
        customMethods.setToggle = toggleMethods.setToggle;

        // Add cleanup for Toggle instance
        this.addCleanups(componentId, [() => instance.dispose()]);

        return instance;
    }

    /**
     * Setup Transition elements inside a component
     */
    protected setupTransitions(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter
    ): TransitionInstance[] {
        const instances: TransitionInstance[] = [];
        const transitionElements = element.querySelectorAll<HTMLElement>('[data-accelade-transition]');

        transitionElements.forEach((transitionEl) => {
            const instance = createTransition(componentId, transitionEl, stateAdapter);
            instances.push(instance);

            // Add cleanup for Transition instance
            this.addCleanups(componentId, [() => instance.dispose()]);
        });

        return instances;
    }

    /**
     * Setup Bridge component for PHP two-way binding
     */
    protected setupBridge(
        element: HTMLElement,
        componentId: string,
        stateAdapter: IStateAdapter,
        customMethods: CustomMethods
    ): BridgeInstance | undefined {
        const instance = createBridge(
            element,
            componentId,
            (key, value) => stateAdapter.set(key, value),
            () => stateAdapter.getState()
        );

        if (!instance) {
            return undefined;
        }

        // Note: BridgeFactory already initializes props in state via setState
        // Do NOT store the Bridge proxy (instance.props) in state directly
        // as it would cause infinite recursion when setting nested paths

        // Add bridge method proxies to customMethods
        const methodProxies = createMethodProxies(instance);
        for (const [name, fn] of Object.entries(methodProxies)) {
            customMethods[name] = fn;
        }

        // Add $bridge helper function for direct access
        customMethods.$bridge = () => instance;

        // Add cleanup for Bridge instance
        this.addCleanups(componentId, [() => disposeBridge(instance.id)]);

        return instance;
    }

    /**
     * Remove cloak from element
     */
    protected removeCloak(element: HTMLElement): void {
        element.removeAttribute('data-accelade-cloak');
        element.removeAttribute('a-cloak');
        element.removeAttribute('v-cloak');
        element.classList.add('accelade-ready');
    }

    /**
     * Dispose a component
     */
    disposeComponent(instance: ComponentInstance): void {
        // Run cleanups
        const cleanups = this.cleanupFns.get(instance.id);
        if (cleanups) {
            cleanups.forEach((fn) => fn());
            this.cleanupFns.delete(instance.id);
        }

        // Cancel pending syncs
        SyncFactory.cancelComponent(instance.id);

        // Dispose adapters
        instance.stateAdapter.dispose();
        instance.bindingAdapter.dispose();

        // Remove from components map
        this.components.delete(instance.id);
    }

    /**
     * Add cleanup functions for a component
     */
    protected addCleanups(componentId: string, fns: CleanupFn[]): void {
        const existing = this.cleanupFns.get(componentId) ?? [];
        this.cleanupFns.set(componentId, [...existing, ...fns]);
    }

    /**
     * Get a component instance by ID
     */
    getComponent(id: string): ComponentInstance | undefined {
        return this.components.get(id);
    }

    /**
     * Get all component instances
     */
    getAllComponents(): ComponentInstance[] {
        return Array.from(this.components.values());
    }

    /**
     * Dispose all components
     */
    disposeAll(): void {
        for (const instance of this.components.values()) {
            this.disposeComponent(instance);
        }
    }
}

export default BaseAdapter;
</file>

<file path="resources/views/components/layouts/demo-sidebar.blade.php">
@props([
    'framework' => 'vanilla',
    'section' => 'counter',
])

@php
    $frameworkColors = [
        'vanilla' => ['bg' => 'bg-indigo-600', 'shadow' => 'shadow-indigo-200', 'text' => 'text-indigo-600', 'dot' => 'bg-indigo-500', 'ring' => 'ring-indigo-500'],
        'vue' => ['bg' => 'bg-emerald-600', 'shadow' => 'shadow-emerald-200', 'text' => 'text-emerald-600', 'dot' => 'bg-emerald-500', 'ring' => 'ring-emerald-500'],
        'react' => ['bg' => 'bg-cyan-600', 'shadow' => 'shadow-cyan-200', 'text' => 'text-cyan-600', 'dot' => 'bg-cyan-500', 'ring' => 'ring-cyan-500'],
        'svelte' => ['bg' => 'bg-orange-600', 'shadow' => 'shadow-orange-200', 'text' => 'text-orange-600', 'dot' => 'bg-orange-500', 'ring' => 'ring-orange-500'],
        'angular' => ['bg' => 'bg-red-600', 'shadow' => 'shadow-red-200', 'text' => 'text-red-600', 'dot' => 'bg-red-500', 'ring' => 'ring-red-500'],
    ];
    $colors = $frameworkColors[$framework] ?? $frameworkColors['vanilla'];

    // Grouped sections for better organization
    $sectionGroups = [
        'Getting Started' => [
            ['id' => 'counter', 'label' => 'Counter', 'icon' => '🔢'],
            ['id' => 'scripts', 'label' => 'Custom Scripts', 'icon' => '📜'],
        ],
        'Data & State' => [
            ['id' => 'data', 'label' => 'Data Component', 'icon' => '💾'],
            ['id' => 'state', 'label' => 'State Component', 'icon' => '🔀'],
            ['id' => 'shared-data', 'label' => 'Shared Data', 'icon' => '📤'],
            ['id' => 'flash', 'label' => 'Flash Data', 'icon' => '⚡'],
            ['id' => 'errors', 'label' => 'Errors Component', 'icon' => '⚠️'],
        ],
        'UI Components' => [
            ['id' => 'modal', 'label' => 'Modal/Slideover', 'icon' => '🪟'],
            ['id' => 'toggle', 'label' => 'Toggle', 'icon' => '🔘'],
            ['id' => 'transition', 'label' => 'Transition', 'icon' => '✨'],
            ['id' => 'notifications', 'label' => 'Notifications', 'icon' => '🔔'],
        ],
        'Content Loading' => [
            ['id' => 'lazy', 'label' => 'Lazy Loading', 'icon' => '⏳'],
            ['id' => 'defer', 'label' => 'Defer Component', 'icon' => '⏱️'],
            ['id' => 'content', 'label' => 'Content', 'icon' => '📄'],
            ['id' => 'rehydrate', 'label' => 'Rehydrate', 'icon' => '🔄'],
            ['id' => 'teleport', 'label' => 'Teleport', 'icon' => '🚀'],
        ],
        'Navigation & Events' => [
            ['id' => 'navigation', 'label' => 'SPA Navigation', 'icon' => '🧭'],
            ['id' => 'link', 'label' => 'Link Component', 'icon' => '🔗'],
            ['id' => 'progress', 'label' => 'Progress Bar', 'icon' => '📊'],
            ['id' => 'persistent', 'label' => 'Persistent Layout', 'icon' => '📌'],
            ['id' => 'event-bus', 'label' => 'Event Bus', 'icon' => '🔊'],
            ['id' => 'event', 'label' => 'Event (Echo)', 'icon' => '📡'],
        ],
        'Backend Integration' => [
            ['id' => 'bridge', 'label' => 'Bridge (PHP)', 'icon' => '🌉'],
        ],
    ];

    // Flatten for finding section info
    $allSections = collect($sectionGroups)->flatten(1)->keyBy('id')->toArray();
@endphp
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <meta name="accelade-framework" content="{{ $framework }}">

    <title>Accelade Demo - {{ ucfirst($framework) }} - {{ ucfirst($section) }}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=instrument-sans:400,500,600,700" rel="stylesheet" />

    <!-- Prism.js Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <!-- Tailwind CSS -->
    @if(file_exists(public_path('build/manifest.json')))
        @vite(['resources/css/app.css'])
    @else
        <script src="https://cdn.tailwindcss.com"></script>
    @endif

    @acceladeStyles
    @php
        app('accelade')->setFramework($framework);
    @endphp

    <style>
        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.8125rem;
            font-weight: 500;
            transition: all 0.15s ease;
            color: #64748b;
            text-decoration: none;
        }
        .sidebar-link:hover {
            background-color: #f1f5f9;
            color: #334155;
            transform: translateX(2px);
        }
        .sidebar-link.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            box-shadow: 0 2px 4px -1px rgba(99, 102, 241, 0.3);
        }
        .sidebar-link.active:hover {
            transform: translateX(2px);
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .sidebar-link .icon {
            width: 1.25rem;
            height: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }
        .group-title {
            font-size: 0.625rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.075em;
            color: #94a3b8;
            padding: 0.5rem 0.75rem 0.25rem;
            margin-top: 0.75rem;
        }
        .group-title:first-child {
            margin-top: 0;
        }
        /* Framework buttons */
        .framework-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            background: #f1f5f9;
            border: 2px solid transparent;
        }
        .framework-btn:hover {
            transform: scale(1.1);
            background: #e2e8f0;
        }
        .framework-btn.active {
            border-color: currentColor;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        .framework-btn svg {
            width: 20px;
            height: 20px;
        }
        /* Code block styles */
        .code-block-wrapper pre[class*="language-"] {
            margin: 0 !important;
            padding: 1rem !important;
            border-radius: 0 !important;
            background: #1e293b !important;
            font-size: 0.875rem !important;
            line-height: 1.6 !important;
        }
        .code-block-wrapper code[class*="language-"] {
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace !important;
            font-size: 0.875rem !important;
        }
        .code-block-wrapper .token.comment,
        .code-block-wrapper .token.prolog,
        .code-block-wrapper .token.doctype,
        .code-block-wrapper .token.cdata { color: #6b7280 !important; }
        .code-block-wrapper .token.punctuation { color: #94a3b8 !important; }
        .code-block-wrapper .token.property,
        .code-block-wrapper .token.tag,
        .code-block-wrapper .token.boolean,
        .code-block-wrapper .token.number,
        .code-block-wrapper .token.constant,
        .code-block-wrapper .token.symbol { color: #f472b6 !important; }
        .code-block-wrapper .token.selector,
        .code-block-wrapper .token.attr-name,
        .code-block-wrapper .token.string,
        .code-block-wrapper .token.char,
        .code-block-wrapper .token.builtin { color: #a5f3fc !important; }
        .code-block-wrapper .token.operator,
        .code-block-wrapper .token.entity,
        .code-block-wrapper .token.url,
        .code-block-wrapper .language-css .token.string,
        .code-block-wrapper .style .token.string,
        .code-block-wrapper .token.variable { color: #fbbf24 !important; }
        .code-block-wrapper .token.atrule,
        .code-block-wrapper .token.attr-value,
        .code-block-wrapper .token.keyword { color: #c084fc !important; }
        .code-block-wrapper .token.function { color: #60a5fa !important; }
        .code-block-wrapper .token.regex,
        .code-block-wrapper .token.important { color: #fb923c !important; }
        /* Scrollbar styling */
        .sidebar-nav::-webkit-scrollbar {
            width: 4px;
        }
        .sidebar-nav::-webkit-scrollbar-track {
            background: transparent;
        }
        .sidebar-nav::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }
        .sidebar-nav::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
    @stack('styles')
</head>
<body class="bg-slate-50 min-h-screen font-sans antialiased">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-slate-200 flex flex-col fixed h-full">
            <!-- Logo -->
            <div class="p-5 border-b border-slate-100">
                <h1 class="text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                    Accelade
                </h1>
                <p class="text-[10px] text-slate-400 mt-0.5">Reactive Blade Templates</p>
            </div>

            <!-- Framework Selector with Logos -->
            <div class="px-4 py-3 border-b border-slate-100">
                <label class="text-[10px] font-semibold text-slate-400 uppercase tracking-wider mb-2 block">Framework</label>
                <div class="flex items-center justify-between gap-1">
                    {{-- Vanilla JS --}}
                    <a href="{{ route('docs.section', ['framework' => 'vanilla', 'section' => $section]) }}"
                       class="framework-btn {{ $framework === 'vanilla' ? 'active text-indigo-600' : 'text-slate-500' }}"
                       title="Vanilla JavaScript">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"/>
                        </svg>
                    </a>

                    {{-- Vue --}}
                    <a href="{{ route('docs.section', ['framework' => 'vue', 'section' => $section]) }}"
                       class="framework-btn {{ $framework === 'vue' ? 'active text-emerald-600' : 'text-slate-500' }}"
                       title="Vue.js">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 1.61h-9.94L12 5.16 9.94 1.61H0l12 20.78L24 1.61zM12 14.08 5.16 2.23h4.43L12 6.41l2.41-4.18h4.43L12 14.08z"/>
                        </svg>
                    </a>

                    {{-- React --}}
                    <a href="{{ route('docs.section', ['framework' => 'react', 'section' => $section]) }}"
                       class="framework-btn {{ $framework === 'react' ? 'active text-cyan-500' : 'text-slate-500' }}"
                       title="React">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14.23 12.004a2.236 2.236 0 0 1-2.235 2.236 2.236 2.236 0 0 1-2.236-2.236 2.236 2.236 0 0 1 2.235-2.236 2.236 2.236 0 0 1 2.236 2.236zm2.648-10.69c-1.346 0-3.107.96-4.888 2.622-1.78-1.653-3.542-2.602-4.887-2.602-.41 0-.783.093-1.106.278-1.375.793-1.683 3.264-.973 6.365C1.98 8.917 0 10.42 0 12.004c0 1.59 1.99 3.097 5.043 4.03-.704 3.113-.39 5.588.988 6.38.32.187.69.275 1.102.275 1.345 0 3.107-.96 4.888-2.624 1.78 1.654 3.542 2.603 4.887 2.603.41 0 .783-.09 1.106-.275 1.374-.792 1.683-3.263.973-6.365C22.02 15.096 24 13.59 24 12.004c0-1.59-1.99-3.097-5.043-4.032.704-3.11.39-5.587-.988-6.38-.318-.184-.688-.277-1.092-.278zm-.005 1.09v.006c.225 0 .406.044.558.127.666.382.955 1.835.73 3.704-.054.46-.142.945-.25 1.44-.96-.236-2.006-.417-3.107-.534-.66-.905-1.345-1.727-2.035-2.447 1.592-1.48 3.087-2.292 4.105-2.295zm-9.77.02c1.012 0 2.514.808 4.11 2.28-.686.72-1.37 1.537-2.02 2.442-1.107.117-2.154.298-3.113.538-.112-.49-.195-.964-.254-1.42-.23-1.868.054-3.32.714-3.707.19-.09.4-.127.563-.132zm4.882 3.05c.455.468.91.992 1.36 1.564-.44-.02-.89-.034-1.345-.034-.46 0-.915.01-1.36.034.44-.572.895-1.096 1.345-1.565zM12 8.1c.74 0 1.477.034 2.202.093.406.582.802 1.203 1.183 1.86.372.64.71 1.29 1.018 1.946-.308.655-.646 1.31-1.013 1.95-.38.66-.773 1.288-1.18 1.87-.728.063-1.466.098-2.21.098-.74 0-1.477-.035-2.202-.093-.406-.582-.802-1.204-1.183-1.86-.372-.64-.71-1.29-1.018-1.946.303-.657.646-1.313 1.013-1.954.38-.66.773-1.286 1.18-1.868.728-.064 1.466-.098 2.21-.098zm-3.635.254c-.24.377-.48.763-.704 1.16-.225.39-.435.782-.635 1.174-.265-.656-.49-1.31-.676-1.947.64-.15 1.315-.283 2.015-.386zm7.26 0c.695.103 1.365.23 2.006.387-.18.632-.405 1.282-.66 1.933-.2-.39-.41-.783-.64-1.174-.225-.392-.465-.774-.705-1.146zm3.063.675c.484.15.944.317 1.375.498 1.732.74 2.852 1.708 2.852 2.476-.005.768-1.125 1.74-2.857 2.475-.42.18-.88.342-1.355.493-.28-.958-.646-1.956-1.1-2.98.45-1.017.81-2.01 1.085-2.964zm-13.395.004c.278.96.645 1.957 1.1 2.98-.45 1.017-.812 2.01-1.086 2.964-.484-.15-.944-.318-1.37-.5-1.732-.737-2.852-1.706-2.852-2.474 0-.768 1.12-1.742 2.852-2.476.42-.18.88-.342 1.356-.494zm11.678 4.28c.265.657.49 1.312.676 1.948-.64.157-1.316.29-2.016.39.24-.375.48-.762.705-1.158.225-.39.435-.788.636-1.18zm-9.945.02c.2.392.41.783.64 1.175.23.39.465.772.705 1.143-.695-.102-1.365-.23-2.006-.386.18-.63.406-1.282.66-1.933zM17.92 16.32c.112.493.2.968.254 1.423.23 1.868-.054 3.32-.714 3.708-.147.09-.338.128-.563.128-1.012 0-2.514-.807-4.11-2.28.686-.72 1.37-1.536 2.02-2.44 1.107-.118 2.154-.3 3.113-.54zm-11.83.01c.96.234 2.006.415 3.107.532.66.905 1.345 1.727 2.035 2.446-1.595 1.483-3.092 2.295-4.11 2.295-.22-.005-.406-.05-.553-.132-.666-.38-.955-1.834-.73-3.703.054-.46.142-.944.25-1.438zm4.56.64c.44.02.89.034 1.345.034.46 0 .915-.01 1.36-.034-.44.572-.895 1.095-1.345 1.565-.455-.47-.91-.993-1.36-1.565z"/>
                        </svg>
                    </a>

                    {{-- Svelte --}}
                    <a href="{{ route('docs.section', ['framework' => 'svelte', 'section' => $section]) }}"
                       class="framework-btn {{ $framework === 'svelte' ? 'active text-orange-600' : 'text-slate-500' }}"
                       title="Svelte">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10.354 21.125a4.44 4.44 0 0 1-4.765-1.767 4.109 4.109 0 0 1-.703-3.107 3.898 3.898 0 0 1 .134-.522l.105-.321.287.21a7.21 7.21 0 0 0 2.186 1.092l.208.063-.02.208a1.253 1.253 0 0 0 .226.83 1.337 1.337 0 0 0 1.435.533 1.231 1.231 0 0 0 .343-.15l5.59-3.562a1.164 1.164 0 0 0 .524-.778 1.242 1.242 0 0 0-.211-.937 1.338 1.338 0 0 0-1.435-.533 1.23 1.23 0 0 0-.343.15l-2.133 1.36a4.078 4.078 0 0 1-1.135.499 4.44 4.44 0 0 1-4.765-1.766 4.108 4.108 0 0 1-.702-3.108 3.855 3.855 0 0 1 1.742-2.582l5.589-3.563a4.072 4.072 0 0 1 1.135-.499 4.44 4.44 0 0 1 4.765 1.767 4.109 4.109 0 0 1 .703 3.107 3.943 3.943 0 0 1-.134.522l-.105.321-.286-.21a7.204 7.204 0 0 0-2.187-1.093l-.208-.063.02-.207a1.255 1.255 0 0 0-.226-.831 1.337 1.337 0 0 0-1.435-.532 1.231 1.231 0 0 0-.343.15L8.62 9.368a1.162 1.162 0 0 0-.524.778 1.24 1.24 0 0 0 .211.937 1.338 1.338 0 0 0 1.435.533 1.235 1.235 0 0 0 .344-.151l2.132-1.36a4.067 4.067 0 0 1 1.135-.498 4.44 4.44 0 0 1 4.765 1.766 4.108 4.108 0 0 1 .702 3.108 3.857 3.857 0 0 1-1.742 2.583l-5.589 3.562a4.072 4.072 0 0 1-1.135.499Z"/>
                        </svg>
                    </a>

                    {{-- Angular --}}
                    <a href="{{ route('docs.section', ['framework' => 'angular', 'section' => $section]) }}"
                       class="framework-btn {{ $framework === 'angular' ? 'active text-red-600' : 'text-slate-500' }}"
                       title="Angular">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9.93 12.645h4.134L11.996 7.74M11.996.009L.686 3.988l1.725 14.76 9.585 5.243 9.588-5.238L23.308 3.99 11.996.01zm7.058 18.297h-2.636l-1.42-3.501H8.995l-1.42 3.501H4.937l7.06-15.648 7.057 15.648z"/>
                        </svg>
                    </a>
                </div>
            </div>

            <!-- Navigation with Groups -->
            <nav class="flex-1 px-3 py-2 overflow-y-auto sidebar-nav">
                @foreach($sectionGroups as $groupName => $groupSections)
                    <div class="group-title">{{ $groupName }}</div>
                    <div class="space-y-0.5">
                        @foreach($groupSections as $s)
                            <a
                                href="{{ route('docs.section', ['framework' => $framework, 'section' => $s['id']]) }}"
                                class="sidebar-link {{ $section === $s['id'] ? 'active' : '' }}"
                            >
                                <span class="icon">{{ $s['icon'] }}</span>
                                <span>{{ $s['label'] }}</span>
                            </a>
                        @endforeach
                    </div>
                @endforeach
            </nav>

            <!-- Footer -->
            <div class="p-3 border-t border-slate-100 text-[10px] text-slate-400">
                <div class="flex items-center justify-between">
                    <span>Laravel {{ app()->version() }}</span>
                    <span class="inline-flex items-center gap-1">
                        <span class="w-1.5 h-1.5 {{ $colors['dot'] }} rounded-full"></span>
                        {{ ucfirst($framework) }}
                    </span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64">
            <!-- Top Bar -->
            <header class="bg-white border-b border-slate-200 px-8 py-4 sticky top-0 z-10">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <span class="w-2.5 h-2.5 {{ $colors['dot'] }} rounded-full"></span>
                        <h2 class="text-lg font-semibold text-slate-800">
                            {{ $allSections[$section]['label'] ?? ucfirst($section) }}
                        </h2>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-xs text-slate-400">
                            @foreach($sectionGroups as $groupName => $groupSections)
                                @if(collect($groupSections)->pluck('id')->contains($section))
                                    {{ $groupName }}
                                    @break
                                @endif
                            @endforeach
                        </span>
                        <span class="inline-flex items-center gap-1.5 px-2.5 py-1 {{ $colors['bg'] }} text-white rounded-full text-xs font-medium">
                            {{ ucfirst($framework) }}
                        </span>
                    </div>
                </div>
            </header>

            <!-- Content -->
            <div class="p-8" data-accelade-page>
                {{ $slot }}
            </div>
        </main>
    </div>

    @acceladeScripts
    @acceladeNotifications

    {{-- Prism.js for syntax highlighting --}}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup-templating.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    {{-- Code block functionality --}}
    <script>
    (function() {
        // Run Prism highlighting
        if (typeof Prism !== 'undefined') {
            Prism.highlightAll();
        }

        // Copy functionality
        document.querySelectorAll('.code-copy-btn').forEach(btn => {
            btn.addEventListener('click', async function() {
                const targetId = this.dataset.codeTarget;
                const codeEl = document.getElementById(targetId);
                if (!codeEl) return;

                const code = codeEl.textContent;
                try {
                    await navigator.clipboard.writeText(code);

                    // Show success feedback
                    const copyIcon = this.querySelector('.copy-icon');
                    const checkIcon = this.querySelector('.check-icon');
                    const copyText = this.querySelector('.copy-text');

                    copyIcon.classList.add('hidden');
                    checkIcon.classList.remove('hidden');
                    copyText.textContent = 'Copied!';
                    this.classList.add('text-green-400');

                    setTimeout(() => {
                        copyIcon.classList.remove('hidden');
                        checkIcon.classList.add('hidden');
                        copyText.textContent = 'Copy';
                        this.classList.remove('text-green-400');
                    }, 2000);
                } catch (err) {
                    console.error('Failed to copy:', err);
                }
            });
        });

        // Download as image functionality - Pure Canvas approach
        document.querySelectorAll('.code-download-btn').forEach(btn => {
            btn.addEventListener('click', async function() {
                const targetId = this.dataset.codeTarget;
                const codeEl = document.getElementById(targetId);
                const wrapper = document.querySelector(`[data-code-block="${targetId}"]`);
                if (!codeEl || !wrapper) return;

                try {
                    const code = codeEl.textContent;
                    const lines = code.split('\n').filter(l => l.trim() !== '' || lines.length === 1);
                    const filename = wrapper.querySelector('.text-slate-400')?.textContent?.trim() || 'code';

                    // Canvas settings
                    const paddingX = 24;
                    const paddingY = 20;
                    const headerHeight = 44;
                    const lineHeight = 22;
                    const fontSize = 13;
                    const scale = 2;
                    const borderRadius = 12;

                    // Calculate dimensions
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    ctx.font = `${fontSize}px ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace`;

                    // Find max line width
                    let maxWidth = 350;
                    lines.forEach(line => {
                        const width = ctx.measureText(line).width;
                        if (width > maxWidth) maxWidth = width;
                    });

                    const innerWidth = maxWidth + paddingX * 2;
                    const innerHeight = headerHeight + lines.length * lineHeight + paddingY * 2;
                    const outerPadding = 20;

                    canvas.width = (innerWidth + outerPadding * 2) * scale;
                    canvas.height = (innerHeight + outerPadding * 2) * scale;

                    // Scale for retina
                    ctx.scale(scale, scale);

                    // Outer background (gradient)
                    const gradient = ctx.createLinearGradient(0, 0, canvas.width / scale, canvas.height / scale);
                    gradient.addColorStop(0, '#1e1b4b');
                    gradient.addColorStop(1, '#312e81');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width / scale, canvas.height / scale);

                    // Draw rounded rectangle for code block
                    const x = outerPadding;
                    const y = outerPadding;
                    const w = innerWidth;
                    const h = innerHeight;
                    const r = borderRadius;

                    ctx.beginPath();
                    ctx.moveTo(x + r, y);
                    ctx.lineTo(x + w - r, y);
                    ctx.quadraticCurveTo(x + w, y, x + w, y + r);
                    ctx.lineTo(x + w, y + h - r);
                    ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
                    ctx.lineTo(x + r, y + h);
                    ctx.quadraticCurveTo(x, y + h, x, y + h - r);
                    ctx.lineTo(x, y + r);
                    ctx.quadraticCurveTo(x, y, x + r, y);
                    ctx.closePath();

                    // Code block background
                    ctx.fillStyle = '#1e293b';
                    ctx.fill();

                    // Header background (top rounded corners)
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(x + r, y);
                    ctx.lineTo(x + w - r, y);
                    ctx.quadraticCurveTo(x + w, y, x + w, y + r);
                    ctx.lineTo(x + w, y + headerHeight);
                    ctx.lineTo(x, y + headerHeight);
                    ctx.lineTo(x, y + r);
                    ctx.quadraticCurveTo(x, y, x + r, y);
                    ctx.closePath();
                    ctx.fillStyle = '#334155';
                    ctx.fill();
                    ctx.restore();

                    // Traffic lights
                    const trafficLightY = y + headerHeight / 2;
                    const dotRadius = 6;
                    const dotSpacing = 20;
                    const dotStartX = x + 16;

                    ctx.fillStyle = '#ef4444';
                    ctx.beginPath();
                    ctx.arc(dotStartX, trafficLightY, dotRadius, 0, Math.PI * 2);
                    ctx.fill();

                    ctx.fillStyle = '#facc15';
                    ctx.beginPath();
                    ctx.arc(dotStartX + dotSpacing, trafficLightY, dotRadius, 0, Math.PI * 2);
                    ctx.fill();

                    ctx.fillStyle = '#22c55e';
                    ctx.beginPath();
                    ctx.arc(dotStartX + dotSpacing * 2, trafficLightY, dotRadius, 0, Math.PI * 2);
                    ctx.fill();

                    // Filename
                    ctx.fillStyle = '#94a3b8';
                    ctx.font = `11px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
                    ctx.fillText(filename.toUpperCase(), dotStartX + dotSpacing * 3 + 10, trafficLightY + 4);

                    // Code text
                    ctx.fillStyle = '#e2e8f0';
                    ctx.font = `${fontSize}px ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace`;

                    lines.forEach((line, i) => {
                        ctx.fillText(line, x + paddingX, y + headerHeight + paddingY + (i + 1) * lineHeight - 6);
                    });

                    // Border
                    ctx.strokeStyle = '#475569';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(x + r, y);
                    ctx.lineTo(x + w - r, y);
                    ctx.quadraticCurveTo(x + w, y, x + w, y + r);
                    ctx.lineTo(x + w, y + h - r);
                    ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
                    ctx.lineTo(x + r, y + h);
                    ctx.quadraticCurveTo(x, y + h, x, y + h - r);
                    ctx.lineTo(x, y + r);
                    ctx.quadraticCurveTo(x, y, x + r, y);
                    ctx.closePath();
                    ctx.stroke();

                    // Download
                    const link = document.createElement('a');
                    link.download = `${filename.toLowerCase().replace(/[^a-z0-9]/g, '-')}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) {
                    console.error('Failed to download:', err);
                    alert('Failed to generate image.');
                }
            });
        });
    })();
    </script>
    @stack('scripts')
</body>
</html>
</file>

</files>
